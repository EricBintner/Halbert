{"text": "You should have been redirected.\nIf not, click here to continue.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://ubuntu.com/server/docs/package-management"}}
{"text": "You should have been redirected.\nIf not, click here to continue.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://ubuntu.com/server/docs/network-configuration"}}
{"text": "LVM - Debian Wiki\nWiki\nLogin\nFrontPage\nRecentChanges\nFindPage\nHelpContents\nLVM\nSearch:\nWiki\n/\nLogin\nComments\nInfo\nAttachments\nMore Actions:\nRaw Text\nPrint View\nRender as Docbook\nDelete Cache\n------------------------\nCheck Spelling\nLike Pages\nLocal Site Map\n------------------------\nRename Page\nDelete Page\n------------------------\nSubscribe User\n------------------------\nRemove Spam\nRevert to this revision\nPackage Pages\n------------------------\nLoad\nSave\nSlideShow\nLVM\nDiscussion\nTranslation(s)\n:\nEnglish\n-\nEspañol\n-\nFrançais\n-\nLVM is a\nLogical Volume Manager\nfor the Linux operating system.\nContents\nOverview\nDefinitions\nEncrypted LVM\nBacking up passwords for encrypted LVM\nRestore passwords\nUsing Encrypted LVM as a swap partition\nLabels\n/boot\nLVM cached volumes\nInstallation\nList of LVM commands\nPhysical Volumes (PV)\nCreate a PV\nRemove a PV\nList of PV commands\nVolume Groups (VG)\nCreate a volume group\nExtend a volume group\nRenaming a volume group\nList VGs\nList of VG commands\nLogical Volumes (LV)\nCreate an LV\nRemove a LV\nIncrease the size of a partition using LVM\nShrinking a partition using LVM\nList of LV commands\nGraphical applications for managing LVM\nKDE PartitionManager\nBlivet-GUI\nSee also:\nOverview\nLogical volume management with LVM provides a more flexible way to manage the disk space on a system than the traditional approach of dividing a disk into  partitions. LVM gives the system administrator much more flexibility in allocating storage, because partitions controlled by LVM be resized and moved  around, and a single partition can reside on more than one physical hard disk.\nDefinitions\nPV\n: Physical Volumes.  This means a hard disk, hard disk partition, RAID or LUNs from a SAN.\nVG\n: Volume Groups.  This is a collection of one or more Physical Volumes.\nLV\n: Logical Volumes.  LVs sit inside a Volume Group and form, in effect, a virtual partition.\nPE\n: Physical Extents.  In order to manipulate the actual data, it is divided into blocks called\nP\nhysical\nE\nxtents.\nLE\n: Logical Extents.  Similar to Physical Extents, but at the Logical Volume level.  Physical Extents are to Physical Volumes as Logical Extents are to Logical Volumes.  The size of blocks are the same for each logical volume (LV) in the same volume group (VG).\nThe most important terms for users are the PVs, VGs and LVs.\nAn example:\n||-------------------------OS----------------------------||\n||-------------------------LVM---------------------------||\n||  LV-1 (/)    |LV-2 (swap)|  LV 3 (/home) | LV-4 (/tmp)|| Logical Volumes (LV)\n||------------------------------------------|------------||\n||                  VG 1                    |    VG 2    || Volume Groups (VG)\n||------------------------------------------|------------||\n||  /dev/sda2 |    /dev/sda3    | /dev/sdb2 | /dev/sdd4  || Physical Volumes (PV)\n||-------------------------------------------------------||\nEncrypted LVM\nWhen formatting an LVM volume, you can choose whether to encrypt the data on it or not. Using encrypted LVM is recommended if you are worried about your  computer or disk storage being stolen.\nIf you choose the encrypted LVM option, it is suggested to consider creating\nbackup passwords\nto ensure you can recover from data loss: Otherwise if you forget the password you will permanently lose all your valuable data\nBacking up passwords for encrypted LVM\nCreating backup passwords is a two step process. First you create a backup password and then you back them up.\nAdd backup passwords\nRun the following command as root:\ncryptsetup luksChangeKey <device> -S <key-slot>\nNotes\nThe\n-S\noption specifies a\n<key-slot>\n(number from 0 to 7) holding a password. You need to replace\n<device>\nwith the path to your encrypted LVM volume. For example\n/dev/sda\n.\nIt is suggested to create at least 3 backup passwords. To add an additional backup password simply run the same command, but change the\n<key-slot>\nnumber. For example to set the password in slot 2 use:\ncryptsetup luksChangeKey /dev/sda -S 2\nThe password(s) of a encrypted LVM volume are stored inside its Linux Unified Key Setup (LUKS) header.\nBack up the passwords\nRun the following command as root:\ncryptsetup luksHeaderBackup <device> --header-backup-file <file>\nNotes\n<device>\nis the location to save your backup to, for example\n/dev/sda\n. And\n<file>\nis the name of your backup file, for example\n/media/jenn/2017-05-18_luks_sda_backup\n. This command backs up the passwords in all eight key-slots.\nIt is suggested to store the backup file in a secure, off-line, and different location to ensure that you can access them if you lose access to LVM volume.\nSee the official\nLUKS wiki documentation\nfor more information\nRestore passwords\nRestore passwords from backup\nRun the following command as root\ncryptsetup luksHeaderRestore <device> --header-backup-file <file>\nNotes\nThis command will delete\nall\neight passwords, then restore\nall\nyour backed up passwords. Before running this command, you should double check that you are sure you really want to proceed: there is no undo\nYou need to change\n<device>\nto the path to your encrypted LVM volume, for example\n/dev/sda\n. You need to change\n<file>\nto the path to your backup file, for example\n/media/jenn/2017-05-18_luks_sda_backup\n.\nSee the official\nLUKS wiki documentation\nfor more information\nUsing Encrypted LVM as a swap partition\nIf you use encrypted LVM partitions then you will probably want to encrypt your swap partition as well, because the LVM encryption key is stored in memory and may be written to swap: anyone with physical access may be able to retrieve the encryption keys for all encrypted partitions by accessing the swap partition. The Debian installer will warn against creating an LVM encrypted partition unless the swap partition is encrypted (see\nSource\n)\nLabels\nYou should use labels for Logical Volume (LV) identification in\n/etc/fstab\n, instead of UUIDs or the kernel naming rules (/dev/sda) in order to avoid conflicts with the restoration of volume snapshots.\n/boot\nGrub\nv2 supports booting from an LVM partition since\nDebianSqueeze\n.\nIf you plan to encrypt your root filesystem\n/boot\nmay need to be located in a separate, unencrypted, Logical Volume or partition. Refer to the\nCryptsetup\ndocumentation for more information.\nGRUB v1 and\nLILO\nwere not compatible with LVM, if you use one of those legacy bootloaders\n/boot\ncould not be on the storage disk managed by LVM.\nLVM cached volumes\nTo use\nlvmcache(7)\nyour system must have the\nthin-provisioning-tools\ninstalled for its\ncache_check\ntool, otherwise cached volumes will not be available at boot.  This could result in the system being unbootable without manual intervention.\nInstallation\nAll tools to manage an LVM volume are available in the\nlvm2\npackage which can be installed by running\napt install lvm2\nList of LVM commands\nlvmchange\n— Change attributes of the Logical Volume Manager.\nlvmdiskscan\n— Scan for all devices visible to LVM2.\nlvmdump\n— Create lvm2 information dumps for diagnostic purposes.\nPhysical Volumes (PV)\nCreate a PV\nTo add a hard disk or partition, such as\n/dev/sda2\n, to LVM, you create a physical volume, by running the following as root:\npvcreate /dev/sda2\nYou can now add this PV to a volume group (or create a new VG, see below).\nRemove a PV\nIn order to remove a physical disk from LVM Physical Volume (PV) all data must first be moved off it.  To do this, make sure any other physical volumes in the same volume group have enough free space and then issue this command as root:\npvmove /dev/sda2\nAfter the data is moved, remove the disk from the volume group. Assuming the VG is named\nvol-group\n, run the following as root:\nvgreduce vol-group /dev/sda2\nAnd finally remove the PV by running this as root:\npvremove /dev/sda2\nList of PV commands\npvchange\n— Change attributes of a Physical Volume.\npvck\n— Check Physical Volume metadata.\npvcreate\n— Initialize a disk or partition for use by LVM.\npvdisplay\n— Display attributes of a Physical Volume.\npvmove\n— Move Physical Extents.\npvremove\n— Remove a Physical Volume.\npvresize\n— Resize a disk or partition in use by LVM2.\npvs\n— Report information about Physical Volumes.\npvscan\n— Scan all disks for Physical Volumes.\nVolume Groups (VG)\nCreate a volume group\nAssuming\n/dev/sda2\nhas been set up as an LVM Physical volume, root can add it to a new volume group by running:\nvgcreate myVirtualGroup1 /dev/sda2\nExtend a volume group\nA volume group can contian multiple physical volumes: after running\npvcreate /dev/sda3\nyou can add the new PV to an existing VG that already exists:\nvgextend VG /dev/sda3\nRenaming a volume group\nRenaming a volume group can be tricky if it contains the root or swap partition.  In that case it should be insured that the old names are still accessible via /dev/mapper until a full reboot cycle is complete.\nvgrename somename-vg vgsomename\ncd /dev/mapper\nls somename-vg*\n## somename--vg-lv1\n## somename--vg-lv2\n...\nln -s vgsomename-lv1   somename--vg-lv1\nln -s vgsomename-lv2   somename--vg-lv2\n...\n# if logical volumes of the group are contained in /etc/fstab:\nsed -i 's#/dev/mapper/somename--vg-#/dev/vgsomename/#g' /etc/fstab\n# if logical volumes of the group are contained in /boot/grub/grub.cfg:\nsed -i 's#/dev/mapper/somename--vg-#/dev/vgsomename/#g' /boot/grub/grub.cfg  # this is only good for the initramfs run and the initial next reboot\nupdate-initramfs -c -k all\nreboot\nupdate-grub #creating final /boot/grub/grub.cfg\nList VGs\nSimply run this command:\nvgdisplay\nList of VG commands\nvgcfgbackup\n— Backup Volume Group descriptor area.\nvgcfgrestore\n— Restore Volume Group descriptor area.\nvgchange\n— Change attributes of a Volume Group.\nvgck\n— Check Volume Group metadata.\nvgconvert\n— Convert Volume Group metadata format.\nvgcreate\n— Create a Volume Group.\nvgdisplay\n— Display attributes of Volume Groups.\nvgexport\n— Make volume Groups unknown to the system.\nvgextend\n— Add Physical Volumes to a Volume Group.\nvgimport\n— Make exported Volume Groups known to the system.\nvgimportclone\n— Import and rename duplicated Volume Group (e.g. a hardware snapshot).\nvgmerge\n— Merge two Volume Groups.\nvgmknodes\n— Recreate Volume Group directory and Logical Volume special files\nvgreduce\n— Reduce a Volume Group by removing one or more Physical Volumes.\nvgremove\n— Remove a Volume Group.\nvgrename\n— Rename a Volume Group.\nvgs\n— Report information about Volume Groups.\nvgscan\n— Scan all disks for Volume Groups and rebuild caches.\nvgsplit\n— Split a Volume Group into two, moving any logical volumes from one Volume Group to another by moving entire Physical Volumes.\nLogical Volumes (LV)\nCreate an LV\nDon't forget to check that you have enough space: naturally, an LV of 100 GB does not work if you only have 10 GB of space.\nUse\nvgdisplay\nto see the free space in each volume group. All these commands must be run as root.\nCreate a logical volume in a volume group:\nlvcreate --name myLogicalVolume1 --size 10g myVirtualGroup1\nCreate a filesystem on the logical volume:\nmkfs -t ext4 /dev/myVirtualGroup1/myLogicalVolume1\nYou can test to see if it's working:\nmkdir /test\nsudo mount /dev/myVirtualGroup1/myLogicalVolume1 /test\ndf -h\nYou can list your logical volumes with:\nsudo lvdisplay\nRemove a LV\nTo remove a logical volume, make sure it is not in use.  Then simply issue this command to remove the logical volume myLogicalVolume1 in volume group myVirtualGroup1:\nlvremove myVirtualGroup1/myLogicalVolume1\nIncrease the size of a partition using LVM\nTo increase the size of a partition, such as\n/boot\nstored in a logical volume\n/dev/vg/boot\nof a volume group\nvg\nthat has some unused space:\nlvextend --resizefs --verbose --size +3G /dev/vg/boot\nThis can be done with the partition still mounted. If you do not have free space in the volume group you will need to shrink one of the other LVs in the VG or add another physical volume.\nShrinking a partition using LVM\nTo shrink a partition, such as\n/tmp\nstored on a logical volume\n/dev/vg/tmp\nof a volume group\nvg\nlvreduce --resizefs --verbose --size -1G /dev/vg/tmp\nThis assumes there was 1GB of unused space on the partition. The commmand will unmount the partition and remount it when finished: you will need to ensure nothing is using the filesystem before starting (for the root partition you may need to boot into a rescue disk and resize from there)\nList of LV commands\nlvchange\n— Change attributes of a Logical Volume.\nlvconvert\n— Convert a Logical Volume from linear to mirror or snapshot.\nlvcreate\n— Create a Logical Volume in an existing Volume Group.\nlvdisplay\n— Display the attributes of a Logical Volume.\nlvextend\n— Extend the size of a Logical Volume.\nlvreduce\n— Reduce the size of a Logical Volume.\nlvremove\n— Remove a Logical Volume.\nlvrename\n— Rename a Logical Volume.\nlvresize\n— Resize a Logical Volume.\nlvs\n— Report information about Logical Volumes.\nlvscan\n— Scan (all disks) for Logical Volumes.\nGraphical applications for managing LVM\nBelow are applications with a graphical user interface (GUI) that allows you to manage LVM devices\nKDE PartitionManager\nTo install, get this KDE\npartitionmanager\npackage\nSupports LVM2, PV, VG, LV, LUKS encryption, and others\nCode repository at\nhttps://github.com/KDE/partitionmanager/\nLibre Source (Open Source) with LGPL 3, GPL 4, GFDL 1.2, CCO 1, CC-BY 4 licences\nBlivet-GUI\nTo install, click on the \"Debian\" button at\nhttps://software.opensuse.org/download.html?project=home:vtrefny&package=blivet-gui\nThen choose an installation option.\nAvailable for Debian 10 or 11\nSupport LVM2, PV, VG, LV, and others\nCode repository at\nhttps://github.com/storaged-project/blivet-gui/\nLibre Source (Open Source) with GPL 2 licence\nSee also:\nComparison of\nLinux volume management\nsolutions for Debian users\nhttps://tldp.org/HOWTO/LVM-HOWTO\nUpstream:\nhttps://sourceware.org/lvm2/\n- Homepage, mailing list, IRC...\nhttps://sourceware.org/lvm2/wiki/\n- Wiki\nCategorySystemAdministration\n|\nCategoryStorage\n|\nCategoryPermalink\n: mentioned in the\nRelease Notes for trixie\nLVM  (\nlast modified 2025-10-20 12:52:09\n)\nChanges made after 24 July 2025 00:00 UTC are available under\nCreative Commons Attribution-ShareAlike 4.0 International\nunless otherwise noted.\nDebian\nprivacy policy\n, Wiki\nteam\n,\nbugs\nand\nconfig\n.\nPowered by\nMoinMoin\nand\nPython\n, with hosting provided by\nMetropolitan Area Network Darmstadt\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://wiki.debian.org/LVM"}}
{"text": "LVM - ArchWiki\nHome\nPackages\nForums\nWiki\nGitLab\nSecurity\nAUR\nDownload\nJump to content\nArchWiki\nSearch\nSearch\nLVM\n6 languages\nDeutsch\nEspañol\nMagyar\n日本語\nPortuguês\n中文（简体）\nFrom ArchWiki\nRelated articles\nInstall Arch Linux on LVM\nLVM on software RAID\ndm-crypt/Encrypting an entire system#LVM on LUKS\ndm-crypt/Encrypting an entire system#LUKS on LVM\nResizing LVM-on-LUKS\nCreate root filesystem snapshots with LVM\nFrom\nWikipedia:Logical Volume Manager (Linux)\n:\nLogical Volume Manager (LVM) is a\ndevice mapper\nframework that provides\nlogical volume management\nfor the\nLinux kernel\n.\nBackground\nLVM building blocks\nLogical Volume Management utilizes the kernel's\ndevice-mapper\nfeature to provide a system of\npartitions\nindependent of underlying disk layout. With LVM you abstract your storage and have \"virtual partitions\", making\nextending/shrinking\neasier (subject to potential filesystem limitations).\nVirtual partitions allow addition and removal without worry of whether you have enough contiguous space on a particular disk, getting caught up fdisking a disk in use (and wondering whether the kernel is using the old or new partition table), or, having to move other partitions out of the way.\nBasic building blocks of LVM:\nPhysical volume (PV)\nUnix block device node, usable for storage by LVM. Examples: a hard disk, an\nMBR\nor\nGPT\npartition, a loopback file, a device mapper device (e.g.\ndm-crypt\n). It hosts an LVM header.\nVolume group (VG)\nGroup of PVs that serves as a container for LVs. PEs are allocated from a VG for a LV.\nLogical volume (LV)\n\"Virtual/logical partition\" that resides in a VG and is composed of PEs. LVs are Unix block devices analogous to physical partitions, e.g. they can be directly formatted with a\nfile system\n.\nPhysical extent (PE)\nThe smallest contiguous extent (default 4 MiB) in the PV that can be assigned to a LV. Think of PEs as parts of PVs that can be allocated to any LV.\nExample:\nPhysical disks\nDisk1 (/dev/sda):\n┌──────────────────────────────────────┬─────────────────────────────────────┐\n│ Partition1  50 GiB (Physical volume) │ Partition2 80 GiB (Physical volume) │\n│ /dev/sda1                            │ /dev/sda2                           │\n└──────────────────────────────────────┴─────────────────────────────────────┘\nDisk2 (/dev/sdb):\n┌──────────────────────────────────────┐\n│ Partition1 120 GiB (Physical volume) │\n│ /dev/sdb1                            │\n└──────────────────────────────────────┘\nLVM logical volumes\nVolume Group1 (/dev/MyVolGroup/ = /dev/sda1 + /dev/sda2 + /dev/sdb1):\n┌─────────────────────────┬─────────────────────────┬──────────────────────────┐\n│ Logical volume1 15 GiB  │ Logical volume2 35 GiB  │ Logical volume3 200 GiB  │\n│ /dev/MyVolGroup/rootvol │ /dev/MyVolGroup/homevol │ /dev/MyVolGroup/mediavol │\n└─────────────────────────┴─────────────────────────┴──────────────────────────┘\nNote\nLogical volumes are accessible at both\n/dev/\nVolumeGroupName\n/\nLogicalVolumeName\nand\n/dev/mapper/\nVolumeGroupName-LogicalVolumeName\n. However,\nlvm(8) § VALID NAMES\nrecommends the former format for \"software and scripts\" (e.g.\nfstab\n) since the latter is intended for \"internal use\" and subject to possible \"change between releases and distributions\".\nAdvantages\nLVM gives you more flexibility than just using normal hard drive partitions:\nUse any number of disks as one big disk.\nHave logical volumes stretched over several disks (\nRAID\n, mirroring, striping which offer advantages such as additional resilience and performance\n[1]\n).\nCreate small logical volumes and resize them \"dynamically\" as they get filled up.\nResize logical volumes regardless of their order on disk. It does not depend on the position of the LV within VG, there is no need to ensure surrounding available space.\nResize/create/delete logical and physical volumes online. File systems on them still need to be resized, but some (such as\nExt4\nand\nBtrfs\n) support online resizing.\nOnline/live migration of LV (or segments) being used by services to different disks without having to restart services.\nSnapshots allow you to backup a frozen copy of the file system, while keeping service downtime to a minimum and easily merge the snapshot into the original volume later.\nSupport for unlocking separate volumes without having to enter a key multiple times on boot (\nmake LVM on top of LUKS\n).\nBuilt-in support for caching of frequently used data (\nlvmcache(7)\n).\nDisadvantages\nAdditional steps in setting up the system (may require changes to\nmkinitcpio\nconfiguration), more complicated. Requires (multiple) daemons to constantly run.\nIf dual-booting, note that Windows does not support LVM; you will be unable to access any LVM partitions from Windows. 3rd Party software may allow to mount certain kinds of LVM setups.\n[2]\nIf your physical volumes are not on a RAID-1, RAID-5 or RAID-6 losing one disk\ncan\nlose one or more logical volumes if you span (or extend) your logical volumes across multiple non-redundant disks.\nIt is not always easy to shrink the space used by the logical volume manager, meaning the physical volumes used for the logical volumes. If the physical extents are scattered across the physical volume until the end you might need to inspect the segments and move them (potentially to another physical device) or the same device with custom allocation settings (e.g.\n--alloc anywhere\n). If you want to dual-boot with other operating systems (e.g. with Microsoft Windows), the only space left on the device for Microsoft Windows is the space not used by LVM / not used as physical volume.\nPotentially worse performance than using plain partitions.\n[3]\nMay not work well with all file systems, especially those that are designed to be (multi-)device aware. For example,\nBtrfs\noffers some of the same functionality (\nmulti device support\n,\n(sub)volumes\n, snapshots and\nRAID\n) which could clash (read further about issues with LVM snapshots with\nBtrfs\n).\nInstallation\nMake sure the\nlvm2\npackage is\ninstalled\n.\nIf you have LVM volumes not activated via the\ninitramfs\n,\nenable\nlvm2-monitor.service\n, which is provided by the\nlvm2\npackage.\nVolume operations\nPhysical volumes\nCreating\nTo create a PV on\n/dev/sda1\n, run:\n# pvcreate /dev/sda1\nYou can check the PV is created using the following command:\n# pvs\nGrowing\nAfter extending or prior to reducing the size of a device that has a physical volume on it, you need to grow or shrink the PV using\npvresize(8)\n.\nTo expand the PV on\n/dev/sda1\nafter enlarging the\npartition\n, run:\n# pvresize /dev/sda1\nThis will automatically detect the new size of the device and extend the PV to its maximum.\nNote\nThis command can be done while the volume is online.\nShrinking\nTo shrink a physical volume prior to reducing its underlying device, add the\n--setphysicalvolumesize\nsize\nparameters to the command,\ne.g.\n:\n# pvresize --setphysicalvolumesize 40G /dev/sda1\nThe above command may leave you with this error:\n/dev/sda1: cannot resize to 25599 extents as later ones are allocated.\n0 physical volume(s) resized / 1 physical volume(s) not resized\nIndeed\npvresize\nwill refuse to shrink a PV if it has allocated extents after where its new end would be. One needs to run\npvmove\nbeforehand to relocate these elsewhere in the volume group if there is sufficient free space.\nMove physical extents\nBefore freeing up physical extents at the end of the volume, one must run\npvdisplay -v -m\nto see them. An alternative way to view segments in a tabular form is\npvs --segments -v\n.\nIn the below example, there is one physical volume on\n/dev/sdd1\n, one volume group\nvg1\nand one logical volume\nbackup\n.\n# pvdisplay -v -m\nFinding all volume groups.\nUsing physical volume(s) on command line.\n--- Physical volume ---\nPV Name               /dev/sdd1\nVG Name               vg1\nPV Size               1.52 TiB / not usable 1.97 MiB\nAllocatable           yes\nPE Size               4.00 MiB\nTotal PE              399669\nFree PE               153600\nAllocated PE          246069\nPV UUID               MR9J0X-zQB4-wi3k-EnaV-5ksf-hN1P-Jkm5mW\n--- Physical Segments ---\nPhysical extent 0 to 153600:\nFREE\nPhysical extent 153601 to 307199:\nLogical volume\t/dev/vg1/backup\nLogical extents\t1 to 153599\nPhysical extent 307200 to 307200:\nFREE\nPhysical extent 307201 to 399668:\nLogical volume\t/dev/vg1/backup\nLogical extents\t153601 to 246068\nOne can observe\nFREE\nspace are split across the volume. To shrink the physical volume, we must first move all used segments to the beginning.\nHere, the first free segment is from 0 to 153600 and leaves us with 153601 free extents. We can now move this segment number from the last physical extent to the first extent. The command will thus be:\n# pvmove --alloc anywhere /dev/sdd1:307201-399668 /dev/sdd1:0-92467\n/dev/sdd1: Moved: 0.1 %\n/dev/sdd1: Moved: 0.2 %\n...\n/dev/sdd1: Moved: 99.9 %\n/dev/sdd1: Moved: 100.0 %\nNote\nThis command moves 399668 - 307201 + 1 = 92468 PEs\nfrom\nthe last segment\nto\nthe first segment. This is possible as the first segment encloses 153600 free PEs, which can contain the 92467 - 0 + 1 = 92468 moved PEs.\nThe\n--alloc anywhere\noption is used as we move PEs inside the same partition. In case of different partitions, the command would look something like this:\n# pvmove /dev/sdb1:1000-1999 /dev/sdc1:0-999\nThis command may take a long time (one to two hours) in case of large volumes. It might be a good idea to run this command in a\ntmux\nor\nGNU Screen\nsession. Any unwanted stop of the process could be fatal.\nOnce the operation is complete, run\nfsck\nto make sure your file system is valid.\nResize physical volume\nOnce all your free physical segments are on the last physical extents, run\nvgdisplay\nwith root privileges and see your free PE.\nThen you can now run again the command:\n# pvresize --setphysicalvolumesize\nsize\nPhysicalVolume\nSee the result:\n# pvs\nPV         VG   Fmt  Attr PSize    PFree\n/dev/sdd1  vg1  lvm2 a--     1t     500g\nResize partition\nLast, you need to shrink the partition with your favorite\npartitioning tool\n.\nVolume groups\nCreating a volume group\nTo create a VG\nMyVolGroup\nwith an associated PV\n/dev/sdb1\n, run:\n# vgcreate MyVolGroup /dev/sdb1\nYou can check the VG\nMyVolGroup\nis created using the following command:\n# vgs\nYou can bind multiple PVs when creating a VG like this:\n# vgcreate MyVolGroup /dev/sdb1 /dev/sdb2\nActivating a volume group\nNote\nYou can restrict the volumes that are activated automatically by setting the\nauto_activation_volume_list\nin\n/etc/lvm/lvm.conf\n. If in doubt, leave this option commented out.\n# vgchange -a y MyVolGroup\nBy default, this will reactivate the volume group when applicable. For example, if you had a drive failure in a mirror and you swapped the drive; and ran (1)\npvcreate\n, (2)\nvgextend\nand (3)\nvgreduce --removemissing --force\n.\nRepairing a volume group\nTo start the rebuilding process of the degraded mirror array in this example, you would run:\n# lvconvert --repair /dev/MyVolGroup/mirror\nYou can monitor the rebuilding process (Cpy%Sync Column output) with:\n# lvs -a -o +devices\nDeactivating a volume group\nJust invoke\n# vgchange -a n MyVolGroup\nThis will deactivate the volume group and allow you to unmount the container it is stored in.\nRenaming a volume group\nUse the\nvgrename(8)\ncommand to rename an existing volume group.\nEither of the following commands renames the existing volume group\nMyVolGroup\nto\nmy_volume_group\n# vgrename /dev/MyVolGroup /dev/my_volume_group\n# vgrename MyVolGroup my_volume_group\nMake sure to update all configuration files (e.g.\n/etc/fstab\nor\n/etc/crypttab\n) that reference the renamed volume group.\nAdd physical volume to a volume group\nYou first create a new physical volume on the block device you wish to use, then extend your volume group\n# pvcreate /dev/sdb1\n# vgextend MyVolGroup /dev/sdb1\nThis of course will increase the total number of physical extents on your volume group, which can be allocated by logical volumes as you see fit.\nNote\nIt is considered good form to have a\npartition table\non your storage medium below LVM. Use the appropriate partition type:\n8e\nfor MBR, and\nE6D6D379-F507-44C2-A23C-238F2A3DF928\nfor GPT partitions (\n8e00\ntype code in\ngdisk\n,\nlvm\ntype alias in\nfdisk\n).\nRemove partition from a volume group\nIf you created a logical volume on the partition,\nremove\nit first.\nAll of the data on that partition needs to be moved to another partition. Fortunately, LVM makes this easy:\n# pvmove /dev/sdb1\nIf you want to have the data on a specific physical volume, specify that as the second argument to\npvmove\n:\n# pvmove /dev/sdb1 /dev/sdf1\nThen the physical volume needs to be removed from the volume group:\n# vgreduce MyVolGroup /dev/sdb1\nOr remove all empty physical volumes:\n# vgreduce --all MyVolGroup\nFor example: if you have a bad disk in a group that cannot be found because it has been removed or failed:\n# vgreduce --removemissing --force MyVolGroup\nAnd lastly, if you want to use the partition for something else, and want to avoid LVM thinking that the partition is a physical volume:\n# pvremove /dev/sdb1\nLogical volumes\nNote\nlvresize(8)\nprovides more or less the same options as the specialized\nlvextend(8)\nand\nlvreduce(8)\ncommands, while allowing to do both types of operation. Notwithstanding this, all those utilities offer a\n-r\n/\n--resizefs\noption which allows to resize the file system together with the LV using\nfsadm(8)\n(\next2\n,\next3\n,\next4\n,\nReiserFS\nand\nXFS\nsupported). Therefore it may be easier to simply use\nlvresize\nfor both operations and use\n--resizefs\nto simplify things a bit, except if you have specific needs or want full control over the process.\nWarning\nWhile enlarging a file system can often be done on-line (\ni.e.\nwhile it is mounted), even for the root partition, shrinking will nearly always require to first unmount the file system so as to prevent data loss. Make sure your file system supports what you are trying to do.\nTip\nIf a logical volume will be formatted with\next4\n, leave at least 256 MiB free space in the volume group to allow using\ne2scrub(8)\n. After creating the last volume with\n-l 100%FREE\n, this can be accomplished by reducing its size with\nlvreduce -L -256M\nvolume_group\n/\nlogical_volume\n.\nCreating a logical volume\nTo create a LV\nhomevol\nin a VG\nMyVolGroup\nwith 300 GiB of capacity, run:\n# lvcreate -L 300G MyVolGroup -n homevol\nor, to create a LV\nhomevol\nin a VG\nMyVolGroup\nwith the rest of capacity, run:\n# lvcreate -l 100%FREE MyVolGroup -n homevol\nTo create the LV while restricting it to specific PVs within the VG, append them to the command:\n# lvcreate -L 300G MyVolGroup -n homevol /dev/sda1\nThe new LV will appear as\n/dev/MyVolGroup/homevol\n. Now you can\nformat\nthe LV with an appropriate file system.\nYou can check the LV is created using the following command:\n# lvs\nRenaming a logical volume\nTo rename an existing logical volume, use the\nlvrename(8)\ncommand.\nEither of the following commands renames logical volume\nold_vol\nin volume group\nMyVolGroup\nto\nnew_vol\n.\n# lvrename /dev/MyVolGroup/old_vol /dev/MyVolGroup/new_vol\n# lvrename MyVolGroup old_vol new_vol\nMake sure to update all configuration files (e.g.\n/etc/fstab\nor\n/etc/crypttab\n) that reference the renamed logical volume.\nResizing the logical volume and file system in one go\nNote\nOnly\next2\n,\next3\n,\next4\n,\nReiserFS\nand\nXFS\nfile systems\nare supported. For a different type of file system see\n#Resizing the logical volume and file system separately\n.\nExtend the logical volume\nmediavol\nin\nMyVolGroup\nby 10 GiB  and resize its file system\nall at once\n:\n# lvresize -L +10G --resizefs MyVolGroup/mediavol\nSet the size of logical volume\nmediavol\nin\nMyVolGroup\nto 15 GiB and resize its file system\nall at once\n:\n# lvresize -L 15G --resizefs MyVolGroup/mediavol\nIf you want to fill all the free space on a volume group, use the following command:\n# lvresize -l +100%FREE --resizefs MyVolGroup/mediavol\nSee\nlvresize(8)\nfor more detailed options.\nResizing the logical volume and file system separately\nFor file systems not supported by\nfsadm(8)\nwill need to use the\nappropriate utility\nto resize the file system before shrinking the logical volume or after expanding it.\nTo extend logical volume\nmediavol\nwithin volume group\nMyVolGroup\nby 2 GiB\nwithout\ntouching its file system:\n# lvresize -L +2G MyVolGroup/mediavol\nNow expand the file system (\next4\nin this example) to the maximum size of the underlying logical volume:\n# resize2fs /dev/MyVolGroup/mediavol\nFor\nBtrfs\n,\nbtrfs-filesystem(8)\nexpects the mountpoint instead of the device, the equivalent is:\n# btrfs filesystem resize max\n/mnt/my-mountpoint\nTo reduce the size of logical volume\nmediavol\nin\nMyVolGroup\nby 500 MiB, first calculate the resulting file system size and shrink the file system (\nExt4\nin this example) to the new size:\n# resize2fs /dev/MyVolGroup/mediavol\nNewSize\nUnlike Ext4,\nBtrfs\nsupports online shrinking (again, a mountpoint should be specified) e.g.:\n# btrfs filesystem resize -500M\n/mnt/my-mountpoint\nWhen the file system is shrunk, reduce the size of logical volume:\n# lvresize -L -500M MyVolGroup/mediavol\nTo calculate the exact logical volume size for\next2\n,\next3\n,\next4\nfile systems, use a simple formula:\nLVM_EXTENTS = FS_BLOCKS × FS_BLOCKSIZE ÷ LVM_EXTENTSIZE\n.\n# tune2fs -l /dev/MyVolGroup/mediavol | grep Block\nBlock count:              102400000\nBlock size:               4096\nBlocks per group:         32768\n# vgdisplay MyVolGroup | grep \"PE Size\"\nPE Size               4.00 MiB\nNote\nThe file system block size is in bytes. Make sure to use the same units for both block and extent size.\n102400000 blocks × 4096 bytes/block ÷ 4 MiB/extent = 100000 extents\nPassing\n--resizefs\nwill confirm that the correctness.\n# lvreduce -l 100000 --resizefs /dev/MyVolGroup/mediavol\n...\nThe filesystem is already 102400000 (4k) blocks long.  Nothing to do!\n...\nLogical volume sysvg/root successfully resized.\nSee\nlvresize(8)\nfor more detailed options.\nRemoving a logical volume\nWarning\nBefore you remove a logical volume, make sure to move all data that you want to keep somewhere else; otherwise, it will be lost!\nFirst, find out the name of the logical volume you want to remove. You can get a list of all logical volumes with:\n# lvs\nNext, look up the mountpoint of the chosen logical volume:\n$ lsblk\nThen unmount the filesystem on the logical volume:\n# umount /\nmountpoint\nFinally, remove the logical volume:\n# lvremove\nvolume_group\n/\nlogical_volume\nFor example:\n# lvremove MyVolGroup/homevol\nConfirm by typing in\ny\n.\nMake sure to update all configuration files (e.g.\n/etc/fstab\nor\n/etc/crypttab\n) that reference the removed logical volume.\nYou can verify the removal of the logical volume by typing\nlvs\nas root again (see first step of this section).\nSnapshots\nLVM supports CoW (Copy-on-Write) snapshots. A CoW snapshot initially points to the original data. When data blocks are overwritten, the original copy is left intact and the new blocks are written elsewhere on-disk. This has several desirable properties:\nCreating snapshots is fast, because it does not copy data (just the much shorter list of pointers to the on-disk locations).\nSnapshots require just enough free space to hold the new data blocks (plus a negligible amount for the pointers to the new blocks). For example, a snapshot of 35 GiB of data, where you write only 2 GiB (on both the original and snapshot), only requires 2 GiB of free space.\nLVM snapshots are at the block level. They make a new block device, with no apparent relationship to the original except when dealing with the LVM tools. Therefore, deleting files in the original copy does not free space in the snapshots. If you need filesystem-level snapshots, you rather need\nbtrfs\n,\nZFS\nor\nbcachefs\n.\nWarning\nA CoW snapshot\nis not a backup\n, because it does not make a second copy of the original data. For example, a damaged disk sector that affects original data also affects the snapshots. That said, a snapshot can be helpful while using other tools to make backups, as outlined\nbelow\n.\nBtrfs expects different filesystems to have different UUIDs. If you snapshot a LVM volume that contains a btrfs filesystem, make sure to change the UUID of the original or the copy, before both are mounted (or made visible to the kernel, for example if an unrelated daemon triggers a\nbtrfs device scan\n). For details see\nbtrfs wiki Gotcha's\n.\nConfiguration\nYou create snapshot logical volumes just like normal ones.\n# lvcreate --size 100M --snapshot --name snap01vol /dev/MyVolGroup/lvol\nWith that volume, you may modify less than 100 MiB of data, before the snapshot volume fills up.\nReverting the modified\nlvol\nlogical volume to the state when the\nsnap01vol\nsnapshot was taken can be done with\n# lvconvert --merge /dev/MyVolGroup/snap01vol\nIn case the origin logical volume is active, merging will occur on the next reboot (merging can be done even from a LiveCD).\nNote\nThe snapshot will no longer exist after merging.\nAlso multiple snapshots can be taken and each one can be merged with the origin logical volume at will.\nBackups\nA snapshot provides a frozen copy of a file system to make backups. For example, a backup taking two hours provides a more consistent image of the file system than directly backing up the partition.\nThe snapshot can be mounted and backed up with\ndd\nor\ntar\n. The size of the backup file done with\ndd\nwill be the size of the files residing on the snapshot volume.\nTo restore just create a snapshot, mount it, and write or extract the backup to it. And then merge it with the origin.\nSee\nCreate root filesystem snapshots with LVM\nfor automating the creation of clean root file system snapshots during system startup for backup and rollback.\nThis article or section needs expansion.\nReason:\nShow scripts to automate snapshots of root before updates, to rollback... updating\nmenu.lst\nto boot snapshots (maybe in a separate article?) (Discuss in\nTalk:LVM\n)\nEncryption\nSee\ndm-crypt/Encrypting an entire system#LUKS on LVM\nand\ndm-crypt/Encrypting an entire system#LVM on LUKS\nfor the possible schemes of combining LUKS with LVM.\nCache\nThis article or section needs expansion.\nReason:\nLVM also supports\n--type writecache\nwhich uses dm-writecache. (Discuss in\nTalk:LVM\n)\nFrom\nlvmcache(7)\n:\nThe cache logical volume type uses a small and fast LV to improve the performance of a large and slow LV. It does this by storing the frequently used blocks on the faster LV. LVM refers to the small fast LV as a cache pool LV. The large slow LV is called the origin LV. Due to requirements from dm-cache (the kernel driver), LVM further splits the cache pool LV into two devices - the cache data LV and cache metadata LV. The cache data LV is where copies of data blocks are kept from the origin LV to increase speed. The cache metadata LV holds the accounting information that specifies where data blocks are stored (e.g. on the origin LV or on the cache data LV).  Users should be familiar with these LVs if they wish to create the best and most robust cached logical volumes. All of these associated LVs must be in the same VG.\nCreate cache\nConvert your fast disk (\n/dev/\nfastdisk\n) to PV and add to your existing VG (\nMyVolGroup\n):\n# vgextend MyVolGroup /dev/\nfastdisk\nUsing a cache logical volume\nCreate a cache logical volume with automatic metadata on\n/dev/\nfastdisk\nand convert the existing LV\nMyVolGroup/rootvol\nto a cached LV, all in one step:\n# lvcreate --type cache --cachemode writethrough -l 100%FREE -n root_cachevol MyVolGroup/rootvol /dev/\nfastdisk\nTip\nInstead of using\n-l 100%FREE\nto allocate 100% of available space from PV\n/dev/\nfastdisk\n, you can use\n-L 20G\ninstead to allocate only 20 GiB for cachevol.\nUsing a cache pool\nWith a cache logical volume, LVM automatically manages metadata and data for the cache. But you can also manually create the metatada and cache LVs, and create a cache pool:\n# lvcreate -n cache_meta -l 1%FREE MyVolGroup /dev/\nfastdisk\n# lvcreate -n cache_data -l 100%FREE MyVolGroup /dev/\nfastdisk\n# lvconvert --type cache-pool --cachemode writeback --poolmetadata MyVolGroup/cache_meta MyVolGroup/cache_data\n# lvconvert --type cache --cachepool MyVolGroup/cache_data MyVolGroup/rootvol\nCachemode options\nCachemode has two possible options:\nwritethrough\nensures that any data written will be stored both in the cache LV and on the origin LV. The loss of a device associated with the cache LV in this case would not mean the loss of any data;\nwriteback\nensures better performance, but at the cost of a higher risk of data loss in case the drive used for cache fails.\nIf a specific\n--cachemode\nis not indicated, the system will assume\nwritethrough\nas default.\nTip\nCache hit and miss counts can be viewed with\nlvdisplay\nor alternatively with\nlvm-cache-stats\nfrom\nlibblockdev-lvm\nwhich also shows them in percentages.\nRemove cache\nIf you ever need to undo the one step creation operation above:\n# lvconvert --uncache MyVolGroup/rootvol\nThis commits any pending writes still in the cache back to the origin LV, then deletes the cache. Other options are available and described in\nlvmcache(7)\n.\nRAID\nLVM may be used to create a\nsoftware RAID\n. It is a good choice if the user does not have hardware RAID and was planning on using LVM anyway. From\nlvmraid(7)\n:\nlvm(8)\nRAID is a way to create a Logical Volume (LV) that uses multiple physical devices to improve performance or tolerate device failures.  In LVM, the physical devices are Physical Volumes (PVs) in a single Volume Group (VG).\nLVM RAID supports RAID 0, RAID 1, RAID 4, RAID 5, RAID 6 and RAID 10. See\nWikipedia:Standard RAID levels\nfor details on each level.\nTip\nmdadm\nmay also be used to create a software RAID. It is arguably simpler, more popular, and easier to setup.\nSetup RAID\nCreate physical volumes:\n# pvcreate /dev/sda2 /dev/sdb2\nCreate volume group on the physical volumes:\n# vgcreate MyVolGroup /dev/sda2 /dev/sdb2\nNew volumes\nCreate logical volumes using\nlvcreate --type\nraidlevel\n, see\nlvmraid(7)\nand\nlvcreate(8)\nfor more options.\n# lvcreate --type RaidLevel [OPTIONS] -n Name -L Size VG [PVs]\nPlease mind how the examples below each specify the physical volumes. This can make sense in some situations to have LVM use a specific subset of devices for your new logical volume. But generally speaking, this is not necessary.\nRAID 0\nFor example:\n# lvcreate -n myraid1vol -i 2 -I 64 -L 70G VolGroup00 /dev/nvme1n1p1 /dev/nvme0n1p1\nwill create a 70 GiB striped (raid0) logical volume named \"myraid1vol\" in VolGroup00. Stripes will be spread over\n/dev/nvme1n1p1\nand\n/dev/nvme0n1p1\n. Stripesize is set to be 64K.\nRAID 1\nFor example:\n# lvcreate --type raid1 --mirrors 1 -L 20G -n myraid1vol MyVolGroup /dev/sda2 /dev/sdb2\nwill create a 20 GiB mirrored logical volume named \"myraid1vol\" in VolGroup00 on\n/dev/sda2\nand\n/dev/sdb2\n.\nRAID 5\nRAID5 requires at least three drives (number of\n--stripes\nplus one parity device). Data and parity blocks are stored on each device, typically in a rotating pattern.\nFor example:\n# lvcreate --type raid5 --stripes 2 -L 40G -n myraid5vol MyVolGroup /dev/sda2 /dev/sdb2 /dev/sdc2\nwill create a 40 GiB striped logical volume named \"myraid5vol\" in VolGroup00 on\n/dev/sda2\n,\n/dev/sdb2\nand\n/dev/sdc2\n. On each disk, the RAID5 will occupy about 20 GiB.\nRAID 6\nRAID6 requires at least five drives (number of\n--stripes\nplus two parity devices). As with RAID5, data and parity blocks are stored on each device, typically in a rotating pattern.\nFor example:\n# lvcreate --type raid6 --stripes 3 -L 60G -n myraid6vol MyVolGroup /dev/sda2 /dev/sdb2 /dev/sdc2 /dev/sdd2\nwill create a 60 GiB striped logical volume named \"myraid6vol\" in VolGroup00 on\n/dev/sda2\n,\n/dev/sdb2\n,\n/dev/sdc2\nand\n/dev/sdd2\n. On each disk, the RAID6 will occupy about 20 GiB.\nRAID 10\nFor example:\n# lvcreate -n myraid1vol -L 100G --type raid10 -m 1 -i 2 MyVolGroup /dev/sdd1 /dev/sdc1 /dev/sdb1 /dev/sda5\nwill create a 100 GiB RAID10 logical volume named \"myraid1vol\" in VolGroup00 on\n/dev/sdd1\n,\n/dev/sdc1\n,\n/dev/sdb1\n, and\n/dev/sda5\n.\nExisting volumes\nYou can convert easily a non-RAID (e.g. linear) volume to pretty much any other raid configuration provided that you have enough physical devices to meet the RAID requirements. Some of them will require you to go through intermediate steps which\nlvconvert\nwill inform you about and prompt you to agree.\nraid10\nbelow can be replaced with\nraid0\n,\nraid1\n,\nraid5\netc.\n# lvconvert --type raid10 /dev/vg01/lv01\nUse specific PVs:\n# lvconvert --type raid10 /dev/vg01/lv01 /dev/sda1 /dev/sdb2 /dev/nvme0n1p1 ...\nYou can keep track of the progress of conversion with:\n# watch lvs -o name,vg_name,copy_percent\nThin provisioning\nNote\nWhen mounting a thin LV file system, always remember to use the\ndiscard\noption or to use\nfstrim\nregularly, to allow the thin LV to shrink as files are deleted.\nFrom\nlvmthin(7)\n:\nBlocks in a standard\nlvm(8)\nLogical Volume (LV) are allocated when the LV is created, but blocks in a thin provisioned LV are allocated as they are written. Because of this, a thin provisioned LV is given a virtual size, and can then be much larger than physically available storage. The amount of physical storage provided for thin provisioned LVs can be increased later as the need arises.\nExample: implementing virtual private servers\nHere is the classic use case. Suppose you want to start your own VPS service, initially hosting about 100 VPSes on a single PC with a 930 GiB hard drive. Hardly any of the VPSes will actually use all of the storage they are allotted, so rather than allocate 9 GiB to each VPS, you could allow each VPS a maximum of 30 GiB and use thin provisioning to only allocate as much hard drive space to each VPS as they are actually using. Suppose the 930 GiB hard drive is\n/dev/sdb\n. Here is the setup.\nPrepare the volume group,\nMyVolGroup\n.\n# vgcreate MyVolGroup /dev/sdb\nCreate the thin pool LV,\nMyThinPool\n. This LV provides the blocks for storage.\n# lvcreate --type thin-pool -n MyThinPool -l 95%FREE MyVolGroup\nThe thin pool is composed of two sub-volumes, the data LV and the metadata LV. This command creates both automatically. But the thin pool stops working if either fills completely, and LVM currently does not support the shrinking of either of these volumes. This is why the above command allows for 5% of extra space, in case you ever need to expand the data or metadata sub-volumes of the thin pool.\nFor each VPS, create a thin LV. This is the block device exposed to the user for their root partition.\n# lvcreate -n SomeClientsRoot -V 30G --thinpool MyThinPool MyVolGroup\nThe block device\n/dev/MyVolGroup/SomeClientsRoot\nmay then be used by a\nVirtualBox\ninstance as the root partition.\nUse thin snapshots to save more space\nThin snapshots are much more powerful than regular snapshots, because they are themselves thin LVs. See Red Hat's guide\n[4]\nfor a complete list of advantages thin snapshots have.\nInstead of installing Linux from scratch every time a VPS is created, it is more space-efficient to start with just one thin LV containing a basic installation of Linux:\n# lvcreate -n GenericRoot -V 30G --thinpool MyThinPool MyVolGroup\n*** install Linux at /dev/MyVolGroup/GenericRoot ***\nThen create snapshots of it for each VPS:\n# lvcreate -s MyVolGroup/GenericRoot -n SomeClientsRoot\nThis way, in the thin pool there is only one copy the data common to all VPSes, at least initially. As an added bonus, the creation of a new VPS is instantaneous.\nSince these are thin snapshots, a write operation to\nGenericRoot\nonly causes one COW operation in total, instead of one COW operation per snapshot. This allows you to update\nGenericRoot\nmore efficiently than if each VPS were a regular snapshot.\nExample: zero-downtime storage upgrade\nThere are applications of thin provisioning outside of VPS hosting. Here is how you may use it to grow the effective capacity of an already-mounted file system without having to unmount it. Suppose, again, that the server has a single 930 GiB hard drive. The setup is the same as for VPS hosting, only there is only one thin LV and the LV's size is far larger than the thin pool's size.\n# lvcreate -n MyThinLV -V 16T --thinpool MyThinPool MyVolGroup\nThis extra virtual space can be filled in with actual storage at a later time by extending the thin pool.\nSuppose some time later, a storage upgrade is needed, and a new hard drive,\n/dev/sdc\n, is plugged into the server. To upgrade the thin pool's capacity, add the new hard drive to the VG:\n# vgextend MyVolGroup /dev/sdc\nNow, extend the thin pool:\n# lvextend -l +95%FREE MyVolGroup/MyThinPool\nSince this thin LV's size is 16 TiB, you could add another 15.09 TiB of hard drive space before finally having to unmount and resize the file system.\nNote\nYou will probably want to use\nreserved blocks\nor a\ndisk quota\nto prevent applications from attempting to use more physical storage than there actually is.\nCustomizing\nSome customisation is available by editing\n/etc/lvm/lvm.conf\n. You may find it useful to customize the output of\nlvs\nand\npvs\nwhich by default does not include the % sync (useful to see progress of conversion between e.g. linear and raid type) and type of logical volume:\n/etc/lvm/lvm.conf\nreport {\nlvs_cols = \"lv_name,lv_attr,lv_active,vg_name,lv_size,lv_layout,lv_allocation_policy,copy_percent,chunk_size\"\npvs_cols = \"pv_name,vg_name,pv_size,pv_free,pv_used,dev_size\"\n}\nTroubleshooting\nLVM commands do not work\nLoad proper module:\n# modprobe dm_mod\nThe\ndm_mod\nmodule should be automatically loaded. In case it does not, explicitly\nload the module at boot\n.\nTry preceding commands with\nlvm\nlike this:\n# lvm pvdisplay\nLogical volumes do not show up\nIf you are trying to mount existing logical volumes, but they do not show up in\nlvscan\n, you can use the following commands to activate them:\n# vgscan\n# vgchange -ay\nLVM on removable media\nSymptoms:\n# vgscan\nReading all physical volumes.  This may take a while...\n/dev/backupdrive1/backup: read failed after 0 of 4096 at 319836585984: Input/output error\n/dev/backupdrive1/backup: read failed after 0 of 4096 at 319836643328: Input/output error\n/dev/backupdrive1/backup: read failed after 0 of 4096 at 0: Input/output error\n/dev/backupdrive1/backup: read failed after 0 of 4096 at 4096: Input/output error\nFound volume group \"backupdrive1\" using metadata type lvm2\nFound volume group \"networkdrive\" using metadata type lvm2\nCause: removing an external LVM drive without deactivating the volume group(s) first. Before you disconnect, make sure to:\n# vgchange -an\nvolume_group_name\nFix: assuming you already tried to activate the volume group with\nvgchange -ay\nvg\n, and are receiving the Input/output errors:\n# vgchange -an\nvolume_group_name\nUnplug the external drive and wait a few minutes:\n# vgscan\n# vgchange -ay\nvolume_group_name\nSuspend/resume with LVM and removable media\nThe factual accuracy of this article or section is disputed.\nReason:\nProvided solution will not work in more complex setups like LUKS on LVM. (Discuss in\nTalk:LVM#LVM on removable media\n)\nIn order for LVM to work properly with removable media – like an external USB drive – the volume group of the external drive needs to be deactivated before suspend. If this is not done, you may get buffer I/O errors on the dm device (after resume). For this reason, it is not recommended to mix external and internal drives in the same volume group.\nTo automatically deactivate the volume groups with external USB drives, tag each volume group with the\nsleep_umount\ntag in this way:\n# vgchange --addtag sleep_umount\nvg_external\nOnce the tag is set, use the following unit file for systemd to properly deactivate the volumes before suspend. On resume, they will be automatically activated by LVM.\n/etc/systemd/system/ext_usb_vg_deactivate.service\n[Unit]\nDescription=Deactivate external USB volume groups on suspend\nBefore=sleep.target\n[Service]\nType=oneshot\nExecStart=-/etc/systemd/system/deactivate_sleep_vgs.sh\n[Install]\nWantedBy=sleep.target\nand this script:\n/etc/systemd/system/deactivate_sleep_vgs.sh\n#!/bin/sh\nTAG=@sleep_umount\nvgs=$(vgs --noheadings -o vg_name $TAG)\necho \"Deactivating volume groups with $TAG tag: $vgs\"\n# Unmount logical volumes belonging to all the volume groups with tag $TAG\nfor vg in $vgs; do\nfor lv_dev_path in $(lvs --noheadings  -o lv_path -S lv_active=active,vg_name=$vg); do\necho \"Unmounting logical volume $lv_dev_path\"\numount $lv_dev_path\ndone\ndone\n# Deactivate volume groups tagged with sleep_umount\nfor vg in $vgs; do\necho \"Deactivating volume group $vg\"\nvgchange -an $vg\ndone\nFinally,\nenable\nthe unit.\nResizing a contiguous logical volume fails\nIf trying to extend a logical volume errors with:\n\" Insufficient suitable contiguous allocatable extents for logical volume \"\nThe reason is that the logical volume was created with an explicit contiguous allocation policy (options\n-C y\nor\n--alloc contiguous\n) and no further adjacent contiguous extents are available.\n[5]\n[\ndead link\n2025-11-17—SSL error]\nTo fix this, prior to extending the logical volume, change its allocation policy with\nlvchange --alloc inherit\nlogical_volume\n. If you need to keep the contiguous allocation policy, an alternative approach is to move the volume to a disk area with sufficient free extents. See\n[6]\n.\nCommand \"grub-mkconfig\" reports \"unknown filesystem\" errors\nMake sure to remove snapshot volumes before\ngenerating grub.cfg\n.\nThinly-provisioned root volume device times out\nWith a large number of snapshots,\nthin_check\nruns for a long enough time so that waiting for the root device times out. To compensate, add the\nrootdelay=60\nkernel boot parameter to your boot loader configuration.  Or, make\nthin_check\nskip checking block mappings (see\n[7]\n) and\nregenerate the initramfs\n:\n/etc/lvm/lvm.conf\nthin_check_options = [ \"-q\", \"--clear-needs-check-flag\", \"--skip-mappings\" ]\nDelay on shutdown\nIf you use RAID, snapshots or thin provisioning and experience a delay on shutdown, make sure\nlvm2-monitor.service\nis\nstarted\n. See\nFS#50420\n.\nHibernating into a thinly-provisioned swap volume\nSee\nPower management/Suspend and hibernate#Hibernation into a thinly-provisioned LVM volume\n.\nSee also\nLVM2 Resource Page\non SourceWare.org\nGentoo:LVM\nRed Hat Enterprise 9: Configuring and managing logical volumes\nUbuntu LVM Guide Part 1\nPart 2 details snapshots\nRetrieved from \"\nhttps://wiki.archlinux.org/index.php?title=LVM&oldid=853734\n\"\nCategory\n:\nStorage virtualization\nHidden categories:\nPages or sections flagged with Template:Expansion\nPages or sections flagged with Template:Accuracy\nPages with dead links\nSearch\nSearch\nLVM\nAdd topic", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://wiki.archlinux.org/title/LVM"}}
{"text": "NetworkConfiguration - Debian Wiki\nWiki\nLogin\nFrontPage\nRecentChanges\nFindPage\nHelpContents\nNetworkConfiguration\nSearch:\nWiki\n/\nLogin\nComments\nInfo\nAttachments\nMore Actions:\nRaw Text\nPrint View\nRender as Docbook\nDelete Cache\n------------------------\nCheck Spelling\nLike Pages\nLocal Site Map\n------------------------\nRename Page\nDelete Page\n------------------------\nSubscribe User\n------------------------\nRemove Spam\nRevert to this revision\nPackage Pages\n------------------------\nLoad\nSave\nSlideShow\nNetworkConfiguration\nTranslation(s)\n:\nEnglish\n-\nEspañol\n-\nFrançais\n-\nItaliano\n-\nPortuguês (Brasil)\n-\n简体中文\nSee the official manual:\nDebian Reference Manual - Chapter 5. Network setup\nReader Prerequisites\n: To get the most from this article, understand the following concepts before reading: basic unix command line tools, text editors, DNS, TCP/IP, DHCP, netmask, gateway\nTable of Contents\nContents\n4 ways to configure the network\nSetting up an Ethernet Interface\nStarting and Stopping Interfaces\nReinitialize new network setup\nNetwork Interface Names\nUpgrading and Network Interface Names\nUsing DHCP to automatically configure the interface\nConfiguring the interface manually\nSetting the speed and duplex\nBringing up an interface without an IP address\nDefining the (DNS) Nameservers\nDNS configuration for NetworkManager\nUsing systemd-resolved for DNS resolution\nEnabling systemd-resolved\nChecking the status and flushing the cache in systemd-resolved\nManaging systemd-resolved settings\nConfiguring dhclient\nModifying /etc/dhcp/dhclient.conf\nStop dhclient from modifying /etc/resolv.conf\nSetting additional DNS Servers\nSetting additional search domains\nConfiguring resolvconf (or a workalike)\nMaking /etc/resolv.conf immutable\nBridging\nFirewall\nHowto use vlan\nBridges and VLANs\nHowto create fault tolerant bonding with vlan\nNetwork config\nbonding with active backup\n/etc/network/interfaces\nHow to set the MTU (Max transfer unit / packet size) with VLANS over a bonded  interface\nMultiple IP addresses on one Interface\n4 ways to configure the network\nThe interfaces configuration file at /etc/network/interfaces (this page): for basic or simple configurations (e.g. workstation)\nNetworkManager\n: This is the default for Laptop configuration\nSystemd:\nDebian reference Doc Chapter 5\nNetplan\n:\nDebian reference Doc Chapter 5\nSetting up an Ethernet Interface\nThe majority of network setup can be done via the\ninterfaces\nconfiguration file at\n/etc/network/interfaces\n. Here, you can give your network card an IP address (or use dhcp), set up routing information, configure IP masquerading, set default routes and much more.\nRemember to add interfaces that you want brought up at boot time to the 'auto' line.\nSee\ninterfaces\nfor more options.\nStarting and Stopping Interfaces\nInterfaces configured with\n/etc/network/interfaces\ncan be brought up and down with the\nifup\nand\nifdown\ncommands.  For example, with an interface named\nenp7s0\n:\nsudo ifdown enp7s0\nsudo ifup enp7s0\nSome outdated guides claim you need to restart the networking service to apply changes to\n/etc/network/interfaces\n.  This was deprecated because it is possible that not all interfaces will be restarted.\nReinitialize new network setup\nIf you make more fundamental network changes to\n/etc/network/interfaces\n(e.g. adding new virtual interfaces like a bridge), you can reinitialize the network configuration by restarting the\nnetworking\ndaemon:\nsudo systemctl status networking\nsudo systemctl restart networking\nNetwork Interface Names\nSee\nNetworkInterfaceNames\n. Since\nStretch\n, old-style interface names (\neth0\n,\nwlan1\netc.) have been replaced by names based on hardware location (\nenp0s31f6\n,\nwlp1s7\netc.).  For USB dongles, these can even include the MAC address:\nenx2c56ac39ec0d\n).\nYou can list interfaces with:\nls /sys/class/net\nReplace\neno1\nwith your default interface name in the examples below.\nUpgrading and Network Interface Names\nBuster\nstill supports the old naming system as long as the file\n/etc/udev/rules.d/70-local-persistent-net.rules\nexists, but\nBullseye\nusers need to switch.\nUsing DHCP to automatically configure the interface\nIf you're just using DHCP, all you need is something like:\nauto eno1\nallow-hotplug eno1\niface eno1 inet dhcp\nFor IPv6 with DHCPv6,\nappend\nthe following:\niface eno1 inet6 dhcp\nOr for IPv6 with\nstateless address autoconfiguration\n(\"SLAAC\"),\nappend\nthe following:\niface eno1 inet6 auto\nSee also\nIPv6PrefixDelegation\n.\nConfiguring the interface manually\nIf you configure the interface manually, use something like this to set the default gateway (network, broadcast and gateway are optional):\nauto eno1\niface eno1 inet static\naddress 192.0.2.7/24\ngateway 192.0.2.254\nIf you want to add an IPv6 address too,\nappend\nsomething like:\niface eno1 inet6 static\naddress 2001:db8::c0ca:1eaf/64\ngateway 2001:db8::1ead:ed:beef\nSee\ninterfaces\nfor more options.\nMake sure to disable all DHCP services, e.g.\ndhcpcd\n.\nMixing manual and automatic configuration is also possible, e.g. to use IPv6 SLAAC for internet connectivity and static addresses within the network:\n# manual unique local address\niface eno1 inet6 static\naddress fdc3:cafe::3/64\n# use SLAAC to get global IPv6 address from the router\n# we may not enable ipv6 forwarding, otherwise SLAAC gets disabled\nautoconf 1\naccept_ra 2\nSetting the speed and duplex\nAutonegotiation repeatedly failing is often a symptom of faulty cabling - investigate physical matters before assuming that the interfaces' autonegotiation algorithms are incompatible.\nIf you turn off autonegotiation and set speed and duplex manually, the partner interface at the other end of the cable will assume that the absence of autonegotiation indicates a speed of 10Mbps and a duplex of half. For error-free operation when setting speed and duplex manually, set exactly the same speed and duplex for the devices at both ends of the cable.\nIf you set your interface's speed and duplex by hand, some trial and error may be required.  Here are the basic steps:\ninstall\nethtool\nand\nnet-tools\n, so that you have the\nethtool\nand\nmii-tool\nprograms\none or both of these might work for your interface\nhave a way to login to the system in case the network interface becomes nonfunctional\nan\nSSH\nconnection could be disrupted, so you need a fallback strategy\nidentify the interface in question (often\neno1\n)\nadjust the remainder of these instructions accordingly\ntry to determine what its current speed and duplex settings are...\ntry\nsudo ethtool eno1\nand see whether the \"Speed:\" and \"Duplex:\" lines look right\nif not,\nethtool\nmay not be supported by your device\ntry\nsudo mii-tool -v eno1\nand see whether its output looks right\nif not,\nmii-tool\nmay not be supported by your device\nif neither is supported, you may have to set parameters directly on the kernel driver module:\nidentify which driver module you're using by reading the output of\ndmesg\nand\nlsmod\ntry\nmodinfo MODULENAME\nto see what parameters it accepts, if any (you can use\nmodinfo\neven on modules that are not loaded, for comparison)\nToDo\n: where does one set kernel module parameters?\ntry to change the settings of the interface with one of these (assuming 100 Mbps and full duplex):\nsudo ethtool -s eno1 speed 100 duplex full autoneg off\nsudo mii-tool -F 100baseTx-FD eno1\nre-check to see whether the interface settings actually changed\ntry sending some data in and out of the system to see whether the NIC is operating correctly\nput the successful command in\n/etc/network/interfaces\nso it runs when you bring the interface up (e.g. at boot time)\nsome drivers begin autonegotiation when they're loaded, so you may need to delay the command a few seconds until autonegotiation finishes\niface eno1 inet static\naddress .../...\ngateway ...\nup sleep 5; ethtool -s eno1 ...\nreboot the machine to make sure it comes up correctly\nbe prepared to intervene manually (e.g. Ctrl-Alt-Del and then boot into single-user mode from GRUB or LILO)\nBringing up an interface without an IP address\nTo create a network interface without an IP address at all, use the\nmanual\nmethod and the\npre-up\nand\npost-down\ncommands:\niface eno1 inet manual\npre-up ifconfig $IFACE up\npost-down ifconfig $IFACE down\nIf the interface is a VLAN interface, the up/down commands must be executed after/before the vlan hooks.  You also have to install the\nvlan\npackage.\niface eno1.99 inet manual\npost-up ifconfig $IFACE up\npre-down ifconfig $IFACE down\nNote: If you create the VLAN interface only to put it in a bridge, there is no need to define the VLAN interface manually. Just configure the bridge, and the VLAN interface will be created automatically when creating the bridge (see below).\nDefining the (DNS) Nameservers\nBefore a computer can connect to an external network resource (e.g. a web server), it must have a means of resolving domain names used by people (e.g.\nwiki.debian.org\n) to numeric network addresses used by routers (e.g.\n140.211.166.4\n).  Here is an example\n/etc/resolv.conf\nfile that tells your computer to do that with\nCloudflare's nameserver\nand\nGoogle's nameserver\n:\nnameserver 1.1.1.1\nnameserver 8.8.8.8\nSee\nresolv.conf\nfor details.\nDNS configuration for NetworkManager\nNetworkManager\nnormally manages\n/etc/resolv.conf\n, even if you've configured DNS in\n/etc/dhcp/dhclient.conf\n.  You can get an idea of\nNetworkManager\n's settings by running\nnmcli\non the command line.\nYou can configure these settings graphically:\nrun\nnm-connection-editor\n\"Advanced Network Configuration\") in the menu system\nChoose a connection and click the cog button to edit\nClick on the IPv4 Settings tab\nChoose 'Automatic (DHCP) addresses only' instead of just 'Automatic (DHCP)'.\nEnter the DNS servers in the “DNS servers” field, separated by spaces (e.g.\n208.67.222.222\nfor OpenDNS).\nClick “Save”\nNetworkManager\nsaves these settings in\n/etc/NetworkManager/system-connections/name-of-connection\n.  For example:\n[802-3-ethernet]\nduplex\n=\nfull\nmac-address\n=\nXX:XX:XX:XX:XX:XX\n[connection]\nid\n=\nWired connection 1\nuuid\n=\nxxx-xxxxxx-xxxxxx-xxxxxx-xxx\ntype\n=\n802-3-ethernet\ntimestamp\n=\n1385213042\n[ipv6]\nmethod\n=\nauto\n[ipv4]\nmethod\n=\nauto\ndns\n=\n208.67.222.222;\nignore-auto-dns\n=\ntrue\nRun\nnmcli\nagain to check\nNetworkManager\nnow has the right idea of how your DNS should be resolved.\nUsing systemd-resolved for DNS resolution\nsystemd-resolved\nis not installed by default.  It runs a local caching dns resolver that can be integrated with\nNetworkManager\nand\nsystemd-networkd\n:\napt install systemd-resolved\nEnabling systemd-resolved\nsystemd-resolved\nis disabled by default.  To enable it:\nsystemctl enable systemd-resolved\nln -sf /run/systemd/resolve/resolv.conf /etc/resolv.conf\nAlso for glibc apps using nss, you need to edit\n/etc/nsswitch.conf\nso the hosts line looks like:\nhosts:           mymachines resolve [!UNAVAIL=return] files dns myhostname\nThis will use\nnss-resolve(8)\nfor resolution.\nNote that resolved supports\n/etc/hosts\nso should to go before the\nfiles\nentry.\nChecking the status and flushing the cache in systemd-resolved\nYou can check the status of\nsystemd-resolved\nwith\nresolvectl\n:\nresolvectl\nYou can flush the cache that resolved has with:\nresolvectl flush-cache\nManaging systemd-resolved settings\nGeneral settings for\nsystemd-resolved\nare managed in\n/etc/systemd/resolved.conf\n- see\nresolved.conf\n.\nConfiguring dhclient\nIf you have disabled\nNetworkManager\netc., the last remaining daemon which overwrites\nresolv.conf\nmay be\ndhclient(8)\n(from\nisc-dhcp-client\n).  If so, you can change\nresolv.conf\nby configuring this service.\nModifying /etc/dhcp/dhclient.conf\nIf you just want to override specific values from the DHCP server, edit\n/etc/dhcp/dhclient.conf\n:\nsupersede domain-name \"example.com\";\nsupersede domain-search \"example.com\";\nsupersede domain-name-servers 127.0.0.1;\nAnother option is to remove \"domain-name, domain-name-servers, domain-search\" from the request line.  However, this only works on\nsome\nnetworks.  If the DHCP server sends unsolicited domain-name-servers (et al.) responses,\ndhclient\nwill still heed them, and will still overwrite the\nresolv.conf\nfile.\nStop dhclient from modifying /etc/resolv.conf\nIf you don't want\ndhclient\nto change the file at all, do:\necho\n'make_resolv_conf() { :; }'\n> /etc/dhcp/dhclient-enter-hooks.d/leave_my_resolv_conf_alone\nchmod\n755\n/etc/dhcp/dhclient-enter-hooks.d/leave_my_resolv_conf_alone\nThe execute bit is required because dhclient-script uses\nrun-parts(8)\nto decide which files to read.  For that same reason, the filename\nmust not\ncontain anything but letters, digits, underscores and hyphens.\nAccording to\ndhclient-script(8)\n:\nWhen  it starts, the client script first defines a shell function, make_resolv_conf , which is later used to create the /etc/resolv.conf file.   To override the default behaviour, redefine this function in  the  enter hook script.\nSetting additional DNS Servers\nExample: dhclient3 uses\n/etc/dhcp/dhclient.conf\n.  The setting you want is:\nsupersede domain-name-servers 12.34.56.78, 12.34.56.79;\nor perhaps\nprepend domain-name-servers 12.34.56.78, 12.34.56.79;\nSetting additional search domains\nAdding search domains for VPNs or local virtual networks:\nappend domain-name \" virt vpn\";\nNote the leading space since the string is literally appended to the search domain provided by other configurations.\nSee the\ndhclient.conf\nfor details.\nConfiguring resolvconf (or a workalike)\nresolvconf\nprograms keep track of system information about the currently available nameservers.  They should not be confused with the\nconfiguration file\n/etc/resolv.conf\n, which unfortunately has a nearly identical name.  There was originally only one\nresolvconf\npackage, but now you can choose one of the other\npackages providing resolvconf\n.  These commands let you add settings without them being overwritten by other commands.\nA\nresolvconf\nprogram acts as an intermediary between programs that supply nameserver information (e.g. dhcp clients) and programs that use nameserver information (e.g. resolver).  If you have more than one program modifying\n/etc/resolv.conf\n, this stops them from overwriting each others' configuration.\nThese packages replace\n/etc/resolv.conf\nwith a symbolic link to\n/etc/resolvconf/run/resolv.conf\n, which is generated dynamically.\nThese packages include various configuration files for other packages (such as\nisc-dhcp-client\n).  For example,\nresolvconf\nincludes a file which modifies the\nmake_resolv_conf\nshell function used by\ndhclient-script(8)\n.\nTo manually define the nameservers (as with a static interface), add a line like the following to the\ninterfaces\nconfiguration file at\n/etc/network/interfaces\n:\ndns-nameservers 12.34.56.78 12.34.56.79\nPlace the line indented within an\niface\nstanza, e.g., right after the\ngateway\nline. Enter the IP addresses of the nameservers you need to use after\ndns-nameservers\n. Put all of them on one line separated by spaces. Don't forget the \"\ns\n\" on the end of\ndns-nameservers\n.\nopenresolv\nlets you tell it to\ndo nothing\nwhenever some daemon tries to modify\nresolv.conf\n, by putting\nresolvconf=NO\nin the\n/etc/resolvconf.conf\nfile.  (Note: this is\nnot\nthe\n/etc/resolv.conf\nfile!)\nSee\n/usr/share/doc/resolvconf/README\nfor more information.\nMaking /etc/resolv.conf immutable\nYou can make\n/etc/resolv.conf\nimmutable, so it cannot be changed by any package:\nrm -f /etc/resolv.conf\neditor /etc/resolv.conf\nchattr +i /etc/resolv.conf\nObviously, you will need to put the appropriate content into the file\nbefore\nsetting the immutable bit.  Any time you wish to change the file, you will have to remove the bit, make your change, and then restore the bit.\ndhclient-script\nmay clutter\n/etc\nwith temporary files when it fails to write to them - see\n860928\n.  You may need to periodically clean these files out of\n/etc\n.\nBridging\nBridging puts multiple interfaces into the same network segment. This is very popular for virtualization, and for connecting a server to multiple switches for high availability.\nSee\nBridgeNetworkConnections\nfor more information.\nFirewall\nSee\nnftables\nor\nufw\nfor more information.\nHowto use vlan\nAn\nIEEE_802.1Q\nVLAN lets you split a single physical LAN into multiple virtual LANs.  This lets network administrators do some configuration at layer 2 that would otherwise need to be done at the IP layer.\nAdd this to\n/etc/modules\n:\n8021q\nThen add a section to\n/etc/network/interfaces\nlike:\nauto eno1.222\niface eno1.222 inet static\naddress 10.10.10.1/24\nSee\nvlan-interfaces\nfor more information.\nBridges and VLANs\nIf you create VLAN interfaces only to put them into a bridge, there is no need to define the VLAN interfaces manually. Just config the bridge, and the VLAN interface will be created automatically when creating the bridge, e.g:\nauto br1\niface br1 inet manual\nbridge_ports eno1.99 eno2.99\nup /usr/sbin/brctl stp br1 on\nHowto create fault tolerant bonding with vlan\nTo \"bond\" two Ethernet connections together to create an auto failover interface, see\nBonding\n.\nNetwork config\nCisco switch interface example config:\ninterface GigabitEthernet1/2\ndescription eno2\nswitchport\nswitchport trunk encapsulation dot1q\nswitchport trunk allowed vlan 10,20,30\nswitchport mode trunk\nno ip address\nno cdp enable\nspanning-tree portfast trunk\nbonding with active backup\nCreate a file\n/etc/modprobe.d/bonding.conf\ncontaining:\nalias bond0 bonding\noptions bonding mode=active-backup miimon=100 downdelay=200 updelay=200 primary=eno2\n/etc/network/interfaces\n# The loopback network interface\nauto lo\niface lo inet loopback\n# The primary network interface\nauto bond0\niface bond0 inet manual\nup ifconfig bond0 0.0.0.0 up\nslaves eno2 eno1\nauto vlan10\niface vlan10 inet static\naddress 10.10.10.12/24\nvlan-raw-device bond0\ngateway 10.10.0.1\ndns-search hup.hu\ndns-nameservers 10.10.0.2\nauto vlan20\niface vlan20 inet static\naddress 10.20.10.12/24\nvlan-raw-device bond0\nauto vlan30\niface vlan30 inet static\naddress 10.30.10.12/24\nvlan-raw-device bond0\nIn Debian Buster, you must use interface names for VLANs in the form of:\nbond0.10\n,\nbond0.20\n, and\nbond0.30\ninstead of\nvlan10\n,\nvlan20\n,\nvlan30\nhttps://www.kernel.org/doc/Documentation/networking/bonding.txt\n- Linux kernel documentation on bonding\nHow to set the MTU (Max transfer unit / packet size) with VLANS over a bonded  interface\nMTU needs to be configured on the bonding interface and slave interfaces after the reset of the configuration has been applied to the bonding interfaces. This is done using a post-up line in the bonding interface configuration.\nauto bond0\niface bond0 inet manual\nup ifconfig lacptrunk0 0.0.0.0 up\nslaves eno1 eno2\n# bond-mode 4 = 802.3ad\nbond-mode 4\nbond-miimon 100\nbond-downdelay 200\nbond-updelay 200\nbond-lacp-rate 1\nbond-xmit-hash-policy layer2+3\npost-up ifconfig eno1 mtu 9000 && ifconfig eno2 mtu 9000 && ifconfig bond0 mtu 9000\n#vlan devices will use the MTU set on bond0 device\nauto vlan101\niface vlan101 inet static\naddress 10.101.60.123/24\ngateway 10.155.60.1\nvlan-raw-device bond0\nauto vlan151\niface vlan151 inet static\naddress 192.168.1.1/24\nvlan-raw-device bond0\nMultiple IP addresses on one Interface\nif you just need your web server to respond to two domain names,\nvirtual hosts\nare a better solution than multiple addresses.\nInterface aliases are deprecated and should not really be used anymore. (citation needed)\nThe link may fail to come up if no labels are assigned to the alias interfaces!\nThis issue may be driver/hardware-specific.  It has been seen on\nWheezy\nand\nJessie\nwith an\nRTL8111/8168/8411 PCI Express Gigabit Ethernet Controller (rev 01)\nauto-negotiating to\n10/full\n.  A similar warning from another person exists in the history of this page.\nThis\n/etc/network/interfaces\nexample assigns multiple IP addresses to\neno1\n.\nauto eno1\nallow-hotplug eno1\niface eno1 inet static\naddress 192.168.1.42/24\ngateway 192.168.1.1\nup   /sbin/ip addr add 192.168.1.43/24 dev $IFACE label $IFACE:0\ndown /sbin/ip addr del 192.168.1.43/24 dev $IFACE label $IFACE:0\nup   /sbin/ip addr add 192.168.1.44/24 dev $IFACE label $IFACE:1\ndown /sbin/ip addr del 192.168.1.44/24 dev $IFACE label $IFACE:1\nup   /sbin/ip addr add 10.10.10.14/24 dev $IFACE label $IFACE:2\ndown /sbin/ip addr del 10.10.10.14/24 dev $IFACE label $IFACE:2\niface eno1 inet6 static\naddress 2001:db8:1234::1/64\ngateway fe80::1\nup   /sbin/ip address add 2001:db8:1234:5678::1/64 dev $IFACE\ndown /sbin/ip address del 2001:db8:1234:5678::1/64 dev $IFACE\nCategoryNetwork\nCategorySystemAdministration\nNetworkConfiguration  (\nlast modified 2025-11-26 11:41:03\n)\nChanges made after 24 July 2025 00:00 UTC are available under\nCreative Commons Attribution-ShareAlike 4.0 International\nunless otherwise noted.\nDebian\nprivacy policy\n, Wiki\nteam\n,\nbugs\nand\nconfig\n.\nPowered by\nMoinMoin\nand\nPython\n, with hosting provided by\nMetropolitan Area Network Darmstadt\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://wiki.debian.org/NetworkConfiguration"}}
{"text": "Apt - Debian Wiki\nWiki\nLogin\nFrontPage\nRecentChanges\nFindPage\nHelpContents\nApt\nSearch:\nWiki\n/\nRedirected from page \"\napt\n\"\nClear message\nLogin\nComments\nInfo\nAttachments\nMore Actions:\nRaw Text\nPrint View\nRender as Docbook\nDelete Cache\n------------------------\nCheck Spelling\nLike Pages\nLocal Site Map\n------------------------\nRename Page\nDelete Page\n------------------------\nSubscribe User\n------------------------\nRemove Spam\nRevert to this revision\nPackage Pages\n------------------------\nLoad\nSave\nSlideShow\nApt\nTranslation(s)\n:\nCatalà\n-\nEnglish\n-\nEspañol\n-\nFrançais\n-\nItaliano\n-\n日本語 (Nihongo)\n-\n한국어(Korean)\n-\nPortuguês (Brasil)\n-\nРусский\n-\n简体中文\nAPT may refer to:\nAdvanced Package Tool (or APT)\n, the main command-line\npackage manager\nfor Debian and its derivatives. It provides command-line\ntools\nfor searching,\nmanaging\nand querying information about packages, as well as low-level access to all features provided by the libapt-pkg and libapt-inst libraries which higher-level package managers can depend upon.\nThe\napt\npackage, providing, among others, the\napt\nmanagement tool, a high-level command-line interface for better interactive usage.\nFor more information, see\nAptCLI\n.\nCategoryPackageManagement\nApt  (\nlast modified 2025-08-23 16:31:18\n)\nChanges made after 24 July 2025 00:00 UTC are available under\nCreative Commons Attribution-ShareAlike 4.0 International\nunless otherwise noted.\nDebian\nprivacy policy\n, Wiki\nteam\n,\nbugs\nand\nconfig\n.\nPowered by\nMoinMoin\nand\nPython\n, with hosting provided by\nMetropolitan Area Network Darmstadt\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://wiki.debian.org/apt"}}
{"text": "systemd - Debian Wiki\nWiki\nLogin\nFrontPage\nRecentChanges\nFindPage\nHelpContents\nsystemd\nSearch:\nWiki\n/\nLogin\nComments\nInfo\nAttachments\nMore Actions:\nRaw Text\nPrint View\nRender as Docbook\nDelete Cache\n------------------------\nCheck Spelling\nLike Pages\nLocal Site Map\n------------------------\nRename Page\nDelete Page\n------------------------\nSubscribe User\n------------------------\nRemove Spam\nRevert to this revision\nPackage Pages\n------------------------\nLoad\nSave\nSlideShow\nsystemd\nTranslation(s)\n:\nEnglish\n-\nEspañol\n-\nFrançais\n-\nItaliano\n-\n한국어\n-\nRussian\n-\nBrasileiro\n-\n简体中文\nsystemd - system and service manager\nContents\nsystemd - system and service manager\nIntroduction\nBasic usage\nGetting information on system status\nManaging services\nCreating or altering services\nSmall tweaks\nInstalling and Testing\nInstallation\nConfiguring for testing\nConfiguring as default\nDaemon Security\nOverview\nChecking Daemon Security\nIncreasing Daemon Security\nDebugging\nFailed units\nVerify units\nsystemd hangs on startup or shutdown\nKernel debug without systemd debug in Jessie\nBugs and Bug-Tracking-Systems\nKnown Issues and Workarounds\nShared bind mounts\nSSH session doesn't cleanly terminate on reboot/shutdown\nMissing startup messages on console(tty1) after the boot\nVirtual and serial console changes\nOrphaned processes\nWhere to get help?\nInstalling without systemd\nDebian Resources\nOther Resources\nIntroduction\nsystemd\nis a system and service manager for Linux. It is the default init system for Debian since\nDebian 8 (\"jessie\")\n. Systemd is compatible with SysV and LSB init scripts. It can work as a drop-in replacement for sysvinit. Systemd\nProvides aggressive parallelization capabilities\nUses socket and D-Bus activation for starting services\nOffers on-demand starting of daemons\nImplements transactional dependency-based service control logic\nTracks processes using Linux cgroups\nSupports snapshotting and restoring\nMaintains mount and automount points\nSystemd runs as a daemon with PID 1.\nSystemd tasks are organized as\nunits\n. The most common units are services (.service), mount points (.mount), devices (.device), sockets (.socket), or timers (.timer). For instance, starting the secure shell daemon is done by the unit ssh.service.\nSystemd puts every service into a dedicated\ncontrol group\n(cgroup) named after the service. Modern kernels support process isolation and resource allocation based on cgroups.\nTargets\nare groups of units. Targets call units to put the system together. For instance, graphical.target calls all units that are necessary to start a workstation with graphical user interface.  Targets can build on top of another or depend on other targets. At boot time, systemd activates the target default.target which is an alias for another target such as graphical.target.\nSystemd creates and manages the\nsockets\nused for communication between system components. For instance, it first creates the socket /dev/log and then starts the syslog daemon. This approach has two advantages: Firstly, processes communicating with syslog via /dev/log can be started in parallel. Secondly, crashed services can be restarted without processes that communicate via sockets with them losing their connection. The kernel will buffer the communication while the process restarts.\nPlease see the\nupstream systemd page\nfor more information.\nBasic usage\nsystemctl is the main tool used to introspect and control the state of the \"systemd\" system and service manager. You can use systemctl for instance to enable/disable services permanently or only for the current session. Refer to the\nsystemctl(1)\nmanpage for more details.\nGetting information on system status\nShow system status:\n$ systemctl status\nList failed units:\n$ systemctl --failed\nList installed unit files:\n$ systemctl list-unit-files\nManaging services\nList all running services:\n$ systemctl\nActivates the service \"example1\" immediately:\n# systemctl start example1\nDeactivates the service \"example1\" immediately:\n# systemctl stop example1\nRestarts the service \"example1\" immediately:\n# systemctl restart example1\nShows status of the service \"example1\":\n# systemctl status example1\nEnables \"example1\" to be started on bootup:\n# systemctl enable example1\nDisables \"example1\" to not start during bootup:\n# systemctl disable example1\nDisplays the configuration for \"example1\":\n# systemctl cat example1\nCreating or altering services\nUnits are defined by individual configuration files, called\nunit files\n. The type of the unit is recognized by the file name suffix, .mount in case of a mount point. Unit files provided by Debian are located in the /lib/systemd/system directory. If an identically named local unit file exists in the directory /etc/systemd/system, it will take precedence and systemd will ignore the file in the /lib/systemd/system directory.  Some units are created by systemd without a unit file existing in the file system.\nSystem administrators should put new or heavily-customized unit files in\n/etc/systemd/system\n.\nSmall tweaks\nFor small tweaks to a unit file, system administrators should use the \"drop-in directory\" feature (documented in\nsystemd.unit(5)\n).\nStart by determining the\ncanonical\nsystemd service name (e.g. ssh.service, not an alias like sshd.service). We'll use \"name.service\" for this example.\nUse the command\n# systemctl edit name.service\nto create or edit a file\n/etc/systemd/system/name.service.d/override.conf\nand make changes as needed.\nThis brings up the default\neditor\nwith all the sections and settings from the units\n.conf\n-file commented out and instructions on how to override theese.\nIf needed, create more files inside this directory ending with a \".conf\" suffix to separate overrides in atomic units. For example, /etc/systemd/system/name.service.d/local.conf\nEach file should contain the section headers and section options to be overridden, using the same format as unit files.\nIf you're overriding\nExecStart=\n, you need to put an empty\nExecStart=\nline in the override file, to \"clear out\" the existing command list.  Otherwise, all non-empty\nExecStart=\nlines append a new command to the list.\nHere's an example:\n# cat /etc/systemd/system/name.service.d/local.conf\n[Service]\nExecStart=\nExecStart=/usr/sbin/name-service --my-options\nFor information about writing your own services, see\nsystemd/Services\n.\nInstalling and Testing\nsystemd was included in Debian wheezy as a technology preview. Please make sure that you are using Debian jessie or newer to get a recent version of systemd.\nInstallation\nTo install systemd run:\n# apt-get update\n# apt-get install systemd\nThis will install the systemd packages but will not configure systemd as your init system.\nConfiguring for testing\nTo test systemd before switching to it by default, you can add the following boot parameter to the kernel:\ninit=/lib/systemd/systemd\nThis can be done in the grub menu for a single boot - press \"e\" in the grub menu and add this to the\nkernel\nline. For example, depending on the options required for\nyour\nparticular system, it might look something like:\nlinux   /vmlinuz-3.13-1-amd64 root=/dev/mapper/root-root init=/lib/systemd/systemd ro quiet\nIf PID\n1\nis\nsystemd\nthen your system is running with systemd.\nConfiguring as default\nIn order to use systemd you should also install\nsystemd-sysv\nwhich provides the symlinks links for /sbin/init. It is recommended to run this when already running under systemd, as described in the previous section.\n# apt-get install systemd-sysv\nIn order to boot your system with the newly installed systemd, simply reboot.\n# reboot\nIf you run a self-compiled kernel, make sure you have 2.6.39 or newer and enable the following options:\n* CONFIG_DEVTMPFS=y\n* CONFIG_CGROUPS=y\n* CONFIG_AUTOFS4_FS=[y|m]\n* CONFIG_IPV6=[y|m], optional, but highly recommended\n* CONFIG_FANOTIFY=y, optional, required for systemd readahead. available in Linux kernel >= 2.6.37.\nFor an up-to-date list, see section \"REQUIREMENTS\" in the upstream\nREADME\nfile.\nDaemon Security\nOverview\nA significant feature of systemd is the ability to consistently manage the access that daemons are granted to the system. Prior to systemd's adoption the expectation was that every daemon would call setgid(2), setuid(2), and daemon(3) to limit the scope of damage if the daemon is compromised. But before the daemon dropped privileges any bug, configuration error, or attack could cause unlimited damage. If a daemon was under the control of a hostile party from the initialisation phase and started manually by the sysadmin it could use the TIOCSTI ioctl to stuff characters into the keyboard buffer to take over the system, this was a difficult problem to solve as some daemons wanted the sysadmin to enter a password on startup (a web server with encrypted SSL keys was a common example).\nTo address this systemd manages the daemon startup process, has systemd-ask-password(1) and associated programs for getting passwords on daemon startup and apart from that gives them no direct access to the sysadmin terminal. The daemon can be started under a specific UID/GID, a specific\nSELinux\nsecurity context, and with the full range of Linux access control mechanisms (private mounts, read-only mounts, limits to system calls, etc). See\nthe documentation for systemd-exec for all the options\n.\nChecking Daemon Security\nThe following command shows a list of all units and the exposure number from 0 to 10 (high is bad):\nsystemd-analyze security\nThe following command shows the details of the exposure of the rsyslog service:\nsystemd-analyze security rsyslog.service\nGenerally you want to decrease the numbers as much as possible within the scope of what they do. But a login program (sshd, getty, xdm, etc) that allows either a direct root login or access to run su/sudo can't be meaningfully restricted much.\nIncreasing Daemon Security\nSee the\n?\nSmall Tweaks section of this document for information on tweaking a daemon configuration, for security or other reasons.\nOne of the most important things to set is the list of permitted capabilities for the daemon. The CapabilityBoundingSet is the list of capabilities that are permitted (space separated on a single line) or the list of capabilities to be blocked prefixed with a ~. Here is an example of allowing a daemon to have DAC_OVERRIDE (read files that aren't permitted by Unix permissions when running as UID 0), SETUID and SETGID (for dropping privs - not needed if you use systemd to run under the required UID/GID), PTRACE, and memory locking. All other capabilities will be denied:\nCapabilityBoundingSet=CAP_DAC_OVERRIDE CAP_SETGID CAP_SETUID CAP_SYS_PTRACE CAP_IPC_LOCK\nThere is a full list of capabilities with their descriptions in the file /usr/include/linux/capability.h from package linux-libc-dev or refer to\ncapabilities(7)\n. Usually it's best to just list the capabilities that are to be permitted as it's a smaller set.\nWorking out which capabilities are needed for a daemon is difficult, usually the logs don't indicate what was missing.\nAnother good option for restricting is system calls. The following example lists some system calls that are known to be risky (such as the @clock group and the @mount group as well as some that aren't usually used and which can be safely restricted to reduce the attack surface such as @cpu-emulation and @raw-io. Filtering system calls has some overlap with restricting capabilities but it's good to restrict things in two ways. It usually isn't difficult to map error messages logged by a daemon to which groups of syscalls were filtered and then do a binary search for the most restrictive options.\nSystemCallFilter=~@mount @cpu-emulation @debug @raw-io @reboot @resources @swap @module @obsolete @clock\nThe following is recommended for every daemon that doesn't directly interact with user files. Daemons such as database servers almost never need to access user home directories and should be prevented from accessing /home by default.\nProtectHome=true\nThe following settings are good for protecting the overall OS installation. You can use these on most daemons with little risk of breaking things:\nProtectKernelLogs=true\nProtectControlGroups=true\nProtectKernelModules=true\nMemoryDenyWriteExecute=true\nProtectHostname=true\nLockPersonality=true\nRestrictRealtime=true\nDevicePolicy=closed\nProtectClock=true\nRestrictSUIDSGID=true\nProtectKernelTunables=true\nPrivateDevices=true\nThe following setting is good to prevent a daemon being attacked by a user or another daemon via /tmp race conditions. It's unlikely to cause any problems.\nPrivateTmp=true\nThe following is good for daemons which need no networking. This allows Unix domain sockets by filesystem (EG /run/$DAEMON/whatever.sock) but not the abstract socket namespace. The risk of this is PAM services that use networking or other indirect network access. This is a good option for the sysadmin who is locking down their own system but risky for the package maintainer.\nPrivateNetwork=true\nThe NoNewPrivileges option prevents a daemon from running a SETUID program to gain privileges that are undesired. But there are some corner cases for this such as running a program that has a SE Linux automatic domain transition to LESS privileges can be denied.\nNoNewPrivileges=true\nDebugging\nFailed units\nIn some cases units enter a\nfailed state\n. The\nstatus\ncommand can be used to find out some details:\n$ systemctl status <UNITNAME>\nFailed units can be manually cleared out:\n# systemctl reset-failed\nVerify units\nTo check that we didn't misspell anything or used any unknown options when writing units,\nsystemd-analyze\n$ systemd-analyze verify <UNITNAME-or-PATHTOUNIT>\nNo output means everything checks out.\nsystemd hangs on startup or shutdown\nSometimes it is necessary to investigate why\nsystemd\nhangs on startup or on reboot/shutdown.\nSolution #0: Remove \"quiet\" from Kernel command line (so called \"cmdline\" or \"grub line\")\nSolution #1: Increase verbosity via cmdline: Add \"systemd.log_target=kmsg systemd.log_level=debug\"\nOf course you can have a \"temporary\" persistent solution:\n[ /etc/default/grub ]\nGRUB_CMDLINE_LINUX=\"systemd.log_target=kmsg systemd.log_level=debug\" <--- Add here (by uncommenting you can easily switch to debug)\n# update-grub\nSolution #2: Increase verbosity via /etc/systemd/system.conf\nLogLevel=debug           <--- Uncomment this line and use \"debug\" (default: commented and \"info\")\nLogTarget=syslog-or-kmsg <--- Uncomment this line (default: commented)\nSolution #3: Boot an emergency shell: Add\nsystemd.unit=rescue.target\nor just\n1\n(the number one) to the kernel command line.\nSolution #4: Enable the debug shell: Run\nsystemctl enable debug-shell.service\n. (You can do this in a chroot environment after booting a rescue system.) This starts a root shell on TTY 9.\nHINT: \"man systemd\" and \"man systemd-system.conf\"\nHINT: Extensive debugging information about systemd is on\nthis FreeDesktop page\n.\nHINT: How to check Kernel command line parameters/options?\n# cat /proc/cmdline\nNOTE on LogLevel (see\nsystemd(1)\nand\nsystemd-system.conf(5)\n):\n\"Set log level. As an argument this accepts a numerical log level or the well-known syslog(3) symbolic names\n(lowercase): emerg, alert, crit, err, warning, notice, info, debug.\"\nHINT: Keep a copy of /sbin/init from\nsysvinit\npackage in case of rescue (so you can use init=/sbin/init.sysvinit in cmdline)!\n# cp -av /sbin/init /sbin/init.sysvinit <--- Before installing systemd-sysv package\nSee also\nhttps://fedoraproject.org/wiki/How_to_debug_Systemd_problems\nKernel debug without systemd debug in Jessie\nUsing the old \"debug\" kernel parameter in Jessie will turn on systemd debug logging as well as kernel debug logging. To get the old behaviour, do not use \"debug\", instead use the kernel parameter \"loglevel=7\".\nBugs and Bug-Tracking-Systems\nUpstream issue tracker\nDebian bug tracker\nUsertagged bugs in Debian BTS\nFor known bugs please see topic \"Known Issues and Workarounds\"\nKnown Issues and Workarounds\nShared bind mounts\nThe default behavior of bind mounts changes under systemd. The Linux kernel makes bind mounts of anything below / PRIVATE. Systemd changes this to SHARED.\nThus, when you do this:\nmount --bind / $CHROOT\nmount --bind /dev/ $CHROOT/dev\numount $CHROOT/dev\nthen /dev will be unmounted in your base/parent system\nas well\n!\nWhat you can do now instead, is to:\nmount --bind --make-rslave / $CHROOT\nmount --bind --make-rslave /dev/ $CHROOT/dev\nthis will propagate mount changes (also mount options) in the base/parent system into the $CHROOT but not from the $CHROOT back to the parent.\nThe rationale for the change of the default behavior can be found in bug\n739593\n, particularly in\nLenart's comment\ntherein.\nSSH session doesn't cleanly terminate on reboot/shutdown\nIf you happen to reboot/shutdown remote machine over\nssh\nyou may find out that your session isn't terminated properly, leaving you with the non-reacting terminal until a long timeout has been reached. There was bug\n751636\nabout it. A workaround to this problem was to install:\napt-get install libpam-systemd\nwhich would terminate the\nssh\nsession before the network was dropped. Please note, that that would require\nPAM\nto be enabled in\nsshd\n.\nMissing startup messages on console(tty1) after the boot\nWith\nsystemd\nconsole(tty1) is handled differently and if you used to check it to see how did your boot go now you'll see only couple of non-informative lines.\nTo be able to get full transcript of the system boot on your console you need to perform two steps.\n1. Add to the kernel options\nsystemd.show_status=1\n, for example via\n/etc/default/grub\n:\nGRUB_CMDLINE_LINUX_DEFAULT=\"quiet systemd.show_status=1\"\nand run\nupdate-grub2\n.\n2. Create file\n/etc/systemd/system/getty@tty1.service.d/noclear.conf\nwith the content:\n[Service]\nTTYVTDisallocate=no\nto disable clearing of the terminal on\ngetty\ninvocation.\nVirtual and serial console changes\nThose used to change\ninittab\nto enable/disable virtual or serial consoles will notice that that file is gone from clean installs. This is all managed through systemd directly now. For example, you can enable a serial console on\nCOM1\nwith:\nsystemctl enable serial-getty@ttyS0.service\nsystemctl start serial-getty@ttyS0.service\nSo ... wouldn't it be better to, rather than put kernel command line and/or GRUB bits here that aren't systemd\nspecific, instead link to somewhere else where they're better and more authoritatively documented on Debian's\nwiki ... if that exists ... or when it comes to exist?\nHowever, it is generally preferable to add\nconsole=ttyS0\non the kernel commandline, since this also enables kernel output on reboots. For, e.g. GRUB, this is done by adding the following to\n/etc/default/grub\n:\nGRUB_CMDLINE_LINUX=\"console=ttyS0\"\n... and running\nupdate-grub\n. This will take effect only on the next reboot, however.\nNote also that Linux supports multiple consoles for output - but only one for input - the last named (or default if none named)\nfrom the kernel commandline specifies which is used for input, and all are used for output.  E.g. for GRUB:\nGRUB_CMDLINE_LINUX=\"console=tty0 console=ttyS0\"\nThat will, after running\nupdate-grub\nand rebooting, have console input from /dev/ttyS0 and output to both that and /dev/tty0\ndevice.  Note also that serial parameters can also be specified, e.g.:\nGRUB_CMDLINE_LINUX=\"console=tty0 console=ttyS0,9600n8\"\nOrphaned processes\nBecause it manages user sessions (taking over the role of X or other components), systemd may slightly change how processes survive a logoff.  By default, when X shuts down all processes should exit and systemd will clean up the session, but there are some corner cases where certain processes don't cleanup after themselves properly.\nYou can configure how systemd manages leftover processes with the\nKillUserProcesses=\nparameter in\nlogind.conf\n. By setting this to\nyes\n, processes will be forcibly killed when the session terminates. Note that this will break tools like\nscreen\nor\ntmux\n, unless they are configured to run under a distinct\nuser@.service\nunit and if\nenable-linger\nis set to\nyes\nin\nloginctl\n. A simple way to do this on the fly is to run the program in a \"transient scope\", using\nsystemd-run\n:\nsystemd-run --scope --user screen\nNow, normally sessions should cleanup after themselves, and such issues should be fixed without having to revert to the\nKillUserProcesses=yes\nsledgehammer.  A good way to list the affected processes is to group them by \"control group\", with the\nsystemd-cgls\ncommand:\nsystemd-cgls\nSome known misbehaving applications:\nparcimonie\n-\n849016\nredshift-gtk\n? - workaround: run as a systemd service,\n827098\nxplanet\nWhere to get help?\nSystemd is a young project with a strong emphasis on solving problems in a distribution agnostic manner.\nmailing-list @\nhttps://lists.freedesktop.org/mailman/listinfo/systemd-devel\n#systemd\n(irc.libera.chat)\nDebian specific channels include\nmailing-list @\nhttps://lists.alioth.debian.org/cgi-bin/mailman/listinfo/pkg-systemd-maintainers\n#debian-systemd\n(irc.oftc.net)\nSeveral other distributions are using systemd\nFedora systemd wiki\nGentoo systemd wiki\nopenSUSE systemd setup instructions\nUbuntu systemd wiki\nArch systemd wiki\nInstalling without systemd\nSee\nInit\n, under \"Changing the init system - at installation time\"\nDebian Resources\nsystemd\n- This page\nRelease Goals\n-\nIntegration\n-\nPackaging\n-\nDiscussion\n-\nHelping\n-\nDebian package\nOther Resources\nUpstream Homepage\nsystemd.directives(7)\nIndex of configuration directives\nsystemd.index(7)\nList all manpages from the systemd project\nThe systemd for Administrators Blog Series\nby Lennart Poettering may be suitable as an introduction. It was published in 2010-2013, so a bit outdated.\nslides\nand\nvideo\nabout simple security features that can be enabled in service files\na nethack systemd comic strip\nthorough runbook for Debugging Systemd Services\nCategoryPermalink\nsystemd  (\nlast modified 2025-01-19 12:20:54\n)\nChanges made after 24 July 2025 00:00 UTC are available under\nCreative Commons Attribution-ShareAlike 4.0 International\nunless otherwise noted.\nDebian\nprivacy policy\n, Wiki\nteam\n,\nbugs\nand\nconfig\n.\nPowered by\nMoinMoin\nand\nPython\n, with hosting provided by\nMetropolitan Area Network Darmstadt\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://wiki.debian.org/systemd"}}
{"text": "Network configuration - ArchWiki\nHome\nPackages\nForums\nWiki\nGitLab\nSecurity\nAUR\nDownload\nJump to content\nArchWiki\nSearch\nSearch\nNetwork configuration\n9 languages\nČeština\nEspañol\nSuomi\nMagyar\nItaliano\n日本語\nPortuguês\nРусский\n中文（简体）\nFrom ArchWiki\nRelated articles\nDomain name resolution\nFirewalls\nInternet sharing\nNetwork Debugging\nRouter\nThis article describes how to configure network connections on\nOSI layer 3\nand above. Medium-specifics are handled in the\n/Ethernet\nand\n/Wireless\nsubpages.\nCheck the connection\nThis article or section needs expansion.\nReason:\nStep 4. is unclear,\n#Routing table\ndoes not explain what a correct setup looks like. (Discuss in\nTalk:Network configuration\n)\nTo troubleshoot a network connection, go through the following conditions and ensure that you meet them:\nYour\nnetwork interface\nis listed and enabled. Otherwise, check the device driver – see\n/Ethernet#Device driver\nor\n/Wireless#Device driver\n.\nYou are connected to the network. The cable is plugged in or you are\nconnected to the wireless LAN\n.\nYour network interface has an\nIP address\n.\nYour\nrouting table\nis correctly set up.\nYou can\nping\na local IP address (e.g. your default gateway).\nYou can\nping\na public IP address (e.g.\n9.9.9.9\n, which is a DNS server operated by the Quad9 Foundation and is a convenient address to test with).\nCheck if you can resolve domain names\n(e.g.\narchlinux.org\n).\nNote\nIf your network is fine during install, but can't ping in the new system, even having proper networking services (e.g.\nNetworkManager\n) installed, check whether your network needed device authenation (i.e. School network). If so, wait prabably 2 hours and try again. The reason may be that during the installation, the host name \"archiso\", is changed to \"archlinux\" in the installed system, causing authenation failure, therefore ignoring the connection request from the new system.\nPing\nping\nis used to test if you can reach a host.\n$ ping www.example.com\nPING www.example.com (93.184.216.34) 56(84) bytes of data.\n64 bytes from 93.184.216.34 (93.184.216.34): icmp_seq=1 ttl=56 time=11.632 ms\n64 bytes from 93.184.216.34 (93.184.216.34): icmp_seq=2 ttl=56 time=11.726 ms\n64 bytes from 93.184.216.34 (93.184.216.34): icmp_seq=3 ttl=56 time=10.683 ms\n...\nFor every reply received, the\nping\nutility will print a line like the above until you interrupt (\nCtrl+c\n) it interactively. For more information see the\nping(8)\nmanual. Note that computers can be configured not to respond to ICMP echo requests.\n[1]\nIf you receive an error message (see\nping error indications\n) or no reply, this may be related to incomplete configuration, but also your default gateway or your Internet Service Provider (ISP). You can run a\ntraceroute\nto further diagnose the route to the host.\nNetwork management\nThis article or section needs language, wiki syntax or style improvements. See\nHelp:Style\nfor reference.\nReason:\nSplit into manual configuration with iproute2 and automatic with DHCP & SLAAC. (Discuss in\nTalk:Network configuration#Style_notice_in_Network_Management_section\n)\nTo set up a network connection, go through the following steps:\nEnsure your\nnetwork interface\nis listed and enabled.\nConnect to the network. Plug in the Ethernet cable or\nconnect to the wireless LAN\n.\nConfigure your network connection:\nMost networks use the\nDynamic Host Configuration Protocol\nfor network configuration. Clients can automatically obtain a dynamic or static IP address from the DHCP server via\na standalone DHCP client or using a network manager\n.\nIf the network does not have a DHCP server, you can configure a static IP address, routing table and DNS servers manually for each client. See\n#Static IP address\nfor details.\nNote\nThe installation image uses\nsystemd-networkd\n, which is configured as a DHCP client for\nEthernet\n,\nWLAN\nand\nWWAN\nnetwork interfaces, and\nsystemd-resolved\nconfigured for system-wide\nDNS\n, see\nsystemd-resolved#DNS\n.\nManual\niproute2\nThis article or section needs language, wiki syntax or style improvements. See\nHelp:Style\nfor reference.\nReason:\nThis section does not fit in\n#Network management\n– it does not\nmanage\nanything, it only introduces the\niproute2\npackage. (Discuss in\nTalk:Network configuration\n)\niproute2\nis a dependency of the\nbase\nmeta package\nand provides the\nip(8)\ncommand-line interface, used to manage\nnetwork interfaces\n,\nIP addresses\nand the\nrouting table\n. Be aware that configuration made using\nip\nwill be lost after a reboot. For persistent configuration, you can automate\nip\ncommands using scripts and\nsystemd units\n. Also note that\nip\ncommands can generally be abbreviated, for clarity they are however spelled out in this article.\nNote\nArch Linux has deprecated\nnet-tools\nin favor of\niproute2\n.\n[2]\nSee also\nDeprecated Linux networking commands and their replacements\n.\nStatic IP address\nA static IP address can be configured with most standard\nnetwork managers\nand also\ndhcpcd\n.\nTo manually configure a static IP address, add an IP address as described in\n#IP addresses\n, set up your\nrouting table\nand\nconfigure your DNS servers\n.\nIP addresses\nIP addresses\nare managed using\nip-address(8)\n.\nList IP addresses:\n$ ip address show\nAdd an IP address to an interface:\n# ip address add\naddress/prefix_len\nbroadcast + dev\ninterface\nNote that:\nthe address is given in\nCIDR notation\nto also supply a\nsubnet mask\n+\nis a special symbol that makes\nip\nderive the\nbroadcast address\nfrom the IP address and the subnet mask\nNote\nMake sure manually assigned IP addresses do not conflict with DHCP assigned ones.\nDelete an IP address from an interface:\n# ip address del\naddress/prefix_len\ndev\ninterface\nDelete all addresses matching a criteria, e.g. of a specific interface:\n# ip address flush dev\ninterface\nTip\nIPv4 addresses can be calculated with\nipcalc\n(\nipcalc\n).\nRouting table\nThe\nrouting table\nis used to determine if you can reach an IP address directly or what gateway (router) you should use. If no other route matches the IP address, the\ndefault gateway\nis used.\nThe routing table is managed using\nip-route(8)\n.\nPREFIX\nis either a CIDR notation or\ndefault\nfor the default gateway.\nList IPv4 routes:\n$ ip route show\nList IPv6 routes:\n$ ip -6 route show\nAdd a route:\n# ip route add\nPREFIX\nvia\naddress\ndev\ninterface\nDelete a route:\n# ip route del\nPREFIX\nvia\naddress\ndev\ninterface\nAutomatic\nThis article or section needs expansion.\nReason:\nExplain\nSLAAC\n. (Discuss in\nTalk:Network configuration\n)\nAutomatic network configuration is accomplished using\nDynamic Host Configuration Protocol\n(DHCP). The network's DHCP server provides IP address(es), the default gateway IP address(es) and optionally also DNS name servers upon request\nfrom the DHCP client.\nSee\nRouter#DNS and DHCP\nfor a DHCP server comparison table.\nNetwork managers\nA network manager lets you manage network connection settings in so called network profiles to facilitate switching networks.\nTip\nYou can check if a DHCPv4 server is running with\ndhcping\n.\nNote\nEach network interface should be managed by only one DHCP client or network manager, so it is advised to run only one DHCP client or network manager on the system.\nSoftware\nConnection type\nWireless authentication\nIP address, route and DNS management\nInterface\nEthernet\nPPPoE\nMobile broadband\nStatic IP\nDHCP client\nDomain name resolution\nCLI\nTUI\nGUI\ndhclient\n1\nYes\nNo\nNo\nNo\n2\nYes\ninternal\nYes (writes\n/etc/resolv.conf\n)\nNo\nNo\nNo\ndhcpcd\nYes\nNo\nNo\nLaunches wpa_supplicant\n3\nYes\ninternal\nYes\n(uses\nresolvconf\nor writes\n/etc/resolv.conf\n)\nNo\nNo\ndhcpcd-ui\nAUR\nConnMan\nYes\nNo\nYes (via\nofono\nAUR\n)\nYes (via\nwpa_supplicant\nor\niwd\n)\nYes\ninternal\nYes\n(runs a builtin resolver and writes\n/etc/resolv.conf\n)\nconnmanctl(1)\nYes\nYes\nnetctl\nYes\nYes\n(via\nppp\n)\nYes (via\nppp\n)\nYes (via\nwpa_supplicant\n)\nYes\ndhcpcd\nor\ndhclient\nYes\n(uses\nresolvconf\n)\nnetctl(1)\nwifi-menu(1)\n4\nNo\nNetworkManager\nYes\nYes\n(via\nppp\n)\nYes\n(via\nmodemmanager\n)\nYes (via\nwpa_supplicant\nor\niwd\n)\nYes\ninternal,\ndhclient\nor\ndhcpcd\n5\nYes\n(uses\nsystemd-resolved\n,\nresolvconf\nor writes\n/etc/resolv.conf\n)\nnmcli(1)\nnmtui(1)\nYes\nsystemd-networkd\nYes\nNo\nNo\nNo\n2\nYes\ninternal\nYes (uses\nsystemd-resolved\n)\nnetworkctl(1)\nNo\nNo\nwpa_supplicant\nIEEE 802.1X\nNo\nNo\nYes\nNo\nwpa_cli(8)\nNo\nwpa_supplicant_gui\nAUR\niwd\nIEEE 802.1X\nNo\nNo\nYes\nYes\ninternal\nYes\n(uses\nsystemd-resolved\nor\nresolvconf\n)\niwctl(1)\nimpala\niwgtk\nAUR\nNo longer maintained as of early 2022. ISC advises no longer using it in production.\nWireless authentication can be configured separately with\nwpa_supplicant\nor\niwd\n.\nWireless authentication must be configured separately with\nwpa_supplicant\n.\nOnly Wi-Fi connections can be managed.\nNetworkManager does not use dhcpcd for DHCPv6, see\nNetworkManager#DHCP client\n.\nNetwork interfaces\nNetwork interfaces are managed by\nudev\nand configured by\nsystemd.link(5)\nfiles. The default configuration assigns names to your\nnetwork interface controllers\nusing\nPredictable Network Interface Names\n, which prefixes interfaces names with\nen\n(wired/\nEthernet\n),\nwl\n(wireless/\nWLAN\n), or\nww\n(mobile broadband/\nWWAN\n). See\nsystemd.net-naming-scheme(7)\n.\nTip\nThe system\n/usr/lib/systemd/network/99-default.link\nis generally sufficient for most cases.\nTo change interface names, see\n#Change interface name\nand\n#Revert to traditional interface names\n.\nYou can run\nudevadm test-builtin net_setup_link\n/sys/path/to/network/device\nas the root user to diagnose problems with\n.link\nfiles.\nNote\nThe predictable network interface names can change after adding or removing a PCIe device if the system firmware decides to renumber the devices. See\nsystemd issue 33347\n.\nThe\niwd\npackage contains a\n.link\nfile that disables predictable network interface names. Merely having it installed will prevent all network interfaces from being renamed to predictable names. See\niwd#Wireless device is not renamed by udev\n.\nListing network interfaces\nBoth wired and wireless interface names can be found via\nls /sys/class/net\nor\nip link\n. Note that\nlo\nis the\nvirtual loopback interface\nand not used in making network connections.\nWireless device names can also be retrieved using\niw dev\n. See also\n/Wireless#Get the name of the interface\n.\nIf your network interface is not listed, make sure your device driver was loaded successfully. See\n/Ethernet#Device driver\nor\n/Wireless#Device driver\n.\nEnabling and disabling network interfaces\nNetwork interfaces can be enabled or disabled using\nip link set\ninterface\nup|down\n, see\nip-link(8)\n.\nTo check the status of the interface\nenp2s0\n:\n$ ip link show dev enp2s0\n2: enp2s0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast master br0 state DOWN mode DEFAULT qlen 1000\n...\nThe\nUP\nin\n<BROADCAST,MULTICAST,UP,LOWER_UP>\nis what indicates the interface is up, not the later\nstate DOWN\n.\nNote\nIf your default route is through interface\nenp2s0\n, taking it down will also remove the route, and bringing it back up will not automatically re-establish the default route.  See\n#Routing table\nfor re-establishing it.\nChange interface name\nThis article or section needs expansion.\nReason:\nSuggest using an\nalternative name\n(altname), or assigning one, as an alternative to changing the interface name. (Discuss in\nTalk:Network configuration\n)\nNote\nWhen changing the naming scheme, do not forget to update all network-related configuration files and custom systemd unit files to reflect the change.\nYou can change the device name by defining the name manually with a\nsystemd.link(5)\nfile. The file must be ordered lexicographically before\n99-default.link\n, for example:\n/etc/systemd/network/10-net0.link\n[Match]\nPermanentMACAddress=aa:bb:cc:dd:ee:ff\n[Link]\nName=net0\nAlternatively, a udev rule can be used:\n/etc/udev/rules.d/10-network.rules\nSUBSYSTEM==\"net\", ACTION==\"add\", ATTR{address}==\"aa:bb:cc:dd:ee:ff\", NAME=\"net0\"\nThese rules will be applied automatically at boot. To apply the change immediately, do a manual trigger of the udev rule on the\nnet\nsubsystem:\n# udevadm trigger --verbose --subsystem-match=net --action=add\nIf you want to run a\ntest\non the changes made,\nudevadm --debug test /sys/class/net/*\ncan be of help.\nNote\nThe priority of\nName\nis lower than\nNamePolicy\n, so make sure the latter is unset/empty or the name will not be changed.\nThe network interface must be down before changing its name.\n[3]\nTo get the MAC address of each card, run\nip link\n.\nMake sure to use the lower-case hex values in your udev rules. It does not like upper-case.\nIf the network card has a dynamic MAC, you can use\nPath\n(which can be checked using\nnetworkctl status\ninterface_name\n):\n/etc/systemd/network/10-net1.link\n[Match]\nPath=pci-0000:01:00.0\n[Link]\nName=net1\nOr, use a udev rule with\nDEVPATH\n:\n/etc/udev/rules.d/10-network.rules\nSUBSYSTEM==\"net\", DEVPATH==\"/devices/pci*/*1c.0/*/net/*\", NAME=\"net1\"\nTo get the\nDEVPATH\nof all currently-connected devices, see where the symlinks in\n/sys/class/net/\nlead. For example:\n$ file /sys/class/net/*\n/sys/class/net/enp0s20f0u4u1: symbolic link to ../../devices/pci0000:00/0000:00:14.0/usb2/2-4/2-4.1/2-4.1:1.0/net/enp0s20f0u4u1\n/sys/class/net/enp0s31f6:     symbolic link to ../../devices/pci0000:00/0000:00:1f.6/net/enp0s31f6\n/sys/class/net/lo:            symbolic link to ../../devices/virtual/net/lo\n/sys/class/net/wlp4s0:        symbolic link to ../../devices/pci0000:00/0000:00:1c.6/0000:04:00.0/net/wlp4s0\nThe device path should match both the new and old device name, since the rule may be executed more than once on bootup. For example, in the given rule,\n\"/devices/pci*/*1c.0/*/net/en*\"\nwould be wrong since it will stop matching once the name is changed to\nnet1\n. Only the system-default rule will fire the second time around, causing the name to be changed back.\nIf you are using a USB network device (e.g. Android phone tethering) that has a dynamic MAC address and you want to be able to use different USB ports, you could use a rule that matched depending on vendor and model ID instead:\n/etc/systemd/network/20-net2.link\n[Match]\nProperty=ID_VENDOR_ID=12ab ID_MODEL_ID=3cd4\n[Link]\nName=net2\nor\n/etc/udev/rules.d/10-network.rules\nSUBSYSTEM==\"net\", ACTION==\"add\", ATTRS{idVendor}==\"12ab\", ATTRS{idProduct}==\"3cd4\", NAME=\"net2\"\nNote\nWhen choosing the static names\nit should be avoided to use names in the format of \"eth\nX\n\" and \"wlan\nX\n\"\n, because this may lead to race conditions between the kernel and udev during boot. Instead, it is better to use interface names that are not used by the kernel as default, e.g.:\nnet0\n,\nnet1\n,\nwifi0\n,\nwifi1\n. For further details please see the\nsystemd\ndocumentation.\nRevert to traditional interface names\nIf you would prefer to retain traditional interface names such as\neth0\n,\nPredictable Network Interface Names\ncan be disabled by changing the default\nNamePolicy\nfor udev's\nnet_setup_link\nbuilt-in:\n/etc/systemd/network/99-default.link.d/traditional-naming.conf\n[Link]\nNamePolicy=keep kernel\nAlternatively,\nnet_setup_link\ncan be completely disabled by masking the corresponding udev rule:\n# ln -s /dev/null /etc/udev/rules.d/80-net-setup-link.rules\nor by adding\nnet.ifnames=0\nto the\nkernel parameters\n.\nNote\nsystemd.link(5)\nrelies on\nnet_setup_link\nto work. Prefer to use the first approach unless you fully understand what you are doing.\nSet device MTU and queue length\nThe factual accuracy of this article or section is disputed.\nReason:\nCreating a\n30-mtu.link\nfile means that\n99-default.link\nwill not get applied. (Discuss in\nTalk:Network configuration\n)\nYou can change the device\nMTU\nand queue length by defining manually with a\nsystemd.link(5)\nconfig. For example:\n/etc/systemd/network/30-mtu.link\n[Match]\nType=wlan\n[Link]\nMTUBytes=1500\nTransmitQueueLength=2000\nOr through a udev rule:\n/etc/udev/rules.d/10-network.rules\nACTION==\"add\", SUBSYSTEM==\"net\", KERNEL==\"wl*\", ATTR{mtu}=\"1500\", ATTR{tx_queue_len}=\"2000\"\nMTUBytes\n: Using a value larger than 1500 (so called\njumbo frames\n) can significantly speed up your network transfers. Note that all network interfaces, including switches in the local network, must support the same MTU in order to use jumbo frames. For PPPoE, the MTU should not be larger than 1492. You can also set MTU via\nsystemd.netdev(5)\n.\nTransmitQueueLength\n: Small value for slower devices with a high latency like modem links and ISDN. High value is recommended for server connected over the high-speed internet connections that perform large data transfers.\nSet the hostname\nA\nhostname\nis a unique name created to identify a machine on a network, configured in\n/etc/hostname\n—see\nhostname(5)\nand\nhostname(7)\nfor details. The file can contain the system's domain name, if any. To set the hostname,\nedit\n/etc/hostname\nto include a single line with\nyourhostname\n:\n/etc/hostname\nyourhostname\nTip\nFor advice on choosing a hostname, see\nRFC 1178\n.\nAlternatively, using\nhostnamectl(1)\n:\n# hostnamectl hostname\nyourhostname\nTo temporarily set the hostname (until reboot), use\nhostname(1)\nfrom\ninetutils\n:\n# hostname\nyourhostname\nTo set the \"pretty\" hostname and other machine metadata, see\nmachine-info(5)\n.\nLocal network hostname resolution\nTo make your machine accessible in your LAN via its hostname you can:\nedit the\n/etc/hosts\nfile for every device in your LAN, see\nhosts(5)\nset up a\nDNS server\nto resolve your hostname and make the LAN devices use it (e.g. via\nDHCP\n)\nor the easy way: use a\nZero-configuration networking\nservice:\nHostname resolution via Microsoft's\nNetBIOS\n. Provided by\nSamba\non Linux. It only requires the\nnmb.service\n. Computers running Windows, macOS, or Linux with\nnmb\nrunning, will be able to find your machine.\nHostname resolution via\nmDNS\n. Provided by either\nnss_mdns\nwith\nAvahi\n(see\nAvahi#Hostname resolution\nfor setup details) or\nsystemd-resolved\n. Computers running macOS, or Linux with Avahi or systemd-resolved running, will be able to find your machine. The older Win32 API does not support mDNS, which may prevent some older Windows applications from accessing your device.\nTips and tricks\nBonding or LAG\nSee\nnetctl\nor\nsystemd-networkd\n, or\nWireless bonding\n.\nIP address aliasing\nIP aliasing is the process of adding more than one IP address to a network interface. With this, one node on a network can have multiple connections to a network, each serving a different purpose. Typical uses are virtual hosting of Web and FTP servers, or reorganizing servers without having to update any other machines (this is especially useful for nameservers).\nExample\nTo manually set an alias, for some NIC, use\niproute2\nto execute\n# ip addr add 192.168.2.101/24 dev enp2s0 label enp2s0:1\nTo remove a given alias execute\n# ip addr del 192.168.2.101/24 dev enp2s0:1\nPackets destined for a subnet will use the primary alias by default. If the destination IP is within a subnet of a secondary alias, then the source IP is set respectively. Consider the case where there is more than one NIC, the default routes can be listed with\nip route\n.\nPromiscuous mode\nToggling\npromiscuous mode\nwill make a (wireless) NIC forward all traffic it receives to the OS for further processing. This is opposite to \"normal mode\" where a NIC will drop frames it is not intended to receive. It is most often used for advanced network troubleshooting and\npacket sniffing\n.\n/etc/systemd/system/promiscuous@.service\n[Unit]\nDescription=Set %i interface in promiscuous mode\nAfter=network.target\n[Service]\nType=oneshot\nExecStart=/usr/bin/ip link set dev %i promisc on\nRemainAfterExit=yes\n[Install]\nWantedBy=multi-user.target\nIf you want to enable promiscuous mode on interface\nenp2s0\n,\nenable\npromiscuous@enp2s0.service\n.\nInvestigate sockets\nss\nis a utility to investigate network ports and is part of the\niproute2\npackage. It has a similar functionality to the\ndeprecated\nnetstat utility.\nCommon usage includes:\nDisplay all TCP Sockets with service names:\n$ ss -at\nDisplay all TCP Sockets with port numbers:\n$ ss -atn\nDisplay all UDP Sockets:\n$ ss -au\nFor more information see\nss(8)\n.\nTroubleshooting\nThe TCP window scaling problem\nTCP packets contain a \"window\" value in their headers indicating how much data the other host may send in return. This value is represented with only 16 bits, hence the window size is at most 64KiB. TCP packets are cached for a while (they have to be reordered), and as memory is (or used to be) limited, one host could easily run out of it.\nBack in 1992, as more and more memory became available,\nRFC:1323\nwas written to improve the situation: Window Scaling. The \"window\" value, provided in all packets, will be modified by a Scale Factor defined once, at the very beginning of the connection. That 8-bit Scale Factor allows the Window to be up to 32 times higher than the initial 64KiB.\nIt appears that some broken routers and firewalls on the Internet are rewriting the Scale Factor to 0 which causes misunderstandings between hosts. The Linux kernel 2.6.17 introduced a new calculation scheme generating higher Scale Factors, virtually making the aftermaths of the broken routers and firewalls more visible.\nThe resulting connection is at best very slow or broken.\nHow to diagnose the problem\nFirst of all, let us make it clear: this problem is odd. In some cases, you will not be able to use TCP connections (HTTP, FTP, ...) at all and in others, you will be able to communicate with some hosts (very few).\nWhen you have this problem, the output from\ndmesg\nis okay, logs are clean and\nip addr\nwill report normal status... and actually everything appears normal.\nIf you cannot browse any website, but you can ping some random hosts, chances are great that you are experiencing this problem: ping uses ICMP and is not affected by TCP problems.\nYou can try to use\nWireshark\n. You might see successful UDP and ICMP communications but unsuccessful TCP communications (only to foreign hosts).\nWays of fixing it\nBad\nTo fix it the bad way, you can change the\ntcp_rmem\nvalue, on which Scale Factor calculation is based. Although it should work for most hosts, it is not guaranteed, especially for very distant ones.\n# sysctl -w net.ipv4.tcp_rmem=\"4096 87380 174760\"\nGood\nSimply disable Window Scaling. Since Window Scaling is a nice TCP feature, it may be uncomfortable to disable it, especially if you cannot fix the broken router. There are several ways to disable Window Scaling, and it seems that the most bulletproof way (which will work with most kernels) is to add the following line to\n/etc/sysctl.d/99-disable_window_scaling.conf\n(see also\nsysctl\n):\nnet.ipv4.tcp_window_scaling = 0\nBest\nThis problem is caused by broken routers/firewalls, so let us change them. Some users have reported that the broken router was their very own DSL router.\nMore about it\nThis section is based on the LWN article\nTCP window scaling and broken routers\nand an archived Kernel Trap article:\nWindow Scaling on the Internet\n.\nThere are also several relevant threads on the LKML.\nlocal hostname is resolved over the network\nnss-myhostname(8)\n(an\nNSS\nmodule provided by\nsystemd\nand enabled by default in\n/etc/nsswitch.conf\n) provides\nlocalhost\nand the local\nhostname\nresolution to an IP address. Some software may, however, still instead read\n/etc/hosts\ndirectly; see\n[4]\n[5]\nfor examples.\nTo prevent such software from unsafely resolving the local hostname over the network, add an entry for it to the\nhosts(5)\nfile:\n/etc/hosts\n127.0.0.1        localhost\n::1              localhost\n127.0.1.1\nyourhostname\nFor a system with a permanent IP address, replace\n127.0.1.1\nwith that permanent IP address. For a system with a\nfully qualified domain name\n, insert the fully qualified domain name before the hostname (see the following link for\nthe reasoning\n). For example:\n/etc/hosts\n127.0.0.1        localhost\n::1              localhost\n203.0.113.45     host1.fqdomain.example host1\nNote\nThe order of hostnames/aliases that follow the IP address in\n/etc/hosts\nis significant. The first string is considered the canonical hostname and may be appended with parent domains, where domain components are separated by a dot. All following strings on the same line are considered aliases. See\nhosts(5)\nfor more information.\nSee also\nLinux Network Administrators Guide\nDebian Reference: Network setup\nRHEL7: Networking Guide\nMonitoring and tuning the Linux Networking Stack: Receiving data\nMonitoring and tuning the Linux Networking Stack: Sending data\nTracing a packet journey using tracepoints, perf and eBPF\nRetrieved from \"\nhttps://wiki.archlinux.org/index.php?title=Network_configuration&oldid=853724\n\"\nCategory\n:\nNetwork configuration\nHidden categories:\nPages or sections flagged with Template:Expansion\nPages or sections flagged with Template:Style\nPages or sections flagged with Template:Accuracy\nSearch\nSearch\nNetwork configuration\nAdd topic", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://wiki.archlinux.org/title/Network_configuration"}}
{"text": "systemd - ArchWiki\nHome\nPackages\nForums\nWiki\nGitLab\nSecurity\nAUR\nDownload\nJump to content\nArchWiki\nSearch\nSearch\nsystemd\n10 languages\nDeutsch\nEspañol\nSuomi\nFrançais\nMagyar\nItaliano\n日本語\nPortuguês\nРусский\n中文（简体）\nFrom ArchWiki\nRelated articles\nsystemd/User\nsystemd/Timers\nsystemd/Journal\nsystemd/Sandboxing\nsystemd/FAQ\ninit\nudev\nImproving performance/Boot process\nAllow users to shutdown\nFrom the\nproject web page\n:\nsystemd\nis a suite of basic building blocks for a Linux system. It provides a system and service manager that runs as PID 1 and starts the rest of the system.\nsystemd\nprovides aggressive parallelization capabilities, uses socket and\nD-Bus\nactivation for starting services, offers on-demand starting of daemons, keeps track of processes using Linux\ncontrol groups\n, maintains mount and automount points, and implements an elaborate transactional dependency-based service control logic.\nsystemd\nsupports SysV and LSB init scripts and works as a replacement for sysvinit. Other parts include a logging daemon, utilities to control basic system configuration like the hostname, date, locale, maintain a list of logged-in users and running containers and virtual machines, system accounts, runtime directories and settings, and daemons to manage simple network configuration, network time synchronization, log forwarding, and name resolution.\nHistorically, what systemd calls \"service\" was named\ndaemon\n: any program that runs as a \"background\" process (without a terminal or user interface), commonly waiting for events to occur and offering services. A good example is a web server that waits for a request to deliver a page, or an ssh server waiting for someone trying to log in. While these are full featured applications, there are daemons whose work is not that visible. Daemons are for tasks like writing messages into a log file (e.g.\nsyslog\n,\nmetalog\n) or keeping your system time accurate (e.g.\nntpd\n). For more information see\ndaemon(7)\n.\nNote\nFor a detailed explanation of why Arch moved to\nsystemd\n, see\nthis forum post\n.\nBasic systemctl usage\nThe main command used to introspect and control\nsystemd\nis\nsystemctl\n. Some of its uses are examining the system state and managing the system and services. See\nsystemctl(1)\nfor more details.\nTip\nYou can use all of the following\nsystemctl\ncommands with the\n-H\nuser\n@\nhost\nswitch to control a\nsystemd\ninstance on a remote machine. This will use\nSSH\nto connect to the remote\nsystemd\ninstance.\nPlasma\nusers can install\nsystemdgenie\nas a graphical frontend for\nsystemctl\n.\nUsing units\nUnits commonly include, but are not limited to, services (\n.service\n), mount points (\n.mount\n), devices (\n.device\n) and sockets (\n.socket\n).\nWhen using\nsystemctl\n, you generally have to specify the complete name of the unit file, including its suffix, for example\nsshd.socket\n. There are however a few short forms when specifying the unit in the following\nsystemctl\ncommands:\nIf you do not specify the suffix, systemctl will assume\n.service\n. For example,\nnetctl\nand\nnetctl.service\nare equivalent.\nMount points will automatically be translated into the appropriate\n.mount\nunit. For example, specifying\n/home\nis equivalent to\nhome.mount\n.\nSimilar to mount points, devices are automatically translated into the appropriate\n.device\nunit, therefore specifying\n/dev/sda2\nis equivalent to\ndev-sda2.device\n.\nSee\nsystemd.unit(5)\nfor details.\nNote\nSome unit names contain an\n@\nsign (e.g.\nname@\nstring\n.service\n): this means that they are\ninstances\nof a\ntemplate\nunit, whose actual file name does not contain the\nstring\npart (e.g.\nname@.service\n).\nstring\nis called the\ninstance identifier\n, and is similar to an argument that is passed to the template unit when called with the\nsystemctl\ncommand: in the unit file it will substitute the\n%i\nspecifier. To be more accurate,\nbefore\ntrying to instantiate the\nname@.\nsuffix\ntemplate unit,\nsystemd\nwill actually look for a unit with the exact\nname@\nstring\n.\nsuffix\nfile name, although by convention such a \"clash\" happens rarely, i.e. most unit files containing an\n@\nsign are meant to be templates. Also, if a template unit is called without an instance identifier, it will generally fail (except with certain\nsystemctl\ncommands, like\ncat\n).\nThe commands in the below table operate on\nsystem units\nsince\n--system\nis the implied default for\nsystemctl\n. To instead operate on\nuser units\n(for the\ncalling user\n), use\nsystemctl --user\nwithout root privileges. See also\nsystemd/User#Basic setup\nto enable/disable user units for\nall users\n.\nTip\nMost commands also work if multiple units are specified, see\nsystemctl(1)\nfor more information.\nThe\n--now\nswitch can be used in conjunction with\nenable\n,\ndisable\n, and\nmask\nto respectively start, stop, or mask the unit\nimmediately\nrather than after rebooting.\nA package may offer units for different purposes. If you just installed a package,\npacman -Qql\npackage\n| grep -Fe .service -e .socket\ncan be used to check and find them.\nWhen available, enabling\nunit\n.socket\ninstead of\nunit\n.service\nmight be beneficial because the socket would start the service when necessary. See\n#Socket activation\nfor more details.\nAction\nCommand\nNote\nAnalyzing the system state\nShow system status\nsystemctl status\nList running\nunits\nsystemctl\nor\nsystemctl list-units\nList failed\nunits\nsystemctl --failed\nList installed\nunit files\n1\nsystemctl list-unit-files\nShow process status\nfor a PID\nsystemctl status\npid\ncgroup slice\n, memory and parent\nChecking the unit status\nShow a manual page\nassociated with a unit\nsystemctl help\nunit\nas supported by the unit\nStatus\nof a unit\nsystemctl status\nunit\nincluding whether it is running or not\nCheck\nwhether a unit is enabled\nsystemctl is-enabled\nunit\nStarting, restarting, reloading a unit\nStart\na unit immediately\nsystemctl start\nunit\nas root\nStop\na unit immediately\nsystemctl stop\nunit\nas root\nRestart\na unit\nsystemctl restart\nunit\nas root\nReload\na unit and its configuration\nsystemctl reload\nunit\nas root\nReload systemd manager\nconfiguration\n2\nsystemctl daemon-reload\nas root\nscan for new or changed units\nEnabling a unit\nEnable\na unit to start automatically at boot\nsystemctl enable\nunit\nas root\nEnable\na unit to start automatically at boot and\nstart\nit immediately\nsystemctl enable --now\nunit\nas root\nDisable\na unit to no longer start at boot\nsystemctl disable\nunit\nas root\nReenable\na unit\n3\nsystemctl reenable\nunit\nas root\ni.e. disable and enable anew\nMasking a unit\nMask\na unit to make it impossible to start\n4\nsystemctl mask\nunit\nas root\nUnmask\na unit\nsystemctl unmask\nunit\nas root\nSee\nsystemd.unit(5) § UNIT FILE LOAD PATH\nfor the directories where available unit files can be found.\nThis does not ask the changed units to reload their own configurations (see the\nReload\naction).\nFor example, in case its\n[Install]\nsection has changed since last enabling it.\nBoth manually and as a dependency, which makes masking dangerous. Check for existing masked units with:\n$ systemctl list-unit-files --state=masked\nPower management\npolkit\nis necessary for power management as an unprivileged user. If you are in a local\nsystemd-logind\nuser session and no other session is active, the following commands will work without root privileges. If not (for example, because another user is logged into a tty),\nsystemd\nwill automatically ask you for the root password.\nAction\nCommand\nShut down and reboot the system\nsystemctl reboot\nShut down and power-off the system\nsystemctl poweroff\nSuspend the system\nsystemctl suspend\nPut the system into hibernation (write RAM to disk)\nsystemctl hibernate\nPut the system into hybrid-sleep state (also called suspend-to-both, it saves RAM to disk and then suspends)\nsystemctl hybrid-sleep\nFirst suspend the system, then wake up after a configured time in order to just hibernate the system\nsystemctl suspend-then-hibernate\nPerform a reboot of the userspace-only with a\n#Soft reboot\n.\nsystemctl soft-reboot\nSoft reboot\nSoft reboot is a special kind of a userspace-only reboot operation that does not involve the kernel. It is implemented by\nsystemd-soft-reboot.service(8)\nand can be invoked through\nsystemctl soft-reboot\n. As with\nkexec\n, it skips firmware re-initialization, but additionally the system does not go through kernel initialization and\ninitramfs\n, and unlocked\ndm-crypt\ndevices remain attached.\nWhen\n/run/nextroot/\ncontains a valid root file system hierarchy (e.g. is the root mount of another distribution or another snapshot),\nsoft-reboot\nwould switch the system root into it, allowing for switching to another installation without losing states managed by kernel, e.g.\nnetworking\n.\nTip\n/run/nextroot/\nis not necessarily a mount point or backed by physical device. For example, it can reside in the\n/run/\ntmpfs.\nsystemd\nwill turn\n/run/nextroot/\nautomatically into a mount point on\nsoft-reboot\n.\nNote\nDo not invoke\nsystemctl soft-reboot\nafter package updates that involved the kernel and initramfs.\nWriting unit files\nThe syntax of\nsystemd'\ns unit files (\nsystemd.unit(5)\n) is inspired by\nXDG Desktop Entry Specification .desktop files\n, which are in turn inspired by\nMicrosoft Windows .ini files\n. Unit files are loaded from multiple locations (to see the full list, run\nsystemctl show --property=UnitPath\n), but the main ones are (listed from lowest to highest precedence):\n/usr/lib/systemd/system/\n: units provided by installed packages\n/etc/systemd/system/\n: units installed by the system administrator\nNote\nThe load paths are completely different when running\nsystemd\nin\nuser mode\n.\nsystemd\nunit names may only contain ASCII alphanumeric characters, underscores and periods. All other characters must be replaced by C-style \"\\x2d\" escapes, or employ their predefined semantics ('@', '-'). See\nsystemd.unit(5)\nand\nsystemd-escape(1)\nfor more information.\nLook at the units installed by your packages for examples, as well as\nsystemd.service(5) § EXAMPLES\n.\nTip\nComments prepended with\n#\nmay be used in unit-files as well, but only in new lines. Do not use end-line comments after\nsystemd\nparameters or the unit will fail to activate.\nsystemd-analyze(1)\ncan help verifying the work. See the\nsystemd-analyze verify FILE...\nsection of that page.\nHandling dependencies\nWith\nsystemd\n, dependencies can be resolved by designing the unit files correctly. The most typical case is when unit\nA\nrequires unit\nB\nto be running before\nA\nis started. In that case add\nRequires=\nB\nand\nAfter=\nB\nto the\n[Unit]\nsection of\nA\n. If the dependency is optional, add\nWants=\nB\nand\nAfter=\nB\ninstead. Note that\nWants=\nand\nRequires=\ndo not imply\nAfter=\n, meaning that if\nAfter=\nis not specified, the two units will be started in parallel.\nDependencies are typically placed on services and not on\n#Targets\n. For example,\nnetwork.target\nis pulled in by whatever service configures your network interfaces, therefore ordering your custom unit after it is sufficient since\nnetwork.target\nis started anyway.\nService types\nThere are several different start-up types to consider when writing a custom service file. This is set with the\nType=\nparameter in the\n[Service]\nsection:\nType=simple\n(default):\nsystemd\nconsiders the service to be started up immediately. The process must not fork. Do not use this type if other services need to be ordered on this service, unless it is socket activated.\nType=forking\n:\nsystemd\nconsiders the service started up once the process forks and the parent has exited. For classic daemons, use this type unless you know that it is not necessary. You should specify\nPIDFile=\nas well so\nsystemd\ncan keep track of the main process.\nType=oneshot\n: this is useful for scripts that do a single job and then exit. You may want to set\nRemainAfterExit=yes\nas well so that\nsystemd\nstill considers the service as active after the process has exited. Setting\nRemainAfterExit=yes\nis appropriate for the units which change the system state (e.g., mount some partition). See also\n[1]\nfor the differences of simple and oneshot.\nType=notify\n: identical to\nType=simple\n, but with the stipulation that the daemon will send a signal to\nsystemd\nwhen it is ready. The reference implementation for this notification is provided by\nlibsystemd-daemon.so\n.\nType=dbus\n: the service is considered ready when the specified\nBusName\nappears on DBus's system bus.\nType=idle\n:\nsystemd\nwill delay execution of the service binary until all jobs are dispatched unless these take longer than 5s, where the service binary is started anyway. Other than that its behaviour is very similar to\nType=simple\n. It should never be used for service ordering and is intended for helping with console output readability.\nSee the\nsystemd.service(5) § OPTIONS\nman page for a more detailed explanation of the\nType\nvalues.\nEditing provided units\nThis article or section needs expansion.\nReason:\nWe should fit \"If\n--runtime\nis specified, the changes will be made temporarily in\n/run/\nand they will be lost on the next reboot.\" in here. An example would be passing debug flags to a service and not wanting to keep the changes permanently. (Discuss in\nTalk:Systemd\n)\nTo avoid conflicts with pacman, unit files provided by packages should not be directly edited. There are two safe ways to modify a unit without touching the original file: create a new unit file which\noverrides the original unit\nor create\ndrop-in snippets\nwhich are applied on top of the original unit. For both methods, you must reload the unit afterwards to apply your changes. This can be done either by editing the unit with\nsystemctl edit\n(which reloads the unit automatically) or by reloading all units with:\n# systemctl daemon-reload\nTip\nYou can use\nsystemd-delta\nto see which unit files have been overridden or extended and what exactly has been changed.\nUse\nsystemctl cat\nunit\nto view the content of a unit file and all associated drop-in snippets.\nReplacement unit files\nTo replace the unit file\n/usr/lib/systemd/system/\nunit\n, create the file\n/etc/systemd/system/\nunit\nand\nreenable\nthe unit to update the symlinks.\nAlternatively, run:\n# systemctl edit --full\nunit\nThis opens\n/etc/systemd/system/\nunit\nin your editor (copying the installed version if it does not exist yet) and automatically reloads it when you finish editing.\nNote\nThe replacement units will keep on being used even if Pacman updates the original units in the future. This method makes system maintenance more difficult and therefore the next approach is preferred.\nDrop-in files\nTo create drop-in files for the unit file\n/usr/lib/systemd/system/\nunit\n, create the directory\n/etc/systemd/system/\nunit\n.d/\nand place\n.conf\nfiles there to override or add new options.\nsystemd\nwill parse and apply these files on top of the original unit.\nThe easiest way to do this is to run:\n# systemctl edit\nunit\n--drop-in=\ndrop_in_name\nThis opens the file\n/etc/systemd/system/\nunit\n.d/\ndrop_in_name\n.conf\nin your text editor (creating it if necessary) and automatically reloads the unit when you are done editing. Omitting\n--drop-in=\noption will result in systemd using the default file name\noverride.conf\n.\nNote\nThe key must be still placed in the appropriate section in the override file.\nNot all keys can be overridden with drop-in files. For example, for changing\nConflicts=\na replacement file\nis necessary\n.\nYou can use top-level drop-in files to affect all units of the same type. For example, a drop-in file in\n/etc/systemd/system/service.d/\naffects all\n.service\nunits. You can see an example in\n#Notifying about failed services\nRevert to vendor version\nTo revert any changes to a unit made using\nsystemctl edit\ndo:\n# systemctl revert\nunit\nExamples\nFor example, if you simply want to add an additional dependency to a unit, you may create the following file:\n/etc/systemd/system/\nunit\n.d/customdependency.conf\n[Unit]\nRequires=\nnew dependency\nAfter=\nnew dependency\nAs another example, in order to replace the\nExecStart\ndirective, create the following file:\n/etc/systemd/system/\nunit\n.d/customexec.conf\n[Service]\nExecStart=\nExecStart=\nnew command\nNote how\nExecStart\nmust be cleared before being re-assigned\n[2]\n. The same holds for every item that can be specified multiple times, e.g.\nOnCalendar\nfor timers.\nOne more example to automatically restart a service:\n/etc/systemd/system/\nunit\n.d/restart.conf\n[Service]\nRestart=always\nRestartSec=30\nService logging levels\nFor services that send logs directly to journald or syslog, you can control their verbosity by setting a numeric value between 0 and 6 for the\nLogLevelMax=\nparameter in the\n[Service]\nsection using the methods described above. For example:\n/etc/systemd/system/\nunit\n.d/override.conf\n[Service]\nLogLevelMax=3\nThe standard log levels are identical to those used to filter the\njournal\n. Setting a lower number excludes all higher and less important log messages from your journal.\nSuppressing a service's standard output\nIf a service is echoing stdout and/or stderr output, by default this will end up in the journal as well. This behavior can be suppressed by setting\nStandardOutput=null\nand/or\nStandardError=null\nin the\n[Service]\nsection. Other values than\nnull\ncan be used to further tweak this behavior. See\nsystemd.exec(5) § LOGGING_AND_STANDARD_INPUT/OUTPUT\n.\nTargets\nsystemd\nuses\ntargets\nto group units together via dependencies and as standardized synchronization points. They serve a similar purpose as\nrunlevels\nbut act a little differently. Each\ntarget\nis named instead of numbered and is intended to serve a specific purpose with the possibility of having multiple ones active at the same time. Some\ntarget\ns are implemented by inheriting all of the services of another\ntarget\nand adding additional services to it. There are\nsystemd\ntarget\ns that mimic the common SystemVinit runlevels.\nGet current targets\nThe following should be used under\nsystemd\ninstead of running\nrunlevel\n:\n$ systemctl list-units --type=target\nCreate custom target\nThe runlevels that held a defined meaning under sysvinit (i.e., 0, 1, 3, 5, and 6); have a 1:1 mapping with a specific\nsystemd\ntarget\n. Unfortunately, there is no good way to do the same for the user-defined runlevels like 2 and 4. If you make use of those it is suggested that you make a new named\nsystemd\ntarget\nas\n/etc/systemd/system/\nyour target\nthat takes one of the existing runlevels as a base (you can look at\n/usr/lib/systemd/system/graphical.target\nas an example), make a directory\n/etc/systemd/system/\nyour target\n.wants\n, and then symlink the additional services from\n/usr/lib/systemd/system/\nthat you wish to enable.\nMapping between SysV runlevels and systemd targets\nSysV Runlevel\nsystemd Target\nNotes\n0\npoweroff.target\nHalt the system.\n1, s, single\nrescue.target\nSingle user mode.\n2, 4\nmulti-user.target\nUser-defined/Site-specific runlevels. By default, identical to 3.\n3\nmulti-user.target\nMulti-user, non-graphical. Users can usually login via multiple consoles or via the network.\n5\ngraphical.target\nMulti-user, graphical. Usually has all the services of runlevel 3 plus a graphical login.\n6\nreboot.target\nReboot\nemergency\nemergency.target\nEmergency shell\nChange current target\nIn\nsystemd\n, targets are exposed via\ntarget units\n. You can change them like this:\n# systemctl isolate graphical.target\nThis will only change the current target, and has no effect on the next boot. This is equivalent to commands such as\ntelinit 3\nor\ntelinit 5\nin Sysvinit.\nChange default target to boot into\nThe standard target is\ndefault.target\n, which is a symlink to\ngraphical.target\n. This roughly corresponds to the old runlevel 5.\nTo verify the current target with\nsystemctl\n:\n$ systemctl get-default\nTo change the default target to boot into, change the\ndefault.target\nsymlink. With\nsystemctl\n:\n# systemctl set-default multi-user.target\nRemoved /etc/systemd/system/default.target.\nCreated symlink /etc/systemd/system/default.target -> /usr/lib/systemd/system/multi-user.target.\nAlternatively, append one of the following\nkernel parameters\nto your boot loader:\nsystemd.unit=multi-user.target\n(which roughly corresponds to the old runlevel 3),\nsystemd.unit=rescue.target\n(which roughly corresponds to the old runlevel 1).\nDefault target order\nsystemd\nchooses the\ndefault.target\naccording to the following order:\nKernel parameter shown above\nSymlink of\n/etc/systemd/system/default.target\nSymlink of\n/usr/lib/systemd/system/default.target\nsystemd components\nSome (not exhaustive) components of\nsystemd\nare:\nkernel-install\n— to automatically move\nkernels\nand their respective\ninitramfs\nimages to the boot partition;\nsystemd-analyze(1)\n— may be used to determine boot-up performance,  statistics and retrieve other state and tracing information, and to verify the correctness of unit files. It is also used to access special functions useful for advanced debugging.\nsystemd-boot\n— simple UEFI\nboot manager\n;\nsystemd-creds\n— to securely store and retrieve credentials used by systemd units;\nsystemd-cryptenroll\n— Enroll PKCS#11, FIDO2, TPM2 token/devices to LUKS2 encrypted volumes;\nsystemd-firstboot\n— basic system setting initialization before first boot;\nsystemd-homed\n— portable human-user\naccounts\n;\nsystemd-logind(8)\n—\nsession management\n;\nsystemd-networkd\n—\nnetwork configuration\nmanagement;\nsystemd-nspawn\n— light-weight namespace container;\nsystemd-repart\n— creates partition tables, adds or grows partitions;\nsystemd-resolved\n— network\nname resolution\n;\nsystemd-run(1)\n/\nrun0(1)\n— Temporarily and interactively acquire elevated or different privileges.\nsystemd-stub(7)\n— a UEFI boot stub used for creating\nunified kernel images\n;\nsystemd-sysusers(8)\n— creates system users and groups and adds users to groups at package installation or boot time;\nsystemd-timesyncd\n—\nsystem time\nsynchronization across the network;\nsystemd/Journal\n— system logging;\nsystemd/Timers\n— monotonic or realtime timers for controlling\n.service\nfiles or events, reasonable alternative to\ncron\n.\nsystemd.mount - mounting\nsystemd\nis in charge of mounting the partitions and filesystems specified in\n/etc/fstab\n. The\nsystemd-fstab-generator(8)\ntranslates all the entries in\n/etc/fstab\ninto\nsystemd\nunits; this is performed at boot time and whenever the configuration of the system manager is reloaded.\nsystemd\nextends the usual\nfstab\ncapabilities and offers additional mount options. These affect the dependencies of the mount unit. They can, for example, ensure that a mount is performed only once the network is up or only once another partition is mounted. The full list of specific\nsystemd\nmount options, typically prefixed with\nx-systemd.\n, is detailed in\nsystemd.mount(5) § FSTAB\n.\nAn example of these mount options is\nautomounting\n, which means mounting only when the resource is required rather than automatically at boot time. This is provided in\nfstab#Automount with systemd\n.\nGPT partition automounting\nOn UEFI-booted systems, GPT partitions such as\nroot\n,\nhome\n,\nswap\n, etc. can be mounted automatically following the\nDiscoverable Partitions Specification\n. These partitions can thus be omitted from\nfstab\n, and if the root partition is automounted, then\nroot=\ncan be omitted from the kernel command line. See\nsystemd-gpt-auto-generator(8)\n.\nThe prerequisites are:\nWhen using\nmkinitcpio\n, the\nsystemd hook\nis required to automount the\nroot\npartition.\nAll automounted partitions must reside on the same physical disk as the ESP.\nThe correct GPT partition types must be set. See\nPartitioning#Partition scheme\n.\nThe boot loader must set the\nLoaderDevicePartUUID\nEFI variable, so that the used EFI system partition can be identified. This is supported by\nsystemd-boot\n,\nsystemd-stub(7)\n,\nLimine\n,\nGRUB\n(with\ngrub-mkconfig\ngenerated\ngrub.cfg\n; custom\ngrub.cfg\nrequires\nloading the bli module\n) and\nrEFInd (not enabled by default)\n. This can be verified by running\nbootctl\nand checking if there is a line with\nPartition:\nunder\nCurrent Boot Loader\nor\nCurrent Stub\nwhen booting via\nUnified kernel images\n.\nudev\nwill create\nsymlinks to the discovered partitions\nwhich can be used to reference the partitions and volumes in configuration files.\nTip\nThe automounting of a partition can be disabled by changing the partition's\ntype GUID\nor setting the partition attribute bit 63 \"do not automount\", see\ngdisk#Prevent GPT partition automounting\n.\n/var\nFor\n/var\nautomounting to work, the PARTUUID must match the SHA256 HMAC hash of the partition type UUID keyed by the machine ID. The required PARTUUID can be obtained using:\n$ systemd-id128 -u var-partition-uuid\nNote\nsystemd-id128(1)\nreads the machine ID from\n/etc/machine-id\n, this makes it impossible to know the needed PARTUUID before the system is installed.\nsystemd-sysvcompat\nThe primary role of\nsystemd-sysvcompat\n(required by\nbase\n) is to provide the traditional linux\ninit\nbinary. For\nsystemd\n-controlled systems,\ninit\nis just a symbolic link to its\nsystemd\nexecutable.\nIn addition, it provides four convenience shortcuts that\nSysVinit\nusers might be used to. The convenience shortcuts are\nhalt(8)\n,\npoweroff(8)\n,\nreboot(8)\nand\nshutdown(8)\n. Each one of those four commands is a symbolic link to\nsystemctl\n, and is governed by\nsystemd\nbehavior. Therefore, the discussion at\n#Power management\napplies.\nsystemd\n-based systems can give up those System V compatibility methods by using the\ninit=\nboot parameter\n(see, for example,\n/bin/init is in systemd-sysvcompat ?\n) and\nsystemd\nnative\nsystemctl\ncommand arguments.\nsystemd-tmpfiles - temporary files\nsystemd-tmpfiles\ncreates, deletes and cleans up volatile and temporary files and directories. It reads configuration files in\n/etc/tmpfiles.d/\nand\n/usr/lib/tmpfiles.d/\nto discover which actions to perform. Configuration files in the former directory take precedence over those in the latter directory.\nConfiguration files are usually provided together with service files, and they are named in the style of\n/usr/lib/tmpfiles.d/\nprogram\n.conf\n. For example, the\nSamba\ndaemon expects the directory\n/run/samba\nto exist and to have the correct permissions. Therefore, the\nsamba\npackage ships with this configuration:\n/usr/lib/tmpfiles.d/samba.conf\nD /run/samba 0755 root root\nConfiguration files may also be used to write values into certain files on boot. For example, if you used\n/etc/rc.local\nto disable wakeup from USB devices with\necho USBE > /proc/acpi/wakeup\n, you may use the following tmpfile instead:\n/etc/tmpfiles.d/disable-usb-wake.conf\n#    Path                  Mode UID  GID  Age Argument\nw    /proc/acpi/wakeup     -    -    -    -   USBE\nIt is possible to write multiple lines to the same file, either with\n\\n\nin the argument or using the\nw+\ntype on multiple lines (including the first one) for\nappending\n:\n/etc/tmpfiles.d/disable-usb-wake.conf\n#    Path                  Mode UID  GID  Age Argument\nw+   /proc/acpi/wakeup     -    -    -    -   USBE\nw+   /proc/acpi/wakeup     -    -    -    -   LID0\nSee the\nsystemd-tmpfiles(8)\nand\ntmpfiles.d(5)\nman pages for details.\nNote\nThis method may not work to set options in\n/sys\nsince the\nsystemd-tmpfiles-setup\nservice may run before the appropriate device modules are loaded. In this case, you could check whether the module has a parameter for the option you want to set with\nmodinfo\nmodule\nand set this option with a\nconfig file in /etc/modprobe.d\n. Otherwise, you will have to write a\nudev rule\nto set the appropriate attribute as soon as the device appears.\nDrop-in configuration files\nThe factual accuracy of this article or section is disputed.\nReason:\nThis page is about PID 1 (init), and unit drop-ins are already mentioned. Drop-in is a generic concept, plus other systemd components have their dedicated wiki pages. Therefore this section doesn't seem to belong here. (Discuss in\nTalk:Systemd#YHNdnzj : Configuration files in conf.d / drop-in snippets: misplaced?\n)\nConfiguration files provided by packages should not be directly edited to avoid conflicts with pacman updates. For this, many (but not all) systemd packages provide a way to modify the configuration, but without touching the original file by creation of drop-in snippets. Check the package manual to see if drop-in configuration files are supported.\nTo create a drop-in configuration file for the unit file\n/etc/systemd/\nunit\n.conf\n, create the directory\n/etc/systemd/\nunit\n.conf.d/\nand place\n.conf\nfiles there to override or add new options.\nsystemd\nwill parse and apply these files on top of the original unit.\nCheck the overall configuration:\n$ systemd-analyze cat-config systemd/\nunit\n.conf\nThe applied drop-in snippets file(s) and content will be listed at the end.\nRestart\nthe service for the changes to take effect.\nTips and tricks\nSocket activation\nSome packages provide a\n.socket\nunit. For example,\ncups\nprovides a\ncups.socket\nunit\n[3]\n. If\ncups.socket\nis\nenabled\n(and\ncups.service\nis left disabled),\nsystemd\nwill not start CUPS immediately; it will just listen to the appropriate sockets. Then, whenever a program attempts to connect to one of these CUPS sockets,\nsystemd\nwill start\ncups.service\nand transparently hand over control of these ports to the CUPS process.\nGUI configuration tools\nsystemadm\n— Graphical browser for\nsystemd\nunits. It can show the list of units, possibly filtered by type.\nhttps://github.com/systemd/systemd-ui\n||\nsystemd-ui\nsystemdGenie\n—\nsystemd\nmanagement utility based on KDE technologies.\nhttps://apps.kde.org/systemdgenie/\n||\nsystemdgenie\nisd\n—  TUI for working with\nsystemd\nunits.\nhttps://github.com/kainctl/isd\n||\nisd\nRunning services after the network is up\nTo delay a service until after the network is up, include the following dependencies in the\n.service\nfile:\n/etc/systemd/system/\nfoo\n.service\n[Unit]\n...\nWants=network-online.target\nAfter=network-online.target\n...\nThe network wait service of the\nnetwork manager\nin use must also be enabled so that\nnetwork-online.target\nproperly reflects the network status.\nIf using\nNetworkManager\n,\nNetworkManager-wait-online.service\nshould be enabled together with\nNetworkManager.service\n. Check if this is the case with\nsystemctl is-enabled NetworkManager-wait-online.service\n. If it is not enabled, then\nreenable\nNetworkManager.service\n.\nIn the case of\nnetctl\n,\nenable\nthe\nnetctl-wait-online.service\n(unless you are using\nnetctl-auto\n; see\nFS#75836\n).\nIf using\nsystemd-networkd\n,\nsystemd-networkd-wait-online.service\nshould be enabled together with\nsystemd-networkd.service\n. Check if this is the case with\nsystemctl is-enabled systemd-networkd-wait-online.service\n. If it is not enabled, then\nreenable\nsystemd-networkd.service\n.\nFor more detailed explanations, see the discussion in the\nNetwork configuration synchronization points\n.\nIf a service needs to perform DNS queries, it should additionally be ordered after\nnss-lookup.target\n:\n/etc/systemd/system/\nfoo\n.service\n[Unit]\n...\nWants=network-online.target\nAfter=network-online.target nss-lookup.target\n...\nSee\nsystemd.special(7) § Special Passive System Units\n.\nFor\nnss-lookup.target\nto have any effect it needs a service that pulls it in via\nWants=nss-lookup.target\nand orders itself before it with\nBefore=nss-lookup.target\n. Typically this is done by local\nDNS resolvers\n.\nCheck which active service, if any, is pulling in\nnss-lookup.target\nwith:\n$ systemctl list-dependencies --reverse nss-lookup.target\nEnable installed units by default\nThis article or section needs expansion.\nReason:\nHow does it work with instantiated units? (Discuss in\nTalk:Systemd\n)\nBy default, Arch Linux does not make use of systemd presets, and does not enable most services on installation.\nIf you wish for systemd presets to be honored when packages are installed, you will need to create a\na pacman hook\nin order to run\nsystemctl preset\nor\nsystemctl preset-all\nwhenever a new systemd unit is installed. Something like\n/etc/pacman.d/hooks/40-systemd-presets.hook\n[Trigger]\nOperation = Install\nType = Path\nTarget = usr/lib/systemd/system/*.service\nTarget = usr/lib/systemd/system/*.timer\nTarget = usr/lib/systemd/system/*.socket\nTarget = usr/lib/systemd/system/*.slice\nTarget = usr/lib/systemd/system/*.path\nTarget = usr/lib/systemd/system/*.target\n[Action]\nDescription = Run systemctl preset\nWhen = PostTransaction\nDepends = systemd\nNeedsTargets\n# Alternatively, you could just run systemd preset-all.\n# However, note that this will reset ALL services to the defaults,\n# which is probably not what you want unless you have carefully configured\n# your presets.\nExec = /etc/pacman.d/scripts/systemd-presets-hook\n/etc/pacman.d/scripts/systemd-presets-hook\n#!/bin/sh -e\nwhile read -r f; do\nunit=\"${f##*/}\"\n# alternatively, you could read all the units and pass them to systemctl preset in a single invocation\nsystemctl preset \"$unit\"\ndone\nArch Linux ships with\n/usr/lib/systemd/system-preset/99-default.preset\ncontaining\ndisable *\n. This causes\nsystemctl preset\nto disable all units by default, such that when a new package is installed, the user must manually enable the unit.\nTo enable units by default instead, simply create a symlink from\n/etc/systemd/system-preset/99-default.preset\nto\n/dev/null\nor replace with a file containing\nenable *\nin order to override the configuration file. This will cause\nsystemctl preset\nto enable all units that get installed—regardless of unit type—unless specified in another file in one\nsystemctl preset'\ns configuration directories. User units are not affected. It is also possible to configure higher priority files with more specific rules on what should be enabled. See\nsystemd.preset(5)\nfor more information.\nNote\nEnabling all units by default may cause problems with packages that contain two or more mutually exclusive units.\nsystemctl preset\nis designed to be used by distributions and spins or system administrators. In the case where two conflicting units would be enabled, you should explicitly specify which one is to be disabled in a preset configuration file as specified in the\nsystemd.preset(5)\nman page.\nSandboxing application environments\nSee\nsystemd/Sandboxing\n.\nNotifying about failed services\nIn order to notify about service failures, an\nOnFailure=\ndirective needs to be added to the according service file, for example by using a\ndrop-in configuration file\n. Adding this directive to every service unit can be achieved with a top-level drop-in configuration file. For details about top-level drop-ins, see\nsystemd.unit(5)\n.\nCreate a top-level drop-in for services:\n/etc/systemd/system/service.d/toplevel-override.conf\n[Unit]\nOnFailure=failure-notification@%n.service\nThis adds\nOnFailure=failure-notification@%n.service\nto every service file. If\nsome_service_unit\nfails,\nfailure-notification@\nsome_service_unit\n.service\nwill be started to handle the notification delivery (or whatever task it is configured to perform).\nCreate the\nfailure-notification@.service\ntemplate unit:\n/etc/systemd/system/failure-notification@.service\n[Unit]\nDescription=Send a notification about a failed systemd unit\n[Service]\nType=oneshot\nExecStart=/\npath\n/\nto\n/failure-notification.sh %i\n# runs as a temporary user/group and enables several other security precautions\nDynamicUser=true\nYou can create the\nfailure-notification.sh\nscript and define what to do or how to notify. Examples include\nsending e-mail\n,\nshowing desktop notifications\n, using gotify, XMPP, etc. The\n%i\nwill be the name of the failed service unit and will be passed as an argument to the script.\nIn order to prevent a recursion for starting instances of\nfailure-notification@.service\nagain and again if the start fails, create an empty drop-in configuration file with the same name as the top-level drop-in (the empty service-level drop-in configuration file takes precedence over the top-level drop-in and overrides the latter one):\n# mkdir /etc/systemd/system/failure-notification@.service.d\n# touch /etc/systemd/system/failure-notification@.service.d/toplevel-override.conf\nNotifying with e-mail\nYou can set up systemd to send an e-mail when a unit fails. Cron sends mail to\nMAILTO\nif the job outputs to stdout or stderr, but many jobs are setup to only output on error. First you need two files: an executable for sending the mail and a\n.service\nfor starting the executable. For this example, the executable is just a shell script using\nsendmail\n, which is in packages that provide\nsmtp-forwarder\n.\n/usr/local/bin/systemd-email\n#!/bin/sh\n/usr/bin/sendmail -t <<ERRMAIL\nTo: $1\nFrom: systemd <root@$HOSTNAME>\nSubject: $2\nContent-Transfer-Encoding: 8bit\nContent-Type: text/plain; charset=UTF-8\n$(systemctl status --full \"$2\")\nERRMAIL\nWhatever executable you use, it should probably take at least two arguments as this shell script does: the address to send to and the unit file to get the status of. The\n.service\nwe create will pass these arguments:\n/etc/systemd/system/status_email_\nuser\n@.service\n[Unit]\nDescription=status email for %i to\nuser\n[Service]\nType=oneshot\nExecStart=/usr/local/bin/systemd-email\naddress\n%i\nUser=nobody\nGroup=systemd-journal\nWhere\nuser\nis the user being emailed and\naddress\nis that user's email address. Although the recipient is hard-coded, the unit file to report on is passed as an instance parameter, so this one service can send email for many other units. At this point you can\nstart\nstatus_email_\nuser\n@dbus.service\nto verify that you can receive the emails.\nThen simply\nedit\nthe service you want emails for and add\nOnFailure=status_email_\nuser\n@%n.service\nto the\n[Unit]\nsection.\n%n\npasses the unit's name to the template.\nNote\nIf you set up sSMTP security according to\nsSMTP#Security\nthe user\nnobody\nwill not have access to\n/etc/ssmtp/ssmtp.conf\n, and the\nsystemctl start status_email_\nuser\n@dbus.service\ncommand will fail. One solution is to use\nroot\nas the User in the\nstatus_email_\nuser\n@.service\nunit.\nIf you try to use\nmail -s somelogs\naddress\nin your email script,\nmail\nwill fork and systemd will kill the mail process when it sees your script exit. Make the mail non-forking by doing\nmail -Ssendwait -s somelogs\naddress\n.\nTip\nNewer versions of systemd recommend using\nDynamicUser=true\nas a replacement for\nUser=nobody\nwhich is now discouraged. See\nGitHub issue 428\nfor more details.\nAutomatically turn off an external HDD at shutdown\nSee\nudisks#Automatically turn off an external HDD at shutdown\n.\nTroubleshooting\nInvestigating failed services\nTo find the\nsystemd\nservices which failed to start:\n$ systemctl --failed\nTo find out why they failed, examine their log output. See\nsystemd/Journal#Filtering output\nfor details.\nDiagnosing boot problems\nsystemd\nhas several options for diagnosing problems with the boot process. See\nboot debugging\nfor more general instructions and options to capture boot messages before\nsystemd\ntakes over the\nboot process\n. Also see\nsystemd debugging documentation\n.\nDiagnosing a service\nIf some\nsystemd\nservice misbehaves or you want to get more information about what is happening, set the\nSYSTEMD_LOG_LEVEL\nenvironment variable\nto\ndebug\n. For example, to run the\nsystemd-networkd\ndaemon in debug mode:\nAdd a\ndrop-in file\nfor the service adding the two lines:\n[Service]\nEnvironment=SYSTEMD_LOG_LEVEL=debug\nOr equivalently, set the environment variable manually:\n# SYSTEMD_LOG_LEVEL=debug /lib/systemd/systemd-networkd\nthen\nrestart\nsystemd-networkd\nand watch the journal for the service with the\n-f\n/\n--follow\noption.\nShutdown/reboot takes terribly long\nIf the shutdown process takes a very long time (or seems to freeze), most likely a service not exiting is to blame.\nsystemd\nwaits some time for each service to exit before trying to kill it. To find out whether you are affected, see\nShutdown completes eventually\nin the\nsystemd\ndocumentation.\nA common problem is a stalled shutdown or suspend process. To verify whether that is the case, you could run either of these commands and check the outputs\n# systemctl poweroff\nFailed to power off system via logind: There's already a shutdown or sleep operation in progress\n# systemctl list-jobs\nJOB UNIT                    TYPE  STATE\n...\n21593 systemd-suspend.service start running\n21592 suspend.target          start waiting\n..\nThe\nsolution\nto this would be to cancel these jobs by running\n# systemctl cancel\n# systemctl stop systemd-suspend.service\nand then trying shutdown or reboot again.\nShort lived processes do not seem to log any output\nIf running\njournalctl -u foounit\nas root does not show any output for a short lived service, look at the PID instead. For example, if\nsystemd-modules-load.service\nfails, and\nsystemctl status systemd-modules-load\nshows that it ran as PID 123, then you might be able to see output in the journal for that PID, i.e. by running\njournalctl -b _PID=123\nas root. Metadata fields for the journal such as\n_SYSTEMD_UNIT\nand\n_COMM\nare collected asynchronously and rely on the\n/proc\ndirectory for the process existing. Fixing this requires fixing the kernel to provide this data via a socket connection, similar to\nSCM_CREDENTIALS\n. In short, it is a\nbug\n. Keep in mind that immediately failed services might not print anything to the journal as per design of\nsystemd\n.\nBoot time increasing over time\nThe factual accuracy of this article or section is disputed.\nReason:\nNetworkManager issues are not\nsystemd\n's fault, the alleged reports are missing. Slow\nsystemctl status\nor\njournalctl\ndo not affect boot time. (Discuss in\nTalk:Systemd\n)\nAfter using\nsystemd-analyze\na number of users have noticed that their boot time has increased significantly in comparison with what it used to be. After using\nsystemd-analyze blame\nNetworkManager\nis being reported as taking an unusually large amount of time to start.\nThe problem for some users has been due to\n/var/log/journal\nbecoming too large. This may have other impacts on performance, such as for\nsystemctl status\nor\njournalctl\n. As such the solution is to remove every file within the folder (ideally making a backup of it somewhere, at least temporarily) and then setting a journal file size limit as described in\nsystemd/Journal#Journal size limit\n.\nsystemd-tmpfiles-setup.service fails to start at boot\nStarting with\nsystemd\n219,\n/usr/lib/tmpfiles.d/systemd.conf\nspecifies ACL attributes for directories under\n/var/log/journal\nand, therefore, requires ACL support to be enabled for the filesystem the journal resides on.\nSee\nAccess Control Lists#Enable ACL\nfor instructions on how to enable ACL on the filesystem that houses\n/var/log/journal\n.\nDisable emergency mode on remote machine\nYou may want to disable emergency mode on a remote machine, for example, a virtual machine hosted at Azure or Google Cloud. It is because if emergency mode is triggered, the machine will be blocked from connecting to network.\nTo disable it,\nmask\nemergency.service\nand\nemergency.target\n.\nError \"Unit xxx.service not found\", but service does exist\nYou may be trying to start or enable a user unit as a system unit.\nsystemd.unit(5)\nindicates, which units reside where. By default\nsystemctl\noperates on system services.\nSee\nsystemd/User\nfor more details.\nManually renewing LoaderDevicePartUUID after changing EFI partition UUID\nSome bootloaders only set the\nLoaderDevicePartUUID\nvariable when it is empty. Consequently, even if the UUID of the EFI partition changes, the bootloader will not update\nLoaderDevicePartUUID\n. By deleting the EFI variable with the commands below, the bootloader will then repopulate it with the new UUID.\n# chattr -i /sys/firmware/efi/efivars/LoaderDevicePartUUID-4a67b082-0a4c-41cf-b6c7-440b29bb8c4f\n# rm /sys/firmware/efi/efivars/LoaderDevicePartUUID-4a67b082-0a4c-41cf-b6c7-440b29bb8c4f\nSee also\nWikipedia:systemd\nOfficial web site\nsystemd optimizations\nsystemd FAQ\nsystemd Tips and tricks\nsystemd(1)\nOther distributions\nGentoo:systemd\nFedora:systemd\nFedora:How to debug Systemd problems\nFedora:SysVinit to Systemd Cheatsheet\nDebian:systemd\nLennart's blog story\n,\nupdate 1\n,\nupdate 2\n,\nupdate 3\n,\nsummary\nDebug Systemd Services\nsystemd for Administrators (PDF)\nHow To Use Systemctl to Manage Systemd Services and Units\nSession management with systemd-logind\nEmacs#Syntax highlighting for systemd files\nTwo\npart\nintroductory article in\nThe H Open\nmagazine.\nRetrieved from \"\nhttps://wiki.archlinux.org/index.php?title=Systemd&oldid=852074\n\"\nCategory\n:\nInit\nHidden categories:\nPages or sections flagged with Template:Expansion\nPages or sections flagged with Template:Accuracy\nSearch\nSearch\nsystemd\nAdd topic", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://wiki.archlinux.org/title/Systemd"}}
{"text": "pacman - ArchWiki\nHome\nPackages\nForums\nWiki\nGitLab\nSecurity\nAUR\nDownload\nJump to content\nArchWiki\nSearch\nSearch\npacman\n11 languages\nDeutsch\nEspañol\nSuomi\nFrançais\nItaliano\nMagyar\n日本語\nPortuguês\nРусский\nSvenska\n中文（简体）\nFrom ArchWiki\nRelated articles\n/Package signing\n/Pacnew and Pacsave\n/Restore local database\n/Rosetta\n/Tips and tricks\nArch User Repository\nCreating packages\nDowngrading packages\nnamcap\nFAQ#Package management\nSystem maintenance\nPackage Proxy Cache\nThe\npacman\npackage manager\nis one of the major distinguishing features of\nArch Linux\n. It combines a simple binary package format with an easy-to-use\nArch build system\n. The goal of\npacman\nis to make it possible to easily manage packages, whether they are from the\nofficial repositories\nor the user's own builds.\nPacman\nkeeps the system up-to-date by synchronizing package lists with the master server. This server/client model also allows the user to download/install packages with a simple command, complete with all required dependencies.\nPacman\nis written in the\nC\nprogramming language and uses the\nbsdtar(1)\ntar\nformat for packaging.\nTip\nThe\npacman\npackage contains tools such as\nmakepkg\nand\nvercmp(8)\n. Other useful tools such as\npactree\nand\ncheckupdates\nare found in\npacman-contrib\n(\nformerly\npart of\npacman\n). Run\npacman -Ql pacman pacman-contrib | grep -E 'bin/.+'\nto see the full list.\nUsage\nWhat follows is just a small sample of the operations that\npacman\ncan perform. To read more examples, refer to\npacman(8)\n.\nTip\nFor those who have used other Linux distributions before, there is a helpful\nPacman/Rosetta\narticle.\nInstalling packages\nA package is an archive containing:\nall of the (compiled) files of an application\nmetadata about the application, such as application name, version, dependencies, etc.\ninstallation files and directives for\npacman\nArch's package manager\npacman\ncan install, update, and remove those packages. Using packages instead of compiling and installing programs yourself has various benefits:\neasily updatable:\npacman\nwill update existing packages as soon as updates are available\ndependency checks:\npacman\nhandles dependencies for you, you only need to specify the program and\npacman\ninstalls it together with every other program it needs\nclean removal:\npacman\nhas a list of every file in a package; this way, no files are unintentionally left behind when you decide to remove a package.\nNote\nPackages often have\noptional dependencies\nwhich are packages that provide additional functionality to the application but not strictly required for running it. When installing a package,\npacman\nwill list a package's optional dependencies, but they will not be found in\npacman.log\n. Use the\n#Querying package databases\ncommand to view the optional dependencies of a package.\nWhen installing a package which you require only as a (optional) dependency of some other package (i.e. not required by you explicitly), it is recommended to use the\n--asdeps\noption. For details, see the\n#Installation reason\nsection.\nWarning\nWhen installing packages in Arch, avoid refreshing the package list without\nupgrading the system\n(for example, when a\npackage is no longer found\nin the official repositories). In practice, do\nnot\nrun\npacman -Sy\npackage_name\ninstead of\npacman -Sy\nu\npackage_name\n, as this could lead to dependency issues. See\nSystem maintenance#Partial upgrades are unsupported\nand\nBBS#89328\n.\nInstalling specific packages\nTo install a single package or list of packages, including dependencies, issue the following command:\n# pacman -S\npackage_name1\npackage_name2\n...\nTo install a list of packages with regex (see\nthis forum thread\n):\n# pacman -S $(pacman -Ssq\npackage_regex\n)\nSometimes there are multiple versions of a package in different repositories (e.g.\nextra\nand\nextra-testing\n). To install the version from the\nextra\nrepository in this example, the repository needs to be defined in front of the package name:\n# pacman -S extra/\npackage_name\nTo install a number of packages sharing similar patterns in their names, one can use curly brace expansion. For example:\n# pacman -S plasma-{desktop,mediacenter,nm}\nThis can be expanded to however many levels needed:\n# pacman -S plasma-{workspace{,-wallpapers},pa}\nVirtual packages\nA virtual package is a special package which does not exist by itself, but is\nprovided\nby one or more other packages. Virtual packages allow other packages to not name a specific package as a dependency, in case there are several candidates. Virtual packages cannot be installed by their name, instead they become installed in your system when you have installed a package\nproviding\nthe virtual package. An example is the\ndbus-units\npackage.\nTip\nWhen there are multiple candidates, the list of choices presented will sort first by\nrepositories\nin the order they appear in\npacman.conf\n, then alphabetically when multiple results exist from the same repository.\nInstalling package groups\nSome packages belong to a\ngroup of packages\nthat can all be installed simultaneously. For example, issuing the command:\n# pacman -S gnome\nwill prompt you to select the packages from the\ngnome\ngroup that you wish to install.\nSometimes a package group will contain a large amount of packages, and there may be only a few that you do or do not want to install. Instead of having to enter all the numbers except the ones you do not want, it is sometimes more convenient to select or exclude packages or ranges of packages with the following syntax:\nEnter a selection (default=all): 1-10 15\nwhich will select packages 1 through 10 and 15 for installation, or:\nEnter a selection (default=all): ^5-8 ^2\nwhich will select all packages except 5 through 8 and 2 for installation.\nTo see what packages belong to the gnome group, run:\n$ pacman -Sg gnome\nAlso visit\nhttps://archlinux.org/groups/\nto see what package groups are available.\nNote\nIf a package in the list is already installed on the system, it will be reinstalled even if it is already up-to-date. This behavior can be overridden with the\n--needed\noption.\nRemoving packages\nTo remove a single package, leaving all of its dependencies installed:\n# pacman -R\npackage_name\nTo remove a package and its dependencies which are not required by any other installed package:\n# pacman -Rs\npackage_name\nWarning\nWhen removing a group, such as\ngnome\n, this ignores the install reason of the packages in the group, because it acts as though each package in the group is listed separately. Install reason of dependencies is still respected.\nThe above may sometimes refuse to run when removing a group which contains otherwise needed packages. In this case try:\n# pacman -Rsu\npackage_name\nTo remove a package, its dependencies and all the packages that depend on the target package:\nWarning\nThis operation is recursive, and must be used with care since it can remove many potentially needed packages.\n# pacman -Rsc\npackage_name\nTo remove a package, which is required by another package, without removing the dependent package:\nWarning\nThe following operation can break a system and should be avoided. See\nSystem maintenance#Avoid certain pacman commands\n.\n# pacman -Rdd\npackage_name\nPacman\nsaves important configuration files when removing certain applications and names them with the extension:\n.pacsave\n. To prevent the creation of these backup files use the\n-n\noption:\n# pacman -Rn\npackage_name\nNote\nPacman\nwill not remove configurations that the application itself creates (for example \"dotfiles\" in the home directory).\nUpgrading packages\nWarning\nUsers are expected to follow the guidance in the\nSystem maintenance#Upgrading the system\nsection to upgrade their systems regularly and not blindly run the following command.\nArch only supports full system upgrades. See\nSystem maintenance#Partial upgrades are unsupported\nand\n#Installing packages\nfor details.\nPacman\ncan update all packages on the system with just one command. This could take quite a while depending on how up-to-date the system is. The following command synchronizes the repository databases\nand\nupdates the system's packages, excluding \"local\" packages that are not in the configured repositories:\n# pacman -Syu\nQuerying package databases\nPacman\nqueries the local package database with the\n-Q\nflag, the sync database with the\n-S\nflag and the files database with the\n-F\nflag. See\npacman -Q --help\n,\npacman -S --help\nand\npacman -F --help\nfor the respective suboptions of each flag.\nNote\nSync the files database before querying it to get up-to-date results:\n# pacman -Fy\nTip\nYou can\nenable/start\nthe\npacman-filesdb-refresh.timer\n(provided within the\npacman-contrib\npackage) to refresh\npacman\nfiles database weekly.\nPacman\ncan search for packages in the database, searching both in packages' names and descriptions:\n$ pacman -Ss\nstring1\nstring2\n...\nSometimes,\n-s\n's builtin ERE (Extended Regular Expressions) can cause a lot of unwanted results, so it has to be limited to match the package name only; not the description nor any other field:\n$ pacman -Ss '^vim-'\nTo search for already installed packages:\n$ pacman -Qs\nstring1\nstring2\n...\nTo search for package file names in remote packages:\n$ pacman -F\nstring1\nstring2\n...\nTo display extensive information about a given package (e.g. its dependencies):\n$ pacman -Si\npackage_name\nFor locally installed packages:\n$ pacman -Qi\npackage_name\nPassing two\n-i\nflags will also display the list of backup files and their modification states:\n$ pacman -Qii\npackage_name\nTo retrieve a list of the files installed by a package:\n$ pacman -Ql\npackage_name\nTo retrieve a list of the files installed by a remote package:\n$ pacman -Fl\npackage_name\nTo verify the presence of the files installed by a package:\n$ pacman -Qk\npackage_name\nPassing the\nk\nflag twice will perform a more thorough check.\nTo query the database to know which package a file in the file system belongs to:\n$ pacman -Qo\n/path/to/file_name\nTo query the database to know which remote package a file belongs to:\n$ pacman -F\n/path/to/file_name\nTo list all packages no longer required as dependencies (orphans):\n$ pacman -Qdt\nTo list all packages explicitly installed and not required as dependencies:\n$ pacman -Qet\nSee\npacman/Tips and tricks\nfor more examples.\nFor advanced functionality, install\npkgfile\n, which uses a separate database with all files and their associated packages.\nPactree\nNote\npactree(8)\nis not part of the\npacman\npackage anymore. Instead it can be found in\npacman-contrib\n.\nTo view the dependency tree of a package:\n$ pactree\npackage_name\nTo view the dependent tree of a package, pass the reverse flag\n-r\nto\npactree\n.\nDatabase structure\nThe\npacman\ndatabases are normally located at\n/var/lib/pacman/sync\n. For each repository specified in\n/etc/pacman.conf\n, there will be a corresponding database file located there. Database files are gzipped tar archives containing one directory for each package, for example for the\nwhich\npackage:\n$ tree which-2.21-5\nwhich-2.21-5\n|-- desc\nThe\ndesc\nfile contains meta data such as the package description, dependencies, file size and MD5 hash.\nCleaning the package cache\nPacman\nstores its downloaded packages in\n/var/cache/pacman/pkg/\nand does not remove the old or uninstalled versions automatically. This has some advantages:\nIt allows to\ndowngrade\na package without the need to retrieve the previous version through other means, such as the\nArch Linux Archive\n.\nA package that has been uninstalled can easily be reinstalled directly from the cache directory, not requiring a new download from the repository.\nHowever, it is necessary to deliberately clean up the cache periodically to prevent the directory to grow indefinitely in size.\nThe\npaccache(8)\nscript, provided within the\npacman-contrib\npackage, deletes all cached versions of installed and uninstalled packages, except for the most recent three, by default:\n# paccache -r\nEnable\nand\nstart\npaccache.timer\nto discard unused packages weekly. You can configure the arguments for the service in\n/etc/conf.d/pacman-contrib\n, e.g with\nPACCACHE_ARGS='-k1'\nor\nPACCACHE_ARGS='-uk0'\nfor the two examples below.\nTip\nYou can create a\nhook\nto run this automatically after every\npacman\ntransaction,\ninstall\npaccache-hook\nAUR\nand see\nother examples\nYou can also define how many recent versions you want to keep. To retain only one past version use:\n# paccache -rk1\nAdd the\n-u\n/\n--uninstalled\nswitch to limit the action of\npaccache\nto uninstalled packages. For example to remove all cached versions of uninstalled packages, use the following:\n# paccache -ruk0\nSee\npaccache -h\nfor more options.\nPacman\nalso has some built-in options to clean the cache and the leftover database files from repositories which are no longer listed in the configuration file\n/etc/pacman.conf\n. However\npacman\ndoes not offer the possibility to keep a number of past versions and is therefore more aggressive than\npaccache\ndefault options.\nTo remove all the cached packages that are not currently installed, and the unused sync databases, execute:\n# pacman -Sc\nTo remove all files from the cache, use the clean switch twice, this is the most aggressive approach and will leave nothing in the cache directory:\n# pacman -Scc\nWarning\nOne should avoid deleting from the cache all past versions of installed packages and all uninstalled packages unless one desperately needs to free some disk space. This will prevent downgrading or reinstalling packages without downloading them again.\npkgcacheclean\nAUR\nand\npacleaner\nAUR\nare two further alternatives to clean the cache.\nAdditional commands\nDownload a package without installing it:\n# pacman -Sw\npackage_name\nInstall a 'local' package that is not from a remote repository (e.g. the package is from the\nAUR\n):\n# pacman -U\n/path/to/package/package_name-version.pkg.tar.zst\nTo keep a copy of the local package in\npacman'\ns cache, use:\n# pacman -U file:///\npath/to/package/package_name-version.pkg.tar.zst\nInstall a 'remote' package (not from a repository stated in\npacman'\ns configuration files):\n# pacman -U\nhttp://www.example.com/repo/example.pkg.tar.zst\ndry run\nPacman\nalways\nlists packages to be installed or removed, and asks for permission before taking any action.\nTo get a list in a processable format, and to prevent the actions of\n-S\n,\n-U\nand\n-R\n, you can use\n-p\n, short for\n--print\n.\n--print-format\ncan be added to format this list in various ways.\n--print-format %n\nwill return a list without package versions.\nInstallation reason\nThe\npacman\ndatabase organizes installed packages into two groups, according to installation reason:\nexplicitly-installed\n: packages that were literally passed to a generic\npacman\n-S\nor\n-U\ncommand;\ndependencies\n: packages that, despite never (in general) having been passed to a\npacman\ninstallation command, were\nimplicitly\ninstalled because they were\nrequired\nby packages explicitly installed.\nWhen installing a package, it is possible to force its installation reason to\ndependency\nwith:\n# pacman -S --asdeps\npackage_name\nThe command is normally used because explicitly-installed packages may offer\noptional packages\n, usually for non-essential features for which the user has discretion.\nTip\nInstalling optional dependencies with\n--asdeps\nwill ensure that, if you\nremove orphans\n,\npacman\nwill also remove optional packages set this way.\nWhen\nre\ninstalling a package, though, the current installation reason is preserved by default.\nThe list of explicitly-installed packages can be shown with\npacman -Qe\n, while the complementary list of dependencies can be shown with\npacman -Qd\n.\nTo change the installation reason of an already installed package, execute:\n# pacman -D --asdeps\npackage_name\nUse\n--asexplicit\nto do the opposite operation.\nNote\nUsing\n--asdeps\nand\n--asexplicit\noptions when upgrading, such as with\npacman -Syu\npackage_name\n--asdeps\n, is discouraged. This would change the installation reason of not only the package being installed, but also the packages being upgraded.\nWhat happens during package install/upgrade/removal\nWhen successful, the workflow of a transaction follows five high-level steps plus pre/post transaction hooks:\nInitialize the transaction if there is not a database lock.\nChoose which packages will be added or removed in the transaction.\nPrepare the transaction, based on flags, by performing sanity checks on the sync databases, packages, and their dependencies.\nCommit the transaction:\nWhen applicable, download packages (\n_alpm_sync_load\n).\nIf pre-existing\npacman\nPreTransaction\nhooks apply, they are executed.\nPackages are removed that are to-be-replaced, conflicting, or explicitly targeted to be removed.\nIf there are packages to add, then each package is committed:\nIf the package has an install script, its\npre_install\nfunction is executed (or\npre_upgrade\nor\npre_remove\nin the case of an upgraded or removed package).\nPacman\ndeletes all the files from a pre-existing version of the package (in the case of an upgraded or removed package). However, files that were marked as configuration files in the package are kept (see\n/Pacnew and Pacsave\n).\nPacman\nuntars the package and dumps its files into the file system (in the case of an installed or upgraded package). Files that would overwrite kept, and manually modified, configuration files (see previous step), are stored with a new name (\n.pacnew\n).\nIf the package has an install script, its\npost_install\nfunction is executed (or\npost_upgrade\nor\npost_remove\nin the case of an upgraded or removed package).\nIf\npacman\nPostTransaction\nhooks that exist at the end of the transaction apply, they are executed.\nRelease the transaction and transaction resource (i.e. database lock).\nConfiguration\nPacman\nsettings are located in\n/etc/pacman.conf\n: this is the place where the user configures the program to work in the desired manner. In-depth information about the configuration file can be found in\npacman.conf(5)\n.\nGeneral options\nGeneral options are in the\n[options]\nsection. Read\npacman.conf(5)\nor look in the default\npacman.conf\nfor information on what can be done here.\nComparing versions before updating\nTo see old and new versions of available packages, uncomment the \"VerbosePkgLists\" line in\n/etc/pacman.conf\n. The output of\npacman -Syu\nwill be like this:\nPackage (6)             Old Version  New Version  Net Change  Download Size\nextra/libmariadbclient  10.1.9-4     10.1.10-1      0.03 MiB       4.35 MiB\nextra/libpng            1.6.19-1     1.6.20-1       0.00 MiB       0.23 MiB\nextra/mariadb           10.1.9-4     10.1.10-1      0.26 MiB      13.80 MiB\nParallel downloads\nThe number of packages being downloaded in parallel (at the same time) are configured in\n/etc/pacman.conf\nwith the\nParallelDownloads\noption under\n[options]\n. The\n/etc/pacman.conf\nshipped with the\npacman\npackage sets it to\n5\n. If the option is unset, packages will be downloaded sequentially.\nSkip package from being upgraded\nWarning\nBe careful in skipping packages, since\npartial upgrades\nare unsupported.\nTo have a specific package skipped when\nupgrading\nthe system, add this line in the\n[options]\nsection:\nIgnorePkg=linux\nFor multiple packages use a space-separated list, or use additional\nIgnorePkg\nlines. Also,\nglob\npatterns can be used. If you want to skip packages just once, you can also use the\n--ignore\noption on the command-line - this time with a comma-separated list.\nIt will still be possible to upgrade the ignored packages using\npacman -S\n: in this case\npacman\nwill remind you that the packages have been included in an\nIgnorePkg\nstatement.\nSkip package group from being upgraded\nWarning\nBe careful in skipping package groups, since\npartial upgrades\nare unsupported.\nAs with packages, skipping a whole package group is also possible:\nIgnoreGroup=gnome\nSkip file from being upgraded\nAll files listed with a\nNoUpgrade\ndirective will never be touched during a package install/upgrade, and the new files will be installed with a\n.pacnew\nextension.\nNoUpgrade=\npath/to/file\nMultiple files can be specified like this:\nNoUpgrade=\npath/to/file1 path/to/file2\nNote\nThe path refers to files in the package archive. Therefore, do not include the leading slash.\nSkip files from being installed to system\nTo always skip installation of specific files or directories list them under\nNoExtract\n. For example, to avoid installing bash completion scripts, use:\nNoExtract=usr/share/bash-completion/completions/*\nLater rules override previous ones, and you can negate a rule by prepending\n!\n.\nMaintain several configuration files\nIf you have several configuration files (e.g. main configuration and configuration with\ntesting\nrepository enabled) and would have to share options between configurations you may use\nInclude\noption declared in the configuration files, e.g.:\nInclude =\n/path/to/common/settings\nwhere\n/path/to/common/settings\nfile contains the same options for both configurations.\nHooks\nPacman can run pre- and post-transaction hooks from the\n/usr/share/libalpm/hooks/\ndirectory; more directories can be specified with the\nHookDir\noption in\npacman.conf\n, which defaults to\n/etc/pacman.d/hooks\n. Hook file names must be suffixed with\n.hook\n. Pacman hooks are not interactive.\nPacman hooks are used, for example, in combination with\nsystemd-sysusers\nand\nsystemd-tmpfiles\nto automatically create system users and files during the installation of packages. For example,\ntomcat8\nspecifies that it wants a system user called\ntomcat8\nand certain directories owned by this user. The\npacman\nhooks\nsystemd-sysusers.hook\nand\nsystemd-tmpfiles.hook\ninvoke\nsystemd-sysusers\nand\nsystemd-tmpfiles\nwhen\npacman\ndetermines that\ntomcat8\ncontains files specifying users and tmp files.\nFor more information on alpm hooks, see\nalpm-hooks(5)\n.\nRepositories and mirrors\nBesides the special\n[options]\nsection, each other\n[section]\nin\npacman.conf\ndefines a package repository to be used. A\nrepository\nis a\nlogical\ncollection of packages, which are\nphysically\nstored on one or more servers: for this reason each server is called a\nmirror\nfor the repository.\nRepositories are distinguished between\nofficial\nand\nunofficial\n. The order of repositories in the configuration file matters; repositories listed first will take precedence over those listed later in the file when packages in two repositories have identical names, regardless of version number. In order to use a repository after adding it, you will need to\nupgrade\nthe whole system first.\nEach repository section allows defining the list of its mirrors directly or in a dedicated external file through the\nInclude\ndirective; for example, the mirrors for the official repositories are included from\n/etc/pacman.d/mirrorlist\n. See the\nMirrors\narticle for mirror configuration.\nPackage cache directory\nPacman stores downloaded package files in cache, in a directory denoted by\nCacheDir\nin\n[options]\nsection of\npacman.conf\n(defaults to\n/var/cache/pacman/pkg/\nif not set).\nCache directory may grow over time, even if keeping just the freshest versions of installed packages.\nIf you want to move that directory to some more convenient place, do one of the following:\nSet the\nCacheDir\noption in\npacman.conf\nto new directory. Remember to retain the trailing slash.\nThis is the recommended solution\n.\nMount a dedicated partition or e.g.\nBtrfs subvolume\nin\n/var/cache/pacman/pkg/\n.\nBind-mount selected directory in\n/var/cache/pacman/pkg/\n.\nWarning\nDo not symlink\nthe\n/var/cache/pacman/pkg/\ndirectory to some other location. It\nwill\ncause pacman to misbehave, especially when pacman attempts to update itself.\nPackage security\nPacman supports package signatures, which add an extra layer of security to the packages. The default configuration,\nSigLevel = Required DatabaseOptional\n, enables signature verification for all the packages on a global level. This can be overridden by per-repository\nSigLevel\nlines. For more details on package signing and signature verification, take a look at\npacman-key\n.\nTroubleshooting\n\"Failed to commit transaction (conflicting files)\" error\nIf you see the following error:\n[1]\nerror: could not prepare transaction\nerror: failed to commit transaction (conflicting files)\npackage\n:\n/path/to/file\nexists in filesystem\nErrors occurred, no packages were upgraded.\nThis is happening because\npacman\nhas detected a file conflict, and by design, will not overwrite files for you. This is by design, not a flaw.\nThe problem is usually trivial to solve (although to be sure, you should try to find out how these files got there in the first place). A safe way is to first check if another package owns the file (\npacman -Qo\n/path/to/file\n). If the file is owned by another package,\nfile a bug report\n. If the file is not owned by another package, rename the file which \"exists in filesystem\" and re-issue the update command. If all goes well, the file may then be removed.\nIf you had installed a program manually without using\npacman\n, for example through\nmake install\n, you have to remove/uninstall this program with all of its files. See also\nPacman tips#Identify files not owned by any package\n.\nEvery installed package provides a\n/var/lib/pacman/local/\npackage-version\n/files\nfile that contains metadata about this package. If this file gets corrupted, is empty or goes missing, it results in\nfile exists in filesystem\nerrors when trying to update the package. Such an error usually concerns only one package. Instead of manually renaming and later removing all the files that belong to the package in question, you may explicitly run\npacman -S --overwrite\nglob\npackage\nto force\npacman\nto overwrite files that match\nglob\n.\nWarning\nGenerally avoid using the\n--overwrite\nswitch. See\nSystem maintenance#Avoid certain pacman commands\n.\n\"Failed to commit transaction (invalid or corrupted package)\" error\nThis article or section is out of date.\nReason:\nWith pacman 7.1.0, expired keys should have updates fetched automatically (reliability depends on key infrastructure...) - this should remove the \"package is corrupt\" messages when keys need updated. (Discuss in\nTalk:Pacman\n)\nLook for\n.part\nfiles (partially downloaded packages) in\n/var/cache/pacman/pkg/\nand remove them (often caused by usage of a custom\nXferCommand\nin\npacman.conf\n).\n# find /var/cache/pacman/pkg/ -iname \"*.part\" -delete\nThat same error may also appear if\narchlinux-keyring\nis out-of-date, preventing\npacman\nfrom verifying signatures. See\nPacman/Package signing#Upgrade system regularly\nfor the fix and how to avoid it in the future.\n\"Failed to init transaction (unable to lock database)\" error\nWhen\npacman\nis about to alter the package database, for example installing a package, it creates a lock file at\n/var/lib/pacman/db.lck\n. This prevents another instance of\npacman\nfrom trying to alter the package database at the same time.\nIf\npacman\nis interrupted while changing the database, this stale lock file can remain. If you are certain that no instances of\npacman\nare running then delete the lock file:\n# rm /var/lib/pacman/db.lck\nTip\nYou can run\nfuser /var/lib/pacman/db.lck\nas root to verify if there is any process still using it.\nPackages cannot be retrieved on installation\nThis error manifests as\nNot found in sync db\n,\nTarget not found\nor\nFailed retrieving file\n.\nFirstly, ensure the package actually exists. If certain the package exists, your package list may be out-of-date. Try running\npacman -Syu\nto force a refresh of all package lists and upgrade. Also make sure the selected\nmirrors\nare up-to-date and\nrepositories\nare correctly configured. You can also use\nReflector\nto keep the mirrors up-to-date.\nIf\npacman\nreports there is nothing to update, but the\nFailed retrieving file\nerror continues to be printed, consider\nforcing a database download\nwith\npacman -Syyu\n. This is never needed under normal circumstances, so inspect more closely the\nstatus and consistency of the mirror\n.\nIt could also be that the repository containing the package is not enabled on your system, e.g. the package could be in the\nmultilib\nrepository, but\nmultilib\nis not enabled in your\npacman.conf\n.\nSee also\nFAQ#Why is there only a single version of each shared library in the official repositories?\n.\nFixing an unbootable system caused by an interrupted upgrade\nThis article or section needs expansion.\nReason:\nMultiple things to consider. (Discuss in\nTalk:Pacman#More details in pacman crashes during an update\n)\nWhether due to power loss, kernel panic or hardware failure an update may be interrupted. In most cases, there will not be much damage but the system will likely be unbootable.\nReady a\nUSB flash installation medium\nand boot it.\nMount\nthe root filesystem as well as your\nESP\n.\narch-chroot\ninto the mounted root filesystem.\nCheck\n/var/log/pacman.log\nand replicate the exact update by supplying the\nentire\nlist of packages that was upgraded during the failed transaction to\npacman -Syu\n, allowing it to reinstall while resuming the original update:\n# pacman -Syu $(grep \"\\[\n2025-07-27T22.*\n\\] \\[ALPM\\] upgraded\" /var/log/pacman.log | cut -d \" \" -f4 | tr \"\\n\" \" \")\nReplicating the\nexact\nupgrade is needed to ensure the right scriptlets and hooks will run.\nPacman crashes during an upgrade\nIn the case that\npacman\ncrashes with a \"database write\" error while removing packages, and reinstalling or upgrading packages fails thereafter, do the following:\nBoot using the Arch\nUSB flash installation medium\n. Preferably use a recent media so that the\npacman\nversion matches/is newer than the system.\nMount the system's root filesystem, e.g.,\nmount /dev/sdaX /mnt\nas root, and check the mount has sufficient space with\ndf -h\nMount the proc, sys and dev filesystems as well:\nmount -t proc proc /mnt/proc; mount --rbind /sys /mnt/sys; mount --rbind /dev /mnt/dev\nIf the system uses default database and directory locations, you can now update the system's\npacman\ndatabase and upgrade it via\npacman --root=/mnt --cachedir=/mnt/var/cache/pacman/pkg -Syu\nas root.\nAlternatively, if you cannot update/upgrade, refer to\nPacman/Tips and tricks#Reinstalling all packages\n.\nAfter the upgrade, one way to double-check for not upgraded but still broken packages:\nfind /mnt/usr/lib -size 0\nFollowed by a re-install of any still broken package via\npacman --root /mnt --cachedir=/mnt/var/cache/pacman/pkg -S\npackage\n.\npacman: command not found\nIf\n/var/cache/pacman/pkg\nis a symlink,\npacman\nwill try to make a directory instead and thus remove this symlink during self-upgrade. This will cause the update to fail. As a result,\n/usr/bin/pacman\nand other contents of the\npacman\npackage will be missing.\nNever symlink\n/var/cache/pacman/pkg\nbecause it is controlled by\npacman\n. Use the\nCacheDir\noption or a bind mount instead; see\n#Package cache directory\n.\nIf you have already encountered this problem and broke your system, you can manually extract\n/usr\ncontents from the package to restore\npacman\nand then reinstall it properly; see\nFS#73306\nand\nrelated forum thread\nfor details.\nManually reinstalling pacman\nUsing pacman-static\npacman-static\nAUR\nis a statically compiled version of\npacman\n, so it will be able to run even when the libraries on the system are not working. This can also come in handy when a\npartial upgrade\nwas performed and\npacman\ncan not run anymore.\nThe pinned comment and the PKGBUILD provides a way to directly download the binary, which can be used to reinstall\npacman\nor to upgrade the entire system in case of partial upgrades.\nUsing a precompiled pacman-static binary when PKGBUILD build fails\nIn some situations, your system may be too broken (e.g., due to missing or incompatible libraries) to run `makepkg` or build the `pacman-static` package from the AUR successfully.\nIf building from the PKGBUILD fails or `makepkg` cannot be run, you can download a precompiled `pacman-static` binary from a trusted source. This static binary does not depend on system libraries and can be used to restore a working `pacman` on your system.\nA reliable source for the binary is:\n#\nhttps://pkgbuild.com/~morganamilo/pacman-static/x86_64/bin/pacman-static\nTo use it, run:\n$ curl -L -o pacman-static\nhttps://pkgbuild.com/~morganamilo/pacman-static/x86_64/bin/pacman-static\n$ chmod +x pacman-static\n$ sudo ./pacman-static -Syu pacman\nThis will update your system and reinstall `pacman`, fixing broken dependencies related to missing shared libraries.\nUsing an external pacman\nIf even\npacman-static\ndoes not work, it is possible to recover using an external\npacman\n. One of the easiest methods to do so is by using the\narchiso\nand simply using\n--sysroot\nor\n--root\nto specify the mount point of the system to perform the operation on. See\nChroot#Using chroot\non how to mount the necessary filesystems required by\n--sysroot\n.\nBy manually extracting\nWarning\nIt is extremely easy to break your system even worse using this approach. Use this only as a last resort if the method from\n#Pacman crashes during an upgrade\nis not an option.\nEven if\npacman\nis terribly broken, you can fix it manually by downloading the latest packages and extracting them to the correct locations. The rough steps to perform are:\nDetermine the\npacman\ndependencies to install\nDownload each package from a\nmirror\nof your choice\nExtract each package to root\nReinstall these packages with\npacman -S --overwrite\nto update the package database accordingly\nDo a full system upgrade\nIf you have a healthy Arch system on hand, you can see the full list of dependencies with:\n$ pacman -Q $(pactree -u pacman)\nBut you may only need to update a few of them depending on your issue. An example of extracting a package is\n# tar -xvpwf\npackage.tar.zst\n-C / --exclude .PKGINFO --exclude .INSTALL --exclude .MTREE --exclude .BUILDINFO\nNote the use of the\nw\nflag for interactive mode. Running non-interactively is very risky since you might end up overwriting an important file. Also take care to extract packages in the correct order (i.e. dependencies first).\nThis forum post\ncontains an example of this process where only a couple\npacman\ndependencies are broken.\n\"Unable to find root device\" error after rebooting\nMost likely the\ninitramfs\nbecame corrupted during a\nkernel\nupdate (improper use of\npacman'\ns\n--overwrite\noption can be a cause). There are two options; first, try the\nFallback\nentry.\nTip\nIn case you removed the\nFallback\nentry, you can always press the\nTab\nkey when the boot loader menu shows up (for Syslinux) or\ne\n(for GRUB or systemd-boot), rename it\ninitramfs-linux-fallback.img\nand press\nEnter\nor\nb\n(depending on your\nboot loader\n) to boot with the new parameters.\nOnce the system starts, run this command (for the stock\nlinux\nkernel) either from the console or from a terminal to rebuild the initramfs image:\n# mkinitcpio -p linux\nIf that does not work, from a current Arch release (CD/DVD or USB stick),\nmount\nyour root and boot partitions to\n/mnt\nand\n/mnt/boot\n, respectively. Then\nchroot\nusing\narch-chroot\n:\n# arch-chroot /mnt\n# pacman -Syu mkinitcpio systemd linux\nNote\nIf you do not have a current release or if you only have some other \"live\" Linux distribution laying around, you can\nchroot\nusing the old fashioned way. Obviously, there will be more typing than simply running the\narch-chroot\nscript.\nIf\npacman\nfails with\nCould not resolve host\n, please\ncheck your internet connection\n.\nIf you cannot enter the arch-chroot or chroot environment but need to re-install packages, you can use the command\npacman --sysroot /mnt -Syu foo bar\nto use\npacman\non your root partition.\nReinstalling the kernel (the\nlinux\npackage) will automatically re-generate the initramfs image with\nmkinitcpio -p linux\n. There is no need to do this separately.\nAfterwards, it is recommended that you run\nexit\n,\numount /mnt/{boot,}\nand\nreboot\n.\n\"Warning: current locale is invalid; using default \"C\" locale\" error\nAs the error message says, your locale is not correctly configured. See\nLocale\n.\nMissing Locales Warning Messages\nWhen locale files are intentionally removed by tools such as\nbleachbit\nor\nlocalepurge\nAUR\n, pacman may issue warnings about missing locales during package updates.\nTo suppress these warnings, you can comment out the\nCheckSpace\noption in\npacman.conf\n. Keep in mind that disabling CheckSpace turns off the space-checking functionality for all package installations, so use this workaround only when you have alternative means to monitor disk space.\nPacman does not honor proxy settings\nMake sure that the relevant environment variables (\n$http_proxy\n,\n$ftp_proxy\netc.) are set up. If you use\npacman\nwith\nsudo\n, you need to configure sudo to\npass these environment variables to pacman\n. Also, ensure the configuration of\ndirmngr\nhas\nhonor-http-proxy\nin\n/etc/pacman.d/gnupg/dirmngr.conf\nto honor the proxy when refreshing the keys.\nHow do I reinstall all packages, retaining information on whether something was explicitly installed or as a dependency?\nTo reinstall all the native packages:\npacman -Qnq | pacman -S -\nor\npacman -S $(pacman -Qnq)\n(the\n-S\noption preserves the installation reason by default).\nYou will then need to reinstall all the foreign packages, which can be listed with\npacman -Qmq\n.\n\"Cannot open shared object file\" error\nIt looks like previous\npacman\ntransaction removed or corrupted shared libraries needed for\npacman\nitself.\nTo recover from this situation, you need to unpack required libraries to your filesystem manually. First find what package contains the missed library and then locate it in the\npacman\ncache (\n/var/cache/pacman/pkg/\n). Unpack required shared library to the filesystem. This will allow to run\npacman\n.\nNow you need to\nreinstall\nthe broken package. Note that you need to use\n--overwrite\nflag as you just unpacked system files and\npacman\ndoes not know about it. Pacman will correctly replace our shared library file with one from package.\nThat is it. Update the rest of the system.\nFreeze of package downloads\nSome issues have been reported regarding network problems that prevent\npacman\nfrom updating/synchronizing repositories.\n[2]\n[3]\nWhen installing Arch Linux natively, these issues have been resolved by replacing the default\npacman\nfile downloader with an alternative (see\nImprove pacman performance\nfor more details). When installing Arch Linux as a guest OS in\nVirtualBox\n, this issue has also been addressed by using\nHost interface\ninstead of\nNAT\nin the machine properties.\nFailed retrieving file 'core.db' from mirror\nIf you receive this error message with correct\nmirrors\n, try setting a different\nname server\n.\nerror: 'local-package.pkg.tar': permission denied\nIf you want to install a package on an sshfs mount using\npacman -U\nand receive this error, move the package to a local directory and try to install again.\nerror: could not determine cachedir mount point /var/cache/pacman/pkg\nUpon executing, e.g.,\npacman -Syu\ninside a chroot environment an error is encountered:\nerror: could not determine cachedir mount point /var/cache/pacman/pkg\nerror: failed to commit transaction (not enough free disk space)\nThis is frequently caused by the chroot directory not being a mountpoint when the chroot is entered. See the note at\nInstall Arch Linux from existing Linux#Downloading basic tools\nfor a solution, and\narch-chroot(8)\nfor an explanation and an example of using bind mounting to make the chroot directory a mountpoint.\nerror: GPGME error: No data\nIf you are unable to update packages and receive this error, then try\nrm -r /var/lib/pacman/sync/\nbefore attempting to update.\nIf removing sync files does not help, check that the sync files are\ngzip compressed data\nusing\nfile /var/lib/pacman/sync/*\nbefore attempting to update. A router or proxy might corrupt the downloads. Corruption could possibly be HTML type.\nIf sync files are of the correct type, there might be an issue with the mirror server. Look up the mirror server(s) in use with\npacman-conf -r core\nand\npacman-conf -r extra\n. Paste the first returned url in a browser and check that a file listing is returned. In case the mirror returns an error, comment it in\n/etc/pacman.d/mirrorlist\n. You may try updating or re-ranking\nmirrors\n.\nerror: GPGME error: General error and \":: File /var/cache/pacman/pkg/<package>.pkg.tar.zst is corrupted (invalid or corrupted package (PGP signature)).\nIf this error occurs and you are, for instance, unable to update your system or any package at all, it is possible that you have\nDISPLAY\nset to a blank value, which seems to break the GPG-Flow.\nIn this case,\nunset DISPLAY\nor setting it to a arbitrary value will most likely allow to update again, in case any other option above did not do the trick yet.\nSee\nthis\npost for further details.\nReinstall broken or out-of-sync packages\nOne may use the\npacman -Qk $pkg\nto check if the installed files of the\n$pkg\npackage match the files from its database version. For several packages, one may use the following loop to\nreinstall all packages which have missing file(s):\n# LC_ALL=C.UTF-8 pacman -Qk 2>/dev/null | grep -v ' 0 missing files' | cut -d: -f1 |\nwhile read -r package; do\npacman -S \"$package\" --noconfirm\ndone\nSuppose that your local database located in\n/var/lib/pacman\nis more up-to-date compared to installed packages in the\n/\nfilesystem (\ne.g.\n, because of a partial rollback), then this method is the appropriate one to re-synchronize the root filesystem with the local database.\nSee also\nlibalpm(3)\npacman(8)\npacman.conf(5)\nrepo-add(8)\nRetrieved from \"\nhttps://wiki.archlinux.org/index.php?title=Pacman&oldid=852140\n\"\nCategories\n:\nArch projects\nPackage manager\nHidden categories:\nPages or sections flagged with Template:Out of date\nPages or sections flagged with Template:Expansion\nSearch\nSearch\npacman\nAdd topic", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://wiki.archlinux.org/title/Pacman"}}
{"text": "apt(8) — apt — Debian unstable — Debian Manpages\nMANPAGES\nSkip Quicknav\nIndex\nAbout Manpages\nFAQ\nService Information\n/\nunstable\n/\napt\n/ apt(8)\nlinks\nlanguage-indep link\npackage tracker\nraw man page\ntable of contents\nNAME\nSYNOPSIS\nDESCRIPTION\nSCRIPT USAGE AND DIFFERENCES FROM OTHER APT TOOLS\nOPTIONS\nSEE ALSO\nDIAGNOSTICS\nBUGS\nAUTHOR\nNOTES\nother versions\ntrixie\n3.0.3\ntesting\n3.1.11\nunstable\n3.1.12\nother languages\nDeutsch\nEnglish\nfrançais\nNederlands\nportuguês (pt)\nScroll to navigation\nAPT(8)\nAPT\nAPT(8)\nNAME\n¶\napt - command-line interface\nSYNOPSIS\n¶\napt\n[\n-h\n] [\n-o=\nconfig_string\n]\n[\n-c=\nconfig_file\n]\n[\n-t=\ntarget_release\n]\n[\n-a=\narchitecture\n] {list | search | show | update |\ninstall\npkg\n[{=\npkg_version_number\n| /\ntarget_release\n}]...\n| remove\npkg\n... | upgrade | full-upgrade | edit-sources |\n{-v | --version} | {-h | --help}}\nDESCRIPTION\n¶\napt\nprovides a high-level commandline interface for the\npackage management system. It is intended as an end user interface and\nenables some options better suited for interactive usage by default compared\nto more specialized APT tools like\napt-get(8)\nand\napt-cache(8)\n.\nMuch like\napt\nitself, its manpage is intended as an end\nuser interface and as such only mentions the most used commands and options\npartly to not duplicate information in multiple places and partly to avoid\noverwhelming readers with a cornucopia of options and details.\nupdate\n(\napt-get(8)\n)\nupdate\nis used to download package information\nfrom all configured sources. Other commands operate on this data to e.g.\nperform package upgrades or search in and display details about all packages\navailable for installation.\nupgrade\n(\napt-get(8)\n)\nupgrade\nis used to install available upgrades of\nall packages currently installed on the system from the sources configured via\nsources.list(5)\n. New packages will be installed if required to satisfy\ndependencies, but existing packages will never be removed. If an upgrade for a\npackage requires the removal of an installed package the upgrade for this\npackage isn't performed.\nWhen a package is supplied as an argument, the package will be\ninstalled prior to the upgrade action.\nfull-upgrade\n(\napt-get(8)\n)\nfull-upgrade performs the function of upgrade but will\nremove currently installed packages if this is needed to upgrade the system as\na whole.\nWhen a package is supplied as an argument, the package will be\ninstalled prior to the upgrade action.\ninstall\n,\nreinstall\n,\nremove\n,\npurge\n(\napt-get(8)\n)\nPerforms the requested action on one or more packages\nspecified via\nregex(7)\n,\nglob(7)\nor exact match. The requested\naction can be overridden for specific packages by appending a plus (+) to the\npackage name to install this package or a minus (-) to remove it.\nA specific version of a package can be selected for installation\nby following the package name with an equals (=) and the version of the\npackage to select. Alternatively the version from a specific release can be\nselected by following the package name with a forward slash (/) and codename\n(trixie, forky, sid ...) or suite name (stable, testing, unstable). This\nwill also select versions from this release for dependencies of this package\nif needed to satisfy the request.\nRemoving a package removes all packaged data, but leaves usually\nsmall (modified) user configuration files behind, in case the remove was an\naccident. Just issuing an installation request for the accidentally removed\npackage will restore its function as before in that case. On the other hand\nyou can get rid of these leftovers by calling\npurge\neven on already\nremoved packages. Note that this does not affect any data or configuration\nstored in your home directory.\nautoremove\n(\napt-get(8)\n)\nautoremove is used to remove packages that were\nautomatically installed to satisfy dependencies for other packages and are now\nno longer needed as dependencies changed or the package(s) needing them were\nremoved in the meantime.\nYou should check that the list does not include applications you\nhave grown to like even though they were once installed just as a dependency\nof another package. You can mark such a package as manually installed by\nusing\napt-mark(8)\n. Packages which you have installed explicitly via\ninstall\nare also never proposed for automatic removal.\nsatisfy\n(\napt-get(8)\n)\nsatisfy\nsatisfies dependency strings, as used in\nBuild-Depends. It also handles conflicts, by prefixing an argument with\n\"Conflicts: \".\nExample: apt satisfy \"foo, bar (>= 1.0)\"\n\"Conflicts: baz, fuzz\"\nwhy, why-not\nThese commands print the reasoning path from the solver.\nThey are similar to the equivalent aptitude commands for many use cases, but\nare different in that they print the actual reason the solver picked rather\nthan the potential strongest path.\nThe\nwhy\ncommand determines why an installed package is\ninstalled. This provides reasonable feedback as to why an automatically\ninstalled package is installed; for a manually installed package no other\nreason is given. If the package is not installed, no reason can be\ndetermined.\nThe\nwhy-not\ncommand determines why a package was determined\nto not be installable. This may not always yield a result, even if a package\nis uninstallable.\nBoth commands take a single argument, the name of a package.\nsearch\n(\napt-cache(8)\n)\nsearch\ncan be used to search for the given\nregex(7)\nterm(s) in the list of available packages and display matches.\nThis can e.g. be useful if you are looking for packages having a specific\nfeature. If you are looking for a package including a specific file try\napt-file(1)\n.\nshow\n(\napt-cache(8)\n)\nShow information about the given package(s) including its\ndependencies, installation and download size, sources the package is available\nfrom, the description of the packages content and much more. It can e.g. be\nhelpful to look at this information before allowing\napt(8)\nto remove a\npackage or while searching for new packages to install.\nlist\nlist\nis somewhat similar to\ndpkg-query\n--list\nin that it can display a list of packages satisfying certain\ncriteria. It supports\nglob(7)\npatterns for matching package names,\napt-patterns(7)\n, as well as options to list installed\n(\n--installed\n), upgradeable (\n--upgradeable\n) or all available\n(\n--all-versions\n) versions.\nedit-sources\n(work-in-progress)\nedit-sources lets you edit your\nsources.list(5)\nfiles in your preferred text editor while also providing basic sanity\nchecks.\nshowsrc, depends, rdepends, policy\n(summarised in\napt-cache(8)\n)\nsource, build-dep, download, changelog, clean, distclean,\nautoclean\n(summarised in\napt-get(8)\n)\nSCRIPT USAGE AND DIFFERENCES FROM OTHER APT TOOLS\n¶\nThe\napt(8)\ncommandline is designed as an end-user tool and\nit may change behavior between versions. While it tries not to break\nbackward compatibility this is not guaranteed either if a change seems\nbeneficial for interactive use.\nAll features of\napt(8)\nare available in dedicated APT tools\nlike\napt-get(8)\nand\napt-cache(8)\nas well.\napt(8)\njust\nchanges the default value of some options (see\napt.conf(5)\nand\nspecifically the Binary scope). So you should prefer using these commands\n(potentially with some additional options enabled) in your scripts as they\nkeep backward compatibility as much as possible.\nOPTIONS\n¶\nAll command line options may be set using the configuration file,\nthe descriptions indicate the configuration option to set. For boolean\noptions you can override the config file by using something like\n-f-\n,\n--no-f\n,\n-f=no\nor several other variations.\n-h\n,\n--help\nShow a short usage summary.\n-v\n,\n--version\nShow the program version.\n--audit\nShow audit (and notice) messages. This overrides the\nquiet option, but only for notice messages, not progress ones.\n-c\n,\n--config-file\nConfiguration File; Specify a configuration file to use.\nThe program will read the default configuration file and then this\nconfiguration file. If configuration settings need to be set before the\ndefault configuration files are parsed specify a file with the\nAPT_CONFIG\nenvironment variable. See\napt.conf(5)\nfor syntax\ninformation.\n-o\n,\n--option\nSet a Configuration Option; This will set an arbitrary\nconfiguration option. The syntax is\n-o Foo::Bar=bar\n.\n-o\nand\n--option\ncan be used multiple times to set different options.\n--cli-version\nRequests a specific CLI version. This is a pattern that\ntakes a MAJOR.MINOR version. You may omit the MINOR version, in which case the\nlatest supported minor level will be used.\nVersion tracks are presented as follows: The version 3.2 has\nequivalent versions 0.32, 1.22, and 2.12, implementing new features for\ntheir specified major versions.\nA special case is the X.9 version pattern: A version like 2.9 is\nfollowed by 3.0, but 2.10 follows directly on 2.8; given that we use odd\nversion numbers as development series (2.9 is the 3.0 development\nseries).\nThis feature has been introduced in APT 3.1.10, and replaces the\nbinary-specific configuration. You may use the\nAPT::Version\nto\nsimilar effect on older binaries, for example, use\n-o APT::Version=2\nto make\napt(8)\nbehave like the 2.x series.\nThe default value is the current APT version for\napt(8)\nand\n0.(10 * major + minor) for the classic commands. The 0.X series is\nsoft-deprecated and the other commands will roll over to the 2.x series in\nthe future.\n--no-color\n,\n--color\nTurn colors on or off. Colors are on by default on\nsupported terminals for\napt(8)\nand can also be disabled using the\nNO_COLOR\nor\nAPT_NO_COLOR\nenvironment variables, or further\nconfigured by the\nAPT::Color\nconfiguration option and scope, see\napt.conf(5)\nfor information on that.\nSEE ALSO\n¶\napt-get(8)\n,\napt-cache(8)\n,\nsources.list(5)\n,\napt.conf(5)\n,\napt-config(8)\n,\napt-patterns(7)\n, The APT\nUser's guide in /usr/share/doc/apt-doc/,\napt_preferences(5)\n, the APT\nHowto.\nDIAGNOSTICS\n¶\napt\nreturns zero on normal operation, decimal 100 on\nerror.\nBUGS\n¶\nAPT bug page\n[1]. If you wish to report a bug in APT, please\nsee /usr/share/doc/debian/bug-reporting.txt or the\nreportbug(1)\ncommand.\nAUTHOR\n¶\nAPT team\nNOTES\n¶\n1.\nAPT bug page\nhttps://bugs.debian.org/src:apt\n07 November 2025\nAPT 3.1.12\nSource file:\napt.8.en.gz (from\napt 3.1.12\n)\nSource last updated:\n2025-11-10T10:35:04Z\nConverted to HTML:\n2025-11-10T15:04:07Z\ndebiman 15b1084, see\ngithub.com/Debian/debiman\n.\nFound a problem? See the\nFAQ\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://manpages.debian.org/unstable/apt/apt.8.en.html"}}
{"text": "Ubuntu Manpage:\nnetplan - YAML network configuration abstraction for various backends\nMenu\nClose menu\nProvided by:\nnetplan.io_0.106.1-7ubuntu0.22.04.4_amd64\nNAME\nnetplan - YAML network configuration abstraction for various backends\nSYNOPSIS\nnetplan\n[\nCOMMAND\n| help ]\nCOMMANDS\nSee\nnetplan\nhelp\nfor a list of available commands on this system.\nDESCRIPTION\nIntroduction\nDistribution  installers,  cloud  instantiation, image builds for particular devices, or any other way to\ndeploy an operating system put its desired network configuration into YAML configuration file(s).  During\nearly boot, the netplan \"network renderer\" runs which reads /{lib,etc,run}/netplan/*.yaml and writes conâ\nfiguration to\n/run\nto hand off control of devices to the specified networking daemon.\nâ¢ Configured devices get handled by systemd-networkd by default, unless explicitly marked as managed by a\nspecific renderer (NetworkManager)\nâ¢ Devices not covered by the network config do not get touched at all.\nâ¢ Usable in initramfs (few dependencies and fast)\nâ¢ No persistent generated config, only original YAML config\nâ¢ Parser supports multiple config files to allow applications like libvirt or lxd to package up  expected\nnetwork  config  (virbr0,  lxdbr0),  or  to  change the global default policy to use NetworkManager for\neverything.\nâ¢ Retains the flexibility to change backends/policy later or adjust to removing NetworkManager, as generâ\nated configuration is ephemeral.\nGeneral\nstructure\nnetplan's  configuration  files  use  the  YAML  (\nhttp://yaml.org/spec/1.1/current.html\n)   format.    All\n/{lib,etc,run}/netplan/*.yaml  are considered.  Lexicographically later files (regardless of in which diâ\nrectory they are) amend (new mapping keys) or override (same mapping keys)  previous  ones.   A  file  in\n/run/netplan  completely shadows a file with same name in\n/etc/netplan\n, and a file in either of those diâ\nrectories shadows a file with the same name in /lib/netplan.\nThe top-level node in a netplan configuration file is a network: mapping that contains  version:  2  (the\nYAML  currently  being  used by curtin, MaaS, etc.  is version 1), and then device definitions grouped by\ntheir type, such as ethernets:, modems:, wifis:, or bridges:.  These are the types that our renderer  can\nunderstand and are supported by our backends.\nEach  type block contains device definitions as a map where the keys (called \"configuration IDs\") are deâ\nfined as below.\nDevice\nconfiguration\nIDs\nThe key names below the per-device-type definition maps (like ethernets:) are called \"ID\"s.  They must be\nunique throughout the entire set of configuration files.  Their primary purpose is  to  serve  as  anchor\nnames for composite devices, for example to enumerate the members of a bridge that is currently being deâ\nfined.\n(Since  0.97) If an interface is defined with an ID in a configuration file; it will be brought up by the\napplicable renderer.  To not have netplan touch an interface at all, it should be completely omitted from\nthe netplan configuration files.\nThere are two physically/structurally different classes of device definitions, and the  ID  field  has  a\ndifferent interpretation for each:\nPhysical devices\n(Examples:  ethernet, modem, wifi) These can dynamically come and go between reboots and even durâ\ning runtime (hot plugging).  In the generic case, they can be selected by match: rules on  desired\nproperties,  such  as  name/name  pattern, MAC address, driver, or device paths.  In general these\nwill match any number of devices (unless they refer to properties which are  unique  such  as  the\nfull  path  or  MAC address), so without further knowledge about the hardware these will always be\nconsidered as a group.\nIt is valid to specify no match rules at all, in which case the ID field is simply  the  interface\nname  to  be matched.  This is mostly useful if you want to keep simple cases simple, and it's how\nnetwork device configuration has been done for a long time.\nIf there are match: rules, then the ID field is a purely opaque name which is only being used  for\nreferences from definitions of compound devices in the config.\nVirtual devices\n(Examples:  veth,  bridge,  bond, vrf) These are fully under the control of the config file(s) and\nthe network stack.  I.  e.  these devices are being created instead of matched.  Thus  match:  and\nset-name:  are  not  applicable for these, and the ID field is the name of the created virtual deâ\nvice.\nTop-level\nconfiguration\nstructure\nThe general structure of a Netplan YAML file is shown below.\nnetwork:\nversion: NUMBER\nrenderer: STRING\nbonds: MAPPING\nbridges: MAPPING\nethernets: MAPPING\nmodems: MAPPING\ntunnels: MAPPING\nvlans: MAPPING\nvrfs: MAPPING\nwifis: MAPPING\nnm-devices: MAPPING\nâ¢\nversion\n(number)\nDefines what version of the configuration format is used.  The only value supported is  2.   Deâ\nfaults to 2 if not defined.\nâ¢\nrenderer\n(scalar)\nDefines what network configuration tool will be used to set up your configuration.  Valid values\nare networkd and NetworkManager.  Defaults to networkd if not defined.\nâ¢\nbonds\n(mapping)\nCreates and configures link aggregation (bonding) devices.\nâ¢\nbridges\n(mapping)\nCreates and configures bridge devices.\nâ¢\nethernets\n(mapping)\nConfigures physical Ethernet interfaces.\nâ¢\nmodems\n(mapping)\nConfigures modems\nâ¢\ntunnels\n(mapping)\nCreates and configures different types of virtual tunnels.\nâ¢\nvlans\n(mapping)\nCreates and configures VLANs.\nâ¢\nvrfs\n(mapping)\nConfigures Virtual Routing and Forwarding (VRF) devices.\nâ¢\nwifis\n(mapping)\nConfigures physical Wifi interfaces as client, adhoc or access point.\nâ¢\nnm-devices\n(mapping)\nnm-devices  are  used  in situations where Netplan doesn't support the connection type.  The raw\nconfiguration expected by NetworkManager can be defined and will be passed as  is  (passthrough)\nto the .nmconnection file.  Users will not normally use this type of device.\nAll the properties for all the device types will be described in the next sections.\nProperties\nfor\nphysical\ndevice\ntypes\nThese properties are used with physical devices such as Ethernet and Wifi network interfaces.\nNote:\nSome options will not work reliably for devices matched by name only and rendered by networkd, due\nto interactions with device renaming in udev.  Match devices by MAC when setting options like:  wakeonlan\nor *-offload.\nâ¢\nmatch\n(mapping)\nThis selects a subset of available physical devices by various hardware properties.  The followâ\ning  configuration  will then apply to all matching devices, as soon as they appear.\nAll\nspeciâ\nfied properties must match.\nâ¢\nname\n(scalar)\nCurrent interface name.  Globs are supported, and the primary use case for matching on  names,\nas  selecting one fixed name can be more easily achieved with having no match: at all and just\nusing the ID (see above).  (NetworkManager: as of v1.14.0)\nâ¢\nmacaddress\n(scalar)\nDevice's 6-byte permanent MAC address in the form \"XX:XX:XX:XX:XX:XX\" or 20 bytes for  Infiniâ\nBand  devices  (IPoIB).   Globs are not allowed.  This doesn't match virtual MAC addresses for\nveth, bridge, bond, vlan, ...\nâ¢\ndriver\n(scalar or sequence of scalars) â sequence since\n0.104\nKernel driver name, corresponding to the DRIVER udev property.  A sequence of  globs  is  supâ\nported, any of which must match.  Matching on driver is\nonly\nsupported with networkd.\nExamples:\nâ¢ All cards on second PCI bus:\nnetwork:\nethernets:\nmyinterface:\nmatch:\nname: enp2*\nâ¢ Fixed MAC address:\nnetwork:\nethernets:\ninterface0:\nmatch:\nmacaddress: 11:22:33:AA:BB:FF\nâ¢ First card of driver ixgbe:\nnetwork:\nethernets:\nnic0:\nmatch:\ndriver: ixgbe\nname: en*s0\nâ¢ First card with a driver matching bcmgenet or smsc*:\nnetwork:\nethernets:\nnic0:\nmatch:\ndriver: [\"bcmgenet\", \"smsc*\"]\nname: en*\nâ¢\nset-name\n(scalar)\nWhen  matching  on unique properties such as path or MAC, or with additional assumptions such as\n\"there will only ever be one wifi device\", match rules can be written so that  they  only  match\none  device.  Then this property can be used to give that device a more specific/desirable/nicer\nname than the default from udev's ifnames.  Any additional device that satisfies the match rules\nwill then fail to get renamed and keep the original kernel name (and dmesg will show an error).\nâ¢\nwakeonlan\n(bool)\nEnable wake on LAN.  Off by default.\nâ¢\nemit-lldp\n(bool) â since\n0.99\n(networkd backend only) Whether to emit LLDP packets.  Off by default.\nâ¢\nreceive-checksum-offload\n(bool) â since\n0.104\n(networkd backend only) If set to true (false), the hardware offload for checksumming of ingress\nnetwork packets is enabled (disabled).  When unset, the kernel's default will be used.\nâ¢\ntransmit-checksum-offload\n(bool) â since\n0.104\n(networkd backend only) If set to true (false), the hardware offload for checksumming of  egress\nnetwork packets is enabled (disabled).  When unset, the kernel's default will be used.\nâ¢\ntcp-segmentation-offload\n(bool) â since\n0.104\n(networkd  backend  only)  If set to true (false), the TCP Segmentation Offload (TSO) is enabled\n(disabled).  When unset, the kernel's default will be used.\nâ¢\ntcp6-segmentation-offload\n(bool) â since\n0.104\n(networkd backend only) If set to true (false), the TCP6 Segmentation Offload (tx-tcp6-segmentaâ\ntion) is enabled (disabled).  When unset, the kernel's default will be used.\nâ¢\ngeneric-segmentation-offload\n(bool) â since\n0.104\n(networkd backend only) If set to true (false), the Generic Segmentation Offload  (GSO)  is  enâ\nabled (disabled).  When unset, the kernel's default will be used.\nâ¢\ngeneric-receive-offload\n(bool) â since\n0.104\n(networkd  backend  only)  If  set to true (false), the Generic Receive Offload (GRO) is enabled\n(disabled).  When unset, the kernel's default will be used.\nâ¢\nlarge-receive-offload\n(bool) â since\n0.104\n(networkd backend only) If set to true (false), the Large Receive Offload (LRO) is enabled (disâ\nabled).  When unset, the kernel's default will be used.\nâ¢\nopenvswitch\n(mapping) â since\n0.100\nThis provides additional configuration for the openvswitch network device.  If Open  vSwitch  is\nnot  available on the system, netplan treats the presence of openvswitch configuration as an erâ\nror.\nAny supported network device that is declared with the openvswitch mapping (or  any  bond/bridge\nthat includes an interface with an openvswitch configuration) will be created in openvswitch inâ\nstead  of the defined renderer.  In the case of a vlan definition declared the same way, netplan\nwill create a fake VLAN bridge in openvswitch with the requested vlan properties.\nâ¢\nexternal-ids\n(mapping) â since\n0.100\nPassed-through directly to Open vSwitch\nâ¢\nother-config\n(mapping) â since\n0.100\nPassed-through directly to Open vSwitch\nâ¢\nlacp\n(scalar) â since\n0.100\nValid for bond interfaces.  Accepts active, passive or off (the default).\nâ¢\nfail-mode\n(scalar) â since\n0.100\nValid for bridge interfaces.  Accepts secure or standalone (the default).\nâ¢\nmcast-snooping\n(bool) â since\n0.100\nValid for bridge interfaces.  False by default.\nâ¢\nprotocols\n(sequence of scalars) â since\n0.100\nValid for bridge interfaces or the network section.  List of protocols to be used when negotiâ\nating a connection with the controller.  Accepts  OpenFlow10,  OpenFlow11,  OpenFlow12,  Openâ\nFlow13, OpenFlow14, and OpenFlow15.\nâ¢\nrstp\n(bool) â since\n0.100\nValid for bridge interfaces.  False by default.\nâ¢\ncontroller\n(mapping) â since\n0.100\nValid for bridge interfaces.  Specify an external OpenFlow controller.\nâ¢\naddresses\n(sequence of scalars)\nSet  the list of addresses to use for the controller targets.  The syntax of these addresses\nis   as    defined    in\novs-vsctl\n(8).     Example:    addresses:    [tcp:127.0.0.1:6653,\n\"ssl:[fe80::1234%eth0]:6653\"]\nâ¢\nconnection-mode\n(scalar)\nSet  the connection mode for the controller.  Supported options are in-band and out-of-band.\nThe default is in-band.\nâ¢\nports\n(sequence of sequence of scalars) â since\n0.100\nOpen vSwitch patch ports.  Each port is declared as a pair of names which can be referenced as\ninterfaces in dependent virtual devices (bonds, bridges).\nExample:\nopenvswitch:\nports:\n- [patch0-1, patch1-0]\nâ¢\nssl\n(mapping) â since\n0.100\nValid for global openvswitch settings.  Options for configuring SSL server  endpoint  for  the\nswitch.\nâ¢\nca-cert\n(scalar)\nPath to a file containing the CA certificate to be used.\nâ¢\ncertificate\n(scalar)\nPath to a file containing the server certificate.\nâ¢\nprivate-key\n(scalar)\nPath to a file containing the private key for the server.\nProperties\nfor\nall\ndevice\ntypes\nâ¢\nrenderer\n(scalar)\nUse the given networking backend for this definition.  Currently supported are networkd and Netâ\nworkManager.   This property can be specified globally in network:, for a device type (in e.  g.\nethernets:) or for a particular device definition.  Default is networkd.\n(Since 0.99) The renderer property has one additional acceptable value for vlan objects (i.   e.\ndefined  in  vlans:): sriov.  If a vlan is defined with the sriov renderer for an SR-IOV Virtual\nFunction interface, this causes netplan to set up a hardware VLAN filter for it.  There  can  be\nonly one defined per VF.\nâ¢\ndhcp4\n(bool)\nEnable DHCP for IPv4.  Off by default.\nâ¢\ndhcp6\n(bool)\nEnable  DHCP for IPv6.  Off by default.  This covers both stateless DHCP - where the DHCP server\nsupplies information like DNS nameservers but not the IP address - and stateful DHCP, where  the\nserver provides both the address and the other information.\nIf  you are in an IPv6-only environment with completely stateless auto-configuration (SLAAC with\nRDNSS), this option can be set to cause the interface to  be  brought  up.   (Setting  accept-ra\nalone  is not sufficient.) Auto-configuration will still honor the contents of the router adverâ\ntisement and only use DHCP if requested in the RA.\nNote that\nrdnssd\n(8) is required to use RDNSS with networkd.  No extra software is  required  for\nNetworkManager.\nâ¢\nipv6-mtu\n(scalar) â since\n0.98\n> Set the IPv6 MTU (only supported with networkd backend).  Note > that\nneeding to set this is an unusual requirement.  > >\nRequires\nfeature:\nipv6-mtu\nâ¢\nipv6-privacy\n(bool)\nEnable IPv6 Privacy Extensions (RFC 4941) for the specified interface, and prefer temporary  adâ\ndresses.   Defaults  to false - no privacy extensions.  There is currently no way to have a priâ\nvate address but prefer the public address.\nâ¢\nlink-local\n(sequence of scalars)\nConfigure the link-local addresses to bring up.  Valid options are 'ipv4' and 'ipv6', which  reâ\nspectively  allow  enabling  IPv4 and IPv6 link local addressing.  If this field is not defined,\nthe default is to enable only IPv6 link-local addresses.  If the field is defined but configured\nas an empty set, IPv6 link-local addresses are disabled as well as IPv4 link- local addresses.\nThis feature enables or disables link-local addresses for a protocol, but the actual implementaâ\ntion differs per backend.  On networkd, this directly changes the behavior and may add an  extra\naddress  on an interface.  When using the NetworkManager backend, enabling link-local has no efâ\nfect if the interface also has DHCP enabled.\nExamples:\nâ¢ Enable only IPv4 link-local: link-local: [ ipv4 ]\nâ¢ Enable all link-local addresses: link-local: [ ipv4, ipv6 ]\nâ¢ Disable all link-local addresses: link-local: [ ]\nâ¢\nignore-carrier\n(bool) â since\n0.104\n(networkd backend only) Allow the specified interface to be configured even if it has no  carriâ\ner.\nâ¢\ncritical\n(bool)\nDesignate the connection as \"critical to the system\", meaning that special care will be taken by\nto not release the assigned IP when the daemon is restarted.  (not recognized by NetworkManager)\nâ¢\ndhcp-identifier\n(scalar)\n(networkd  backend  only) Sets the source of DHCPv4 client identifier.  If mac is specified, the\nMAC address of the link is used.  If this option is omitted, or if duid is  specified,  networkd\nwill  generate  an RFC4361-compliant client identifier for the interface by combining the link's\nIAID and DUID.\nâ¢\ndhcp4-overrides\n(mapping)\n(networkd backend only) Overrides default DHCP behavior; see the DHCP Overrides section below.\nâ¢\ndhcp6-overrides\n(mapping)\n(networkd backend only) Overrides default DHCP behavior; see the DHCP Overrides section below.\nâ¢\naccept-ra\n(bool)\nAccept Router Advertisement that would have the kernel configure IPv6 by itself.  When  enabled,\naccept Router Advertisements.  When disabled, do not respond to Router Advertisements.  If unset\nuse the host kernel default setting.\nâ¢\naddresses\n(sequence of scalars and mappings)\nAdd static addresses to the interface in addition to the ones received through DHCP or RA.  Each\nsequence entry is in CIDR notation, i.  e.  of the form addr/prefixlen.  addr is an IPv4 or IPv6\naddress as recognized by\ninet_pton\n(3) and prefixlen the number of bits of the subnet.\nFor  virtual  devices  (bridges, bonds, vlan) if there is no address configured and DHCP is disâ\nabled, the interface may still be brought online, but will not be addressable from the network.\nIn addition to the addresses themselves one can specify configuration  parameters  as  mappings.\nCurrent supported options are:\nâ¢\nlifetime\n(scalar) â since\n0.100\nDefault: forever.  This can be forever or 0 and corresponds to the PreferredLifetime option in\nsystemd-networkd's Address section.  Currently supported on the networkd backend only.\nâ¢\nlabel\n(scalar) â since\n0.100\nAn  IP  address label, equivalent to the ip address label command.  Currently supported on the\nnetworkd backend only.\nExamples:\nâ¢ Simple: addresses: [192.168.14.2/24, \"2001:1::1/64\"]\nâ¢ Advanced:\nnetwork:\nethernets:\neth0:\naddresses:\n- \"10.0.0.15/24\":\nlifetime: 0\nlabel: \"maas\"\n- \"2001:1::1/64\"\nâ¢\nipv6-address-generation\n(scalar) â since\n0.99\nConfigure method for creating the address for use with RFC4862 IPv6 Stateless Address  Auto-conâ\nfiguration  (only  supported with NetworkManager backend).  Possible values are eui64 or stable-\nprivacy.\nâ¢\nipv6-address-token\n(scalar) â since\n0.100\nDefine an IPv6 address token for creating a static interface identifier for IPv6  Stateless  Adâ\ndress Auto-configuration.  This is mutually exclusive with ipv6-address-generation.\nâ¢\ngateway4\n,\ngateway6\n(scalar)\nDeprecated,  see  Default routes.  Set default gateway for IPv4/6, for manual address configuraâ\ntion.  This requires setting addresses too.  Gateway IPs must be in a  form  recognized  by\ninâ\net_pton\n(3).  There should only be a single gateway per IP address family set in your global conâ\nfig,  to make it unambiguous.  If you need multiple default routes, please define them via routâ\ning-policy.\nExamples\nâ¢ IPv4: gateway4: 172.16.0.1\nâ¢ IPv6: gateway6: \"2001:4::1\"\nâ¢\nnameservers\n(mapping)\nSet DNS servers and search domains, for manual address configuration.  There are  two  supported\nfields:  addresses:  is  a  list of IPv4 or IPv6 addresses similar to gateway*, and search: is a\nlist of search domains.\nExample:\nnetwork:\nethernets:\nid0:\n[...]\nnameservers:\nsearch: [lab, home]\naddresses: [8.8.8.8, \"FEDC::1\"]\nâ¢\nmacaddress\n(scalar)\nSet the device's MAC address.  The MAC address must be in the form \"XX:XX:XX:XX:XX:XX\".\nNote:\nThis will not work reliably for devices matched by name only and rendered by networkd, due\nto interactions with device renaming in udev.  Match devices by MAC when setting MAC addresses.\nExample:\nnetwork:\nethernets:\nid0:\nmatch:\nmacaddress: 52:54:00:6b:3c:58\n[...]\nmacaddress: 52:54:00:6b:3c:59\nâ¢\nmtu\n(scalar)\nSet the Maximum Transmission Unit for the interface.  The default is 1500.  Valid values  depend\non your network interface.\nNote:\nThis will not work reliably for devices matched by name only and rendered by networkd, due\nto interactions with device renaming in udev.  Match devices by MAC when setting MTU.\nâ¢\noptional\n(bool)\nAn  optional device is not required for booting.  Normally, networkd will wait some time for deâ\nvice to become configured before proceeding with booting.  However, if a device is marked as opâ\ntional, networkd will not wait for it.  This is\nonly\nsupported by networkd, and the  default  is\nfalse.\nExample:\nnetwork:\nethernets:\neth7:\n# this is plugged into a test network that is often\n# down - don't wait for it to come up during boot.\ndhcp4: true\noptional: true\nâ¢\noptional-addresses\n(sequence of scalars)\nSpecify  types  of  addresses  that are not required for a device to be considered online.  This\nchanges the behavior of backends at boot time to avoid waiting for addresses that are marked opâ\ntional, and thus consider the interface as \"usable\" sooner.  This does  not  disable  these  adâ\ndresses, which will be brought up anyway.\nExample:\nnetwork:\nethernets:\neth7:\ndhcp4: true\ndhcp6: true\noptional-addresses: [ ipv4-ll, dhcp6 ]\nâ¢\nactivation-mode\n(scalar) â since\n0.103\nAllows  specifying  the management policy of the selected interface.  By default, netplan brings\nup any configured interface if possible.  Using the activation-mode setting users  can  override\nthat  behavior by either specifying manual, to hand over control over the interface state to the\nadministrator or (for networkd backend\nonly\n) off to force the link in a down state at all times.\nAny interface with activation-mode defined is implicitly considered optional.   Supported  offiâ\ncially as of networkd v248+.\nExample:\nnetwork:\nethernets:\neth1:\n# this interface will not be put into an UP state automatically\ndhcp4: true\nactivation-mode: manual\nâ¢\nroutes\n(sequence of mappings)\nConfigure static routing for the device; see the Routing section below.\nâ¢\nrouting-policy\n(sequence of mappings)\nConfigure policy routing for the device; see the Routing section below.\nâ¢\nneigh-suppress\n(scalar) â since\n0.105\nTakes  a  boolean.  Configures whether ARP and ND neighbor suppression is enabled for this port.\nWhen unset, the kernel's default will be used.\nDHCP\nOverrides\nSeveral DHCP behavior overrides are available.  Most currently only have any effect when using  the  netâ\nworkd backend, with the exception of use-routes and route-metric.\nOverrides only have an effect if the corresponding dhcp4 or dhcp6 is set to true.\nIf  both dhcp4 and dhcp6 are true, the networkd backend requires that dhcp4-overrides and dhcp6-overrides\ncontain the same keys and values.  If the values do not match, an error will be  shown  and  the  network\nconfiguration will not be applied.\nWhen  using  the  NetworkManager  backend,  different  values  may  be  specified for dhcp4-overrides and\ndhcp6-overrides, and will be applied to the DHCP client processes as specified in the netplan YAML.\nâ¢\ndhcp4-overrides\n,\ndhcp6-overrides\n(mapping)\nThe dhcp4-overrides and `dhcp6-override`` mappings override the default DHCP behavior.\nâ¢\nuse-dns\n(bool)\nDefault: true.  When true, the DNS servers received from the DHCP server will be used and take\nprecedence over any statically configured ones.  Currently only has an effect on the  networkd\nbackend.\nâ¢\nuse-ntp\n(bool)\nDefault:  true.  When true, the NTP servers received from the DHCP server will be used by sysâ\ntemd-timesyncd and take precedence over any statically configured ones.  Currently only has an\neffect on the networkd backend.\nâ¢\nsend-hostname\n(bool)\nDefault: true.  When true, the machine's hostname will be sent to the DHCP server.   Currently\nonly has an effect on the networkd backend.\nâ¢\nuse-hostname\n(bool)\nDefault: true.  When true, the hostname received from the DHCP server will be set as the tranâ\nsient hostname of the system.  Currently only has an effect on the networkd backend.\nâ¢\nuse-mtu\n(bool)\nDefault: true.  When true, the MTU received from the DHCP server will be set as the MTU of the\nnetwork  interface.   When false, the MTU advertised by the DHCP server will be ignored.  Curâ\nrently only has an effect on the networkd backend.\nâ¢\nhostname\n(scalar)\nUse this value for the hostname which is sent to the DHCP server, instead of  machine's  hostâ\nname.  Currently only has an effect on the networkd backend.\nâ¢\nuse-routes\n(bool)\nDefault:  true.   When true, the routes received from the DHCP server will be installed in the\nrouting table normally.  When set to false, routes from the DHCP server will  be  ignored:  in\nthis  case,  the user is responsible for adding static routes if necessary for correct network\noperation.  This allows users to avoid installing a default gateway for interfaces  configured\nvia DHCP.  Available for both the networkd and NetworkManager backends.\nâ¢\nroute-metric\n(scalar)\nUse  this  value  for  default  metric for automatically-added routes.  Use this to prioritize\nroutes for devices by setting a lower metric on a preferred interface.  Available for both the\nnetworkd and NetworkManager backends.\nâ¢\nuse-domains\n(scalar) â since\n0.98\nTakes a boolean, or the special value \"route\".  When true, the domain name received  from  the\nDHCP server will be used as DNS search domain over this link, similar to the effect of the Doâ\nmains= setting.  If set to \"route\", the domain name received from the DHCP server will be used\nfor  routing  DNS  queries  only, but not for searching, similar to the effect of the Domains=\nsetting when the argument is prefixed with \"~\".\nRequires\nfeature:\ndhcp-use-domains\nRouting\nComplex routing is possible with netplan.  Standard static routes as well as policy routing using routing\ntables are supported via the networkd backend.\nThese options are available for all types of interfaces.\nDefault\nroutes\nThe most common need for routing concerns the definition of default routes to reach the  wider  Internet.\nThose default routes can only defined once per IP family and routing table.  A typical example would look\nlike the following:\nnetwork:\nethernets:\neth0:\n[...]\nroutes:\n- to: default # could be 0.0.0.0/0 optionally\nvia: 10.0.0.1\nmetric: 100\non-link: true\n- to: default # could be ::/0 optionally\nvia: cf02:de:ad:be:ef::2\neth1:\n[...]\nroutes:\n- to: default\nvia: 172.134.67.1\nmetric: 100\non-link: true\n# Not on the main routing table,\n# does not conflict with the eth0 default route\ntable: 76\nâ¢\nroutes\n(mapping)\nThe  routes  block  defines standard static routes for an interface.  At least to must be speciâ\nfied.  If type is local or nat a default scope of host is assumed.  If type is  unicast  and  no\ngateway (via) is given or type is broadcast, multicast or anycast a default scope of link is asâ\nsumed.  Otherwise, a global scope is the default setting.\nFor  from, to, and via, both IPv4 and IPv6 addresses are recognized, and must be in the form adâ\ndr/prefixlen or addr.\nâ¢\nfrom\n(scalar)\nSet a source IP address for traffic going through the route.  (NetworkManager: as of v1.8.0)\nâ¢\nto\n(scalar)\nDestination address for the route.\nâ¢\nvia\n(scalar)\nAddress to the gateway to use for this route.\nâ¢\non-link\n(bool)\nWhen set to \"true\", specifies that the route is directly connected to  the  interface.   (Netâ\nworkManager: as of v1.12.0 for IPv4 and v1.18.0 for IPv6)\nâ¢\nmetric\n(scalar)\nThe relative priority of the route.  Must be a positive integer value.\nâ¢\ntype\n(scalar)\nThe  type  of  route.   Valid options are \"unicast\" (default), \"anycast\", \"blackhole\", \"broadâ\ncast\", \"local\", \"multicast\", \"nat\", \"prohibit\", \"throw\", \"unreachable\" or \"xresolve\".\nâ¢\nscope\n(scalar)\nThe route scope, how wide-ranging it is to the network.  Possible values are \"global\", \"link\",\nor \"host\".  Applies to IPv4 only.\nâ¢\ntable\n(scalar)\nThe table number to use for the route.  In some scenarios, it may be useful to set routes in a\nseparate routing table.  It may also be used to refer to routing policy rules which  also  acâ\ncept  a  table  parameter.  Allowed values are positive integers starting from 1.  Some values\nare already in use to refer to specific routing tables:  see  /etc/iproute2/rt_tables.   (Netâ\nworkManager: as of v1.10.0)\nâ¢\nmtu\n(scalar) â since\n0.101\nThe MTU to be used for the route, in bytes.  Must be a positive integer value.\nâ¢\ncongestion-window\n(scalar) â since\n0.102\nThe  congestion window to be used for the route, represented by number of segments.  Must be a\npositive integer value.\nâ¢\nadvertised-receive-window\n(scalar) â since\n0.102\nThe receive window to be advertised for the route, represented by number of segments.  Must be\na positive integer value.\nâ¢\nrouting-policy\n(mapping)\nThe routing-policy block defines extra routing policy for a network, where traffic may  be  hanâ\ndled specially based on the source IP, firewall marking, etc.\nFor  from,  to,  both  IPv4 and IPv6 addresses are recognized, and must be in the form addr/preâ\nfixlen or addr.\nâ¢\nfrom\n(scalar)\nSet a source IP address to match traffic for this policy rule.\nâ¢\nto\n(scalar)\nMatch on traffic going to the specified destination.\nâ¢\ntable\n(scalar)\nThe table number to match for the route.  In some scenarios, it may be useful to set routes in\na separate routing table.  It may also be used to refer to routes which also  accept  a  table\nparameter.   Allowed values are positive integers starting from 1.  Some values are already in\nuse to refer to specific routing tables: see /etc/iproute2/rt_tables.\nâ¢\npriority\n(scalar)\nSpecify a priority for the routing policy rule, to influence the order in which routing  rules\nare processed.  A higher number means lower priority: rules are processed in order by increasâ\ning priority number.\nâ¢\nmark\n(scalar)\nHave  this  routing policy rule match on traffic that has been marked by the iptables firewall\nwith this value.  Allowed values are positive integers starting from 1.\nâ¢\ntype-of-service\n(scalar)\nMatch this policy rule based on the type of service number applied to the traffic.\nAuthentication\nNetplan supports advanced authentication settings for ethernet and wifi interfaces, as well as individual\nwifi networks, by means of the auth block.\nâ¢\nauth\n(mapping)\nSpecifies authentication settings for a device of type ethernets:, or an access-points: entry on\na wifis: device.\nThe auth block supports the following properties:\nâ¢\nkey-management\n(scalar)\nThe supported key management modes are none (no key management); psk (WPA with pre-shared key,\ncommon for home wifi); eap (WPA with EAP, common for enterprise wifi); sae (used by WPA3); and\n802.1x (used primarily for wired Ethernet connections).\nâ¢\npassword\n(scalar)\nThe password string for EAP, or the pre-shared key for WPA-PSK.\nThe following properties can be used if key-management is eap or 802.1x:\nâ¢\nmethod\n(scalar)\nThe EAP method to use.  The supported EAP methods are tls (TLS),  peap  (Protected  EAP),  and\nttls (Tunneled TLS).\nâ¢\nidentity\n(scalar)\nThe identity to use for EAP.\nâ¢\nanonymous-identity\n(scalar)\nThe  identity to pass over the unencrypted channel if the chosen EAP method supports passing a\ndifferent tunnelled identity.\nâ¢\nca-certificate\n(scalar)\nPath to a file with one or more trusted certificate authority (CA) certificates.\nâ¢\nclient-certificate\n(scalar)\nPath to a file containing the certificate to be used by the client during authentication.\nâ¢\nclient-key\n(scalar)\nPath to a file containing the private key corresponding to client-certificate.\nâ¢\nclient-key-password\n(scalar)\nPassword to use to decrypt the private key specified in client-key if it is encrypted.\nâ¢\nphase2-auth\n(scalar) â since\n0.99\nPhase 2 authentication mechanism.\nProperties\nfor\ndevice\ntype\nethernets:\nStatus\n: Optional.\nPurpose\n: Use the ethernets key to configure Ethernet interfaces.\nStructure\n: The key consists of a mapping of Ethernet interface IDs.  Each ethernet has a number  of  conâ\nfiguration  options.  You don't need to define each interface by their name inside the ethernets mapping.\nYou can use any ID that describes the interface and match the actual network card using  the  match  key.\nThe general configuration structure for Ethernets is shown below.\nnetwork:\nethernets:\ndevice-id:\n...\ndevice-id  is the interface identifier.  If you use the interface name as the ID, Netplan will match that\ninterface.\nConsider the example below.  In this case, an interface called eth0 will be configured with DHCP.\nnetwork:\nethernets:\neth0:\ndhcp4: true\nThe device-id can be any descriptive name your find meaningful.  Although, if it doesn't match a real inâ\nterface name, you must use the property match to identify the device you want to configure.\nThe example below defines an Ethernet connection called isp-interface (supposedly an  external  interface\nconnected to the Internet Service Provider) and uses match to apply the configuration to the physical deâ\nvice with MAC address aa:bb:cc:00:11:22.\nnetwork:\nethernets:\nisp-interface:\nmatch:\nmacaddress: aa:bb:cc:00:11:22\ndhcp4: true\nEthernet  device definitions, beyond common ones described above, also support some additional properties\nthat can be used for SR-IOV devices.\nâ¢\nlink\n(scalar) â since\n0.99\n(SR-IOV devices only) The link property declares the device as a Virtual Function of the selectâ\ned Physical Function device, as identified by the given netplan id.\nExample:\nnetwork:\nethernets:\nenp1: {...}\nenp1s16f1:\nlink: enp1\nâ¢\nvirtual-function-count\n(scalar) â since\n0.99\n(SR-IOV devices only) In certain special cases VFs might need to be configured outside  of  netâ\nplan.   For such configurations virtual-function-count can be optionally used to set an explicit\nnumber of Virtual Functions for the given Physical Function.  If unset, the default is to create\nonly as many VFs as are defined in the netplan configuration.  This should be used  for  special\ncases only.\nRequires\nfeature:\nsriov\nâ¢\nembedded-switch-mode\n(scalar) â since\n0.104\n(SR-IOV devices only) Change the operational mode of the embedded switch of a supported SmartNIC\nPCI device (e.g.  Mellanox ConnectX-5).  Possible values are switchdev or legacy, if unspecified\nthe vendor's default configuration is used.\nRequires\nfeature:\neswitch-mode\nâ¢\ndelay-virtual-functions-rebind\n(bool) â since\n0.104\n(SR-IOV  devices  only) Delay rebinding of SR-IOV virtual functions to its driver after changing\nthe embedded-switch-mode setting to a later stage.  Can be enabled when  bonding/VF  LAG  is  in\nuse.  Defaults to false.\nRequires\nfeature:\neswitch-mode\nâ¢\ninfiniband-mode\n(scalar) â since\n0.105\n(InfiniBand  devices  only)  Change the operational mode of a IPoIB device.  Possible values are\ndatagram or connected.  If unspecified the kernel's default configuration is used.\nRequires\nfeature:\ninfiniband\nProperties\nfor\ndevice\ntype\nmodems:\nStatus\n: Optional.\nPurpose\n: Use the modems key to configure Modem interfaces.  GSM/CDMA modem configuration is only supportâ\ned for the NetworkManager backend.  systemd-networkd does not support modems.\nStructure\n: The key consists of a mapping of Modem IDs.  Each modem has a number of configuration options.\nThe general configuration structure for Modems is shown below.\nnetwork:\nversion: 2\nrenderer: NetworkManager\nmodems:\ncdc-wdm1:\nmtu: 1600\napn: ISP.CINGULAR\nusername:\nISP@CINGULARGPRS.COM\npassword: CINGULAR1\nnumber: \"*99#\"\nnetwork-id: 24005\ndevice-id: da812de91eec16620b06cd0ca5cbc7ea25245222\npin: 2345\nsim-id: 89148000000060671234\nsim-operator-id: 310260\nRequires\nfeature:\nmodems\nâ¢\napn\n(scalar) â since\n0.99\nSet the carrier APN (Access Point Name).  This can be omitted if auto-config is enabled.\nâ¢\nauto-config\n(bool) â since\n0.99\nSpecify whether to try and auto-configure the modem by doing a lookup of the carrier against the\nMobile Broadband Provider database.  This may not work for all carriers.\nâ¢\ndevice-id\n(scalar) â since\n0.99\nSpecify the device ID (as given by the WWAN management service) of the modem to match.  This can\nbe found using mmcli.\nâ¢\nnetwork-id\n(scalar) â since\n0.99\nSpecify the Network ID (GSM LAI format).  If this is specified, the device will  not  roam  netâ\nworks.\nâ¢\nnumber\n(scalar) â since\n0.99\nThe number to dial to establish the connection to the mobile broadband network.  (Deprecated for\nGSM)\nâ¢\npassword\n(scalar) â since\n0.99\nSpecify  the password used to authenticate with the carrier network.  This can be omitted if auâ\nto-config is enabled.\nâ¢\npin\n(scalar) â since\n0.99\nSpecify the SIM PIN to allow it to operate if a PIN is set.\nâ¢\nsim-id\n(scalar) â since\n0.99\nSpecify the SIM unique identifier (as given by the WWAN management service) which  this  connecâ\ntion  applies  to.   If given, the connection will apply to any device also allowed by device-id\nwhich contains a SIM card matching the given identifier.\nâ¢\nsim-operator-id\n(scalar) â since\n0.99\nSpecify the MCC/MNC string (such as \"310260\" or \"21601\") which identifies the carrier that  this\nconnection  should  apply to.  If given, the connection will apply to any device also allowed by\ndevice-id and sim-id which contains a SIM card provisioned by the given operator.\nâ¢\nusername\n(scalar) â since\n0.99\nSpecify the username used to authenticate with the carrier network.  This can be omitted if  auâ\nto-config is enabled.\nProperties\nfor\ndevice\ntype\nwifis:\nStatus\n: Optional.\nPurpose\n: Use the wifis key to configure WiFi access points.\nStructure\n:  The  key consists of a mapping of WiFi IDs.  Each wifi has a number of configuration options.\nThe general configuration structure for WiFis is shown below.\nnetwork:\nversion: 2\nwifis:\nwlp0s1:\naccess-points:\n\"network_ssid_name\":\npassword: \"**********\"\nNote that systemd-networkd does not natively support wifi, so you need wpasupplicant installed if you let\nthe networkd renderer handle wifi.\nâ¢\naccess-points\n(mapping)\nThis provides pre-configured connections to NetworkManager.  Note that users can of  course  seâ\nlect  other access points/SSIDs.  The keys of the mapping are the SSIDs, and the values are mapâ\npings with the following supported properties:\nâ¢\npassword\n(scalar)\nEnable WPA/WPA2 authentication and set the passphrase for it.  If neither  this  nor  an  auth\nblock are given, the network is assumed to be open.  The setting\npassword: \"S3kr1t\"\nis equivalent to\nauth:\nkey-management: psk\npassword: \"S3kr1t\"\nâ¢\nmode\n(scalar)\nPossible  access  point  modes are infrastructure (the default), ap (create an access point to\nwhich other devices can connect), and adhoc (peer to peer networks without  a  central  access\npoint).  ap is only supported with NetworkManager.\nâ¢\nbssid\n(scalar) â since\n0.99\nIf specified, directs the device to only associate with the given access point.\nâ¢\nband\n(scalar) â since\n0.99\nPossible bands are 5GHz (for 5GHz 802.11a) and 2.4GHz (for 2.4GHz 802.11), do not restrict the\n802.11 frequency band of the network if unset (the default).\nâ¢\nchannel\n(scalar) â since\n0.99\nWireless  channel  to  use  for the Wi-Fi connection.  Because channel numbers overlap between\nbands, this property takes effect only if the band property is also set.\nâ¢\nhidden\n(bool) â since\n0.100\nSet to true to change the SSID scan technique for connecting to hidden  WiFi  networks.   Note\nthis  may  have slower performance compared to false (the default) when connecting to publicly\nbroadcast SSIDs.\nâ¢\nwakeonwlan\n(sequence of scalars) â since\n0.99\nThis enables WakeOnWLan on supported devices.  Not all drivers support all options.  May be  any\ncombination  of  any, disconnect, magic_pkt, gtk_rekey_failure, eap_identity_req, four_way_handâ\nshake, rfkill_release or tcp (NetworkManager only).  Or the  exclusive  default  flag  (the  deâ\nfault).\nâ¢\nregulatory-domain\n(scalar) â since\n0.105\nThis  can  be used to define the radio's regulatory domain, to make use of additional WiFi chanâ\nnels outside the \"world domain\".  Takes an ISO / IEC 3166 country code (like GB) or 00 to  reset\nto   the   \"world   domain\".    See   wireless-regdb  (https://git.kernel.org/pub/scm/linux/kerâ\nnel/git/sforshee/wireless-regdb.git/tree/db.txt) for available values.\nRequires\ndependency:\niw\n, if it is to be used outside the networkd (wpa_supplicant) backend.\nProperties\nfor\ndevice\ntype\nbridges:\nStatus\n: Optional.\nPurpose\n: Use the bridges key to create Bridge interfaces.\nStructure\n: The key consists of a mapping of Bridge interface names.  Each bridge has an optional list  of\ninterfaces that will be bridged together.  The interfaces listed in the interfaces key (enp5s0 and enp5s1\nbelow)  must  also  be  defined  in  your Netplan configuration.  The general configuration structure for\nBridges is shown below.\nnetwork:\nbridges:\nbr0:\ninterfaces:\n- enp5s0\n- enp5s1\ndhcp4: true\n...\nWhen applied, a virtual interface of type bridge called br0 will be created in the system.\nThe specific settings for bridges are defined below.\nâ¢\ninterfaces\n(sequence of scalars)\nAll devices matching this ID list will be added to the bridge.  This may be an  empty  list,  in\nwhich case the bridge will be brought online with no member interfaces.\nExample:\nnetwork:\nethernets:\nswitchports:\nmatch: {name: \"enp2*\"}\n[...]\nbridges:\nbr0:\ninterfaces: [switchports]\nâ¢\nparameters\n(mapping)\nCustomization  parameters for special bridging options.  Time intervals may need to be expressed\nas a number of seconds or milliseconds: the default value type is specified  below.   If  necesâ\nsary,  time  intervals  can  be qualified using a time suffix (such as \"s\" for seconds, \"ms\" for\nmilliseconds) to allow for more control over its behavior.\nâ¢\nageing-time\n,\naging-time\n(scalar)\nSet the period of time to keep a MAC address in the forwarding database after a packet is  reâ\nceived.   This  maps to the AgeingTimeSec= property when the networkd renderer is used.  If no\ntime suffix is specified, the value will be interpreted as seconds.\nâ¢\npriority\n(scalar)\nSet the priority value for the bridge.  This value should be a number  between  0  and  65535.\nLower values mean higher priority.  The bridge with the higher priority will be elected as the\nroot bridge.\nâ¢\nport-priority\n(mapping)\nSet  the  port priority per interface.  The priority value is a number between 0 and 63.  This\nmetric is used in the designated port and root port selection algorithms.\nExample:\nnetwork:\nethernets:\neth0:\ndhcp4: false\neth1:\ndhcp4: false\nbridges:\nbr0:\ninterfaces: [eth0, eth1]\nparameters:\nport-priority:\neth0: 10\neth1: 20\nâ¢\nforward-delay\n(scalar)\nSpecify the period of time the bridge will remain in Listening and Learning states before getâ\nting to the Forwarding state.  This field maps to the ForwardDelaySec= property for  the  netâ\nworkd renderer.  If no time suffix is specified, the value will be interpreted as seconds.\nâ¢\nhello-time\n(scalar)\nSpecify  the  interval  between  two hello packets being sent out from the root and designated\nbridges.  Hello packets communicate information about the network topology.  When the networkd\nrenderer is used, this maps to the HelloTimeSec= property.  If no time  suffix  is  specified,\nthe value will be interpreted as seconds.\nâ¢\nmax-age\n(scalar)\nSet the maximum age of a hello packet.  If the last hello packet is older than that value, the\nbridge  will attempt to become the root bridge.  This maps to the MaxAgeSec= property when the\nnetworkd renderer is used.  If no time suffix is specified, the value will be  interpreted  as\nseconds.\nâ¢\npath-cost\n(mapping)\nSet  the  per-interface  cost  of a path on the bridge.  Faster interfaces should have a lower\ncost.  This allows a finer control on the network topology  so  that  the  fastest  paths  are\navailable whenever possible.\nExample:\nnetwork:\nethernets:\neth0:\ndhcp4: false\neth1:\ndhcp4: false\nbridges:\nbr0:\ninterfaces: [eth0, eth1]\nparameters:\npath-cost:\neth0: 100\neth1: 200\nâ¢\nstp\n(bool)\nDefine  whether  the  bridge  should use Spanning Tree Protocol.  The default value is \"true\",\nwhich means that Spanning Tree should be used.\nProperties\nfor\ndevice\ntype\nbonds:\nStatus\n: Optional.\nPurpose\n: Use the bonds key to create Bond (Link Aggregation) interfaces.\nStructure\n: The key consists of a mapping of Bond interface names.  Each bond has an optional list of  inâ\nterfaces  that will be part of the aggregation.  The interfaces listed in the interfaces key must also be\ndefined in your Netplan configuration.  The general configuration structure for Bonds is shown below.\nnetwork:\nbonds:\nbond0:\ninterfaces:\n- enp5s0\n- enp5s1\n- enp5s2\nmode: active-backup\n...\nWhen applied, a virtual interface of type bond called bond0 will be created in the system.\nThe specific settings for bonds are defined below.\nâ¢\ninterfaces\n(sequence of scalars)\nAll devices matching this ID list will be added to the bond.\nExample:\nnetwork:\nethernets:\nswitchports:\nmatch: {name: \"enp2*\"}\n[...]\nbonds:\nbond0:\ninterfaces: [switchports]\nâ¢\nparameters\n(mapping)\nCustomization parameters for special bonding options.  Time intervals may need to  be  expressed\nas  a  number  of seconds or milliseconds: the default value type is specified below.  If necesâ\nsary, time intervals can be qualified using a time suffix (such as \"s\"  for  seconds,  \"ms\"  for\nmilliseconds) to allow for more control over its behavior.\nâ¢\nmode\n(scalar)\nSet  the bonding mode used for the interfaces.  The default is balance-rr (round robin).  Posâ\nsible values are balance-rr, active-backup, balance-xor, broadcast, 802.3ad, balance-tlb,  and\nbalance-alb.  For Open vSwitch active-backup and the additional modes balance-tcp and balance-\nslb are supported.\nâ¢\nlacp-rate\n(scalar)\nSet the rate at which LACPDUs are transmitted.  This is only useful in 802.3ad mode.  Possible\nvalues are slow (30 seconds, default), and fast (every second).\nâ¢\nmii-monitor-interval\n(scalar)\nSpecifies the interval for MII monitoring (verifying if an interface of the bond has carrier).\nThe  default  is  0;  which disables MII monitoring.  This is equivalent to the MIIMonitorSec=\nfield for the networkd backend.  If no time suffix is specified, the value will be interpreted\nas milliseconds.\nâ¢\nmin-links\n(scalar)\nThe minimum number of links up in a bond to consider the bond interface to be up.\nâ¢\ntransmit-hash-policy\n(scalar)\nSpecifies the transmit hash policy for the selection of ports.  This is only  useful  in  balâ\nance-xor,  802.3ad and balance-tlb modes.  Possible values are layer2, layer3+4, layer2+3, enâ\ncap2+3, and encap3+4.\nâ¢\nad-select\n(scalar)\nSet the aggregation selection mode.  Possible values are stable, bandwidth, and  count.   This\noption is only used in 802.3ad mode.\nâ¢\nall-members-active\n(bool) â since\n0.106\nIf the bond should drop duplicate frames received on inactive ports, set this option to false.\nIf  they should be delivered, set this option to true.  The default value is false, and is the\ndesirable behavior in most situations.\nAlias:\nall-slaves-active\nâ¢\narp-interval\n(scalar)\nSet the interval value for how frequently ARP link monitoring should happen.  The default valâ\nue is 0, which disables ARP monitoring.  For the networkd backend, this maps to the  ARPInterâ\nvalSec=  property.  If no time suffix is specified, the value will be interpreted as millisecâ\nonds.\nâ¢\narp-ip-targets\n(sequence of scalars)\nIPs of other hosts on the link which should be sent ARP requests in order to validate  that  a\nport  is  up.   This option is only used when arp-interval is set to a value other than 0.  At\nleast one IP address must be given for ARP link monitoring to function.  Only  IPv4  addresses\nare supported.  You can specify up to 16 IP addresses.  The default value is an empty list.\nâ¢\narp-validate\n(scalar)\nConfigure how ARP replies are to be validated when using ARP link monitoring.  Possible values\nare none, active, backup, and all.\nâ¢\narp-all-targets\n(scalar)\nSpecify  whether  to  use any ARP IP target being up as sufficient for a port to be considered\nup; or if all the targets must be up.  This is only used for active-backup mode when arp-valiâ\ndate is enabled.  Possible values are any and all.\nâ¢\nup-delay\n(scalar)\nSpecify the delay before enabling a link once the link is physically up.  The default value is\n0.  This maps to the UpDelaySec= property for the networkd  renderer.   This  option  is  only\nvalid  for  the miimon link monitor.  If no time suffix is specified, the value will be interâ\npreted as milliseconds.\nâ¢\ndown-delay\n(scalar)\nSpecify the delay before disabling a link once the link has been lost.  The default  value  is\n0.   This  maps  to the DownDelaySec= property for the networkd renderer.  This option is only\nvalid for the miimon link monitor.  If no time suffix is specified, the value will  be  interâ\npreted as milliseconds.\nâ¢\nfail-over-mac-policy\n(scalar)\nSet whether to set all ports to the same MAC address when adding them to the bond, or how else\nthe system should handle MAC addresses.  The possible values are none, active, and follow.\nâ¢\ngratuitous-arp\n(scalar)\nSpecify how many ARP packets to send after failover.  Once a link is up on a new port, a notiâ\nfication  is  sent and possibly repeated if this value is set to a number greater than 1.  The\ndefault value is 1 and valid values are between 1 and 255.  This  only  affects  active-backup\nmode.\nFor  historical  reasons,  the  misspelling  gratuitious-arp is also accepted and has the same\nfunction.\nâ¢\npackets-per-member\n(scalar) â since\n0.106\nIn balance-rr mode, specifies the number of packets to transmit on a port before switching  to\nthe  next.  When this value is set to 0, ports are chosen at random.  Allowable values are beâ\ntween 0 and 65535.  The default value is 1.  This setting is only used in balance-rr mode.\nAlias:\npackets-per-slave\nâ¢\nprimary-reselect-policy\n(scalar)\nSet the reselection policy for the primary port.  On failure of the active  port,  the  system\nwill use this policy to decide how the new active port will be chosen and how recovery will be\nhandled.  The possible values are always, better, and failure.\nâ¢\nresend-igmp\n(scalar)\nIn  modes  balance-rr,  active-backup, balance-tlb and balance-alb, a failover can switch IGMP\ntraffic from one port to another.\nThis parameter specifies how many IGMP membership reports are  issued  on  a  failover  event.\nValues range from 0 to 255.  0 disables sending membership reports.  Otherwise, the first memâ\nbership report is sent on failover and subsequent reports are sent at 200ms intervals.\nâ¢\nlearn-packet-interval\n(scalar)\nSpecify  the  interval  between sending learning packets to each port.  The value range is beâ\ntween 1 and 0x7fffffff.  The default value is 1.  This option  only  affects  balance-tlb  and\nbalance-alb  modes.   Using  the  networkd  renderer, this field maps to the LearnPacketInterâ\nvalSec= property.  If no time suffix is specified, the value will be interpreted as seconds.\nâ¢\nprimary\n(scalar)\nSpecify a device to be used as a primary port, or preferred device to use as a  port  for  the\nbond  (i.e.   the preferred device to send data through), whenever it is available.  This only\naffects active-backup, balance-alb, and balance-tlb modes.\nProperties\nfor\ndevice\ntype\ntunnels:\nStatus\n: Optional.\nPurpose\n: Use the tunnels key to create virtual tunnel interfaces.\nStructure\n: The key consists of a mapping of tunnel interface names.  Each tunnel requires the identificaâ\ntion of the tunnel mode (see the section mode below for the list of supported modes).  The  general  conâ\nfiguration structure for Tunnels is shown below.\nnetwork:\ntunnels:\ntunnel0:\nmode: SCALAR\n...\nWhen  applied,  a  virtual interface called tunnel0 will be created in the system.  Its operation mode is\ndefined by the property mode.\nTunnels allow traffic to pass as if it was between systems on the same local  network,  although  systems\nmay be far from each other but reachable via the Internet.  They may be used to support IPv6 traffic on a\nnetwork  where  the ISP does not provide the service, or to extend and \"connect\" separate local networks.\nPlease see <https://en.wikipedia.org/wiki/Tunneling_protocol> for more general information about tunnels.\nThe specific settings for tunnels are defined below.\nâ¢\nmode\n(scalar)\nDefines the tunnel mode.  Valid options are sit, gre, ip6gre, ipip, ipip6,  ip6ip6,  vti,  vti6,\nwireguard,  vxlan, gretap and ip6gretap modes.  In addition, the NetworkManager backend supports\nisatap tunnels.\nâ¢\nlocal\n(scalar)\nDefines the address of the local endpoint of the tunnel.  (For VXLAN) This should match  one  of\nthe parent's IP addresses or make use of the networkd special values.\nâ¢\nremote\n(scalar)\nDefines  the  address  of  the  remote  endpoint of the tunnel or multicast group IP address for\nVXLAN.\nâ¢\nttl\n(scalar) â since\n0.103\nDefines the Time To Live (TTL) of the tunnel.  Takes a number in the range 1..255.\nâ¢\nkey\n(scalar or mapping)\nDefine keys to use for the tunnel.  The key can be a number or a dotted quad (an IPv4  address).\nFor  wireguard it can be a base64-encoded private key or (as of networkd v242+) an absolute path\nto a file, containing the private key (since 0.100).  It is used for identification of IP transâ\nforms.  This is only required for vti and vti6 when using the networkd backend.\nThis field may be used as a scalar (meaning that a single key is specified and to  be  used  for\ninput, output and private key), or as a mapping, where you can further specify input/output/priâ\nvate.\nâ¢\ninput\n(scalar)\nThe input key for the tunnel\nâ¢\noutput\n(scalar)\nThe output key for the tunnel\nâ¢\nprivate\n(scalar) â since\n0.100\nA  base64-encoded private key required for WireGuard tunnels.  When the systemd-networkd backâ\nend (v242+) is used, this can also be an absolute path to a file containing the private key.\nâ¢\nkeys\n(scalar or mapping)\nAlternate name for the key field.  See above.\nExamples:\nnetwork:\ntunnels:\ntun0:\nmode: gre\nlocal: ...\nremote: ...\nkeys:\ninput: 1234\noutput: 5678\nnetwork:\ntunnels:\ntun0:\nmode: vti6\nlocal: ...\nremote: ...\nkey: 59568549\nnetwork:\ntunnels:\nwg0:\nmode: wireguard\naddresses: [...]\npeers:\n- keys:\npublic: rlbInAj0qV69CysWPQY7KEBnKxpYCpaWqOs/dLevdWc=\nshared: /path/to/shared.key\n...\nkey: mNb7OIIXTdgW4khM7OFlzJ+UPs7lmcWHV7xjPgakMkQ=\nnetwork:\ntunnels:\nwg0:\nmode: wireguard\naddresses: [...]\npeers:\n- keys:\npublic: rlbInAj0qV69CysWPQY7KEBnKxpYCpaWqOs/dLevdWc=\n...\nkeys:\nprivate: /path/to/priv.key\nWireGuard specific keys:\nâ¢\nmark\n(scalar) â since\n0.100\nFirewall mark for outgoing WireGuard packets from this interface, optional.\nâ¢\nport\n(scalar) â since\n0.100\nUDP port to listen at or auto.  Optional, defaults to auto.\nâ¢\npeers\n(sequence of mappings) â since\n0.100\nA list of peers, each having keys documented below.\nExample:\nnetwork:\ntunnels:\nwg0:\nmode: wireguard\nkey: /path/to/private.key\nmark: 42\nport: 5182\npeers:\n- keys:\npublic: rlbInAj0qV69CysWPQY7KEBnKxpYCpaWqOs/dLevdWc=\nallowed-ips: [0.0.0.0/0, \"2001:fe:ad:de:ad:be:ef:1/24\"]\nkeepalive: 23\nendpoint: 1.2.3.4:5\n- keys:\npublic: M9nt4YujIOmNrRmpIRTmYSfMdrpvE7u6WkG8FY8WjG4=\nshared: /some/shared.key\nallowed-ips: [10.10.10.20/24]\nkeepalive: 22\nendpoint: 5.4.3.2:1\nâ¢\nendpoint\n(scalar) â since\n0.100\nRemote endpoint IPv4/IPv6 address or a hostname, followed by a colon and a port number.\nâ¢\nallowed-ips\n(sequence of scalars) â since\n0.100\nA list of IP (v4 or v6) addresses with CIDR masks from which this peer is allowed to send  inâ\ncoming  traffic  and  to  which  outgoing  traffic  for  this peer is directed.  The catch-all\n0.0.0.0/0 may be specified for matching all IPv4 addresses, and  ::/0  may  be  specified  for\nmatching all IPv6 addresses.\nâ¢\nkeepalive\n(scalar) â since\n0.100\nAn  interval  in seconds, between 1 and 65535 inclusive, of how often to send an authenticated\nempty packet to the peer for the purpose of keeping a stateful firewall or NAT  mapping  valid\npersistently.  Optional.\nâ¢\nkeys\n(mapping) â since\n0.100\nDefine keys to use for the WireGuard peers.\nThis field can be used as a mapping, where you can further specify the public and shared keys.\nâ¢\npublic\n(scalar) â since\n0.100\nA base64-encoded public key, required for WireGuard peers.\nâ¢\nshared\n(scalar) â since\n0.100\nA  base64-encoded  preshared  key.  Optional for WireGuard peers.  When the systemd-networkd\nbackend (v242+) is used, this can also be an absolute path to a  file  containing  the  preâ\nshared key.\nVXLAN specific keys:\nâ¢\nid\n(scalar) â since\n0.105\nThe  VXLAN  Network  Identifier  (VNI  or  VXLAN  Segment  ID).   Takes  a  number  in the range\n1..16777215.\nâ¢\nlink\n(scalar) â since\n0.105\nnetplan ID of the parent device definition to which this VXLAN gets connected.\nâ¢\ntype-of-service\n(scalar) â since\n0.105\nThe Type Of Service byte value for a vxlan interface.\nâ¢\nmac-learning\n(scalar) â since\n0.105\nTakes a boolean.  When true, enables dynamic MAC learning to discover remote MAC addresses.\nâ¢\nageing\n,\naging\n(scalar) â since\n0.105\nThe lifetime of Forwarding Database entry learned by the kernel, in seconds.\nâ¢\nlimit\n(scalar) â since\n0.105\nConfigures maximum number of FDB entries.\nâ¢\narp-proxy\n(scalar) â since\n0.105\nTakes a boolean.  When true, bridge-connected VXLAN tunnel endpoint answers  ARP  requests  from\nthe  local  bridge on behalf of remote Distributed Overlay Virtual Ethernet (DOVE) clients.  Deâ\nfaults to false.\nâ¢\nnotifications\n(sequence of scalars) â since\n0.105\nTakes the flags l2-miss and l3-miss to enable netlink LLADDR and/or netlink IP address miss  noâ\ntifications.\nâ¢\nshort-circuit\n(scalar) â since\n0.105\nTakes a boolean.  When true, route short circuiting is turned on.\nâ¢\nchecksums\n(sequence of scalars) â since\n0.105\nTakes  the flags udp, zero-udp6-tx, zero-udp6-rx, remote-tx and remote-rx to enable transmitting\nUDP checksums in VXLAN/IPv4, send/receive zero checksums in VXLAN/IPv6  and  enable  sending/reâ\nceiving checksum offloading in VXLAN.\nâ¢\nextensions\n(sequence of scalars) â since\n0.105\nTakes  the  flags group-policy and generic-protocol to enable the \"Group Policy\" and/or \"Generic\nProtocol\" VXLAN extensions.\nâ¢\nport\n(scalar) â since\n0.105\nConfigures the default destination UDP port.  If the destination port is not specified then Linâ\nux kernel default will be used.  Set to 4789 to get the IANA assigned value.\nâ¢\nport-range\n(sequence of scalars) â since\n0.105\nConfigures the source port range for the VXLAN.  The kernel assigns the source UDP port based on\nthe flow to help the receiver to do load balancing.  When this option is  not  set,  the  normal\nrange of local UDP ports is used.  Uses the form [LOWER, UPPER].\nâ¢\nflow-label\n(scalar) â since\n0.105\nSpecifies the flow label to use in outgoing packets.  The valid range is 0-1048575.\nâ¢\ndo-not-fragment\n(scalar) â since\n0.105\nAllows  setting  the  IPv4 Do not Fragment (DF) bit in outgoing packets.  Takes a boolean value.\nWhen unset, the kernel's default will be used.\nProperties\nfor\ndevice\ntype\nvlans:\nStatus\n: Optional.\nPurpose\n: Use the vlans key to create VLAN interfaces.\nStructure\n: The key consists of a mapping of VLAN interface names.  The interface used in the link  option\n(enp5s0  in the example below) must also be defined in the Netplan configuration.  The general configuraâ\ntion structure for Vlans is shown below.\nnetwork:\nvlans:\nvlan123:\nid: 123\nlink: enp5s0\ndhcp4: yes\nThe specific settings for VLANs are defined below.\nâ¢\nid\n(scalar)\nVLAN ID, a number between 0 and 4094.\nâ¢\nlink\n(scalar)\nnetplan ID of the underlying device definition on which this VLAN gets created.\nExample:\nnetwork:\nethernets:\neno1: {...}\nvlans:\nen-intra:\nid: 1\nlink: eno1\ndhcp4: yes\nen-vpn:\nid: 2\nlink: eno1\naddresses: [...]\nProperties\nfor\ndevice\ntype\nvrfs:\nStatus\n: Optional.\nPurpose\n: Use the vrfs key to create Virtual Routing and Forwarding (VRF) interfaces.\nStructure\n: The key consists of a mapping of VRF interface names.  The interface used in the  link  option\n(enp5s0  in the example below) must also be defined in the Netplan configuration.  The general configuraâ\ntion structure for VRFs is shown below.\nnetwork:\nrenderer: networkd\nvrfs:\nvrf1:\ntable: 1\ninterfaces:\n- enp5s0\nroutes:\n- to: default\nvia: 10.10.10.4\nrouting-policy:\n- from: 10.10.10.42\nâ¢\ntable\n(scalar) â since\n0.105\nThe numeric routing table identifier.  This setting is compulsory.\nâ¢\ninterfaces\n(sequence of scalars) â since\n0.105\nAll devices matching this ID list will be added to the VRF.  This may be an empty list, in which\ncase the VRF will be brought online with no member interfaces.\nâ¢\nroutes\n(sequence of mappings) â since\n0.105\nConfigure static routing for the device; see the Routing section.  The table value is implicitly\nset to the VRF's table.\nâ¢\nrouting-policy\n(sequence of mappings) â since\n0.105\nConfigure policy routing for the device; see the Routing section.  The table value is implicitly\nset to the VRF's table.\nExample:\nnetwork:\nvrfs:\nvrf20:\ntable: 20\ninterfaces: [ br0 ]\nroutes:\n- to: default\nvia: 10.10.10.3\nrouting-policy:\n- from: 10.10.10.42\n[...]\nbridges:\nbr0:\ninterfaces: []\nProperties\nfor\ndevice\ntype\nnm-devices:\nStatus\n: Optional.  Its use is not recommended.\nPurpose\n: Use the nm-devices key to configure device types that are not supported  by  Netplan.   This  is\nNetworkManager specific configuration.\nStructure\n:  The  key  consists of a mapping of NetworkManager connections.  The nm-devices device type is\nfor internal use only and should not be used in normal configuration files.  It enables a  fallback  mode\nfor unsupported settings, using the passthrough mapping.  The general configuration structure for NM conâ\nnections is shown below.\nnetwork:\nversion: 2\nnm-devices:\nNM-db5f0f67-1f4c-4d59-8ab8-3d278389cf87:\nrenderer: NetworkManager\nnetworkmanager:\nuuid: \"db5f0f67-1f4c-4d59-8ab8-3d278389cf87\"\nname: \"myvpnconnection\"\npassthrough:\nconnection.type: \"vpn\"\nvpn.ca: \"path to ca.crt\"\nvpn.cert: \"path to client.crt\"\nvpn.cipher: \"AES-256-GCM\"\nvpn.connection-type: \"tls\"\nvpn.dev: \"tun\"\nvpn.key: \"path to client.key\"\nvpn.remote: \"1.2.3.4:1194\"\nvpn.service-type: \"org.freedesktop.NetworkManager.openvpn\"\nBackend-specific\nconfiguration\nparameters\nIn  addition  to  the other fields available to configure interfaces, some backends may require to record\nsome of their own parameters in netplan, especially if the netplan definitions are generated automaticalâ\nly by the consumer of that backend.  Currently, this is only used with NetworkManager.\nâ¢\nnetworkmanager\n(mapping) â since\n0.99\nKeeps the NetworkManager-specific configuration parameters used by the daemon to recognize  conâ\nnections.\nâ¢\nname\n(scalar) â since\n0.99\nSet the display name for the connection.\nâ¢\nuuid\n(scalar) â since\n0.99\nDefines  the  UUID (unique identifier) for this connection, as generated by NetworkManager itâ\nself.\nâ¢\nstable-id\n(scalar) â since\n0.99\nDefines the stable ID (a different form of a connection name) used by NetworkManager  in  case\nthe  name  of  the connection might otherwise change, such as when sharing connections between\nusers.\nâ¢\ndevice\n(scalar) â since\n0.99\nDefines the interface name for which this connection applies.\nâ¢\npassthrough\n(mapping) â since\n0.102\nCan be used as a fallback mechanism to missing keyfile settings.\nSEE\nALSO\nnetplan-generate\n(8),\nnetplan-apply\n(8),\nnetplan-try\n(8),\nnetplan-get\n(8),\nnetplan-set\n(8),\nnetplan-info\n(8),\nnetplan-ip\n(8),\nnetplan-rebind\n(8),\nnetplan-status\n(8),\nnetplan-dbus\n(8),\nsystemd-networkd\n(8),\nNetworkManagâ\ner\n(8)\nAUTHORS\nMathieu Trudel-Lapierre (<\ncyphermox@ubuntu.com\n>); Martin Pitt (<\nmartin.pitt@ubuntu.com\n>);  Lukas  MÃ¤rdian\n(<\nslyon@ubuntu.com\n>).\nYAML\nconfiguration\n(5)", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://manpages.ubuntu.com/manpages/jammy/man5/netplan.5.html"}}
{"text": "ip(8) — iproute2 — Debian unstable — Debian Manpages\nMANPAGES\nSkip Quicknav\nIndex\nAbout Manpages\nFAQ\nService Information\n/\nunstable\n/\niproute2\n/ ip(8)\nlinks\nlanguage-indep link\npackage tracker\nraw man page\ntable of contents\nNAME\nSYNOPSIS\nOPTIONS\nIP - COMMAND SYNTAX\nENVIRONMENT\nEXIT STATUS\nEXAMPLES\nHISTORY\nSEE ALSO\nREPORTING BUGS\nAUTHOR\nother versions\ntrixie\n6.15.0-1\ntesting\n6.17.0-1\nunstable\n6.17.0-1\nother languages\nEnglish\nfrançais\nromână\nрусский\nother sections\n4freebsd (\nfiles\n)\n7 (\nmisc\n)\n8 (\nsysadmin\n)\nScroll to navigation\nIP(8)\nLinux\nIP(8)\nNAME\n¶\nip - show / manipulate routing, network devices, interfaces and\ntunnels\nSYNOPSIS\n¶\nip\n[\nOPTIONS\n]\nOBJECT\n{\nCOMMAND\n|\nhelp\n}\nip\n[\n-force\n]\n-batch\nfilename\nOBJECT\n:= {\naddress\n|\naddrlabel\n|\nfou\n|\nhelp\n|\nila\n|\nioam\n|\nl2tp\n|\nlink\n|\nmacsec\n|\nmaddress\n|\nmonitor\n|\nmptcp\n|\nmroute\n|\nmrule\n|\nneighbor\n|\nneighbour\n|\nnetconf\n|\nnetns\n|\nnexthop\n|\nntable\n|\nntbl\n|\nroute\n|\nrule\n|\nsr\n|\ntap\n|\ntcpmetrics\n|\ntoken\n|\ntunnel\n|\ntuntap\n|\nvrf\n|\nxfrm\n}\nOPTIONS\n:= {\n-V\n[\nersion\n] |\n-h\n[\numan-readable\n] |\n-s\n[\ntatistics\n] |\n-d\n[\netails\n] |\n-r\n[\nesolve\n] |\n-iec\n|\n-f\n[\namily\n] {\ninet\n|\ninet6\n|\nlink\n} |\n-4\n|\n-6\n|\n-B\n|\n-0\n|\n-l\n[\noops\n] {\nmaximum-addr-flush-attempts\n} |\n-o\n[\nneline\n] |\n-rc\n[\nvbuf\n] [\nsize\n] |\n-t\n[\nimestamp\n] |\n-ts\n[\nhort\n] |\n-n\n[\netns\n] name |\n-N\n[\numeric\n] |\n-a\n[\nll\n] |\n-c\n[\nolor\n] |\n-br\n[\nief\n] |\n-j\n[son] |\n-p\n[retty] }\nOPTIONS\n¶\n-V\n,\n-Version\nPrint the version of the\nip\nutility and exit.\n-h\n,\n-human\n,\n-human-readable\noutput statistics with human readable values followed by suffix.\n-b\n,\n-batch\n<FILENAME>\nRead commands from provided file or standard input and invoke them. First\nfailure will cause termination of ip.\n-force\nDon't terminate ip on errors in batch mode. If there were any errors\nduring execution of the commands, the application return code will be non\nzero.\n-s\n,\n-stats\n,\n-statistics\nOutput more information. If the option appears twice or more, the amount\nof information increases. As a rule, the information is statistics or some\ntime values.\n-d\n,\n-details\nOutput more detailed information.\n-l\n,\n-loops\n<COUNT>\nSpecify maximum number of loops the 'ip address flush' logic will attempt\nbefore giving up. The default is 10. Zero (0) means loop until all\naddresses are removed.\n-f\n,\n-family\n<FAMILY>\nSpecifies the protocol family to use. The protocol family identifier can\nbe one of\ninet\n,\ninet6\n,\nbridge\n,\nmpls\nor\nlink\n. If this option is not present, the protocol family is guessed\nfrom other arguments. If the rest of the command line does not give enough\ninformation to guess the family,\nip\nfalls back to the default one,\nusually\ninet\nor\nany\n.\nlink\nis a special family\nidentifier meaning that no networking protocol is involved.\n-4\nshortcut for\n-family inet\n.\n-6\nshortcut for\n-family inet6\n.\n-B\nshortcut for\n-family bridge\n.\n-M\nshortcut for\n-family mpls\n.\n-0\nshortcut for\n-family link\n.\n-o\n,\n-oneline\noutput each record on a single line, replacing line feeds with the\n'\\'\ncharacter. This is convenient when you want to count records\nwith\nwc(1)\nor to\ngrep(1)\nthe output.\n-r\n,\n-resolve\nuse the system's name resolver to print DNS names instead of host\naddresses.\n-n\n,\n-netns\n<NETNS>\nswitches\nip\nto the specified network namespace\nNETNS\n.\nActually it just simplifies executing of:\nip netns exec\nNETNS\nip\n[\nOPTIONS\n]\nOBJECT\n{\nCOMMAND\n|\nhelp\n}\nto\nip\n-n[etns]\nNETNS\n[\nOPTIONS\n]\nOBJECT\n{\nCOMMAND\n|\nhelp\n}\n-N\n,\n-Numeric\nPrint the number of protocol, scope, dsfield, etc directly instead of\nconverting it to human readable name.\n-a\n,\n-all\nexecutes specified command over all objects, it depends if command\nsupports this option.\n-c\n[\ncolor\n][\n=\n{\nalways\n|\nauto\n|\nnever\n}\nConfigure color output. If parameter is omitted or\nalways\n, color\noutput is enabled regardless of stdout state. If parameter is\nauto\n,\nstdout is checked to be a terminal before enabling color output. If\nparameter is\nnever\n, color output is disabled. If specified multiple\ntimes, the last one takes precedence. This flag is ignored if\n-json\nis also given.\nUsed color palette can be influenced by\nCOLORFGBG\nenvironment variable (see\nENVIRONMENT\n).\n-t\n,\n-timestamp\ndisplay current time when using monitor option.\n-ts\n,\n-tshort\nLike\n-timestamp\n, but use shorter format.\n-rc\n,\n-rcvbuf\n<SIZE>\nSet the netlink socket receive buffer size, defaults to 1MB.\n-iec\nprint human readable rates in IEC units (e.g. 1Ki = 1024).\n-br\n,\n-brief\nPrint only basic information in a tabular format for better readability.\nThis option is currently only supported by\nip addr show\n,\nip\nlink show\n&\nip neigh show\ncommands.\n-j\n,\n-json\nOutput results in JavaScript Object Notation (JSON).\n-p\n,\n-pretty\nThe default JSON format is compact and more efficient to parse but hard\nfor most users to read. This flag adds indentation for readability.\n-echo\nRequest the kernel to send the applied configuration back.\nIP - COMMAND SYNTAX\n¶\nOBJECT\n¶\naddress\n- protocol (IP or IPv6) address on a device.\naddrlabel\n- label configuration for protocol address selection.\nfou\n- Foo-over-UDP receive port configuration.\nila\n- manage identifier locator addresses (ILA).\nioam\n- manage IOAM namespaces and IOAM schemas.\nl2tp\n- tunnel ethernet over IP (L2TPv3).\nlink\n- network device.\nmacsec\n- MACsec device configuration.\nmaddress\n- multicast address.\nmonitor\n- watch for netlink messages.\nmptcp\n- manage MPTCP path manager.\nmroute\n- multicast routing cache entry.\nmrule\n- rule in multicast routing policy database.\nneighbour\n- manage ARP or NDISC cache entries.\nnetconf\n- network configuration monitoring.\nnetns\n- manage network namespaces.\nnexthop\n- manage nexthop objects.\nntable\n- manage the neighbor cache's operation.\nroute\n- routing table entry.\nrule\n- rule in routing policy database.\nsr\n- manage IPv6 segment routing.\nstats\n- manage and show interface statistics.\ntcp_metrics/tcpmetrics\n- manage TCP Metrics.\ntoken\n- manage tokenized interface identifiers.\ntunnel\n- tunnel over IP.\ntuntap\n- manage TUN/TAP devices.\nvrf\n- manage virtual routing and forwarding devices.\nxfrm\n- manage IPSec policies.\nThe names of all objects may be written in full or abbreviated\nform, for example\naddress\ncan be abbreviated as\naddr\nor just\na.\nCOMMAND\n¶\nSpecifies the action to perform on the object. The set of possible\nactions depends on the object type. As a rule, it is possible to\nadd\n,\ndelete\nand\nshow\n(or\nlist\n) objects, but\nsome objects do not allow all of these operations or have some additional\ncommands. The\nhelp\ncommand is available for all objects. It prints\nout a list of available commands and argument syntax conventions.\nIf no command is given, some default command is assumed. Usually\nit is\nlist\nor, if the objects of this class cannot be listed,\nhelp\n.\nENVIRONMENT\n¶\nCOLORFGBG\nIf set, it's value is used for detection whether background is dark or\nlight and use contrast colors for it.\nCOLORFGBG environment variable usually contains either two or\nthree values separated by semicolons; we want the last value in either\ncase. If this value is 0-6 or 8, chose colors suitable for dark\nbackground:\nCOLORFGBG=\";0\" ip -c a\nEXIT STATUS\n¶\nExit status is 0 if command was successful, and 1 if there is a\nsyntax error. If an error was reported by the kernel exit status is 2.\nEXAMPLES\n¶\nip addr\nShows addresses assigned to all network interfaces.\nip neigh\nShows the current neighbour table in kernel.\nip link set x up\nBring up interface x.\nip link set x down\nBring down interface x.\nip route\nShow table routes.\nHISTORY\n¶\nip\nwas written by Alexey N. Kuznetsov and added in Linux\n2.2.\nSEE ALSO\n¶\nip-address(8)\n,\nip-addrlabel(8)\n,\nip-fou(8)\n,\nip-ioam(8)\n,\nip-l2tp(8)\n,\nip-link(8)\n,\nip-macsec(8)\n,\nip-maddress(8)\n,\nip-monitor(8)\n,\nip-mptcp(8)\n,\nip-mroute(8)\n,\nip-neighbour(8)\n,\nip-netconf(8)\n,\nip-netns(8)\n,\nip-nexthop(8)\n,\nip-ntable(8)\n,\nip-route(8)\n,\nip-rule(8)\n,\nip-sr(8)\n,\nip-stats(8)\n,\nip-tcp_metrics(8)\n,\nip-token(8)\n,\nip-tunnel(8)\n,\nip-vrf(8)\n,\nip-xfrm(8)\nIP Command reference\nip-cref.ps\nREPORTING BUGS\n¶\nReport any bugs to the Network Developers mailing list\n<netdev@vger.kernel.org>\nwhere the development and maintenance\nis primarily done. You do not have to be subscribed to the list to send a\nmessage there.\nAUTHOR\n¶\nOriginal Manpage by Michail Litvak\n<mci@owl.openwall.com>\n20 Dec 2011\niproute2\nSource file:\nip.8.en.gz (from\niproute2 6.17.0-1\n)\nSource last updated:\n2025-10-03T20:32:30Z\nConverted to HTML:\n2025-11-03T07:15:26Z\ndebiman 15b1084, see\ngithub.com/Debian/debiman\n.\nFound a problem? See the\nFAQ\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://manpages.debian.org/unstable/iproute2/ip.8.en.html"}}
{"text": "systemctl(1) — systemd — Debian unstable — Debian Manpages\nMANPAGES\nSkip Quicknav\nIndex\nAbout Manpages\nFAQ\nService Information\n/\nunstable\n/\nsystemd\n/ systemctl(1)\nlinks\nlanguage-indep link\npackage tracker\nraw man page\ntable of contents\nNAME\nSYNOPSIS\nDESCRIPTION\nCOMMANDS\nOPTIONS\nEXIT STATUS\nENVIRONMENT\nSEE ALSO\nNOTES\nother versions\ntrixie\n257.9-1~deb13u1\ntesting\n259~rc1-1\nunstable\n259~rc2-1\nother languages\nDeutsch\nEnglish\nfrançais\nукраїнська\n中文 (zh-CN)\n繁體中文 (zh-TW)\nconflicting packages\nsystemctl\nsystemd\nScroll to navigation\nSYSTEMCTL(1)\nsystemctl\nSYSTEMCTL(1)\nNAME\n¶\nsystemctl - Control the systemd system and service manager\nSYNOPSIS\n¶\nsystemctl\n[OPTIONS...] COMMAND [UNIT...]\nDESCRIPTION\n¶\nsystemctl\nmay be used to introspect and control the state\nof the \"systemd\" system and service manager. Please refer to\nsystemd(1)\nfor an introduction into the basic concepts and\nfunctionality this tool manages.\nCOMMANDS\n¶\nThe following commands are understood:\nUnit Commands (Introspection and Modification)\n¶\nlist-units\n[\nPATTERN\n...]\nList units that\nsystemd\ncurrently has in memory.\nThis includes units that are either referenced directly or through a\ndependency, units that are pinned by applications programmatically, or units\nthat were active in the past and have failed. By default, only units which are\nactive, have pending jobs, or have failed are shown; this can be changed with\noption\n--all\n. If one or more\nPATTERN\ns are specified, only units\nmatching one of them are shown. The units that are shown are additionally\nfiltered by\n--type=\nand\n--state=\nif those options are specified.\nNote that this command does not show unit templates, but only\ninstances of unit templates. Units templates that are not instantiated are\nnot runnable, and will thus never show up in the output of this command.\nSpecifically this means that foo@.service will never be shown in this list\n— unless instantiated, e.g. as foo@bar.service. Use\nlist-unit-files\n(see below) for listing installed unit template\nfiles.\nProduces output similar to\nUNIT                         LOAD   ACTIVE SUB     DESCRIPTION\nsys-module-fuse.device       loaded active plugged /sys/module/fuse\n-.mount                      loaded active mounted Root Mount\nboot-efi.mount               loaded active mounted /boot/efi\nsystemd-journald.service     loaded active running Journal Service\nsystemd-logind.service       loaded active running Login Service\n● user@1000.service            loaded failed failed  User Manager for UID 1000\n...\nsystemd-tmpfiles-clean.timer loaded active waiting Daily Cleanup of Temporary Directories\nLOAD   = Reflects whether the unit definition was properly loaded.\nACTIVE = The high-level unit activation state, i.e. generalization of SUB.\nSUB    = The low-level unit activation state, values depend on unit type.\n123 loaded units listed. Pass --all to see loaded but inactive units, too.\nTo show all installed unit files use 'systemctl list-unit-files'.\nThe header and the last unit of a given type are underlined if the\nterminal supports that. A colored dot is shown next to services which were\nmasked, not found, or otherwise failed.\nThe LOAD column shows the load state, one of\nloaded\n,\nnot-found\n,\nbad-setting\n,\nerror\n,\nmasked\n. The\nACTIVE columns shows the general unit state, one of the following:\nTable 1. Unit ACTIVE states\nState\nDescription\nactive\nStarted, bound, plugged in, ..., depending on the unit type.\ninactive\nStopped, unbound, unplugged, ..., depending on the unit type.\nfailed\nSimilar to\ninactive\n, but the unit failed in some way (process\nreturned error code on exit, crashed, an operation timed out, or after too\nmany restarts).\nactivating\nChanging from\ninactive\nto\nactive\n.\ndeactivating\nChanging from\nactive\nto\ninactive\n.\nmaintenance\nUnit is\ninactive\nand a maintenance operation is in progress.\nreloading\nUnit is\nactive\nand it is reloading its configuration.\nrefreshing\nUnit is\nactive\nand a new mount is being activated in its\nnamespace.\nThe SUB column shows the unit-type-specific detailed state of the\nunit, possible values vary by unit type. The list of possible LOAD, ACTIVE,\nand SUB states is not constant and new systemd releases may both add and\nremove values.\nsystemctl --state=help\ncommand may be used to display the current set of possible\nvalues.\nThis is the default command.\nlist-automounts\n[\nPATTERN\n...]\nList automount units currently in memory, ordered by\nmount path. If one or more\nPATTERN\ns are specified, only automount units\nmatching one of them are shown. Produces output similar to\nWHAT        WHERE                    MOUNTED IDLE TIMEOUT UNIT\n/dev/sdb1   /mnt/test                no      120s         mnt-test.automount\nbinfmt_misc /proc/sys/fs/binfmt_misc yes     0            proc-sys-fs-binfmt_misc.automount\n2 automounts listed.\nAlso see\n--show-types\n,\n--all\n, and\n--state=\n.\nAdded in version 252.\nlist-paths\n[\nPATTERN\n...]\nList path units currently in memory, ordered by path. If\none or more\nPATTERN\ns are specified, only path units matching one of\nthem are shown. Produces output similar to\nPATH                           CONDITION         UNIT                               ACTIVATES\n/run/systemd/ask-password      DirectoryNotEmpty systemd-ask-password-plymouth.path systemd-ask-password-plymouth.service\n/run/systemd/ask-password      DirectoryNotEmpty systemd-ask-password-wall.path     systemd-ask-password-wall.service\n/var/cache/cups/org.cups.cupsd PathExists        cups.path                          cups.service\n3 paths listed.\nAlso see\n--show-types\n,\n--all\n, and\n--state=\n.\nAdded in version 254.\nlist-sockets\n[\nPATTERN\n...]\nList socket units currently in memory, ordered by\nlistening address. If one or more\nPATTERN\ns are specified, only socket\nunits matching one of them are shown. Produces output similar to\nLISTEN           UNIT                        ACTIVATES\nkobject-uevent 1 systemd-udevd-kernel.socket systemd-udevd.service\n/dev/rfkill      systemd-rfkill.socket       systemd-rfkill.service\n...\n5 sockets listed.\nNote: because the addresses might contains spaces, this output is\nnot suitable for programmatic consumption.\nAlso see\n--show-types\n,\n--all\n, and\n--state=\n.\nAdded in version 202.\nlist-timers\n[\nPATTERN\n...]\nList timer units currently in memory, ordered by the time\nthey elapse next. If one or more\nPATTERN\ns are specified, only units\nmatching one of them are shown. Produces output similar to\nNEXT                         LEFT          LAST                         PASSED     UNIT                         ACTIVATES\n-                            -             Thu 2017-02-23 13:40:29 EST  3 days ago ureadahead-stop.timer        ureadahead-stop.service\nSun 2017-02-26 18:55:42 EST  1min 14s left Thu 2017-02-23 13:54:44 EST  3 days ago systemd-tmpfiles-clean.timer systemd-tmpfiles-clean.service\nSun 2017-02-26 20:37:16 EST  1h 42min left Sun 2017-02-26 11:56:36 EST  6h ago     apt-daily.timer              apt-daily.service\nSun 2017-02-26 20:57:49 EST  2h 3min left  Sun 2017-02-26 11:56:36 EST  6h ago     snapd.refresh.timer          snapd.refresh.service\nNEXT\nshows the next time the timer will run.\nLEFT\nshows how long till the next time the timer runs.\nLAST\nshows the last time the timer ran.\nPASSED\nshows how long has passed since the timer last\nran.\nUNIT\nshows the name of the timer\nACTIVATES\nshows the name the service the timer activates\nwhen it runs.\nAlso see\n--all\nand\n--state=\n.\nAdded in version 209.\nis-active\nPATTERN\n...\nCheck whether any of the specified units are active (i.e.\nrunning). Returns an exit code\n0\nif at least one is active, or non-zero\notherwise. Unless\n--quiet\nis specified, this will also print the\ncurrent unit state to standard output.\nis-failed\n[\nPATTERN\n...]\nCheck whether any of the specified units is in the\n\"failed\" state. If no unit is specified, check whether there are any\nfailed units or ordering cycles, which corresponds to the \"degraded\"\nstate returned by\nis-system-running\n. Returns an exit code\n0\nif\nat least one has failed, non-zero otherwise. Unless\n--quiet\nis\nspecified, this will also print the current unit or system state to standard\noutput.\nAdded in version 197.\nstatus\n[\nPATTERN\n...|\nPID\n...]]\nShow runtime status information about the whole system or\nabout one or more units followed by most recent log data from the journal. If\nno positional arguments are specified, and no unit filter is given with\n--type=\n,\n--state=\n, or\n--failed\n, shows the status of the\nwhole system. If combined with\n--all\n, follows that with the status of\nall units. If positional arguments are specified, each positional argument is\ntreated as either a unit name to show, or a glob pattern to show units whose\nnames match that pattern, or a PID to show the unit containing that PID. When\n--type=\n,\n--state=\n, or\n--failed\nare used, units are\nadditionally filtered by the TYPE and ACTIVE state.\nThis function is intended to generate human-readable output. If\nyou are looking for computer-parsable output, use\nshow\ninstead. By\ndefault, this function only shows 10 lines of output and ellipsizes lines to\nfit in the terminal window. This can be changed with\n--lines\nand\n--full\n, see above. In addition,\njournalctl\n--unit=\nNAME\nor\njournalctl\n--user-unit=\nNAME\nuse a similar filter for messages and\nmight be more convenient.\nNote that this operation only displays\nruntime\nstatus, i.e.\ninformation about the current invocation of the unit (if it is running) or\nthe most recent invocation (if it is not running anymore, and has not been\nreleased from memory). Information about earlier invocations, invocations\nfrom previous system boots, or prior invocations that have already been\nreleased from memory may be retrieved via\njournalctl --unit=\n.\nsystemd implicitly loads units as necessary, so just running the\nstatus\nwill attempt to load a file. The command is thus not useful\nfor determining if something was already loaded or not. The units may\npossibly also be quickly unloaded after the operation is completed if\nthere's no reason to keep it in memory thereafter.\nExample 1. Example output from systemctl\nstatus\n$ systemctl status bluetooth\n● bluetooth.service - Bluetooth service\nLoaded: loaded (/usr/lib/systemd/system/bluetooth.service; enabled; preset: enabled)\nActive: active (running) since Wed 2017-01-04 13:54:04 EST; 1 weeks 0 days ago\nDocs: man:\nbluetoothd(8)\nMain PID: 930 (bluetoothd)\nStatus: \"Running\"\nTasks: 1\nMemory: 648.0K\nCPU: 435ms\nCGroup: /system.slice/bluetooth.service\n└─930 /usr/lib/bluetooth/bluetoothd\nJan 12 10:46:45 example.com bluetoothd[8900]: Not enough free handles to register service\nJan 12 10:46:45 example.com bluetoothd[8900]: Current Time Service could not be registered\nJan 12 10:46:45 example.com bluetoothd[8900]: gatt-time-server: Input/output error (5)\nThe dot (\"●\") uses color on supported terminals\nto summarize the unit state at a glance. Along with its color, its shape\nvaries according to its state: \"inactive\" or\n\"maintenance\" is a white circle (\"○\"),\n\"active\" is a green dot (\"●\"),\n\"deactivating\" is a white dot, \"failed\" or\n\"error\" is a red cross (\"×\"), and\n\"reloading\" or \"refreshing\" is a green clockwise circle\narrow (\"↻\").\nThe \"Loaded:\" line in the output will show\n\"loaded\" if the unit has been loaded into memory. Other possible\nvalues for \"Loaded:\" include: \"error\" if there was a\nproblem loading it, \"not-found\" if no unit file was found for this\nunit, \"bad-setting\" if an essential unit file setting could not be\nparsed and \"masked\" if the unit file has been masked. Along with\nshowing the path to the unit file, this line will also show the enablement\nstate. Enabled units are included in the dependency network between units,\nand thus are started at boot or via some other form of activation. See the\nfull table of possible enablement states — including the definition\nof \"masked\" — in the documentation for the\nis-enabled\ncommand.\nThe \"Active:\" line shows active state. The value is\nusually \"active\" or \"inactive\". Active could mean\nstarted, bound, plugged in, etc depending on the unit type. The unit could\nalso be in process of changing states, reporting a state of\n\"activating\" or \"deactivating\". A special\n\"failed\" state is entered when the service failed in some way,\nsuch as a crash, exiting with an error code or timing out. If the failed\nstate is entered the cause will be logged for later reference.\nshow\n[\nPATTERN\n...|\nJOB\n...]\nShow properties of one or more units, jobs, or the\nmanager itself. If no argument is specified, properties of the manager will be\nshown. If a unit name is specified, properties of the unit are shown, and if a\njob ID is specified, properties of the job are shown. By default, empty\nproperties are suppressed. Use\n--all\nto show those too. To select\nspecific properties to show, use\n--property=\n. This command is intended\nto be used whenever computer-parsable output is required. Use\nstatus\nif\nyou are looking for formatted human-readable output.\nMany properties shown by\nsystemctl show\nmap directly to\nconfiguration settings of the system and service manager and its unit files.\nNote that the properties shown by the command are generally more low-level,\nnormalized versions of the original configuration settings and expose\nruntime state in addition to configuration. For example, properties shown\nfor service units include the service's current main process identifier as\n\"MainPID\" (which is runtime state), and time settings are always\nexposed as properties ending in the \"...USec\" suffix even if a\nmatching configuration options end in \"...Sec\", because\nmicroseconds is the normalized time unit used internally by the system and\nservice manager.\nFor details about many of these properties, see the documentation\nof the D-Bus interface backing these properties, see\norg.freedesktop.systemd1(5)\n.\ncat\nPATTERN\n...\nShow backing files of one or more units. Prints the\n\"fragment\" and \"drop-ins\" (source files) of units. Each\nfile is preceded by a comment which includes the file name. Note that this\nshows the contents of the backing files on disk, which might not match the\nsystem manager's understanding of these units if any unit files were updated\non disk and the\ndaemon-reload\ncommand was not issued since.\nAdded in version 209.\nhelp\nPATTERN\n...|\nPID\n...\nShow manual pages for one or more units, if available. If\na PID is given, the manual pages for the unit the process belongs to are\nshown.\nAdded in version 185.\nlist-dependencies\n[\nUNIT\n...]\nShows units required and wanted by the specified units.\nThis recursively lists units following the\nRequires=\n,\nRequisite=\n,\nWants=\n,\nConsistsOf=\n,\nBindsTo=\n, and\nUpholds=\ndependencies. If no units are specified, default.target is\nimplied.\nThe units that are shown are additionally filtered by\n--type=\nand\n--state=\nif those options are specified. Note that\nwe will not be able to use a tree structure in this case, so\n--plain\nis implied.\nBy default, only target units are recursively expanded. When\n--all\nis passed, all other units are recursively expanded as\nwell.\nOptions\n--reverse\n,\n--after\n,\n--before\nmay be\nused to change what types of dependencies are shown.\nNote that this command only lists units currently loaded into\nmemory by the service manager. In particular, this command is not suitable\nto get a comprehensive list at all reverse dependencies on a specific unit,\nas it will not list the dependencies declared by units currently not\nloaded.\nAdded in version 198.\nstart\nPATTERN\n...\nStart (activate) one or more units specified on the\ncommand line.\nNote that unit glob patterns expand to names of units currently in\nmemory. Units which are not active and are not in a failed state usually are\nnot in memory, and will not be matched by any pattern. In addition, in case\nof instantiated units, systemd is often unaware of the instance name until\nthe instance has been started. Therefore, using glob patterns with\nstart\nhas limited usefulness. Also, secondary alias names of units\nare not considered.\nOption\n--all\nmay be used to also operate on inactive units\nwhich are referenced by other loaded units. Note that this is not the same\nas operating on \"all\" possible units, because as the previous\nparagraph describes, such a list is ill-defined. Nevertheless,\nsystemctl\nstart --all\nGLOB\nmay be useful if all the units that\nshould match the pattern are pulled in by some target which is known to be\nloaded.\nstop\nPATTERN\n...\nStop (deactivate) one or more units specified on the\ncommand line.\nThis command will fail if the unit does not exist or if stopping\nof the unit is prohibited (see\nRefuseManualStop=\nin\nsystemd.unit(5)\n). It will\nnot\nfail if any of the commands\nconfigured to stop the unit (\nExecStop=\n, etc.) fail, because the\nmanager will still forcibly terminate the unit.\nIf a unit that gets stopped can still be triggered by other units,\na warning containing the names of the triggering units is shown.\n--no-warn\ncan be used to suppress the warning.\nreload\nPATTERN\n...\nAsks all units listed on the command line to reload their\nconfiguration. Note that this will reload the service-specific configuration,\nnot the unit configuration file of systemd. If you want systemd to reload the\nconfiguration file of a unit, use the\ndaemon-reload\ncommand. In other\nwords: for the example case of Apache, this will reload Apache's httpd.conf in\nthe web server, not the apache.service systemd unit file.\nThis command should not be confused with the\ndaemon-reload\ncommand.\nrestart\nPATTERN\n...\nStop and then start one or more units specified on the\ncommand line. If the units are not running yet, they will be started.\nNote that restarting a unit with this command does not necessarily\nflush out all of the unit's resources before it is started again. For\nexample, the per-service file descriptor storage facility (see\nFileDescriptorStoreMax=\nin\nsystemd.service(5)\n) will remain\nintact as long as the unit has a job pending, and is only cleared when the\nunit is fully stopped and no jobs are pending anymore. If it is intended\nthat the file descriptor store is flushed out, too, during a restart\noperation an explicit\nsystemctl stop\ncommand followed by\nsystemctl\nstart\nshould be issued.\ntry-restart\nPATTERN\n...\nStop and then start one or more units specified on the\ncommand line if the units are running. This does nothing if units are not\nrunning.\nreload-or-restart\nPATTERN\n...\nReload one or more units if they support it. If not, stop\nand then start them instead. If the units are not running yet, they will be\nstarted.\nThis has a slightly differing functionality when used in\ncombination with\n--marked\n, see below.\ntry-reload-or-restart\nPATTERN\n...\nReload one or more units if they support it. If not, stop\nand then start them instead. This does nothing if the units are not running.\nAdded in version 229.\nisolate\nUNIT\nStart the unit specified on the command line and its\ndependencies and stop all others, unless they have\nIgnoreOnIsolate=yes\n(see\nsystemd.unit(5)\n). If a unit name with no extension is given, an\nextension of \".target\" will be assumed.\nThis command is dangerous, since it will immediately stop\nprocesses that are not enabled in the new target, possibly including the\ngraphical environment or terminal you are currently using.\nNote that this operation is allowed only on units where\nAllowIsolate=\nis enabled. See\nsystemd.unit(5)\nfor details.\nkill\nPATTERN\n...\nSend a UNIX process signal to one or more processes of\nthe unit. Use\n--kill-whom=\nto select which process to send the signal\nto. Use\n--signal=\nto select the signal to send. Combine with\n--kill-value=\nto enqueue a POSIX Realtime Signal with an associated\nvalue.\nclean\nPATTERN\n...\nRemove the configuration, state, cache, logs, runtime or\nfile descriptor store data of the specified units. Use\n--what=\nto\nselect which kind of resource to remove. For service units this may be used to\nremove the directories configured with\nConfigurationDirectory=\n,\nStateDirectory=\n,\nCacheDirectory=\n,\nLogsDirectory=\nand\nRuntimeDirectory=\n, see\nsystemd.exec(5)\nfor details. It may also\nbe used to clear the file descriptor store as enabled via\nFileDescriptorStoreMax=\n, see\nsystemd.service(5)\nfor details. For\ntimer units this may be used to clear out the persistent timestamp data if\nPersistent=\nis used and\n--what=state\nis selected, see\nsystemd.timer(5)\n. This command only applies to units that use either of\nthese settings. If\n--what=\nis not specified, the cache and runtime data\nas well as the file descriptor store are removed (as these three types of\nresources are generally redundant and reproducible on the next invocation of\nthe unit). Multiple values can be separated by commas. Note that the specified\nunits must be stopped to invoke this operation.\nTable 2.  Possible values for --what=\nValue\nUnit Setting\n\"runtime\"\nRuntimeDirectory=\n\"state\"\nStateDirectory=\n\"cache\"\nCacheDirectory=\n\"logs\"\nLogsDirectory=\n\"configuration\"\nConfigurationDirectory=\n\"fdstore\"\nFileDescriptorStorePreserve=\n\"all\"\nAll of the above\n\"help\"\nShow the supported values and exit\nAdded in version 243.\nfreeze\nPATTERN\n...\nFreeze one or more units specified on the command line\nusing cgroup freezer\nFreezing the unit will cause all processes contained within the\ncgroup corresponding to the unit to be suspended. Being suspended means that\nunit's processes will not be scheduled to run on CPU until thawed. Note that\nthis command is supported only on systems that use unified cgroup hierarchy.\nUnit is automatically thawed just before we execute a job against the unit,\ne.g. before the unit is stopped.\nAdded in version 246.\nthaw\nPATTERN\n...\nThaw (unfreeze) one or more units specified on the\ncommand line.\nThis is the inverse operation to the\nfreeze\ncommand and\nresumes the execution of processes in the unit's cgroup.\nAdded in version 246.\nset-property\nUNIT\nPROPERTY\n=\nVALUE\n...\nSet the specified unit properties at runtime where this\nis supported. This allows changing configuration parameter properties such as\nresource control settings at runtime. Not all properties may be changed at\nruntime, but many resource control settings (primarily those in\nsystemd.resource-control(5)\n) may. The changes are applied immediately,\nand stored on disk for future boots, unless\n--runtime\nis passed, in\nwhich case the settings only apply until the next reboot. The syntax of the\nproperty assignment follows closely the syntax of assignments in unit files.\nExample:\nsystemctl set-property foobar.service\nCPUWeight=200\nIf the specified unit appears to be inactive, the changes will be\nonly stored on disk as described previously hence they will be effective\nwhen the unit will be started.\nNote that this command allows changing multiple properties at the\nsame time, which is preferable over setting them individually.\nExample:\nsystemctl set-property foobar.service CPUWeight=200\nMemoryMax=2G IPAccounting=yes\nLike with unit file configuration settings, assigning an empty\nsetting usually resets a property to its defaults.\nExample:\nsystemctl set-property avahi-daemon.service\nIPAddressDeny=\nAdded in version 206.\nbind\nUNIT\nPATH\n[\nPATH\n]\nBind-mounts a file or directory from the host into the\nspecified unit's mount namespace. The first path argument is the source file\nor directory on the host, the second path argument is the destination file or\ndirectory in the unit's mount namespace. When the latter is omitted, the\ndestination path in the unit's mount namespace is the same as the source path\non the host. When combined with the\n--read-only\nswitch, a read-only\nbind mount is created. When combined with the\n--mkdir\nswitch, the\ndestination path is first created before the mount is applied.\nNote that this option is currently only supported for units that\nrun within a mount namespace (e.g.: with\nRootImage=\n,\nPrivateMounts=\n, etc.). This command supports bind-mounting\ndirectories, regular files, device nodes,\nAF_UNIX\nsocket nodes, as\nwell as FIFOs. The bind mount is ephemeral, and it is undone as soon as the\ncurrent unit process exists. Note that the namespace mentioned here, where\nthe bind mount will be added to, is the one where the main service process\nruns. Other processes (those exececuted by\nExecReload=\n,\nExecStartPre=\n, etc.) run in distinct namespaces.\nIf supported by the kernel, any prior mount on the selected target\nwill be replaced by the new mount. If not supported, any prior mount will be\nover-mounted, but remain pinned and inaccessible.\nAdded in version 248.\nmount-image\nUNIT\nIMAGE\n[\nPATH\n[\nPARTITION_NAME\n:\nMOUNT_OPTIONS\n]]\nMounts an image from the host into the specified unit's\nmount namespace. The first path argument is the source image on the host, the\nsecond path argument is the destination directory in the unit's mount\nnamespace (i.e. inside\nRootImage=\n/\nRootDirectory=\n). The following\nargument, if any, is interpreted as a colon-separated tuple of partition name\nand comma-separated list of mount options for that partition. The format is\nthe same as the service\nMountImages=\nsetting. When combined with the\n--read-only\nswitch, a ready-only mount is created. When combined with\nthe\n--mkdir\nswitch, the destination path is first created before the\nmount is applied.\nNote that this option is currently only supported for units that\nrun within a mount namespace (i.e. with\nRootImage=\n,\nPrivateMounts=\n, etc.). Note that the namespace mentioned here where\nthe image mount will be added to, is the one where the main service process\nruns. Note that the namespace mentioned here, where the bind mount will be\nadded to, is the one where the main service process runs. Other processes\n(those exececuted by\nExecReload=\n,\nExecStartPre=\n, etc.) run in\ndistinct namespaces.\nIf supported by the kernel, any prior mount on the selected target\nwill be replaced by the new mount. If not supported, any prior mount will be\nover-mounted, but remain pinned and inaccessible.\nExample:\nsystemctl mount-image foo.service /tmp/img.raw /var/lib/image root:ro,nosuid\nsystemctl mount-image --mkdir bar.service /tmp/img.raw /var/lib/baz/img\nAdded in version 248.\nservice-log-level\nSERVICE\n[\nLEVEL\n]\nIf the\nLEVEL\nargument is not given, print the\ncurrent log level as reported by service\nSERVICE\n.\nIf the optional argument\nLEVEL\nis provided, then change the\ncurrent log level of the service to\nLEVEL\n. The log level should be a\ntypical syslog log level, i.e. a value in the range 0...7 or one of the\nstrings\nemerg\n,\nalert\n,\ncrit\n,\nerr\n,\nwarning\n,\nnotice\n,\ninfo\n,\ndebug\n; see\nsyslog(3)\nfor\ndetails.\nThe service must have the appropriate\nBusName=\ndestination\nproperty and also implement the\ngeneric\norg.freedesktop.LogControl1(5)\ninterface. (systemctl will use\nthe generic D-Bus protocol to access the\norg.freedesktop.LogControl1.LogLevel interface for the D-Bus name\ndestination\n.)\nAdded in version 247.\nservice-log-target\nSERVICE\n[\nTARGET\n]\nIf the\nTARGET\nargument is not given, print the\ncurrent log target as reported by service\nSERVICE\n.\nIf the optional argument\nTARGET\nis provided, then change\nthe current log target of the service to\nTARGET\n. The log target\nshould be one of the strings\nconsole\n(for log output to the service's\nstandard error stream),\nkmsg\n(for log output to the kernel log\nbuffer),\njournal\n(for log output to\nsystemd-journald.service(8)\nusing the native journal protocol),\nsyslog\n(for log output to the classic syslog socket /dev/log),\nnull\n(for no log output whatsoever) or\nauto\n(for an\nautomatically determined choice, typically equivalent to\nconsole\nif\nthe service is invoked interactively, and\njournal\nor\nsyslog\notherwise).\nFor most services, only a small subset of log targets make sense.\nIn particular, most \"normal\" services should only implement\nconsole\n,\njournal\n, and\nnull\n. Anything else is only\nappropriate for low-level services that are active in very early boot before\nproper logging is established.\nThe service must have the appropriate\nBusName=\ndestination\nproperty and also implement the\ngeneric\norg.freedesktop.LogControl1(5)\ninterface. (systemctl will use\nthe generic D-Bus protocol to access the\norg.freedesktop.LogControl1.LogLevel interface for the D-Bus name\ndestination\n.)\nAdded in version 247.\nreset-failed [\nPATTERN\n...]\nReset the \"failed\" state of the specified\nunits, or if no unit name is passed, reset the state of all units. When a unit\nfails in some way (i.e. process exiting with non-zero error code, terminating\nabnormally or timing out), it will automatically enter the \"failed\"\nstate and its exit code and status is recorded for introspection by the\nadministrator until the service is stopped/re-started or reset with this\ncommand.\nIn addition to resetting the \"failed\" state of a unit it\nalso resets various other per-unit properties: the start rate limit counter\nof all unit types is reset to zero, as is the restart counter of service\nunits. Thus, if a unit's start limit (as configured with\nStartLimitIntervalSec=\n/\nStartLimitBurst=\n) is hit and the unit\nrefuses to be started again, use this command to make it startable\nagain.\nwhoami [\nPID\n...]\nReturns the units the processes referenced by the given\nPIDs belong to (one per line). If no PID is specified returns the unit the\nsystemctl\ncommand is invoked in.\nAdded in version 254.\nUnit File Commands\n¶\nlist-unit-files\n[\nPATTERN...\n]\nList unit files installed on the system, in combination\nwith their enablement state (as reported by\nis-enabled\n). If one or more\nPATTERN\ns are specified, only unit files whose name matches one of them\nare shown (patterns matching unit file system paths are not supported).\nUnlike\nlist-units\nthis command will list template units in\naddition to explicitly instantiated units.\nAdded in version 233.\nenable\nUNIT\n...\n,\nenable\nPATH\n...\nEnable one or more units or unit instances. This will\ncreate a set of symlinks, as encoded in the [Install] sections of the\nindicated unit files. After the symlinks have been created, the system manager\nconfiguration is reloaded (in a way equivalent to\ndaemon-reload\n), in\norder to ensure the changes are taken into account immediately. Note that this\ndoes\nnot\nhave the effect of also starting any of the units being\nenabled. If this is desired, combine this command with the\n--now\nswitch, or invoke\nstart\nwith appropriate arguments later. Note that in\ncase of unit instance enablement (i.e. enablement of units of the form\nfoo@bar.service), symlinks named the same as instances are created in the unit\nconfiguration directory, however they point to the single template unit file\nthey are instantiated from.\nThis command expects either valid unit names (in which case\nvarious unit file directories are automatically searched for unit files with\nappropriate names), or absolute paths to unit files (in which case these\nfiles are read directly). If a specified unit file is located outside of the\nusual unit file directories, an additional symlink is created, linking it\ninto the unit configuration path, thus ensuring it is found when requested\nby commands such as\nstart\n. The file system where the linked unit\nfiles are located must be accessible when systemd is started (e.g. anything\nunderneath /home/ or /var/ is not allowed, unless those directories are\nlocated on the root file system).\nThis command will print the file system operations executed. This\noutput may be suppressed by passing\n--quiet\n.\nNote that this operation creates only the symlinks suggested in\nthe [Install] section of the unit files. While this command is the\nrecommended way to manipulate the unit configuration directory, the\nadministrator is free to make additional changes manually by placing or\nremoving symlinks below this directory. This is particularly useful to\ncreate configurations that deviate from the suggested default installation.\nIn this case, the administrator must make sure to invoke\ndaemon-reload\nmanually as necessary, in order to ensure the changes\nare taken into account.\nWhen using this operation on units without install information, a\nwarning about it is shown.\n--no-warn\ncan be used to suppress the\nwarning.\nEnabling units should not be confused with starting (activating)\nunits, as done by the\nstart\ncommand. Enabling and starting units is\northogonal: units may be enabled without being started and started without\nbeing enabled. Enabling simply hooks the unit into various suggested places\n(for example, so that the unit is automatically started on boot or when a\nparticular kind of hardware is plugged in). Starting actually spawns the\ndaemon process (in case of service units), or binds the socket (in case of\nsocket units), and so on.\nDepending on whether\n--system\n,\n--user\n,\n--runtime\n, or\n--global\nis specified, this enables the unit for\nthe system, for the calling user only, for only this boot of the system, or\nfor all future logins of all users. Note that in the last case, no systemd\ndaemon configuration is reloaded.\nUsing\nenable\non masked units is not supported and results\nin an error.\ndisable\nUNIT\n...\nDisables one or more units. This removes all symlinks to\nthe unit files backing the specified units from the unit configuration\ndirectory, and hence undoes any changes made by\nenable\nor\nlink\n.\nNote that this removes\nall\nsymlinks to matching unit files, including\nmanually created symlinks, and not just those actually created by\nenable\nor\nlink\n. Note that while\ndisable\nundoes the effect\nof\nenable\n, the two commands are otherwise not symmetric, as\ndisable\nmay remove more symlinks than a prior\nenable\ninvocation\nof the same unit created.\nThis command expects valid unit names only, it does not accept\npaths to unit files.\nIn addition to the units specified as arguments, all units are\ndisabled that are listed in the\nAlso=\nsetting contained in the\n[Install] section of any of the unit files being operated on.\nThis command implicitly reloads the system manager configuration\nafter completing the operation. Note that this command does not implicitly\nstop the units that are being disabled. If this is desired, either combine\nthis command with the\n--now\nswitch, or invoke the\nstop\ncommand\nwith appropriate arguments later.\nThis command will print information about the file system\noperations (symlink removals) executed. This output may be suppressed by\npassing\n--quiet\n.\nIf a unit gets disabled but its triggering units are still active,\na warning containing the names of the triggering units is shown.\n--no-warn\ncan be used to suppress the warning.\nWhen this command is used with\n--user\n, the units being\noperated on might still be enabled in global scope, and thus get started\nautomatically even after a successful disablement in user scope. In this\ncase, a warning about it is shown, which can be suppressed using\n--no-warn\n.\nThis command honors\n--system\n,\n--user\n,\n--runtime\n,\n--global\nand\n--no-warn\nin a similar way as\nenable\n.\nAdded in version 238.\nreenable\nUNIT\n...\nReenable one or more units, as specified on the command\nline. This is a combination of\ndisable\nand\nenable\nand is useful\nto reset the symlinks a unit file is enabled with to the defaults configured\nin its [Install] section. This command expects a unit name only, it does not\naccept paths to unit files.\nThis command implicitly reloads the system manager configuration\nafter completing the operation. Note that this command does not implicitly\nrestart the units that are being disabled. If this is desired, either\ncombine this command with the\n--now\nswitch, or invoke the\ntry-restart\ncommand with appropriate arguments later.\nAdded in version 238.\npreset\nUNIT\n...\nReset the enable/disable status of one or more unit\nfiles, as specified on the command line, to the defaults configured in the\npreset policy files. This has the same effect as\ndisable\nor\nenable\n, depending how the unit is listed in the preset files.\nUse\n--preset-mode=\nto control whether units shall be\nenabled and disabled, or only enabled, or only disabled.\nIf the unit carries no install information, it will be silently\nignored by this command.\nUNIT\nmust be the real unit name, any alias\nnames are ignored silently.\nFor more information on the preset policy format, see\nsystemd.preset(5)\n.\nAdded in version 238.\npreset-all\nResets all installed unit files to the defaults\nconfigured in the preset policy file (see above).\nUse\n--preset-mode=\nto control whether units shall be\nenabled and disabled, or only enabled, or only disabled.\nAdded in version 215.\nis-enabled\nUNIT\n...\nChecks whether any of the specified unit files are\nenabled (as with\nenable\n). Returns an exit code of 0 if at least one is\nenabled, non-zero otherwise. Prints the current enable status (see table). To\nsuppress this output, use\n--quiet\n. To show installation targets, use\n--full\n.\nTable 3.  is-enabled output\nName\nDescription\nExit Code\n\"enabled\"\nEnabled via .wants/, .requires/ or\nAlias=\nsymlinks\n(permanently in /etc/systemd/system/, or transiently in\n/run/systemd/system/).\n0\n\"enabled-runtime\"\n\"linked\"\nMade available through one or more symlinks to the unit file\n(permanently in /etc/systemd/system/ or transiently in\n/run/systemd/system/), even though the unit file might reside outside of\nthe unit file search path.\n> 0\n\"linked-runtime\"\n\"alias\"\nThe name is an alias (symlink to another unit file).\n0\n\"masked\"\nCompletely disabled, so that any start operation on it fails\n(permanently in /etc/systemd/system/ or transiently in\n/run/systemd/systemd/).\n> 0\n\"masked-runtime\"\n\"static\"\nThe unit file is not enabled, and has no provisions for enabling in the\n[Install] unit file section.\n0\n\"indirect\"\nThe unit file itself is not enabled, but it has a non-empty\nAlso=\nsetting in the [Install] unit file section, listing other unit files that\nmight be enabled, or it has an alias under a different name through a\nsymlink that is not specified in\nAlso=\n. For template unit files, an\ninstance different than the one specified in\nDefaultInstance=\nis\nenabled.\n0\n\"disabled\"\nThe unit file is not enabled, but contains an [Install] section with\ninstallation instructions.\n> 0\n\"generated\"\nThe unit file was generated dynamically via a generator tool. See\nsystemd.generator(7)\n. Generated unit files may not be enabled, they\nare enabled implicitly by their generator.\n0\n\"transient\"\nThe unit file has been created dynamically with the runtime API.\nTransient units may not be enabled.\n0\n\"bad\"\nThe unit file is invalid or another error occurred. Note that\nis-enabled\nwill not actually return this state, but print an error\nmessage instead. However, the unit file listing printed by\nlist-unit-files\nmight show it.\n> 0\n\"not-found\"\nThe unit file does not exist.\n4\nAdded in version 238.\nmask\nUNIT\n...\nMask one or more units, as specified on the command line.\nThis will link these unit files to /dev/null, making it impossible to start\nthem. This is a stronger version of\ndisable\n, since it prohibits all\nkinds of activation of the unit, including enablement and manual activation.\nUse this option with care. This honors the\n--runtime\noption to only\nmask temporarily until the next reboot of the system. The\n--now\noption\nmay be used to ensure that the units are also stopped. This command expects\nvalid unit names only, it does not accept unit file paths.\nNote that this will create a symlink under the unit's name in\n/etc/systemd/system/ (in case\n--runtime\nis not specified) or\n/run/systemd/system/ (in case\n--runtime\nis specified). If a matching\nunit file already exists under these directories this operation will hence\nfail. This means that the operation is primarily useful to mask units\nshipped by the vendor (as those are shipped in /usr/lib/systemd/system/ and\nnot the aforementioned two directories), but typically does not work for\nunits created locally (as those are typically placed precisely in the two\naforementioned directories). Similar restrictions apply for\n--user\nmode, in which case the directories are below the user's home directory\nhowever.\nIf a unit gets masked but its triggering units are still active, a\nwarning containing the names of the triggering units is shown.\n--no-warn\ncan be used to suppress the warning.\nAdded in version 238.\nunmask\nUNIT\n...\nUnmask one or more unit files, as specified on the\ncommand line. This will undo the effect of\nmask\n. This command expects\nvalid unit names only, it does not accept unit file paths.\nAdded in version 238.\nlink\nPATH\n...\nLink a unit file that is not in the unit file search path\ninto the unit file search path. This command expects an absolute path to a\nunit file. The effect of this may be undone with\ndisable\n. The effect of\nthis command is that a unit file is made available for commands such as\nstart\n, even though it is not installed directly in the unit search\npath. The file system where the linked unit files are located must be\naccessible when systemd is started (e.g. anything underneath /home/ or /var/\nis not allowed, unless those directories are located on the root file system).\nAdded in version 233.\nrevert\nUNIT\n...\nRevert one or more unit files to their vendor versions.\nThis command removes drop-in configuration files that modify the specified\nunits, as well as any user-configured unit file that overrides a matching\nvendor supplied unit file. Specifically, for a unit \"foo.service\"\nthe matching directories \"foo.service.d/\" with all their contained\nfiles are removed, both below the persistent and runtime configuration\ndirectories (i.e. below /etc/systemd/system and /run/systemd/system); if the\nunit file has a vendor-supplied version (i.e. a unit file located below /usr/)\nany matching persistent or runtime unit file that overrides it is removed,\ntoo. Note that if a unit file has no vendor-supplied version (i.e. is only\ndefined below /etc/systemd/system or /run/systemd/system, but not in a unit\nfile stored below /usr/), then it is not removed. Also, if a unit is masked,\nit is unmasked.\nEffectively, this command may be used to undo all changes made\nwith\nsystemctl edit\n,\nsystemctl set-property\nand\nsystemctl\nmask\nand puts the original unit file with its settings back in\neffect.\nAdded in version 230.\nadd-wants\nTARGET\nUNIT\n...\n,\nadd-requires\nTARGET\nUNIT\n...\nAdds \"Wants=\" or \"Requires=\"\ndependencies, respectively, to the specified\nTARGET\nfor one or more\nunits.\nThis command honors\n--system\n,\n--user\n,\n--runtime\nand\n--global\nin a way similar to\nenable\n.\nAdded in version 217.\nedit\nUNIT\n...\nEdit or replace a drop-in snippet or the main unit file,\nto extend or override the definition of the specified unit.\nDepending on whether\n--system\n(the default),\n--user\n,\nor\n--global\nis specified, this command will operate on the system\nunit files, unit files for the calling user, or the unit files shared\nbetween all users.\nThe editor (see the \"Environment\" section below) is\ninvoked on temporary files which will be written to the real location if the\neditor exits successfully. After the editing is finished, configuration is\nreloaded, equivalent to\nsystemctl daemon-reload --system\nor\nsystemctl daemon-reload --user\n. For\nedit --global\n, the reload\nis not performed and the edits will take effect only for subsequent logins\n(or after a reload is requested in a different way).\nIf\n--full\nis specified, a replacement for the main unit\nfile will be created or edited. Otherwise, a drop-in file will be created or\nedited.\nIf\n--drop-in=\nis specified, the given drop-in file name\nwill be used instead of the default override.conf.\nThe unit must exist, i.e. its main unit file must be present. If\n--force\nis specified, this requirement is ignored and a new unit may\nbe created (with\n--full\n), or a drop-in for a nonexistent unit may be\ncreated.\nIf\n--runtime\nis specified, the changes will be made\ntemporarily in /run/ and they will be lost on the next reboot.\nIf\n--stdin\nis specified, the new contents will be read from\nstandard input. In this mode, the old contents of the file are\ndiscarded.\nIf the temporary file is empty upon exit, the modification of the\nrelated unit is canceled.\nNote that this command cannot be used to remotely edit units and\nthat you cannot temporarily edit units which are in /etc/, since they take\nprecedence over /run/.\nAdded in version 218.\nget-default\nReturn the default target to boot into. This returns the\ntarget unit name default.target is aliased (symlinked) to.\nAdded in version 205.\nset-default\nTARGET\nSet the default target to boot into. This sets (symlinks)\nthe default.target alias to the given target unit.\nAdded in version 205.\nMachine Commands\n¶\nlist-machines\n[\nPATTERN\n...]\nList the host and all running local containers with their\nstate. If one or more\nPATTERN\ns are specified, only containers matching\none of them are shown.\nAdded in version 212.\nJob Commands\n¶\nlist-jobs\n[\nPATTERN...\n]\nList jobs that are in progress. If one or more\nPATTERN\ns are specified, only jobs for units matching one of them are\nshown.\nWhen combined with\n--after\nor\n--before\nthe list is\naugmented with information on which other job each job is waiting for, and\nwhich other jobs are waiting for it, see above.\nAdded in version 233.\ncancel\n[\nJOB\n...]\nCancel one or more jobs specified on the command line by\ntheir numeric job IDs. If no job ID is specified, cancel all pending jobs.\nAdded in version 233.\nEnvironment Commands\n¶\nsystemd\nsupports an environment block that is passed to\nprocesses the manager spawns. The names of the variables can contain ASCII\nletters, digits, and the underscore character. Variable names cannot be\nempty or start with a digit. In variable values, most characters are\nallowed, but the whole sequence must be valid UTF-8. (Note that control\ncharacters like newline (\nNL\n), tab (\nTAB\n), or the escape\ncharacter (\nESC\n),\nare\nvalid ASCII and thus valid UTF-8). The\ntotal length of the environment block is limited to\n_SC_ARG_MAX\nvalue\ndefined by\nsysconf(3)\n.\nshow-environment\nDump the systemd manager environment block. This is the\nenvironment block that is passed to all processes the manager spawns. The\nenvironment block will be dumped in straightforward form suitable for sourcing\ninto most shells. If no special characters or whitespace is present in the\nvariable values, no escaping is performed, and the assignments have the form\n\"VARIABLE=value\". If whitespace or characters which have special\nmeaning to the shell are present, dollar-single-quote escaping is used, and\nassignments have the form \"VARIABLE=$'value'\". This syntax is known\nto be supported by\nbash(1)\n,\nzsh(1)\n,\nksh(1)\n, and\nbusybox(1)\n's\nash\n(1), but not\ndash(1)\nor\nfish(1)\n.\nNote that this shows the\neffective\nblock, i.e. the\ncombination of environment variables configured via configuration files,\nenvironment generators and via IPC (i.e. via the\nset-environment\ndescribed below). At the moment a unit process is forked off, this combined\nenvironment block will be further combined with per-unit environment\nvariables, which are not visible in this command.\nset-environment\nVARIABLE=VALUE\n...\nSet one or more service manager environment variables, as\nspecified on the command line. This command will fail if variable names and\nvalues do not conform to the rules listed above.\nNote that this operates on an environment block separate from the\nenvironment block configured from service manager configuration and\nenvironment generators. Whenever a process is invoked the two blocks are\ncombined (also incorporating any per-service environment variables), and\npassed to it. The\nshow-environment\nverb will show the combination of\nthe blocks, see above.\nAdded in version 233.\nunset-environment\nVARIABLE\n...\nUnset one or more systemd manager environment variables.\nIf only a variable name is specified, it will be removed regardless of its\nvalue. If a variable and a value are specified, the variable is only removed\nif it has the specified value.\nNote that this operates on an environment block separate from the\nenvironment block configured from service manager configuration and\nenvironment generators. Whenever a process is invoked the two blocks are\ncombined (also incorporating any per-service environment variables), and\npassed to it. The\nshow-environment\nverb will show the combination of\nthe blocks, see above. Note that this means this command cannot be used to\nunset environment variables defined in the service manager configuration\nfiles or via generators.\nAdded in version 233.\nimport-environment\nVARIABLE...\nImport all, one or more environment variables set on the\nclient into the systemd manager environment block. If a list of environment\nvariable names is passed, client-side values are then imported into the\nmanager's environment block. If any names are not valid environment variable\nnames or have invalid values according to the rules described above, an error\nis raised. If no arguments are passed, the entire environment block inherited\nby the\nsystemctl\nprocess is imported. In this mode, any inherited\ninvalid environment variables are quietly ignored.\nImporting of the full inherited environment block (calling this\ncommand without any arguments) is deprecated. A shell will set dozens of\nvariables which only make sense locally and are only meant for processes\nwhich are descendants of the shell. Such variables in the global environment\nblock are confusing to other processes.\nAdded in version 209.\nManager State Commands\n¶\ndaemon-reload\nReload the systemd manager configuration. This will rerun\nall generators (see\nsystemd.generator(7)\n), reload all unit files, and\nrecreate the entire dependency tree. While the daemon is being reloaded, all\nsockets systemd listens on behalf of user configuration will stay accessible.\nThis command should not be confused with the\nreload\ncommand.\ndaemon-reexec\nReexecute the systemd manager. This will serialize the\nmanager state, reexecute the process and deserialize the state again. This\ncommand is of little use except for debugging and package upgrades. Sometimes,\nit might be helpful as a heavy-weight\ndaemon-reload\n. While the daemon\nis being reexecuted, all sockets systemd listening on behalf of user\nconfiguration will stay accessible.\nlog-level\n[\nLEVEL\n]\nIf no argument is given, print the current log level of\nthe manager. If an optional argument\nLEVEL\nis provided, then the\ncommand changes the current log level of the manager to\nLEVEL\n(accepts\nthe same values as\n--log-level=\ndescribed in\nsystemd(1)\n).\nAdded in version 244.\nlog-target\n[\nTARGET\n]\nIf no argument is given, print the current log target of\nthe manager. If an optional argument\nTARGET\nis provided, then the\ncommand changes the current log target of the manager to\nTARGET\n(accepts the same values as\n--log-target=\n, described in\nsystemd(1)\n).\nAdded in version 244.\nservice-watchdogs\n[yes|no]\nIf no argument is given, print the current state of\nservice runtime watchdogs of the manager. If an optional boolean argument is\nprovided, then globally enables or disables the service runtime watchdogs\n(\nWatchdogSec=\n) and emergency actions (e.g.\nOnFailure=\nor\nStartLimitAction=\n); see\nsystemd.service(5)\n. The hardware\nwatchdog is not affected by this setting.\nAdded in version 244.\nSystem Commands\n¶\nis-system-running\nChecks whether the system is operational. This returns\nsuccess (exit code 0) when the system is fully up and running, specifically\nnot in startup, shutdown or maintenance mode, and with no failed services.\nFailure is returned otherwise (exit code non-zero). In addition, the current\nstate is printed in a short string to standard output, see the table below.\nUse\n--quiet\nto suppress this output.\nUse\n--wait\nto wait until the boot process is completed\nbefore printing the current state and returning the appropriate error\nstatus. If\n--wait\nis in use, states\ninitializing\nor\nstarting\nwill not be reported, instead the command will block until a\nlater state (such as\nrunning\nor\ndegraded\n) is reached.\nTable 4. is-system-running output\nName\nDescription\nExit Code\ninitializing\nEarly bootup, before basic.target is reached or the\nmaintenance\nstate entered.\n> 0\nstarting\nLate bootup, before the job queue becomes idle for the first time, or\none of the rescue targets are reached.\n> 0\nrunning\nThe system is fully operational.\n0\ndegraded\nThe system is operational but one or more units failed.\n> 0\nmaintenance\nThe rescue or emergency target is active.\n> 0\nstopping\nThe manager is shutting down.\n> 0\noffline\nThe manager is not running. Specifically, this is the operational state\nif an incompatible program is running as system manager (PID 1).\n> 0\nunknown\nThe operational state could not be determined, due to lack of resources\nor another error cause.\n> 0\nAdded in version 215.\ndefault\nEnter default mode. This is equivalent to\nsystemctl\nisolate default.target\n. This operation is blocking by default, use\n--no-block\nto request asynchronous behavior.\nrescue\nEnter rescue mode. This is equivalent to\nsystemctl\nisolate rescue.target\n. This operation is blocking by default, use\n--no-block\nto request asynchronous behavior.\nemergency\nEnter emergency mode. This is equivalent to\nsystemctl\nisolate emergency.target\n. This operation is blocking by default, use\n--no-block\nto request asynchronous behavior.\nhalt\nShut down and halt the system. This is mostly equivalent\nto\nsystemctl start halt.target --job-mode=replace-irreversibly\n--no-block\n, but also prints a wall message to all users. This command is\nasynchronous; it will return after the halt operation is enqueued, without\nwaiting for it to complete. Note that this operation will simply halt the OS\nkernel after shutting down, leaving the hardware powered on. Use\nsystemctl\npoweroff\nfor powering off the system (see below).\nIf combined with\n--force\n, shutdown of all running services\nis skipped, however all processes are killed and all file systems are\nunmounted or mounted read-only, immediately followed by the system halt. If\n--force\nis specified twice, the operation is immediately executed\nwithout terminating any processes or unmounting any file systems. This may\nresult in data loss. Note that when\n--force\nis specified twice the\nhalt operation is executed by\nsystemctl\nitself, and the system\nmanager is not contacted. This means the command should succeed even when\nthe system manager has crashed.\nIf combined with\n--when=\n, shutdown will be scheduled after\nthe given timestamp. And\n--when=cancel\nwill cancel the shutdown.\npoweroff\nShut down and power-off the system. This is mostly\nequivalent to\nsystemctl start poweroff.target\n--job-mode=replace-irreversibly --no-block\n, but also prints a wall message\nto all users. This command is asynchronous; it will return after the power-off\noperation is enqueued, without waiting for it to complete.\nThis command honors\n--force\nand\n--when=\nin a similar\nway as\nhalt\n.\nreboot\nShut down and reboot the system.\nThis command mostly equivalent to\nsystemctl start reboot.target\n--job-mode=replace-irreversibly --no-block\n, but also prints a wall\nmessage to all users. This command is asynchronous; it will return after the\nreboot operation is enqueued, without waiting for it to complete.\nIf the switch\n--reboot-argument=\nis given, it will be\npassed as the optional argument to the\nreboot(2)\nsystem call.\nOptions\n--boot-loader-entry=\n,\n--boot-loader-menu=\n,\nand\n--firmware-setup\ncan be used to select what to do\nafter\nthe reboot. See the descriptions of those options for details.\nThis command honors\n--force\nand\n--when=\nin a similar\nway as\nhalt\n.\nIf a new kernel has been loaded via\nkexec --load\n, a\nkexec\nwill be performed instead of a reboot, unless\n\"SYSTEMCTL_SKIP_AUTO_KEXEC=1\" has been set. If a new root file\nsystem has been set up on \"/run/nextroot/\", a\nsoft-reboot\nwill be performed instead of a reboot, unless\n\"SYSTEMCTL_SKIP_AUTO_SOFT_REBOOT=1\" has been set.\nAdded in version 246.\nkexec\nShut down and reboot the system via\nkexec\n. This\ncommand will load a kexec kernel if one was not loaded yet or fail. A kernel\nmay be loaded earlier by a separate step, this is particularly useful if a\ncustom initrd or additional kernel command line options are desired. The\n--force\ncan be used to continue without a kexec kernel, i.e. to perform\na normal reboot. The final reboot step is equivalent to\nsystemctl start\nkexec.target --job-mode=replace-irreversibly --no-block\n.\nTo load a kernel, an enumeration is performed following the\nUAPI.1 Boot Loader Specification\n[1], and the default boot entry is\nloaded. For this step to succeed, the system must be using UEFI and the boot\nloader entries must be configured appropriately.\nbootctl list\nmay be\nused to list boot entries, see\nbootctl(1)\n.\nThis command is asynchronous; it will return after the reboot\noperation is enqueued, without waiting for it to complete.\nThis command honors\n--force\nand\n--when=\nsimilarly to\nhalt\n.\nIf a new kernel has been loaded via\nkexec --load\n, a\nkexec\nwill be performed when\nreboot\nis invoked, unless\n\"SYSTEMCTL_SKIP_AUTO_KEXEC=1\" has been set.\nsoft-reboot\nShut down and reboot userspace. This is equivalent to\nsystemctl start soft-reboot.target --job-mode=replace-irreversibly\n--no-block\n. This command is asynchronous; it will return after the reboot\noperation is enqueued, without waiting for it to complete.\nThis command honors\n--force\nand\n--when=\nin a similar\nway as\nhalt\n.\nThis operation only reboots userspace, leaving the kernel running.\nSee\nsystemd-soft-reboot.service(8)\nfor details.\nIf a new root file system has been set up on\n\"/run/nextroot/\", a\nsoft-reboot\nwill be performed when\nreboot\nis invoked, unless\n\"SYSTEMCTL_SKIP_AUTO_SOFT_REBOOT=1\" has been set.\nAdded in version 254.\nexit\n[\nEXIT_CODE\n]\nAsk the service manager to quit. This is only supported\nfor user service managers (i.e. in conjunction with the\n--user\noption)\nor in containers and is equivalent to\npoweroff\notherwise. This command\nis asynchronous; it will return after the exit operation is enqueued, without\nwaiting for it to complete.\nThe service manager will exit with the specified exit code, if\nEXIT_CODE\nis passed.\nAdded in version 227.\nswitch-root\n[\nROOT\n[\nINIT\n]]\nSwitches to a different root directory and executes a new\nsystem manager process below it. This is intended for use in the initrd, and\nwill transition from the initrd's system manager process (a.k.a.\n\"init\" process, PID 1) to the main system manager process which is\nloaded from the actual host root files system. This call takes two arguments:\nthe directory that is to become the new root directory, and the path to the\nnew system manager binary below it to execute as PID 1. If both are omitted or\nthe former is an empty string it defaults to /sysroot/. If the latter is\nomitted or is an empty string, a systemd binary will automatically be searched\nfor and used as service manager. If the system manager path is omitted, equal\nto the empty string or identical to the path to the systemd binary, the state\nof the initrd's system manager process is passed to the main system manager,\nwhich allows later introspection of the state of the services involved in the\ninitrd boot phase.\nAdded in version 209.\nsleep\nPut the system to sleep, through\nsuspend\n,\nhibernate\n,\nhybrid-sleep\n, or\nsuspend-then-hibernate\n. The\nsleep operation to use is automatically selected by\nsystemd-logind.service(8)\n. By default,\nsuspend-then-hibernate\nis\nused, and falls back to\nsuspend\nand then\nhibernate\nif not\nsupported. Refer to\nSleepOperation=\nsetting in\nlogind.conf(5)\nfor more details. This command is asynchronous, and will return after the\nsleep operation is successfully enqueued. It will not wait for the\nsleep/resume cycle to complete.\nAdded in version 256.\nsuspend\nSuspend the system. This will trigger activation of the\nspecial target unit suspend.target. This command is asynchronous, and will\nreturn after the suspend operation is successfully enqueued. It will not wait\nfor the suspend/resume cycle to complete.\nIf\n--force\nis specified, and\nsystemd-logind\nreturned\nerror for the operation, the error will be ignored and the operation will be\ntried again directly through starting the target unit.\nhibernate\nHibernate the system. This will trigger activation of the\nspecial target unit hibernate.target. This command is asynchronous, and will\nreturn after the hibernation operation is successfully enqueued. It will not\nwait for the hibernate/thaw cycle to complete.\nThis command honors\n--force\nin the same way as\nsuspend\n.\nhybrid-sleep\nHibernate and suspend the system. This will trigger\nactivation of the special target unit hybrid-sleep.target. This command is\nasynchronous, and will return after the hybrid sleep operation is successfully\nenqueued. It will not wait for the sleep/wake-up cycle to complete.\nThis command honors\n--force\nin the same way as\nsuspend\n.\nAdded in version 196.\nsuspend-then-hibernate\nSuspend the system and hibernate it when the battery is\nlow, or when the delay specified in systemd-sleep.conf elapsed. This will\ntrigger activation of the special target unit suspend-then-hibernate.target.\nThis command is asynchronous, and will return after the hybrid sleep operation\nis successfully enqueued. It will not wait for the sleep/wake-up or\nhibernate/thaw cycle to complete.\nThis command honors\n--force\nin the same way as\nsuspend\n.\nAdded in version 240.\nParameter Syntax\n¶\nUnit commands listed above take either a single unit name\n(designated as\nUNIT\n), or multiple unit specifications (designated as\nPATTERN\n...). In the first case, the unit name with or without a\nsuffix must be given. If the suffix is not specified (unit name is\n\"abbreviated\"), systemctl will append a suitable suffix,\n\".service\" by default, and a type-specific suffix in case of\ncommands which operate only on specific unit types. For example,\n# systemctl start sshd\nand\n# systemctl start sshd.service\nare equivalent, as are\n# systemctl isolate default\nand\n# systemctl isolate default.target\nNote that (absolute) paths to device nodes are automatically\nconverted to device unit names, and other (absolute) paths to mount unit\nnames.\n# systemctl status /dev/sda\n# systemctl status /home\nare equivalent to:\n# systemctl status dev-sda.device\n# systemctl status home.mount\nIn the second case, shell-style globs will be matched against the\nprimary names of all units currently in memory; literal unit names, with or\nwithout a suffix, will be treated as in the first case. This means that\nliteral unit names always refer to exactly one unit, but globs may match\nzero units and this is not considered an error.\nGlob patterns use\nfnmatch(3)\n, so normal shell-style\nglobbing rules are used, and \"*\", \"?\", \"[]\"\nmay be used. See\nglob(7)\nfor more details. The patterns are matched\nagainst the primary names of units currently in memory, and patterns which\ndo not match anything are silently skipped. For example:\n# systemctl stop \"sshd@*.service\"\nwill stop all sshd@.service instances. Note that alias names of\nunits, and units that are not in memory are not considered for glob\nexpansion.\nFor unit file commands, the specified\nUNIT\nshould be the\nname of the unit file (possibly abbreviated, see above), or the absolute\npath to the unit file:\n# systemctl enable foo.service\nor\n# systemctl link /path/to/foo.service\nOPTIONS\n¶\nThe following options are understood:\n-t\n,\n--type=\nThe argument is a comma-separated list of unit types such\nas\nservice\nand\nsocket\n. When units are listed with\nlist-units\n,\nlist-dependencies\n,\nshow\n, or\nstatus\n,\nonly units of the specified types will be shown. By default, units of all\ntypes are shown.\nAs a special case, if one of the arguments is\nhelp\n, a list\nof allowed values will be printed and the program will exit.\n--state=\nThe argument is a comma-separated list of unit LOAD, SUB,\nor ACTIVE states. When listing units with\nlist-units\n,\nlist-dependencies\n,\nshow\nor\nstatus\n, show only those in the\nspecified states. Use\n--state=failed\nor\n--failed\nto show only\nfailed units.\nAs a special case, if one of the arguments is\nhelp\n, a list\nof allowed values will be printed and the program will exit.\nAdded in version 206.\n-p\n,\n--property=\nWhen showing unit/job/manager properties with the\nshow\ncommand, limit display to properties specified in the argument.\nThe argument should be a comma-separated list of property names, such as\n\"MainPID\". Unless specified, all known properties are shown. If\nspecified more than once, all properties with the specified names are shown.\nShell completion is implemented for property names.\nFor the manager itself,\nsystemctl show\nwill show all\navailable properties, most of which are derived or closely match the options\ndescribed in\nsystemd-system.conf(5)\n.\nProperties for units vary by unit type, so showing any unit (even\na non-existent one) is a way to list properties pertaining to this type.\nSimilarly, showing any job will list properties pertaining to all jobs.\nProperties for units are documented in\nsystemd.unit(5)\n, and the pages\nfor individual unit types\nsystemd.service(5)\n,\nsystemd.socket(5)\n, etc.\n-P\nEquivalent to\n--value\n--property=\n, i.e.\nshows the value of the property without the property name or \"=\".\nNote that using\n-P\nonce will also affect all properties listed with\n-p\n/\n--property=\n.\nAdded in version 246.\n-a\n,\n--all\nWhen listing units with\nlist-units\n, also show\ninactive units and units which are following other units. When showing\nunit/job/manager properties, show all properties regardless whether they are\nset or not.\nTo list all units installed in the file system, use the\nlist-unit-files\ncommand instead.\nWhen listing units with\nlist-dependencies\n, recursively show\ndependencies of all dependent units (by default only dependencies of target\nunits are shown).\nWhen used with\nstatus\n, show journal messages in full, even\nif they include unprintable characters or are very long. By default, fields\nwith unprintable characters are abbreviated as \"blob data\". (Note\nthat the pager may escape unprintable characters again.)\n-r\n,\n--recursive\nWhen listing units, also show units of local containers.\nUnits of local containers will be prefixed with the container name, separated\nby a single colon character (\":\").\nAdded in version 212.\n--reverse\nShow reverse dependencies between units with\nlist-dependencies\n, i.e. follow dependencies of type\nWantedBy=\n,\nRequiredBy=\n,\nUpheldBy=\n,\nPartOf=\n,\nBoundBy=\n, instead\nof\nWants=\nand similar.\nAdded in version 203.\n--after\nWith\nlist-dependencies\n, show the units that are\nordered before the specified unit. In other words, recursively list units\nfollowing the\nAfter=\ndependency.\nNote that any\nAfter=\ndependency is automatically mirrored\nto create a\nBefore=\ndependency. Temporal dependencies may be\nspecified explicitly, but are also created implicitly for units which are\nWantedBy=\ntargets (see\nsystemd.target(5)\n), and as a result of\nother directives (for example\nRequiresMountsFor=\n). Both explicitly\nand implicitly introduced dependencies are shown with\nlist-dependencies\n.\nWhen passed to the\nlist-jobs\ncommand, for each printed job\nshow which other jobs are waiting for it. May be combined with\n--before\nto show both the jobs waiting for each job as well as all\njobs each job is waiting for.\nAdded in version 203.\n--before\nWith\nlist-dependencies\n, show the units that are\nordered after the specified unit. In other words, recursively list units\nfollowing the\nBefore=\ndependency.\nWhen passed to the\nlist-jobs\ncommand, for each printed job\nshow which other jobs it is waiting for. May be combined with\n--after\nto show both the jobs waiting for each job as well as all jobs each job is\nwaiting for.\nAdded in version 212.\n--with-dependencies\nWhen used with\nstatus\n,\ncat\n,\nlist-units\n, and\nlist-unit-files\n, those commands print all\nspecified units and the dependencies of those units.\nOptions\n--reverse\n,\n--after\n,\n--before\nmay be\nused to change what types of dependencies are shown.\nAdded in version 245.\n-l\n,\n--full\nDo not ellipsize unit names, process tree entries,\njournal output, or truncate unit descriptions in the output of\nstatus\n,\nlist-units\n,\nlist-jobs\n, and\nlist-timers\n.\nAlso, show installation targets in the output of\nis-enabled\n.\n--value\nWhen printing properties with\nshow\n, only print the\nvalue, and skip the property name and \"=\". Also see option\n-P\nabove.\nAdded in version 230.\n--show-types\nWhen showing sockets, show the type of the socket.\nAdded in version 202.\n--job-mode=\nWhen queuing a new job, this option controls how to deal\nwith already queued jobs. It takes one of \"fail\",\n\"lenient\", \"replace\", \"replace-irreversibly\",\n\"isolate\", \"ignore-dependencies\",\n\"ignore-requirements\", \"flush\", \"triggering\", or\n\"restart-dependencies\". Defaults to \"replace\", except when\nthe\nisolate\ncommand is used which implies the \"isolate\" job\nmode.\nIf \"fail\" is specified and a requested operation on weak\ndependencies conflicts with a pending job (more specifically: causes an\nalready pending start job to be reversed into a stop job or vice versa),\ncause the operation to fail.\nIf \"lenient\" is specified and a requested operation\nconflicts with any active/activating unit, cause the operation to fail.\nIf \"replace\" (the default) is specified, any conflicting\npending job will be replaced, as necessary.\nIf \"replace-irreversibly\" is specified, operate like\n\"replace\", but also mark the new jobs as irreversible. This\nprevents future conflicting transactions from replacing these jobs (or even\nbeing enqueued while the irreversible jobs are still pending). Irreversible\njobs can still be cancelled using the\ncancel\ncommand. This job mode\nshould be used on any transaction which pulls in shutdown.target.\n\"isolate\" is only valid for start operations and causes\nall other units to be stopped when the specified unit is started. This mode\nis always used when the\nisolate\ncommand is used.\n\"flush\" will cause all queued jobs to be canceled when\nthe new job is enqueued.\nIf \"ignore-dependencies\" is specified, then all unit\ndependencies are ignored for this new job and the operation is executed\nimmediately. If passed, no required units of the unit passed will be pulled\nin, and no ordering dependencies will be honored. This is mostly a debugging\nand rescue tool for the administrator and should not be used by\napplications.\n\"ignore-requirements\" is similar to\n\"ignore-dependencies\", but only causes the requirement\ndependencies to be ignored, the ordering dependencies will still be\nhonored.\n\"triggering\" may only be used with\nsystemctl\nstop\n. In this mode, the specified unit and any active units that trigger\nit are stopped. See the discussion of\nTriggers=\nin\nsystemd.unit(5)\nfor more information about triggering units.\n\"restart-dependencies\" may only be used with\nsystemctl start\n. In this mode, dependencies of the specified unit\nwill receive restart propagation, as if a restart job had been enqueued for\nthe unit.\nAdded in version 209.\n-T\n,\n--show-transaction\nWhen enqueuing a unit job (for example as effect of a\nsystemctl start\ninvocation or similar), show brief information about\nall jobs enqueued, covering both the requested job and any added because of\nunit dependencies. Note that the output will only include jobs immediately\npart of the transaction requested. It is possible that service start-up\nprogram code run as effect of the enqueued jobs might request further jobs to\nbe pulled in. This means that completion of the listed jobs might ultimately\nentail more jobs than the listed ones.\nAdded in version 242.\n--fail\nShorthand for\n--job-mode=\nfail.\nWhen used with the\nkill\ncommand, if no units were killed,\nthe operation results in an error.\nAdded in version 227.\n--check-inhibitors=\nWhen system shutdown or sleep state is requested, this\noption controls checking of inhibitor locks. It takes one of \"auto\",\n\"yes\", and \"no\". Defaults to \"auto\", which means\nlogind will perform the check and respect active inhibitor locks, but\nsystemctl\nwill only do a client-side check for interactive invocations\n(i.e. from a TTY), so that a more friendly and informative error can be\nreturned to users. \"no\" disables the checks both in\nsystemctl\nand\nsystemd-logind(8)\n.\nApplications can establish inhibitor locks to prevent certain\nimportant operations (such as CD burning) from being interrupted by system\nshutdown or sleep. Any user may take these locks and privileged users may\noverride these locks. If any locks are taken, shutdown and sleep state\nrequests will normally fail (unless explicitly overridden with\n\"no\").\nOption\n--force\nprovides another way to override\ninhibitors.\nAdded in version 248.\n-i\nShortcut for\n--check-inhibitors=no\n.\nAdded in version 198.\n--dry-run\nJust print what would be done. Currently supported by\nverbs\nhalt\n,\npoweroff\n,\nreboot\n,\nkexec\n,\nsuspend\n,\nhibernate\n,\nhybrid-sleep\n,\nsuspend-then-hibernate\n,\ndefault\n,\nrescue\n,\nemergency\n, and\nexit\n.\nAdded in version 236.\n-q\n,\n--quiet\nSuppress printing of the results of various commands and\nalso the hints about truncated log lines. This does not suppress output of\ncommands for which the printed output is the only result (like\nshow\n).\nErrors are always printed.\n-v\n,\n--verbose\nDisplay unit log output while executing unit operations.\nAdded in version 258.\n--no-warn\nDo not generate the warnings shown by default in the\nfollowing cases:\n•when\nsystemctl\nis invoked without procfs\nmounted on /proc/,\n•when using\nenable\nor\ndisable\non\nunits without install information (i.e. do not have or have an empty [Install]\nsection),\n•when using\ndisable\ncombined with\n--user\non units that are enabled in global scope,\n•when a\nstop\n-ped,\ndisable\n-d, or\nmask\n-ed unit still has active triggering units,\n•when a unit file is changed and requires\ndaemon-reload\n.\nAdded in version 253.\n--no-block\nDo not synchronously wait for the requested operation to\nfinish. If this is not specified, the job will be verified, enqueued and\nsystemctl\nwill wait until the unit's start-up is completed. By passing\nthis argument, it is only verified and enqueued. This option may not be\ncombined with\n--wait\n.\n--wait\nWhen used with\nstart\nor\nrestart\n,\nsynchronously wait for started units to terminate again. This option may not\nbe combined with\n--no-block\n. Note that this will wait forever if any\ngiven unit never terminates (by itself or by getting stopped explicitly);\nparticularly services which use \"RemainAfterExit=yes\".\nWhen used with\nis-system-running\n, wait until the boot\nprocess is completed before returning.\nWhen used with\nkill\n, wait until the signalled units\nterminate. Note that this will wait forever if any given unit never\nterminates.\nAdded in version 232.\n--user\nTalk to the service manager of the calling user, rather\nthan the service manager of the system.\n--system\nTalk to the service manager of the system. This is the\nimplied default.\n--failed\nList units in failed state. This is equivalent to\n--state=failed\n.\nAdded in version 233.\n--no-wall\nDo not send wall message before halt, power-off and\nreboot.\n--global\nWhen used with\nenable\nand\ndisable\n, operate\non the global user configuration directory, thus enabling or disabling a unit\nfile globally for all future logins of all users.\n--no-reload\nWhen used with\nenable\n,\ndisable\n,\npreset\n,\nmask\n, or\nunmask\n, do not implicitly reload daemon\nconfiguration after executing the changes.\n--kill-whom=\nWhen used with\nkill\n, choose which processes to\nsend a UNIX process signal to. Must be one of\nmain\n,\ncontrol\n,\ncgroup\nor\nall\nto select whether to kill only the main process,\nthe control process, all processes in the unit's control group or all\nprocesses of the unit. The main process of the unit is the one that defines\nthe life-time of it. A control process of a unit is one that is invoked by the\nmanager to induce state changes of it. For example, all processes started due\nto the\nExecStartPre=\n,\nExecStop=\nor\nExecReload=\nsettings\nof service units are control processes. Note that there is only one control\nprocess per unit at a time, as only one state change is executed at a time.\nFor services of type\nType=forking\n, the initial process started by the\nmanager for\nExecStart=\nis a control process, while the process\nultimately forked off by that one is then considered the main process of the\nunit (if it can be determined). This is different for service units of other\ntypes, where the process forked off by the manager for\nExecStart=\nis\nalways the main process itself. A service unit consists of zero or one main\nprocess, zero or one control process plus any number of additional processes\npart of the unit's control group. Not all unit types manage processes of these\ntypes however. For example, for mount units, control processes are defined\n(which are the invocations of /usr/bin/mount and /usr/bin/umount), but no main\nprocess is defined. If omitted, defaults to\nall\n, except if\n--kill-subgroup=\nis used in which case defaults to\ncgroup\n.\nAdded in version 252.\n--kill-value=\nINT\nIf used with the\nkill\ncommand, enqueues a signal\nalong with the specified integer value parameter to the specified process(es).\nThis operation is only available for POSIX Realtime Signals (i.e.\n--signal=SIGRTMIN+...\nor\n--signal=SIGRTMAX-...\n), and ensures the\nsignals are generated via the\nsigqueue(3)\nsystem call, rather than\nkill\n(3). The specified value must be a 32-bit signed integer, and may\nbe specified either in decimal, in hexadecimal (if prefixed with\n\"0x\"), octal (if prefixed with \"0o\") or binary (if\nprefixed with \"0b\")\nIf this option is used the signal will only be enqueued on the\ncontrol or main process of the unit, never on other processes belonging to\nthe unit, i.e.\n--kill-whom=all\nwill only affect main and control\nprocesses but no other processes.\nAdded in version 254.\n--kill-subgroup=\nPATH\nTakes a control group sub-path to send signals to, for\nuse with the\nkill\ncommand. By default the chosen signal is delivered to\nall processes of the unit's cgroups (as well as the main/control processes (if\noutside) – subject to\n--kill-whom=\n). But with this option a\nsubgroup can be selelected instead. This functionality is only available if\n\"cgroup\" or \"cgroup-fail\" are used with\n--kill-whom=\n, and in fact the former is the default if\n--kill-subgroup=\nis used.\nThe specified path may, but doesn't have to be prefixed with a\nslash, and its absence or presence has no effect, the path is either way\ntaken relative to the unit's main control group path.\nThis functionality is only available on units where control group\ndelegation is enabled (see\nDelegate=\nin\nsystemd.resource-control(5)\n).\nAdded in version 258.\n-s\n,\n--signal=\nWhen used with\nkill\n, choose which signal to send\nto selected processes. Must be one of the well-known signal specifiers such as\nSIGTERM\n,\nSIGINT\nor\nSIGSTOP\n. If omitted, defaults to\nSIGTERM\n.\nThe special value \"help\" will list the known values and\nthe program will exit immediately, and the special value \"list\"\nwill list known values along with the numerical signal numbers and the\nprogram will exit immediately.\n--what=\nSelect what type of per-unit resources to remove when the\nclean\ncommand is invoked, see above. Takes one of\nconfiguration\n,\nstate\n,\ncache\n,\nlogs\n,\nruntime\n,\nfdstore\nto\nselect the type of resource. This option may be specified more than once, in\nwhich case all specified resource types are removed. Also accepts the special\nvalue\nall\nas a shortcut for specifying all six resource types. If this\noption is not specified defaults to the combination of\ncache\n,\nruntime\nand\nfdstore\n, i.e. the three kinds of resources that are\ngenerally considered to be redundant and can be reconstructed on next\ninvocation. Note that the explicit removal of the\nfdstore\nresource type\nis only useful if the\nFileDescriptorStorePreserve=\noption is enabled,\nsince the file descriptor store is otherwise cleaned automatically when the\nunit is stopped.\nAdded in version 243.\n-f\n,\n--force\nWhen used with\nenable\n, overwrite any existing\nconflicting symlinks.\nWhen used with\nedit\n, create all of the specified units\nwhich do not already exist.\nWhen used with\nsuspend\n,\nhibernate\n,\nhybrid-sleep\n, or\nsuspend-then-hibernate\n, the error returned by\nsystemd-logind\nwill be ignored, and the operation will be performed\ndirectly through starting the corresponding units.\nWhen used with\nhalt\n,\npoweroff\n,\nreboot\n, or\nkexec\n, execute the selected operation without shutting down all\nunits. However, all processes will be killed forcibly and all file systems\nare unmounted or remounted read-only. This is hence a drastic but relatively\nsafe option to request an immediate reboot. If\n--force\nis specified\ntwice for these operations (with the exception of\nkexec\n), they will\nbe executed immediately, without terminating any processes or unmounting any\nfile systems.\nWarning\nSpecifying\n--force\ntwice with any of these operations might result in\ndata loss. Note that when\n--force\nis specified twice the selected\noperation is executed by\nsystemctl\nitself, and the system manager is\nnot contacted. This means the command should succeed even when the system\nmanager has crashed.\n--message=\nWhen used with\nhalt\n,\npoweroff\nor\nreboot\n, set a short message explaining the reason for the operation.\nThe message will be logged together with the default shutdown message.\nAdded in version 225.\n--now\nWhen used with\nenable\n,\ndisable\n,\nmask\n, or\nreenable\n, also start/stop/try-restart the units after\nthe specified unit file operations succeed.\nAdded in version 220.\n--root=\nWhen used with\nenable\n/\ndisable\n/\nis-enabled\n(and related commands), use the\nspecified root path when looking for unit files. If this option is present,\nsystemctl\nwill operate on the file system directly, instead of\ncommunicating with the\nsystemd\ndaemon to carry out changes.\n--image=\nimage\nTakes a path to a disk image file or block device node.\nIf specified, all operations are applied to file system in the indicated disk\nimage. This option is similar to\n--root=\n, but operates on file systems\nstored in disk images or block devices. The disk image should either contain\njust a file system or a set of file systems within a GPT partition table,\nfollowing the\nUAPI.2 Discoverable Partitions Specification\n[2]. For\nfurther information on supported disk images, see\nsystemd-nspawn(1)\n's\nswitch of the same name.\nAdded in version 252.\n--image-policy=\npolicy\nTakes an image policy string as argument, as per\nsystemd.image-policy(7)\n. The policy is enforced when operating on the\ndisk image specified via\n--image=\n, see above. If not specified,\ndefaults to the \"*\" policy, i.e. all recognized file systems in the\nimage are used.\n--runtime\nWhen used with\nenable\n,\ndisable\n,\nedit\n, (and related commands), make changes only temporarily, so that\nthey are lost on the next reboot. This will have the effect that changes are\nnot made in subdirectories of /etc/ but in /run/, with identical immediate\neffects, however, since the latter is lost on reboot, the changes are lost\ntoo.\nSimilarly, when used with\nset-property\n, make changes only\ntemporarily, so that they are lost on the next reboot.\n--preset-mode=\nTakes one of \"full\" (the default),\n\"enable-only\", \"disable-only\". When used with the\npreset\nor\npreset-all\ncommands, controls whether units shall be\ndisabled and enabled according to the preset rules, or only enabled, or only\ndisabled.\nAdded in version 215.\n-n\n,\n--lines=\nWhen used with\nstatus\n, controls the number of\njournal lines to show, counting from the most recent ones. Takes a positive\ninteger argument, or 0 to disable journal output. Defaults to 10.\n-o\n,\n--output=\nWhen used with\nstatus\n, controls the formatting of\nthe journal entries that are shown. For the available choices, see\njournalctl(1)\n. Defaults to \"short\".\n--firmware-setup\nWhen used with the\nreboot\n,\npoweroff\n, or\nhalt\ncommand, indicate to the system's firmware to reboot into the\nfirmware setup interface for the next boot. Note that this functionality is\nnot available on all systems.\nAdded in version 220.\n--boot-loader-menu=\ntimeout\nWhen used with the\nreboot\n,\npoweroff\n, or\nhalt\ncommand, indicate to the system's boot loader to show the boot\nloader menu on the following boot. Takes a time value as parameter —\nindicating the menu timeout. Pass zero in order to disable the menu timeout.\nNote that not all boot loaders support this functionality.\nAdded in version 242.\n--boot-loader-entry=\nID\nWhen used with the\nreboot\n,\npoweroff\n, or\nhalt\ncommand, indicate to the system's boot loader to boot into a\nspecific boot loader entry on the following boot. Takes a boot loader entry\nidentifier as argument, or \"help\" in order to list available\nentries. Note that not all boot loaders support this functionality.\nAdded in version 242.\n--reboot-argument=\nThis switch is used with\nreboot\n. The value is\narchitecture and firmware specific. As an example, \"recovery\" might\nbe used to trigger system recovery, and \"fota\" might be used to\ntrigger a “firmware over the air” update.\nAdded in version 246.\n--plain\nWhen used with\nlist-dependencies\n,\nlist-units\nor\nlist-machines\n, the output is printed as a list\ninstead of a tree, and the bullet circles are omitted.\nAdded in version 203.\n--timestamp=\nChange the format of printed timestamps. The following\nvalues may be used:\npretty\n(this is the default)\n\"Day YYYY-MM-DD HH:MM:SS TZ\"\nAdded in version 248.\nunix\n\"@seconds-since-the-epoch\"\nAdded in version 251.\nus\n,\nμs\n\"Day YYYY-MM-DD HH:MM:SS.UUUUUU TZ\"\nAdded in version 248.\nutc\n\"Day YYYY-MM-DD HH:MM:SS UTC\"\nAdded in version 248.\nus+utc\n,\nμs+utc\n\"Day YYYY-MM-DD HH:MM:SS.UUUUUU UTC\"\nAdded in version 248.\nAdded in version 247.\n--mkdir\nWhen used with\nbind\n, creates the destination file\nor directory before applying the bind mount. Note that even though the name of\nthis option suggests that it is suitable only for directories, this option\nalso creates the destination file node to mount over if the object to mount is\nnot a directory, but a regular file, device node, socket or FIFO.\nAdded in version 248.\n--marked\nOnly allowed with\nreload-or-restart\n. Enqueues\nrestart jobs for all units that have the \"needs-restart\" mark, and\nreload jobs for units that have the \"needs-reload\" mark. When a unit\nmarked for reload does not support reload, restart will be queued. Those\nproperties can be set using\nset-property Markers=...\n.\nUnless\n--no-block\nis used,\nsystemctl\nwill wait for\nthe queued jobs to finish.\nAdded in version 248.\n--read-only\nWhen used with\nbind\n, creates a read-only bind\nmount.\nAdded in version 248.\n--drop-in=\nNAME\nWhen used with\nedit\n, use\nNAME\nas the\ndrop-in file name instead of override.conf.\nAdded in version 253.\n--when=\nWhen used with\nhalt\n,\npoweroff\n,\nreboot\nor\nkexec\n, schedule the action to be performed at the\ngiven timestamp, which should adhere to the syntax documented in\nsystemd.time(7)\nsection \"PARSING TIMESTAMPS\". Specially, if\n\"show\" is given, the currently scheduled action will be shown, which\ncan be canceled by passing an empty string or \"cancel\".\n\"auto\" will schedule the action according to maintenance window or\none minute in the future.\nAdded in version 254.\n--stdin\nWhen used with\nedit\n, the contents of the file will\nbe read from standard input and the editor will not be launched. In this mode,\nthe old contents of the file are completely replaced. This is useful to\n\"edit\" unit files from scripts:\n$ systemctl edit --drop-in=limits.conf --stdin some-service.service <<EOF\n[Unit]\nAllowedCPUs=7,11\nEOF\nMultiple drop-ins may be \"edited\" in this mode; the same\ncontents will be written to all of them.\nAdded in version 256.\n-H\n,\n--host=\nExecute the operation remotely. Specify a hostname, or a\nusername and hostname separated by \"@\", to connect to. The hostname\nmay optionally be suffixed by a port ssh is listening on, separated by\n\":\", and then a container name, separated by \"/\", which\nconnects directly to a specific container on the specified host. This will use\nSSH to talk to the remote machine manager instance. Container names may be\nenumerated with\nmachinectl -H\nHOST\n. Put IPv6 addresses in\nbrackets.\n-M\n,\n--machine=\nExecute operation on a local container. Specify a\ncontainer name to connect to, optionally prefixed by a user name to connect as\nand a separating \"@\" character. If the special string\n\".host\" is used in place of the container name, a connection to the\nlocal system is made (which is useful to connect to a specific user's user\nbus: \"--user --machine=lennart@.host\"). If the \"@\" syntax\nis not used, the connection is made as root user. If the \"@\" syntax\nis used either the left hand side or the right hand side may be omitted (but\nnot both) in which case the local user name and \".host\" are\nimplied.\n-C\n,\n--capsule=\nExecute operation on a capsule. Specify a capsule name to\nconnect to. See\ncapsule@.service\n(5) for details about capsules.\nAdded in version 256.\n--no-ask-password\nDo not query the user for authentication for privileged\noperations.\n--no-pager\nDo not pipe output into a pager.\n--legend=\nBOOL\nEnable or disable printing of the legend, i.e. column\nheaders and the footer with hints. The legend is printed by default, unless\ndisabled with\n--quiet\nor similar.\n-h\n,\n--help\nPrint a short help text and exit.\n--version\nPrint a short version string and exit.\nEXIT STATUS\n¶\nOn success, 0 is returned, a non-zero failure code otherwise.\nsystemctl\nuses the return codes defined by LSB, as defined\nin\nLSB 3.0.0\n[3].\nTable 5. LSB return codes\nValue\nDescription in LSB\nUse in systemd\n0\n\"program is running or service is OK\"\nunit is active\n1\n\"program is dead and /var/run pid file exists\"\nunit\nnot\nfailed (used by\nis-failed\n)\n2\n\"program is dead and /var/lock lock file exists\"\nunused\n3\n\"program is not running\"\nunit is not active\n4\n\"program or service status is unknown\"\nno such unit\nThe mapping of LSB service states to systemd unit states is\nimperfect, so it is better to not rely on those return values but to look\nfor specific unit states and substates instead.\nENVIRONMENT\n¶\n$SYSTEMD_EDITOR\nEditor to use when editing units; overrides\n$EDITOR\nand\n$VISUAL\n. If neither\n$SYSTEMD_EDITOR\nnor\n$EDITOR\nnor\n$VISUAL\nare present or if it is set to an empty\nstring or if their execution failed, systemctl will try to execute well known\neditors in this order:\neditor(1)\n,\nnano(1)\n,\nvim(1)\n,\nvi(1)\n.\nAdded in version 218.\n$SYSTEMD_LOG_LEVEL\nThe maximum log level of emitted messages (messages with\na higher log level, i.e. less important ones, will be suppressed). Takes a\ncomma-separated list of values. A value may be either one of (in order of\ndecreasing importance)\nemerg\n,\nalert\n,\ncrit\n,\nerr\n,\nwarning\n,\nnotice\n,\ninfo\n,\ndebug\n, or an integer in the\nrange 0...7. See\nsyslog(3)\nfor more information. Each value may\noptionally be prefixed with one of\nconsole\n,\nsyslog\n,\nkmsg\nor\njournal\nfollowed by a colon to set the maximum log level for that\nspecific log target (e.g.\nSYSTEMD_LOG_LEVEL=debug,console:info\nspecifies to log at debug level except when logging to the console which\nshould be at info level). Note that the global maximum log level takes\npriority over any per target maximum log levels.\n$SYSTEMD_LOG_COLOR\nA boolean. If true, messages written to the tty will be\ncolored according to priority.\nThis setting is only useful when messages are written directly to\nthe terminal, because\njournalctl(1)\nand other tools that display logs\nwill color messages based on the log level on their own.\n$SYSTEMD_LOG_TIME\nA boolean. If true, console log messages will be prefixed\nwith a timestamp.\nThis setting is only useful when messages are written directly to\nthe terminal or a file, because\njournalctl(1)\nand other tools that\ndisplay logs will attach timestamps based on the entry metadata on their\nown.\n$SYSTEMD_LOG_LOCATION\nA boolean. If true, messages will be prefixed with a\nfilename and line number in the source code where the message originates.\nNote that the log location is often attached as metadata to\njournal entries anyway. Including it directly in the message text can\nnevertheless be convenient when debugging programs.\n$SYSTEMD_LOG_TARGET\nThe destination for log messages. One of\nconsole\n(log to the attached tty),\nconsole-prefixed\n(log to the attached tty\nbut with prefixes encoding the log level and \"facility\", see\nsyslog(3)\n,\nkmsg\n(log to the kernel circular log buffer),\njournal\n(log to the journal),\njournal-or-kmsg\n(log to the\njournal if available, and to kmsg otherwise),\nauto\n(determine the\nappropriate log target automatically, the default),\nnull\n(disable log\noutput).\n$SYSTEMD_PAGER\n,\n$PAGER\nPager to use when\n--no-pager\nis not given.\n$SYSTEMD_PAGER\nis used if set; otherwise\n$PAGER\nis used. If\nneither\n$SYSTEMD_PAGER\nnor\n$PAGER\nare set, a set of well-known\npager implementations is tried in turn, including\nless(1)\nand\nmore(1)\n, until one is found. If no pager implementation is discovered,\nno pager is invoked. Setting those environment variables to an empty string or\nthe value \"cat\" is equivalent to passing\n--no-pager\n.\nNote: if\n$SYSTEMD_PAGERSECURE\nis not set,\n$SYSTEMD_PAGER\nand\n$PAGER\ncan only be used to disable the\npager (with \"cat\" or \"\"), and are otherwise ignored.\n$SYSTEMD_LESS\nOverride the options passed to\nless\n(by default\n\"FRSXMK\").\nUsers might want to change two options in particular:\nK\nThis option instructs the pager to exit immediately when\nCtrl+C is pressed. To allow\nless\nto handle Ctrl+C itself to switch back\nto the pager command prompt, unset this option.\nIf the value of\n$SYSTEMD_LESS\ndoes not include\n\"K\", and the pager that is invoked is\nless\n, Ctrl+C will be\nignored by the executable, and needs to be handled by the pager.\nX\nThis option instructs the pager to not send termcap\ninitialization and deinitialization strings to the terminal. It is set by\ndefault to allow command output to remain visible in the terminal even after\nthe pager exits. Nevertheless, this prevents some pager functionality from\nworking, in particular paged output cannot be scrolled with the mouse.\nNote that setting the regular\n$LESS\nenvironment variable\nhas no effect for\nless\ninvocations by systemd tools.\nSee\nless(1)\nfor more discussion.\n$SYSTEMD_LESSCHARSET\nOverride the charset passed to\nless\n(by default\n\"utf-8\", if the invoking terminal is determined to be UTF-8\ncompatible).\nNote that setting the regular\n$LESSCHARSET\nenvironment\nvariable has no effect for\nless\ninvocations by systemd tools.\n$SYSTEMD_PAGERSECURE\nCommon pager commands like\nless(1)\n, in addition to\n\"paging\", i.e. scrolling through the output, support opening of or\nwriting to other files and running arbitrary shell commands. When commands are\ninvoked with elevated privileges, for example under\nsudo(8)\nor\npkexec(1)\n, the pager becomes a security boundary. Care must be taken\nthat only programs with strictly limited functionality are used as pagers, and\nunintended interactive features like opening or creation of new files or\nstarting of subprocesses are not allowed. \"Secure mode\" for the\npager may be enabled as described below,\nif the pager supports that\n(most pagers are not written in a way that takes this into consideration). It\nis recommended to either explicitly enable \"secure mode\" or to\ncompletely disable the pager using\n--no-pager\nor\nPAGER=cat\nwhen\nallowing untrusted users to execute commands with elevated privileges.\nThis option takes a boolean argument. When set to true, the\n\"secure mode\" of the pager is enabled. In \"secure mode\",\nLESSSECURE=1\nwill be set when invoking the pager, which instructs the\npager to disable commands that open or create new files or start new\nsubprocesses. Currently only\nless(1)\nis known to understand this\nvariable and implement \"secure mode\".\nWhen set to false, no limitation is placed on the pager. Setting\nSYSTEMD_PAGERSECURE=0\nor not removing it from the inherited\nenvironment may allow the user to invoke arbitrary commands.\nWhen\n$SYSTEMD_PAGERSECURE\nis not set, systemd tools attempt\nto automatically figure out if \"secure mode\" should be enabled and\nwhether the pager supports it. \"Secure mode\" is enabled if the\neffective UID is not the same as the owner of the login session, see\ngeteuid(2)\nand\nsd_pid_get_owner_uid(3)\n, or when running under\nsudo(8)\nor similar tools (\n$SUDO_UID\nis set [4]). In those\ncases,\nSYSTEMD_PAGERSECURE=1\nwill be set and pagers which are not\nknown to implement \"secure mode\" will not be used at all. Note\nthat this autodetection only covers the most common mechanisms to elevate\nprivileges and is intended as convenience. It is recommended to explicitly\nset\n$SYSTEMD_PAGERSECURE\nor disable the pager.\nNote that if the\n$SYSTEMD_PAGER\nor\n$PAGER\nvariables\nare to be honoured, other than to disable the pager,\n$SYSTEMD_PAGERSECURE\nmust be set too.\n$SYSTEMD_COLORS\nTakes a boolean argument. When true,\nsystemd\nand\nrelated utilities will use colors in their output, otherwise the output will\nbe monochrome. Additionally, the variable can take one of the following\nspecial values: \"16\", \"256\" to restrict the use of colors\nto the base 16 or 256 ANSI colors, respectively. This can be specified to\noverride the automatic decision based on\n$TERM\nand what the console is\nconnected to.\n$SYSTEMD_URLIFY\nThe value must be a boolean. Controls whether clickable\nlinks should be generated in the output for terminal emulators supporting\nthis. This can be specified to override the decision that\nsystemd\nmakes\nbased on\n$TERM\nand other conditions.\nSEE ALSO\n¶\nsystemd(1)\n,\njournalctl(1)\n,\nloginctl(1)\n,\nmachinectl(1)\n,\nsystemd.unit(5)\n,\nsystemd.resource-control(5)\n,\nsystemd.special(7)\n,\nwall(1)\n,\nsystemd.preset(5)\n,\nsystemd.generator(7)\n,\nglob(7)\nNOTES\n¶\n1.\nUAPI.1 Boot Loader Specification\nhttps://uapi-group.org/specifications/specs/boot_loader_specification\n2.\nUAPI.2 Discoverable Partitions Specification\nhttps://uapi-group.org/specifications/specs/discoverable_partitions_specification\n3.\nLSB 3.0.0\nhttp://refspecs.linuxbase.org/LSB_3.0.0/LSB-PDA/LSB-PDA/iniscrptact.html\n4.\nIt is recommended for other tools to set and check\n$SUDO_UID\nas\nappropriate, treating it is a common interface.\nsystemd 259~rc2\nSource file:\nsystemctl.1.en.gz (from\nsystemd 259~rc2-1\n)\nSource last updated:\n2025-11-26T12:41:32Z\nConverted to HTML:\n2025-11-26T20:47:56Z\ndebiman 15b1084, see\ngithub.com/Debian/debiman\n.\nFound a problem? See the\nFAQ\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://manpages.debian.org/unstable/systemd/systemctl.1.en.html"}}
