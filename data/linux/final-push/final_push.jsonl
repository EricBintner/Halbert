{"text": "tc(8) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\ntc(8) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nQDISCS\n|\nCLASSES\n|\nFILTERS\n|\nQEVENTS\n|\nCLASSLESS QDISCS\n|\nCONFIGURING CLASSLESS QDISCS\n|\nCLASSFUL QDISCS\n|\nTHEORY OF OPERATION\n|\nNAMING\n|\nPARAMETERS\n|\nTC COMMANDS\n|\nMONITOR\n|\nOPTIONS\n|\nFORMAT\n|\nEXAMPLES\n|\nHISTORY\n|\nSEE ALSO\n|\nAUTHOR\n|\nCOLOPHON\nTC\n(8)                             Linux\nTC\n(8)\nNAME\ntop\ntc - show / manipulate traffic control settings\nSYNOPSIS\ntop\ntc\n[\nOPTIONS\n]\nqdisc [ add | change | replace | link | delete ]\ndev\nDEV\n[ parent\nqdisc-id\n| root ] [ handle\nqdisc-id\n]\n[\ningress_block\nBLOCK_INDEX\n]\n[ egress_block\nBLOCK_INDEX\n] qdisc [\nqdisc specific parameters ]\ntc\n[\nOPTIONS\n]\nclass [ add | change | replace | delete | show ]\ndev\nDEV\nparent\nqdisc-id\n[ classid\nclass-id\n] qdisc [ qdisc\nspecific parameters ]\ntc\n[\nOPTIONS\n]\nfilter [ add | change | replace | delete | get ]\ndev\nDEV\n[ parent\nqdisc-id\n| root ] [ handle\nfilter-id\n]\nprotocol\nprotocol\nprio\npriority\nfiltertype [ filtertype specific parameters\n]\nflowid\nflow-id\ntc\n[\nOPTIONS\n]\nfilter [ add | change | replace | delete | get ]\nblock\nBLOCK_INDEX\n[ handle\nfilter-id\n]\nprotocol\nprotocol\nprio\npriority\nfiltertype [ filtertype specific parameters ]\nflowid\nflow-id\ntc\n[\nOPTIONS\n]\nchain [ add | delete | get ] dev\nDEV\n[ parent\nqdisc-id\n| root ]\nfiltertype [ filtertype specific parameters ]\ntc\n[\nOPTIONS\n]\nchain [ add | delete | get ] block\nBLOCK_INDEX\nfiltertype [ filtertype specific parameters ]\ntc\n[\nOPTIONS\n] [\nFORMAT\n]\nqdisc { show | list } [ dev\nDEV\n] [ root\n| ingress | handle\nQHANDLE\n| parent\nCLASSID\n] [ invisible ]\ntc\n[\nOPTIONS\n] [\nFORMAT\n]\nclass show dev\nDEV\ntc\n[\nOPTIONS\n]\nfilter show dev\nDEV\ntc\n[\nOPTIONS\n]\nfilter show block\nBLOCK_INDEX\ntc\n[\nOPTIONS\n]\nchain show dev\nDEV\ntc\n[\nOPTIONS\n]\nchain show block\nBLOCK_INDEX\ntc\n[\nOPTIONS\n]\nmonitor [ file\nFILENAME\n]\nOPTIONS\n:= {\n[ -force ] -b\n[\natch\n]\n[ filename ]\n|\n[ -n\n[\netns\n] name\n]\n|\n[ -N\n[\numeric\n]\n]\n|\n[ -nm\n|\n-nam\n[\nes\n]\n]\n|\n[\n{\n-cf\n|\n-c\n[\nonf\n] }\n[\nfilename ] ] [ -t\n[imestamp]\n]\n|\n[ -t\n[short] |\n[ -o\n[neline]\n]\n|\n[\n-echo ]\n}\nFORMAT\n:= {\n-s\n[\ntatistics\n] |\n-d\n[\netails\n] |\n-r\n[\naw\n] |\n-i\n[\nec\n] |\n-g\n[\nraph\n] |\n-j\n[\njson\n] |\n-p\n[\nretty\n] |\n-col\n[\nor\n] }\nDESCRIPTION\ntop\nTc\nis used to configure Traffic Control in the Linux kernel.\nTraffic Control consists of the following:\nSHAPING\nWhen traffic is shaped, its rate of transmission is under\ncontrol. Shaping may be more than lowering the available\nbandwidth - it is also used to smooth out bursts in traffic\nfor better network behaviour. Shaping occurs on egress.\nSCHEDULING\nBy scheduling the transmission of packets it is possible to\nimprove interactivity for traffic that needs it while still\nguaranteeing bandwidth to bulk transfers. Reordering is\nalso called prioritizing, and happens only on egress.\nPOLICING\nWhereas shaping deals with transmission of traffic,\npolicing pertains to traffic arriving. Policing thus occurs\non ingress.\nDROPPING\nTraffic exceeding a set bandwidth may also be dropped\nforthwith, both on ingress and on egress.\nProcessing of traffic is controlled by three kinds of objects:\nqdiscs, classes and filters.\nQDISCS\ntop\nqdisc\nis short for 'queueing discipline' and it is elementary to\nunderstanding traffic control. Whenever the kernel needs to send a\npacket to an interface, it is\nenqueued\nto the qdisc configured for\nthat interface. Immediately afterwards, the kernel tries to get as\nmany packets as possible from the qdisc, for giving them to the\nnetwork adaptor driver.\nA simple QDISC is the 'pfifo' one, which does no processing at all\nand is a pure First In, First Out queue. It does however store\ntraffic when the network interface can't handle it momentarily.\nCLASSES\ntop\nSome qdiscs can contain classes, which contain further qdiscs -\ntraffic may then be enqueued in any of the inner qdiscs, which are\nwithin the\nclasses.\nWhen the kernel tries to dequeue a packet\nfrom such a\nclassful qdisc\nit can come from any of the classes. A\nqdisc may for example prioritize certain kinds of traffic by\ntrying to dequeue from certain classes before others.\nFILTERS\ntop\nA\nfilter\nis used by a classful qdisc to determine in which class a\npacket will be enqueued. Whenever traffic arrives at a class with\nsubclasses, it needs to be classified. Various methods may be\nemployed to do so, one of these are the filters. All filters\nattached to the class are called, until one of them returns with a\nverdict. If no verdict was made, other criteria may be available.\nThis differs per qdisc.\nIt is important to notice that filters reside\nwithin\nqdiscs - they\nare not masters of what happens.\nThe available filters are:\nbasic  Filter packets based on an ematch expression. See\ntc-ematch(8)\nfor details.\nbpf    Filter packets using (e)BPF, see\ntc-bpf(8)\nfor details.\ncgroup Filter packets based on the control group of their process.\nSee\ntc-cgroup(8)\nfor details.\nflow, flower\nFlow-based classifiers, filtering packets based on their\nflow (identified by selectable keys). See\ntc-flow(8)\nand\ntc-flower(8)\nfor details.\nfw     Filter based on fwmark. Directly maps fwmark value to\ntraffic class. See\ntc-fw(8)\n.\nroute  Filter packets based on routing table. See\ntc-route(8)\nfor\ndetails.\nu32    Generic filtering on arbitrary packet data, assisted by\nsyntax to abstract common operations. See\ntc-u32(8)\nfor\ndetails.\nmatchall\nTraffic control filter that matches every packet. See\ntc-matchall(8)\nfor details.\nQEVENTS\ntop\nQdiscs may invoke user-configured actions when certain interesting\nevents take place in the qdisc. Each qevent can either be unused,\nor can have a block attached to it. To this block are then\nattached filters using the \"tc block BLOCK_IDX\" syntax. The block\nis executed when the qevent associated with the attachment point\ntakes place. For example, packet could be dropped, or delayed,\netc., depending on the qdisc and the qevent in question.\nFor example:\ntc qdisc add dev eth0 root handle 1: red limit 500K avpkt\n1K \\\nqevent early_drop block 10\ntc filter add block 10 matchall action mirred egress mirror\ndev eth1\nCLASSLESS QDISCS\ntop\nThe classless qdiscs are:\nchoke  CHOKe (CHOose and Keep for responsive flows, CHOose and\nKill for unresponsive flows) is a classless qdisc designed\nto both identify and penalize flows that monopolize the\nqueue. CHOKe is a variation of RED, and the configuration\nis similar to RED.\ncodel  CoDel (pronounced \"coddle\") is an adaptive \"no-knobs\"\nactive queue management algorithm (AQM) scheme that was\ndeveloped to address the shortcomings of RED and its\nvariants.\n[p|b]fifo\nSimplest usable qdisc, pure First In, First Out behaviour.\nLimited in packets or in bytes.\nfq     Fair Queue Scheduler realises TCP pacing and scales to\nmillions of concurrent flows per qdisc.\nfq_codel\nFair Queuing Controlled Delay is queuing discipline that\ncombines Fair Queuing with the CoDel AQM scheme. FQ_Codel\nuses a stochastic model to classify incoming packets into\ndifferent flows and is used to provide a fair share of the\nbandwidth to all the flows using the queue. Each such flow\nis managed by the CoDel queuing discipline. Reordering\nwithin a flow is avoided since Codel internally uses a FIFO\nqueue.\nfq_pie FQ-PIE (Flow Queuing with Proportional Integral controller\nEnhanced) is a queuing discipline that combines Flow\nQueuing with the PIE AQM scheme. FQ-PIE uses a Jenkins hash\nfunction to classify incoming packets into different flows\nand is used to provide a fair share of the bandwidth to all\nthe flows using the qdisc. Each such flow is managed by the\nPIE algorithm.\ngred   Generalized Random Early Detection combines multiple RED\nqueues in order to achieve multiple drop priorities. This\nis required to realize Assured Forwarding (RFC 2597).\nhhf    Heavy-Hitter Filter differentiates between small flows and\nthe opposite, heavy-hitters. The goal is to catch the\nheavy-hitters and move them to a separate queue with less\npriority so that bulk traffic does not affect the latency\nof critical traffic.\ningress\nThis is a special qdisc as it applies to incoming traffic\non an interface, allowing for it to be filtered and\npoliced.\nmqprio The Multiqueue Priority Qdisc is a simple queuing\ndiscipline that allows mapping traffic flows to hardware\nqueue ranges using priorities and a configurable priority\nto traffic class mapping. A traffic class in this context\nis a set of contiguous qdisc classes which map 1:1 to a set\nof hardware exposed queues.\nmultiq Multiqueue is a qdisc optimized for devices with multiple\nTx queues. It has been added for hardware that wishes to\navoid head-of-line blocking.  It will cycle though the\nbands and verify that the hardware queue associated with\nthe band is not stopped prior to dequeuing a packet.\nnetem  Network Emulator is an enhancement of the Linux traffic\ncontrol facilities that allow one to add delay, packet\nloss, duplication and more other characteristics to packets\noutgoing from a selected network interface.\npfifo_fast\nStandard qdisc for 'Advanced Router' enabled kernels.\nConsists of a three-band queue which honors Type of Service\nflags, as well as the priority that may be assigned to a\npacket.\npie    Proportional Integral controller-Enhanced (PIE) is a\ncontrol theoretic active queue management scheme. It is\nbased on the proportional integral controller but aims to\ncontrol delay.\nred    Random Early Detection simulates physical congestion by\nrandomly dropping packets when nearing configured bandwidth\nallocation. Well suited to very large bandwidth\napplications.\nsfb    Stochastic Fair Blue is a classless qdisc to manage\ncongestion based on packet loss and link utilization\nhistory while trying to prevent non-responsive flows (i.e.\nflows that do not react to congestion marking or dropped\npackets) from impacting performance of responsive flows.\nUnlike RED, where the marking probability has to be\nconfigured, BLUE tries to determine the ideal marking\nprobability automatically.\nsfq    Stochastic Fairness Queueing reorders queued traffic so\neach 'session' gets to send a packet in turn.\ntbf    The Token Bucket Filter is suited for slowing traffic down\nto a precisely configured rate. Scales well to large\nbandwidths.\nCONFIGURING CLASSLESS QDISCS\ntop\nIn the absence of classful qdiscs, classless qdiscs can only be\nattached at the root of a device. Full syntax:\ntc qdisc add dev\nDEV\nroot\nQDISC QDISC-PARAMETERS\nTo remove, issue\ntc qdisc del dev\nDEV\nroot\nThe\npfifo_fast\nqdisc is the automatic default in the absence of a\nconfigured qdisc.\nCLASSFUL QDISCS\ntop\nThe classful qdiscs are:\nATM    Map flows to virtual circuits of an underlying asynchronous\ntransfer mode device.\nDRR    The Deficit Round Robin Scheduler is a more flexible\nreplacement for Stochastic Fairness Queuing. Unlike SFQ,\nthere are no built-in queues -- you need to add classes and\nthen set up filters to classify packets accordingly.  This\ncan be useful e.g. for using RED qdiscs with different\nsettings for particular traffic. There is no default class\n-- if a packet cannot be classified, it is dropped.\nETS    The ETS qdisc is a queuing discipline that merges\nfunctionality of PRIO and DRR qdiscs in one scheduler. ETS\nmakes it easy to configure a set of strict and bandwidth-\nsharing bands to implement the transmission selection\ndescribed in 802.1Qaz.\nHFSC   Hierarchical Fair Service Curve guarantees precise\nbandwidth and delay allocation for leaf classes and\nallocates excess bandwidth fairly. Unlike HTB, it makes use\nof packet dropping to achieve low delays which interactive\nsessions benefit from.\nHTB    The Hierarchy Token Bucket implements a rich linksharing\nhierarchy of classes with an emphasis on conforming to\nexisting practices. HTB facilitates guaranteeing bandwidth\nto classes, while also allowing specification of upper\nlimits to inter-class sharing. It contains shaping\nelements, based on TBF and can prioritize classes.\nPRIO   The PRIO qdisc is a non-shaping container for a\nconfigurable number of classes which are dequeued in order.\nThis allows for easy prioritization of traffic, where lower\nclasses are only able to send if higher ones have no\npackets available. To facilitate configuration, Type Of\nService bits are honored by default.\nQFQ    Quick Fair Queueing is an O(1) scheduler that provides\nnear-optimal guarantees, and is the first to achieve that\ngoal with a constant cost also with respect to the number\nof groups and the packet length. The QFQ algorithm has no\nloops, and uses very simple instructions and data\nstructures that lend themselves very well to a hardware\nimplementation.\nTHEORY OF OPERATION\ntop\nClasses form a tree, where each class has a single parent.  A\nclass may have multiple children. Some qdiscs allow for runtime\naddition of classes (HTB) while others (PRIO) are created with a\nstatic number of children.\nQdiscs which allow dynamic addition of classes can have zero or\nmore subclasses to which traffic may be enqueued.\nFurthermore, each class contains a\nleaf qdisc\nwhich by default has\npfifo\nbehaviour, although another qdisc can be attached in place.\nThis qdisc may again contain classes, but each class can have only\none leaf qdisc.\nWhen a packet enters a classful qdisc it can be\nclassified\nto one\nof the classes within. Three criteria are available, although not\nall qdiscs will use all three:\ntc filters\nIf tc filters are attached to a class, they are consulted\nfirst for relevant instructions. Filters can match on all\nfields of a packet header, as well as on the firewall mark\napplied by iptables.\nType of Service\nSome qdiscs have built in rules for classifying packets\nbased on the TOS field.\nskb->priority\nUserspace programs can encode a\nclass-id\nin the\n'skb->priority' field using the SO_PRIORITY option.\nEach node within the tree can have its own filters but higher\nlevel filters may also point directly to lower classes.\nIf classification did not succeed, packets are enqueued to the\nleaf qdisc attached to that class. Check qdisc specific manpages\nfor details, however.\nNAMING\ntop\nAll qdiscs, classes and filters have IDs, which can either be\nspecified or be automatically assigned.\nIDs consist of a\nmajor\nnumber and a\nminor\nnumber, separated by a\ncolon -\nmajor\n:\nminor\n.  Both\nmajor\nand\nminor\nare hexadecimal numbers\nand are limited to 16 bits. There are two special values: root is\nsignified by\nmajor\nand\nminor\nof all ones, and unspecified is all\nzeros.\nQDISCS A qdisc, which potentially can have children, gets assigned\na\nmajor\nnumber, called a 'handle', leaving the\nminor\nnumber\nnamespace available for classes. The handle is expressed as\n'10:'.  It is customary to explicitly assign a handle to\nqdiscs expected to have children.\nCLASSES\nClasses residing under a qdisc share their qdisc\nmajor\nnumber, but each have a separate\nminor\nnumber called a\n'classid' that has no relation to their parent classes,\nonly to their parent qdisc. The same naming custom as for\nqdiscs applies.\nFILTERS\nFilters have a three part ID, which is only needed when\nusing a hashed filter hierarchy.\nPARAMETERS\ntop\nThe following parameters are widely used in TC. For other\nparameters, see the man pages for individual qdiscs.\nRATES  Bandwidths or rates.  These parameters accept a floating\npoint number, possibly followed by either a unit (both SI\nand IEC units supported), or a float followed by a '%'\ncharacter to specify the rate as a percentage of the\ndevice's speed (e.g. 5%, 99.5%). Warning: specifying the\nrate as a percentage means a fraction of the current speed;\nif the speed changes, the value will not be recalculated.\nbit or a bare number\nBits per second\nkbit   Kilobits per second\nmbit   Megabits per second\ngbit   Gigabits per second\ntbit   Terabits per second\nbps    Bytes per second\nkbps   Kilobytes per second\nmbps   Megabytes per second\ngbps   Gigabytes per second\ntbps   Terabytes per second\nTo specify in IEC units, replace the SI prefix (k-, m-, g-,\nt-) with IEC prefix (ki-, mi-, gi- and ti-) respectively.\nTC store rates as a 32-bit unsigned integer in bps\ninternally, so we can specify a max rate of 4294967295 bps.\nTIMES  Length of time. Can be specified as a floating point number\nfollowed by an optional unit:\ns, sec or secs\nWhole seconds\nms, msec or msecs\nMilliseconds\nus, usec, usecs or a bare number\nMicroseconds.\nTC defined its own time unit (equal to microsecond) and\nstores time values as 32-bit unsigned integer, thus we can\nspecify a max time value of 4294967295 usecs.\nSIZES  Amounts of data. Can be specified as a floating point\nnumber followed by an optional unit:\nb or a bare number\nBytes.\nkbit   Kilobits\nkb or k\nKilobytes\nmbit   Megabits\nmb or m\nMegabytes\ngbit   Gigabits\ngb or g\nGigabytes\nTC stores sizes internally as 32-bit unsigned integer in\nbyte, so we can specify a max size of 4294967295 bytes.\nVALUES Other values without a unit.  These parameters are\ninterpreted as decimal by default, but you can indicate TC\nto interpret them as octal and hexadecimal by adding a '0'\nor '0x' prefix respectively.\nTC COMMANDS\ntop\nThe following commands are available for qdiscs, classes and\nfilter:\nadd    Add a qdisc, class or filter to a node. For all entities, a\nparent\nmust be passed, either by passing its ID or by\nattaching directly to the root of a device.  When creating\na qdisc or a filter, it can be named with the\nhandle\nparameter. A class is named with the\nclassid\nparameter.\ndelete A qdisc can be deleted by specifying its handle, which may\nalso be 'root'. All subclasses and their leaf qdiscs are\nautomatically deleted, as well as any filters attached to\nthem.\nchange Some entities can be modified 'in place'. Shares the syntax\nof 'add', with the exception that the handle cannot be\nchanged and neither can the parent. In other words,\nchange\ncannot move a node.\nreplace\nPerforms a nearly atomic remove/add on an existing node id.\nIf the node does not exist yet it is created.\nget    Displays a single filter given the interface\nDEV\n,\nqdisc-id\n,\npriority\n,\nprotocol\nand\nfilter-id\n.\nshow   Displays all filters attached to the given interface. A\nvalid parent ID must be passed.\nlink   Only available for qdiscs and performs a replace where the\nnode must exist already.\nMONITOR\ntop\nThe\ntc\nutility can monitor events generated by the kernel such as\nadding/deleting qdiscs, filters or actions, or modifying existing\nones.\nThe following command is available for\nmonitor\n:\nfile\nIf the file option is given, the\ntc\ndoes not listen to\nkernel events, but opens the given file and dumps its\ncontents. The file has to be in binary format and contain\nnetlink messages.\nOPTIONS\ntop\n-b\n,\n-b filename\n,\n-batch\n,\n-batch filename\nread commands from provided file or standard input and\ninvoke them.  First failure will cause termination of tc.\n-force\ndon't terminate tc on errors in batch mode.  If there were\nany errors during execution of the commands, the\napplication return code will be non zero.\n-o\n,\n-oneline\noutput each record on a single line, replacing line feeds\nwith the\n'\\'\ncharacter. This is convenient when you want to\ncount records with\nwc(1)\nor to\ngrep(1)\nthe output.\n-n\n,\n-net\n,\n-netns\n<NETNS>\nswitches\ntc\nto the specified network namespace\nNETNS\n.\nActually it just simplifies executing of:\nip netns exec\nNETNS\ntc\n[\nOPTIONS\n]\nOBJECT\n{\nCOMMAND\n|\nhelp\n}\nto\ntc\n-n[etns]\nNETNS\n[\nOPTIONS\n]\nOBJECT\n{\nCOMMAND\n|\nhelp\n}\n-N\n,\n-Numeric\nPrint the number of protocol, scope, dsfield, etc directly\ninstead of converting it to human readable name.\n-cf\n,\n-conf\n<FILENAME>\nspecifies path to the config file. This option is used in\nconjunction with other options (e.g.\n-nm\n).\n-t\n,\n-timestamp\nWhen\ntc monitor\nruns, print timestamp before the event\nmessage in format:\nTimestamp: <Day> <Month> <DD> <hh:mm:ss> <YYYY> <usecs>\nusec\n-ts\n,\n-tshort\nWhen\ntc monitor\nruns, prints short timestamp before the\nevent message in format:\n[<YYYY>-<MM>-<DD>T<hh:mm:ss>.<ms>]\n-echo\nRequest the kernel to send the applied configuration back.\nFORMAT\ntop\nThe show command has additional formatting options:\n-s\n,\n-stats\n,\n-statistics\noutput more statistics about packet usage.\n-d\n,\n-details\noutput more detailed information about rates and cell\nsizes.\n-r\n,\n-raw\noutput raw hex values for handles.\n-p\n,\n-pretty\nfor u32 filter, decode offset and mask values to equivalent\nfilter commands based on TCP/IP.  In JSON output, add\nwhitespace to improve readability.\n-iec\nprint rates in IEC units (ie. 1K = 1024).\n-g\n,\n-graph\nshows classes as ASCII graph. Prints generic stats info\nunder each class if\n-s\noption was specified. Classes can be\nfiltered only by\ndev\noption.\n-c\n[\ncolor\n][\n=\n{\nalways\n|\nauto\n|\nnever\n}\nConfigure color output. If parameter is omitted or\nalways\n,\ncolor output is enabled regardless of stdout state. If\nparameter is\nauto\n, stdout is checked to be a terminal\nbefore enabling color output. If parameter is\nnever\n, color\noutput is disabled. If specified multiple times, the last\none takes precedence. This flag is ignored if\n-json\nis also\ngiven.\n-j\n,\n-json\nDisplay results in JSON format.\n-nm\n,\n-name\nresolve class name from\n/etc/iproute2/tc_cls\nfile or from\nfile specified by\n-cf\noption. This file is just a mapping\nof\nclassid\nto class name:\n# Here is comment\n1:40   voip # Here is another comment\n1:50   web\n1:60   ftp\n1:2    home\ntc\nwill not fail if\n-nm\nwas specified without\n-cf\noption\nbut\n/etc/iproute2/tc_cls\nfile does not exist, which makes\nit possible to pass\n-nm\noption for creating\ntc\nalias.\n-br\n,\n-brief\nPrint only essential data needed to identify the filter and\naction (handle, cookie, etc.) and stats. This option is\ncurrently only supported by\ntc filter show\nand\ntc actions\nls\ncommands.\nEXAMPLES\ntop\ntc -g class show dev eth0\nShows classes as ASCII graph on eth0 interface.\ntc -g -s class show dev eth0\nShows classes as ASCII graph with stats info under each class.\nHISTORY\ntop\ntc\nwas written by Alexey N. Kuznetsov and added in Linux 2.2.\nSEE ALSO\ntop\ntc-basic(8)\n,\ntc-bfifo(8)\n,\ntc-bpf(8)\n,\ntc-cake(8)\n,\ntc-cgroup(8)\n,\ntc-choke(8)\n,\ntc-codel(8)\n,\ntc-drr(8)\n,\ntc-ematch(8)\n,\ntc-ets(8)\n,\ntc-flow(8)\n,\ntc-flower(8)\n,\ntc-fq(8)\n,\ntc-fq_codel(8)\n,\ntc-fq_pie(8)\n,\ntc-fw(8)\n,\ntc-gact(8)\n,\ntc-hfsc(7)\n,\ntc-hfsc(8)\n,\ntc-htb(8)\n,\ntc-mqprio(8)\n,\ntc-pfifo(8)\n,\ntc-pfifo_fast(8)\n,\ntc-pie(8)\n,\ntc-red(8)\n,\ntc-route(8)\n,\ntc-sfb(8)\n,\ntc-sfq(8)\n,\ntc-stab(8)\n,\ntc-tbf(8)\n,\ntc-u32(8)\nUser documentation at\nhttp://lartc.org/\n, but please direct\nbugreports and patches to:\n<netdev@vger.kernel.org>\nAUTHOR\ntop\nManpage maintained by bert hubert (ahu@ds9a.nl)\nCOLOPHON\ntop\nThis page is part of the\niproute2\n(utilities for controlling\nTCP/IP networking and traffic) project.  Information about the\nproject can be found at\nâ¨\nhttp://www.linuxfoundation.org/collaborate/workgroups/networking/iproute2\nâ©.\nIf you have a bug report for this manual page, send it to\nnetdev@vger.kernel.org, shemminger@osdl.org.  This page was\nobtained from the project's upstream Git repository\nâ¨\nhttps://git.kernel.org/pub/scm/network/iproute2/iproute2.git\nâ© on\n2025-08-11.  (At that time, the date of the most recent commit\nthat was found in the repository was 2025-08-08.)  If you discover\nany rendering problems in this HTML version of the page, or you\nbelieve there is a better or more up-to-date source for the page,\nor you have corrections or improvements to the information in this\nCOLOPHON (which is\nnot\npart of the original manual page), send a\nmail to man-pages@man7.org\niproute2                     16 December 2001\nTC\n(8)\nPages that refer to this page:\nbpf(2)\n,\ncgroups(7)\n,\ntc-hfsc(7)\n,\ndcb-buffer(8)\n,\ndcb-maxrate(8)\n,\nnetsniff-ng(8)\n,\ntc-actions(8)\n,\ntc-basic(8)\n,\ntc-bfifo(8)\n,\ntc-bpf(8)\n,\ntc-cake(8)\n,\ntc-cgroup(8)\n,\ntc-choke(8)\n,\ntc-codel(8)\n,\ntc-connmark(8)\n,\ntc-csum(8)\n,\ntc-ct(8)\n,\ntc-ctinfo(8)\n,\ntc-drr(8)\n,\ntc-dualpi2(8)\n,\ntc-ets(8)\n,\ntc-flow(8)\n,\ntc-flower(8)\n,\ntc-fq(8)\n,\ntc-fq_codel(8)\n,\ntc-fq_pie(8)\n,\ntc-fw(8)\n,\ntc-gact(8)\n,\ntc-hfsc(8)\n,\ntc-htb(8)\n,\ntc-ife(8)\n,\ntc-matchall(8)\n,\ntc-mirred(8)\n,\ntc-mpls(8)\n,\ntc-nat(8)\n,\ntc-netem(8)\n,\ntc-pedit(8)\n,\ntc-pfifo_fast(8)\n,\ntc-pie(8)\n,\ntc-police(8)\n,\ntc-red(8)\n,\ntc-route(8)\n,\ntc-sample(8)\n,\ntc-sfb(8)\n,\ntc-sfq(8)\n,\ntc-simple(8)\n,\ntc-skbedit(8)\n,\ntc-skbmod(8)\n,\ntc-stab(8)\n,\ntc-tbf(8)\n,\ntc-tunnel_key(8)\n,\ntc-u32(8)\n,\ntc-vlan(8)\n,\ntrafgen(8)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man8/tc.8.html"}}
{"text": "ethtool(8) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\nethtool(8) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nOPTIONS\n|\nBUGS\n|\nAUTHOR\n|\nAVAILABILITY\n|\nCOLOPHON\nETHTOOL\n(8)               System Manager's Manual\nETHTOOL\n(8)\nNAME\ntop\nethtool - query or control network driver and hardware settings\nSYNOPSIS\ntop\nethtool\ndevname\nethtool -h|--help\nethtool --version\nethtool\n[\n--debug\nN\n]\nargs\nethtool [--disable-netlink]\nargs\nethtool [--json]\nargs\nethtool [-I | --include-statistics]\nargs\nethtool\n[\n--phy\nN\n]\nargs\nethtool --monitor\n[\ncommand\n] [\ndevname\n]\nethtool -a|--show-pause\ndevname\nethtool -A|--pause\ndevname\n[\nautoneg on\n|\noff\n] [\nrx on\n|\noff\n]\n[\ntx on\n|\noff\n]\nethtool -c|--show-coalesce\ndevname\nethtool -C|--coalesce\ndevname\n[\nadaptive-rx on\n|\noff\n]\n[\nadaptive-tx on\n|\noff\n] [\nrx-usecs\nN\n] [\nrx-frames\nN\n]\n[\nrx-usecs-irq\nN\n] [\nrx-frames-irq\nN\n] [\ntx-usecs\nN\n]\n[\ntx-frames\nN\n] [\ntx-usecs-irq\nN\n] [\ntx-frames-irq\nN\n]\n[\nstats-block-usecs\nN\n] [\npkt-rate-low\nN\n] [\nrx-usecs-low\nN\n]\n[\nrx-frames-low\nN\n] [\ntx-usecs-low\nN\n] [\ntx-frames-low\nN\n]\n[\npkt-rate-high\nN\n] [\nrx-usecs-high\nN\n] [\nrx-frames-high\nN\n]\n[\ntx-usecs-high\nN\n] [\ntx-frames-high\nN\n] [\nsample-interval\nN\n]\n[\ncqe-mode-rx on\n|\noff\n] [\ncqe-mode-tx on\n|\noff\n]\n[\ntx-aggr-max-bytes\nN\n] [\ntx-aggr-max-frames\nN\n]\n[\ntx-aggr-time-usecs\nN\n]\nethtool -g|--show-ring\ndevname\nethtool -G|--set-ring\ndevname\n[\nrx\nN\n] [\nrx-mini\nN\n] [\nrx-jumbo\nN\n]\n[\ntx\nN\n] [\nrx-buf-len\nN\n] [\ntcp-data-split auto\n|\non\n|\noff\n]\n[\nhds-thresh\nN\n] [\ncqe-size\nN\n] [\ntx-push\nN\n] [\nrx-push\nN\n]\n[\ntx-push-buf-len\nN\n]\nethtool -i|--driver\ndevname\nethtool -d|--register-dump\ndevname\n[\nraw on\n|\noff\n] [\nhex on\n|\noff\n] [\nfile\nname\n]\nethtool -e|--eeprom-dump\ndevname\n[\nraw on\n|\noff\n] [\noffset\nN\n]\n[\nlength\nN\n]\nethtool -E|--change-eeprom\ndevname\n[\nmagic\nN\n] [\noffset\nN\n] [\nlength\nN\n]\n[\nvalue\nN\n]\nethtool -k|--show-features|--show-offload\ndevname\nethtool -K|--features|--offload\ndevname feature\non\n|\noff\n...\nethtool -p|--identify\ndevname\n[\nN\n]\nethtool -P|--show-permaddr\ndevname\nethtool -r|--negotiate\ndevname\nethtool -S|--statistics\ndevname\n[\n--all-groups\n|\n--groups\n[\neth-phy\n]\n[\neth-mac\n] [\neth-ctrl\n] [\nrmon\n] ]\nethtool --phy-statistics\ndevname\nethtool -t|--test\ndevname\n[\noffline\n|\nonline\n|\nexternal_lb\n]\nethtool -s\ndevname\n[\nspeed\nN\n] [\nlanes\nN\n] [\nduplex half\n|\nfull\n]\n[\nport tp\n|\naui\n|\nbnc\n|\nmii\n] [\nmdix auto\n|\non\n|\noff\n] [\nautoneg on\n|\noff\n]\n[\nadvertise\nN\n[\n/\nM\n] |\nadvertise\nmode\non\n|\noff\n...]  [\nphyad\nN\n]\n[\nxcvr internal\n|\nexternal\n] [\nwol\nN\n[\n/\nM\n]\n|\nwol p\n|\nu\n|\nm\n|\nb\n|\na\n|\ng\n|\ns\n|\nf|d...]\n[\nsopass\nxx\n:\nyy\n:\nzz\n:\naa\n:\nbb\n:\ncc\n]\n[\nmaster-slave preferred-master\n|\npreferred-slave\n|\nforced-\nmaster\n|\nforced-slave\n] [\nmsglvl\nN\n[/\nM\n] |\nmsglvl\ntype\non\n|\noff\n...]\nethtool -n|-u|--show-nfc|--show-ntuple\ndevname\n[\nrx-flow-hash tcp4\n|\nudp4\n|\nah4\n|\nesp4\n|\nsctp4\n|\ntcp6\n|\nudp6\n|\nah6\n|\nesp6\n|\nsctp6 |\nrule\nN\n]\nethtool -N|-U|--config-nfc|--config-ntuple\ndevname\nrx-flow-hash tcp4\n|\nudp4\n|\nah4\n|\nesp4\n|\nsctp4\n|\ntcp6\n|\nudp6\n|\nah6\n|\nesp6\n|\nsctp6\nm\n|\nv\n|\nt\n|\ns\n|\nd\n|\nf\n|\nn\n|\nr\n...\n|\nflow-type\nether|ip4|tcp4|udp4|sctp4|ah4|esp4|ip6|tcp6|udp6|ah6|esp6|sctp6\n[\nsrc\nxx\n:\nyy\n:\nzz\n:\naa\n:\nbb\n:\ncc\n[\nm\nxx\n:\nyy\n:\nzz\n:\naa\n:\nbb\n:\ncc\n]]\n[\ndst\nxx\n:\nyy\n:\nzz\n:\naa\n:\nbb\n:\ncc\n[\nm\nxx\n:\nyy\n:\nzz\n:\naa\n:\nbb\n:\ncc\n]]\n[\nproto\nN\n[\nm\nN\n]] [\nsrc-ip\nip-address\n[\nm\nip-address\n]]\n[\ndst-ip\nip-address\n[\nm\nip-address\n]] [\ntos\nN\n[\nm\nN\n]]\n[\ntclass\nN\n[\nm\nN\n]] [\nl4proto\nN\n[\nm\nN\n]] [\nsrc-port\nN\n[\nm\nN\n]]\n[\ndst-port\nN\n[\nm\nN\n]] [\nspi\nN\n[\nm\nN\n]] [\nl4data\nN\n[\nm\nN\n]]\n[\nvlan-etype\nN\n[\nm\nN\n]] [\nvlan\nN\n[\nm\nN\n]] [\nuser-def\nN\n[\nm\nN\n]]\n[\ndst-mac\nxx\n:\nyy\n:\nzz\n:\naa\n:\nbb\n:\ncc\n[\nm\nxx\n:\nyy\n:\nzz\n:\naa\n:\nbb\n:\ncc\n]]\n[\naction\nN\n] [\ncontext\nN\n] [\nloc\nN\n] |\ndelete\nN\nethtool -w|--get-dump\ndevname\n[\ndata\nfilename\n]\nethtool -W|--set-dump\ndevname N\nethtool -T|--show-time-stamping\ndevname\n[\nindex\nN\nqualifier\nprecise|approx\n]\nethtool --get-hwtimestamp-cfg\ndevname\nethtool --set-hwtimestamp-cfg\ndevname\n[\nindex\nN\nqualifier\nprecise|approx\n]\nethtool -x|--show-rxfh-indir|--show-rxfh\ndevname\nethtool -X|--set-rxfh-indir|--rxfh\ndevname\n[\nhkey\nxx\n:\nyy\n:\nzz\n:\naa\n:\nbb\n:\ncc\n:...]  [\nstart\nN\n] [\nequal\nN\n|\nweight\nW0 W1\n... |\ndefault\n] [\nhfunc\nFUNC\n] [\nxfrm symmetric-\nxor\n|\nsymmetric-or-xor\n|\nnone\n] [\ncontext\nCTX\n|\nnew\n] [\ndelete\n]\nethtool -f|--flash\ndevname file\n[\nN\n]\nethtool -l|--show-channels\ndevname\nethtool -L|--set-channels\ndevname\n[\nrx\nN\n] [\ntx\nN\n] [\nother\nN\n]\n[\ncombined\nN\n]\nethtool -m|--dump-module-eeprom|--module-info\ndevname\n[\nraw on\n|\noff\n]\n[\nhex on\n|\noff\n] [\noffset\nN\n] [\nlength\nN\n] [\npage\nN\n] [\nbank\nN\n]\n[\ni2c\nN\n]\nethtool --show-priv-flags\ndevname\nethtool --set-priv-flags\ndevname flag\non\n|\noff\n...\nethtool --show-eee\ndevname\nethtool --set-eee\ndevname\n[\neee on\n|\noff\n] [\ntx-lpi on\n|\noff\n] [\ntx-\ntimer\nN\n] [\nadvertise\nN\n]\nethtool --set-phy-tunable\ndevname\n[\ndownshift on\n|\noff\n[\ncount\nN\n] ] [\nfast-link-down on\n|\noff\n[\nmsecs\nN\n] ] [\nenergy-detect-power-down on\n|\noff\n[\nmsecs\nN\n] ]\nethtool --get-phy-tunable\ndevname\n[\ndownshift\n] [\nfast-link-down\n]\n[\nenergy-detect-power-down\n]\nethtool --get-tunable\ndevname\n[\nrx-copybreak\n] [\ntx-copybreak\n] [\ntx-\nbuf-size\n] [\npfc-prevention-tout\n]\nethtool --set-tunable\ndevname\n[\nrx-copybreak\nN\n] [\ntx-copybreak\nN\n]\n[\ntx-buf-size\nN\n] [\npfc-prevention-tout\nN\n]\nethtool --reset\ndevname\n[\nflags\nN\n] [\nmgmt\n] [\nmgmt-shared\n] [\nirq\n] [\nirq-\nshared\n] [\ndma\n] [\ndma-shared\n] [\nfilter\n] [\nfilter-shared\n]\n[\noffload\n] [\noffload-shared\n] [\nmac\n] [\nmac-shared\n] [\nphy\n] [\nphy-\nshared\n] [\nram\n] [\nram-shared\n] [\nap\n] [\nap-shared\n] [\ndedicated\n]\n[\nall\n]\nethtool --show-fec\ndevname\nethtool --set-fec\ndevname\nencoding auto\n|\noff\n|\nrs\n|\nbaser\n|\nllrs\n[...]\nethtool -Q|--per-queue\ndevname\n[\nqueue_mask\n%x\n]\nsub_command\n...\nethtool --cable-test\ndevname\nethtool --cable-test-tdr\ndevname\n[\nfirst\nN\n] [\nlast\nN\n] [\nstep\nN\n]\n[\npair\nN\n]\nethtool --show-tunnels\ndevname\nethtool --show-module\ndevname\nethtool --set-module\ndevname\n[\npower-mode-policy high\n|\nauto\n]\nethtool --get-plca-cfg\ndevname\nethtool --set-plca-cfg\ndevname\n[\nenable on\n|\noff\n] [\nnode-id\nN\n]\n[\nnode-cnt\nN\n] [\nto-tmr\nN\n] [\nburst-cnt\nN\n] [\nburst-tmr\nN\n]\nethtool --get-plca-status\ndevname\nethtool --show-mm\ndevname\nethtool --set-mm\ndevname\n[\nverify-enabled on\n|\noff\n] [\nverify-time N\n]\n[\ntx-enabled on\n|\noff\n] [\npmac-enabled on\n|\noff\n] [\ntx-min-frag-size\nN\n]\nethtool --show-pse\ndevname\nethtool --set-pse\ndevname\n[\npodl-pse-admin-control enable\n|\ndisable\n]\n[\nc33-pse-admin-control enable\n|\ndisable\n]\n[\nc33-pse-avail-pw-limit\nN\n]\nethtool --flash-module-firmware\ndevname\nfile\nFILE\n[\npass\nPASS\n]\nethtool --show-phys\ndevname\nDESCRIPTION\ntop\nethtool\nis  used  to  query and control network device driver and\nhardware settings, particularly for wired Ethernet devices.\ndevname\nis the name of the network device on which ethtool  should\noperate.\nOPTIONS\ntop\nethtool\nwith  a single argument specifying the device name prints\ncurrent settings of the specified device.\n-h --help\nShows a short help message.\n--version\nShows the ethtool version number.\n--debug\nN\nTurns on debugging messages. Argument is interpreted as a\nmask:\n0x01  Parser information\n0x02  Summary of netlink messages\n0x04  Hex dump of sent netlink messages\n0x08  Hex dump of received netlink messages\n0x10  Structure of netlink messages\n--disable-netlink\nDo not use netlink and fall back to the ioctl interface if\npossible.\n--json\nOutput results in JavaScript Object Notation (JSON). Only a\nsubset of options support this. Those which do not will\ncontinue to output plain text in the presence of this opâ\ntion.\n-I --include-statistics\nInclude command-related statistics in the output. This opâ\ntion allows displaying relevant device statistics for seâ\nlected get commands.\n--phy\nN\nTarget a PHY within the interface. The PHY index can be reâ\ntrieved with\n--show-phys. PHY index 0 targets the phy deâ\nvice directly attached to\nthe ethernet MAC, if any.  The\nfollowing commands can accept a PHY index:\n--cable-test\n--cable-test-tdr\n--get-plca-cfg\n--set-plca-cfg\n--get-plca-status\n--show-pse\n--set-pse\n-a --show-pause\nQueries the specified Ethernet device for pause parameter\ninformation.\n--src aggregate|emac|pmac\nIf the MAC Merge layer is supported, request a particuâ\nlar source of device statistics (eMAC or pMAC, or their\naggregate). Only valid if ethtool was invoked with the\n-I --include-statistics\nargument.\n-A --pause\nChanges the pause parameters of the specified Ethernet deâ\nvice.\nautoneg on\n|\noff\nSpecifies whether pause autonegotiation should be enâ\nabled.\nrx on\n|\noff\nSpecifies whether RX pause should be enabled.\ntx on\n|\noff\nSpecifies whether TX pause should be enabled.\n-c --show-coalesce\nQueries the specified network device for coalescing inforâ\nmation.\n-C --coalesce\nChanges the coalescing settings of the specified network\ndevice.\n-g --show-ring\nQueries the specified network device for rx/tx ring parameâ\nter information.\n-G --set-ring\nChanges the rx/tx ring parameters of the specified network\ndevice.\nrx\nN\nChanges the number of ring entries for the Rx ring.\nrx-mini\nN\nChanges the number of ring entries for the Rx Mini\nring.\nrx-jumbo\nN\nChanges the number of ring entries for the Rx Jumbo\nring.\ntx\nN\nChanges the number of ring entries for the Tx ring.\nrx-buf-len\nN\nChanges the size of a buffer in the Rx ring.\ntcp-data-split\nauto|on|off\nSpecifies the state of TCP data split.\nhds-thresh\nN\nSpecifies the threshold value of tcp data split\ncqe-size\nN\nChanges the size of completion queue event.\ntx-push\non|off\nSpecifies whether TX push should be enabled.\nrx-push\non|off\nSpecifies whether RX push should be enabled.\ntx-push-buf-len\nN\nSpecifies the maximum number of bytes of a transmitted\npacket a driver can push directly to the underlying deâ\nvice\n-i --driver\nQueries the specified network device for associated driver\ninformation.\n-d --register-dump\nRetrieves and prints a register dump for the specified netâ\nwork device.  The register format for some devices is known\nand decoded others are printed in hex.  When\nraw\nis enâ\nabled, then ethtool dumps the raw register data to stdout.\nIf\nfile\nis specified, then use contents of previous raw\nregister dump, rather than reading from the device.\n-e --eeprom-dump\nRetrieves and prints an EEPROM dump for the specified netâ\nwork device.  When raw is enabled, then it dumps the raw\nEEPROM data to stdout. The length and offset parameters alâ\nlow dumping certain portions of the EEPROM.  Default is to\ndump the entire EEPROM.\nraw\non|off\noffset\nN\nlength\nN\n-E --change-eeprom\nIf value is specified, changes EEPROM byte for the speciâ\nfied network device.  offset and value specify which byte\nand it's new value. If value is not specified, stdin is\nread and written to the EEPROM. The length and offset paraâ\nmeters allow writing to certain portions of the EEPROM.\nBecause of the persistent nature of writing to the EEPROM,\na device-specific magic key must be specified to prevent\nthe accidental writing to the EEPROM.\n-k --show-features --show-offload\nQueries the specified network device for the state of proâ\ntocol offload and other features.\n-K --features --offload\nChanges the offload parameters and other features of the\nspecified network device.  The following feature names are\nbuilt-in and others may be defined by the kernel.\nrx on\n|\noff\nSpecifies whether RX checksumming should be enabled.\ntx on\n|\noff\nSpecifies whether TX checksumming should be enabled.\nsg on\n|\noff\nSpecifies whether scatter-gather should be enabled.\ntso on\n|\noff\nSpecifies whether TCP segmentation offload should be\nenabled.\nufo on\n|\noff\nSpecifies whether UDP fragmentation offload should be\nenabled\ngso on\n|\noff\nSpecifies whether generic segmentation offload should\nbe enabled\ngro on\n|\noff\nSpecifies whether generic receive offload should be enâ\nabled\nlro on\n|\noff\nSpecifies whether large receive offload should be enâ\nabled\nrxvlan on\n|\noff\nSpecifies whether RX VLAN acceleration should be enâ\nabled\ntxvlan on\n|\noff\nSpecifies whether TX VLAN acceleration should be enâ\nabled\nntuple on\n|\noff\nSpecifies whether Rx ntuple filters and actions should\nbe enabled\nrxhash on\n|\noff\nSpecifies whether receive hashing offload should be enâ\nabled\n-p --identify\nInitiates adapter-specific action intended to enable an opâ\nerator to easily identify the adapter by sight.  Typically\nthis involves blinking one or more LEDs on the specific\nnetwork port.\n[\nN\n]   Length of time to perform phys-id, in seconds.\n-P --show-permaddr\nQueries the specified network device for permanent hardware\naddress.\n-r --negotiate\nRestarts auto-negotiation on the specified Ethernet device,\nif auto-negotiation is enabled.\n-S --statistics\nQueries the specified network device for standard (IEEE,\nIETF, etc.), or NIC- and driver-specific statistics. NIC-\nand driver-specific statistics are requested when no group\nof statistics is specified.\nNIC- and driver-specific statistics and standard statistics\nare independent, devices may implement either, both or\nnone. There is little commonality between naming of NIC-\nand driver-specific statistics across vendors.\n--all-groups\n--groups [eth-phy] [eth-mac] [eth-ctrl] [rmon]\nRequest groups of standard device statistics.\n--src aggregate|emac|pmac\nIf the MAC Merge layer is supported, request a particuâ\nlar source of device statistics (eMAC or pMAC, or their\naggregate).\n--phy-statistics\nQueries the specified network device for PHY specific staâ\ntistics.\n-t --test\nExecutes adapter selftest on the specified network device.\nPossible test modes are:\noffline\nPerform full set of tests, possibly interrupting normal\noperation during the tests,\nonline\nPerform limited set of tests, not interrupting normal\noperation,\nexternal_lb\nPerform full set of tests, as for\noffline\n, and addiâ\ntionally an external-loopback test.\n-s --change\nAllows changing some or all settings of the specified netâ\nwork device.  All following options only apply if\n-s\nwas\nspecified.\nspeed\nN\nSet speed in Mb/s.\nethtool\nwith just the device name\nas an argument will show you the supported device\nspeeds.\nlanes\nN\nSet number of lanes.\nduplex half\n|\nfull\nSets full or half duplex mode.\nport tp\n|\naui\n|\nbnc\n|\nmii\nSelects device port.\nmaster-slave preferred-master\n|\npreferred-slave\n|\nforced-masâ\nter\n|\nforced-slave\nConfigure MASTER/SLAVE role of the PHY. When the PHY is\nconfigured as MASTER, the PMA Transmit function shall\nsource TX_TCLK from a local clock source. When configâ\nured as SLAVE, the PMA Transmit function shall source\nTX_TCLK from the clock recovered from data stream proâ\nvided by MASTER. Not all devices support this.\npreferred-master\nPrefer MASTER role on autonegotiation\npreferred-slave\nPrefer SLAVE role on autonegotiation\nforced-master\nForce the PHY in MASTER role. Can be used without autonegotiation\nforced-slave\nForce the PHY in SLAVE role. Can be used without autonegotiation\nmdix auto\n|\non\n|\noff\nSelects MDI-X mode for port. May be used to override\nthe automatic detection feature of most adapters. An\nargument of\nauto\nmeans automatic detection of MDI staâ\ntus,\non\nforces MDI-X (crossover) mode, while\noff\nmeans\nMDI (straight through) mode.  The driver should guaranâ\ntee that this command takes effect immediately, and if\nnecessary may reset the link to cause the change to\ntake effect.\nautoneg on\n|\noff\nSpecifies whether autonegotiation should be enabled.\nAutonegotiation is enabled by default, but in some netâ\nwork devices may have trouble with it, so you can disâ\nable it if really necessary.\nadvertise\nN\nSets the speed and duplex advertised by autonegotiaâ\ntion.  The argument is a hexadecimal value using one or\na combination of the following values:\n0x001\n10baseT Half\n0x002\n10baseT Full\n0x100000000000000000000000\n10baseT1L Full\n0x8000000000000000000000000\n10baseT1S Full\n0x10000000000000000000000000\n10baseT1S Half\n0x20000000000000000000000000\n10baseT1S_P2MP Half\n0x40000000000000000000000000\n10baseT1BRR Full\n0x004\n100baseT Half\n0x008\n100baseT Full\n0x80000000000000000\n100baseT1 Full\n0x40000000000000000000000\n100baseFX Half\n0x80000000000000000000000\n100baseFX Full\n0x010\n1000baseT Half\n(not supported by IEEE standards)\n0x020\n1000baseT Full\n0x20000\n1000baseKX Full\n0x20000000000\n1000baseX Full\n0x100000000000000000\n1000baseT1 Full\n0x8000\n2500baseX Full\n(not supported by IEEE standards)\n0x800000000000\n2500baseT Full\n0x1000000000000\n5000baseT Full\n0x1000\n10000baseT Full\n0x40000\n10000baseKX4 Full\n0x80000\n10000baseKR Full\n0x100000\n10000baseR_FEC\n0x40000000000\n10000baseCR Full\n0x80000000000\n10000baseSR Full\n0x100000000000\n10000baseLR Full\n0x200000000000\n10000baseLRM Full\n0x400000000000\n10000baseER Full\n0x200000\n20000baseMLD2 Full\n(not supported by IEEE standards)\n0x400000\n20000baseKR2 Full\n(not supported by IEEE standards)\n0x80000000\n25000baseCR Full\n0x100000000\n25000baseKR Full\n0x200000000\n25000baseSR Full\n0x800000\n40000baseKR4 Full\n0x1000000\n40000baseCR4 Full\n0x2000000\n40000baseSR4 Full\n0x4000000\n40000baseLR4 Full\n0x400000000\n50000baseCR2 Full\n0x800000000\n50000baseKR2 Full\n0x10000000000\n50000baseSR2 Full\n0x10000000000000\n50000baseKR Full\n0x20000000000000\n50000baseSR Full\n0x40000000000000\n50000baseCR Full\n0x80000000000000\n50000baseLR_ER_FR Full\n0x100000000000000\n50000baseDR Full\n0x8000000\n56000baseKR4 Full\n0x10000000\n56000baseCR4 Full\n0x20000000\n56000baseSR4 Full\n0x40000000\n56000baseLR4 Full\n0x1000000000\n100000baseKR4 Full\n0x2000000000\n100000baseSR4 Full\n0x4000000000\n100000baseCR4 Full\n0x8000000000\n100000baseLR4_ER4 Full\n0x200000000000000\n100000baseKR2 Full\n0x400000000000000\n100000baseSR2 Full\n0x800000000000000\n100000baseCR2 Full\n0x1000000000000000\n100000baseLR2_ER2_FR2 Full\n0x2000000000000000\n100000baseDR2 Full\n0x8000000000000000000\n100000baseKR Full\n0x10000000000000000000\n100000baseSR Full\n0x20000000000000000000\n100000baseLR_ER_FR Full\n0x40000000000000000000\n100000baseCR Full\n0x80000000000000000000\n100000baseDR Full\n0x4000000000000000\n200000baseKR4 Full\n0x8000000000000000\n200000baseSR4 Full\n0x10000000000000000\n200000baseLR4_ER4_FR4 Full\n0x20000000000000000\n200000baseDR4 Full\n0x40000000000000000\n200000baseCR4 Full\n0x100000000000000000000\n200000baseKR2 Full\n0x200000000000000000000\n200000baseSR2 Full\n0x400000000000000000000\n200000baseLR2_ER2_FR2 Full\n0x800000000000000000000\n200000baseDR2 Full\n0x1000000000000000000000\n200000baseCR2 Full\n0x80000000000000000000000000\n200000baseCR Full\n0x100000000000000000000000000\n200000baseKR Full\n0x200000000000000000000000000\n200000baseDR Full\n0x400000000000000000000000000\n200000baseDR_2 Full\n0x800000000000000000000000000\n200000baseSR Full\n0x1000000000000000000000000000\n200000baseVR Full\n0x200000000000000000\n400000baseKR8 Full\n0x400000000000000000\n400000baseSR8 Full\n0x800000000000000000\n400000baseLR8_ER8_FR8 Full\n0x1000000000000000000\n400000baseDR8 Full\n0x2000000000000000000\n400000baseCR8 Full\n0x2000000000000000000000\n400000baseKR4 Full\n0x4000000000000000000000\n400000baseSR4 Full\n0x8000000000000000000000\n400000baseLR4_ER4_FR4 Full\n0x10000000000000000000000\n400000baseDR4 Full\n0x20000000000000000000000\n400000baseCR4 Full\n0x2000000000000000000000000000\n400000baseCR2 Full\n0x4000000000000000000000000000\n400000baseKR2 Full\n0x8000000000000000000000000000\n400000baseDR2 Full\n0x10000000000000000000000000000\n400000baseDR2_2 Full\n0x20000000000000000000000000000\n400000baseSR2 Full\n0x40000000000000000000000000000\n400000baseVR2 Full\n0x200000000000000000000000\n800000baseCR8 Full\n0x400000000000000000000000\n800000baseKR8 Full\n0x800000000000000000000000\n800000baseDR8 Full\n0x1000000000000000000000000\n800000baseDR8_2 Full\n0x2000000000000000000000000\n800000baseSR8 Full\n0x4000000000000000000000000\n800000baseVR8 Full\n0x80000000000000000000000000000\n800000baseCR4 Full\n0x100000000000000000000000000000\n800000baseKR4 Full\n0x200000000000000000000000000000\n800000baseDR4 Full\n0x400000000000000000000000000000\n800000baseDR4_2 Full\n0x800000000000000000000000000000\n800000baseSR4 Full\n0x1000000000000000000000000000000\n800000baseVR4 Full\nphyad\nN\nPHY address.\nxcvr internal\n|\nexternal\nSelects transceiver type. Currently only internal and\nexternal can be specified, in the future further types\nmight be added.\nwol p\n|\nu\n|\nm\n|\nb\n|\na\n|\ng\n|\ns\n|\nf|d...\nSets Wake-on-LAN options.  Not all devices support\nthis.  The argument to this option is a string of charâ\nacters specifying which options to enable.\np\nWake on PHY activity\nu\nWake on unicast messages\nm\nWake on multicast messages\nb\nWake on broadcast messages\na\nWake on ARP\ng\nWake on MagicPacketâ¢\ns\nEnable SecureOnâ¢ password for MagicPacketâ¢\nf\nWake on filter(s)\nd\nDisable (wake on nothing).  This option\nclears all previous options.\nsopass\nxx\n:\nyy\n:\nzz\n:\naa\n:\nbb\n:\ncc\nSets the SecureOnâ¢ password.  The argument to this opâ\ntion must be 6 bytes in Ethernet MAC hex format\n(\nxx\n:\nyy\n:\nzz\n:\naa\n:\nbb\n:\ncc\n).\nmsglvl\nN\nmsglvl\ntype\non\n|\noff\n...\nSets the driver message type flags by name or number.\ntype\nnames the type of message to enable or disable;\nN\nspecifies the new flags numerically. The defined type\nnames and numbers are:\ndrv\n0x0001  General driver status\nprobe\n0x0002  Hardware probing\nlink\n0x0004  Link state\ntimer\n0x0008  Periodic status check\nifdown\n0x0010  Interface being brought down\nifup\n0x0020  Interface being brought up\nrx_err\n0x0040  Receive error\ntx_err\n0x0080  Transmit error\ntx_queued\n0x0100  Transmit queueing\nintr\n0x0200  Interrupt handling\ntx_done\n0x0400  Transmit completion\nrx_status\n0x0800  Receive completion\npktdata\n0x1000  Packet contents\nhw\n0x2000  Hardware status\nwol\n0x4000  Wake-on-LAN status\nThe precise meanings of these type flags differ between\ndrivers.\n-n -u --show-nfc --show-ntuple\nRetrieves receive network flow classification options or\nrules.\nrx-flow-hash tcp4\n|\nudp4\n|\nah4\n|\nesp4\n|\nsctp4\n|\ntcp6\n|\nudp6\n|\nah6\n|\nesp6\n|\nsctp6\nRetrieves the hash options for the specified flow type.\ntcp4\nTCP over IPv4\nudp4\nUDP over IPv4\nah4\nIPSEC AH over IPv4\nesp4\nIPSEC ESP over IPv4\nsctp4\nSCTP over IPv4\ntcp6\nTCP over IPv6\nudp6\nUDP over IPv6\nah6\nIPSEC AH over IPv6\nesp6\nIPSEC ESP over IPv6\nsctp6\nSCTP over IPv6\nrule\nN\nRetrieves the RX classification rule with the given ID.\n-N -U --config-nfc --config-ntuple\nConfigures receive network flow classification options or\nrules.\nrx-flow-hash tcp4\n|\nudp4\n|\nah4\n|\nesp4\n|\nsctp4\n|\ntcp6\n|\nudp6\n|\nah6\n|\nesp6\n|\nsctp6\nm\n|\nv\n|\nt\n|\ns\n|\nd\n|\nf\n|\nn\n|\nr\n...\nConfigures the hash options for the specified flow\ntype.\nm\nHash on the Layer 2 destination address of the rx packet.\nv\nHash on the VLAN tag of the rx packet.\nt\nHash on the Layer 3 protocol field of the rx packet.\ns\nHash on the IP source address of the rx packet.\nd\nHash on the IP destination address of the rx packet.\nf\nHash on bytes 0 and 1 of the Layer 4 header of the rx packet.\nn\nHash on bytes 2 and 3 of the Layer 4 header of the rx packet.\nr\nDiscard all packets of this flow type. When this option is\nset, all other options are ignored.\nflow-type\nether|ip4|tcp4|udp4|sctp4|ah4|esp4|ip6|tcp6|udp6|ah6|esp6|sctp6\nInserts or updates a classification rule for the speciâ\nfied flow type.\nether\nEthernet\nip4\nRaw IPv4\ntcp4\nTCP over IPv4\nudp4\nUDP over IPv4\nsctp4\nSCTP over IPv4\nah4\nIPSEC AH over IPv4\nesp4\nIPSEC ESP over IPv4\nip6\nRaw IPv6\ntcp6\nTCP over IPv6\nudp6\nUDP over IPv6\nsctp6\nSCTP over IPv6\nah6\nIPSEC AH over IPv6\nesp6\nIPSEC ESP over IPv6\nFor all fields that allow both a value and a mask to be speciâ\nfied, the mask may be specified immediately after the value\nusing the\nm\nkeyword, or separately using the field name keyâ\nword with\n-mask\nappended, e.g.\nsrc-mask\n.\nsrc\nxx\n:\nyy\n:\nzz\n:\naa\n:\nbb\n:\ncc\n[\nm\nxx\n:\nyy\n:\nzz\n:\naa\n:\nbb\n:\ncc\n]\nIncludes the source MAC address, specified as 6 bytes\nin hexadecimal separated by colons, along with an opâ\ntional mask.  Valid only for flow-type ether.\ndst\nxx\n:\nyy\n:\nzz\n:\naa\n:\nbb\n:\ncc\n[\nm\nxx\n:\nyy\n:\nzz\n:\naa\n:\nbb\n:\ncc\n]\nIncludes the destination MAC address, specified as 6\nbytes in hexadecimal separated by colons, along with an\noptional mask.  Valid only for flow-type ether.\nproto\nN\n[\nm\nN\n]\nIncludes the Ethernet protocol number (ethertype) and\nan optional mask.  Valid only for flow-type ether.\nsrc-ip\nip-address\n[\nm\nip-address\n]\nSpecify the source IP address of the incoming packet to\nmatch along with an optional mask.  Valid for all IP\nbased flow-types.\ndst-ip\nip-address\n[\nm\nip-address\n]\nSpecify the destination IP address of the incoming\npacket to match along with an optional mask.  Valid for\nall IP based flow-types.\ntos\nN\n[\nm\nN\n]\nSpecify the value of the Type of Service field in the\nincoming packet to match along with an optional mask.\nApplies to all IPv4 based flow-types.\ntclass\nN\n[\nm\nN\n]\nSpecify the value of the Traffic Class field in the inâ\ncoming packet to match along with an optional mask.\nApplies to all IPv6 based flow-types.\nl4proto\nN\n[\nm\nN\n]\nIncludes the layer 4 protocol number and optional mask.\nValid only for flow-types ip4 and ip6.\nsrc-port\nN\n[\nm\nN\n]\nSpecify the value of the source port field (applicable\nto TCP/UDP packets) in the incoming packet to match\nalong with an optional mask.  Valid for flow-types ip4,\ntcp4, udp4, and sctp4 and their IPv6 equivalents.\ndst-port\nN\n[\nm\nN\n]\nSpecify the value of the destination port field (apâ\nplicable to TCP/UDP packets)in the incoming packet to\nmatch along with an optional mask.  Valid for flow-\ntypes ip4, tcp4, udp4, and sctp4 and their IPv6 equivaâ\nlents.\nspi\nN\n[\nm\nN\n]\nSpecify the value of the security parameter index field\n(applicable to AH/ESP packets)in the incoming packet to\nmatch along with an optional mask.  Valid for flow-\ntypes ip4, ah4, and esp4 and their IPv6 equivalents.\nl4data\nN\n[\nm\nN\n]\nSpecify the value of the first 4 Bytes of Layer 4 in\nthe incoming packet to match along with an optional\nmask.  Valid for ip4 and ip6 flow-types.\nvlan-etype\nN\n[\nm\nN\n]\nIncludes the VLAN tag Ethertype and an optional mask.\nvlan\nN\n[\nm\nN\n]\nIncludes the VLAN tag and an optional mask.\nuser-def\nN\n[\nm\nN\n]\nIncludes 64-bits of user-specific data and an optional\nmask.\ndst-mac\nxx\n:\nyy\n:\nzz\n:\naa\n:\nbb\n:\ncc\n[\nm\nxx\n:\nyy\n:\nzz\n:\naa\n:\nbb\n:\ncc\n]\nIncludes the destination MAC address, specified as 6\nbytes in hexadecimal separated by colons, along with an\noptional mask.  Valid for all IP based flow-types.\naction\nN\nSpecifies the Rx queue to send packets to, or some othâ\ner action.\n-1\nDrop the matched flow\n-2\nUse the matched flow as a Wake-on-LAN filter\n0 or higher\nRx queue to route the flow\ncontext\nN\nSpecifies the RSS context to spread packets over multiâ\nple queues; either\n0\nfor the default RSS context, or a\nvalue returned by\nethtool -X\n...\ncontext new\n.  If comâ\nbined with\naction\nor\nqueue\n, the Rx queue specified will\nbe added to the value read from the RSS indirection taâ\nble to produce the actual Rx queue to deliver to.\nvf\nN\nSpecifies the Virtual Function the filter applies to.\nNot compatible with action.\nqueue\nN\nSpecifies the Rx queue to send packets to. Not compatiâ\nble with action.\nloc\nN\nSpecify the location/ID to insert the rule. This will\noverwrite any rule present in that location and will\nnot go through any of the rule ordering process.\ndelete\nN\nDeletes the RX classification rule with the given ID.\n-w --get-dump\nRetrieves and prints firmware dump for the specified netâ\nwork device.  By default, it prints out the dump flag, verâ\nsion and length of the dump data.  When\ndata\nis indicated,\nthen ethtool fetches the dump data and directs it to a\nfile.\n-W --set-dump\nSets the dump flag for the device.\n-T --show-time-stamping\nShow the device's time stamping capabilities and associated\nPTP hardware clock. Show the capabilities of the currently\nselected time stamping if no\nindex\nand\nqualifier\nis providâ\ned.\nindex\nN\nIndex of the ptp hardware clock\nqualifier\nprecise\n|\napprox\nQualifier of the ptp hardware clock. Mainly \"precise\"\nthe default one is for IEEE 1588 quality and \"approx\"\nis for NICs DMA point.\n--get-hwtimestamp-cfg\nShow the selected time stamping PTP hardware clock configuâ\nration.\n--set-hwtimestamp-cfg\nSelect the device's time stamping PTP hardware clock.\nindex\nN\nIndex of the ptp hardware clock\nqualifier\nprecise\n|\napprox\nQualifier of the ptp hardware clock. Mainly \"precise\"\nthe default one is for IEEE 1588 quality and \"approx\"\nis for NICs DMA point.\n-x --show-rxfh-indir --show-rxfh\nRetrieves the receive flow hash indirection table and/or\nRSS hash key.\n-X --set-rxfh-indir --rxfh\nConfigures the receive flow hash indirection table and/or\nRSS hash key.\nhkey\nSets RSS hash key of the specified network device. RSS\nhash key should be of device supported length.  Hash\nkey format must be in xx:yy:zz:aa:bb:cc format meaning\nboth the nibbles of a byte should be mentioned even if\na nibble is zero.\nhfunc\nSets RSS hash function of the specified network device.\nList of RSS hash functions which kernel supports is\nshown as a part of the --show-rxfh command output.\nxfrm\nSets the RSS input transformation. Currently, only the\nsymmetric-xor and symmetric-or-xor\ntransformations are\nsupported where the NIC XORs/ORs the L3 and/or L4\nsource and destination fields (as selected by\n--config-\nnfc rx-flow-hash\n) before passing them to the hash alâ\ngorithm. The RSS hash function will then yield the same\nhash for the other flow direction where the source and\ndestination fields are swapped (i.e. Symmetric RSS).\nNote that this operation reduces the entropy of the inâ\nput set and the hash algorithm could potentially be exâ\nploited. Switch off by\nxfrm none.\nstart\nN\nFor the\nequal\nand\nweight\noptions, sets the starting reâ\nceive queue for spreading flows to\nN\n.\nequal\nN\nSets the receive flow hash indirection table to spread\nflows evenly between the first\nN\nreceive queues.\nweight\nW0 W1\n...\nSets the receive flow hash indirection table to spread\nflows between receive queues according to the given\nweights.  The sum of the weights must be non-zero and\nmust not exceed the size of the indirection table.\ndefault\nSets the receive flow hash indirection table to its deâ\nfault value.\ncontext\nCTX\n|\nnew\nSpecifies an RSS context to act on; either\nnew\nto alloâ\ncate a new RSS context, or\nCTX\n, a value returned by a\nprevious\n...\ncontext new\n.\ndelete\nDelete the specified RSS context.  May only be used in\nconjunction with\ncontext\nand a non-zero\nCTX\nvalue.\n-f --flash\nWrite a firmware image to flash or other non-volatile memoâ\nry on the device.\nfile\nSpecifies the filename of the firmware image.  The\nfirmware must first be installed in one of the directoâ\nries where the kernel firmware loader or firmware agent\nwill look, such as /lib/firmware.\nN\nIf the device stores multiple firmware images in sepaâ\nrate regions of non-volatile memory, this parameter may\nbe used to specify which region is to be written.  The\ndefault is 0, requesting that all regions are written.\nAll other values are driver-dependent.\n-l --show-channels\nQueries the specified network device for the numbers of\nchannels it has.  A channel is an IRQ and the set of queues\nthat can trigger that IRQ.\n-L --set-channels\nChanges the numbers of channels of the specified network\ndevice.\nrx\nN\nChanges the number of channels with only receive\nqueues.\ntx\nN\nChanges the number of channels with only transmit\nqueues.\nother\nN\nChanges the number of channels used only for other purâ\nposes e.g. link interrupts or SR-IOV co-ordination.\ncombined\nN\nChanges the number of multi-purpose channels.\n-m --dump-module-eeprom --module-info\nRetrieves and if possible decodes the EEPROM from plugin\nmodules, e.g SFP+, QSFP.  If the driver and module support\nit, the optical diagnostic information is also read and deâ\ncoded.  When either one of\npage, bank\nor\ni2c\nparameters is\nspecified, dumps only of a single page or its portion is\nallowed. In such a case\noffset\nand\nlength\nparameters are\ntreated relatively to EEPROM page boundaries.\n--show-priv-flags\nQueries the specified network device for its private flags.\nThe names and meanings of private flags (if any) are deâ\nfined by each network device driver.\n--set-priv-flags\nSets the device's private flags as specified.\nflag\non\n|\noff\nSets the state of the named private flag.\n--show-eee\nQueries the specified network device for its support of Enâ\nergy-Efficient Ethernet (according to the IEEE 802.3az\nspecifications)\n--set-eee\nSets the device EEE behaviour.\neee on\n|\noff\nEnables/disables the device support of EEE.\ntx-lpi on\n|\noff\nDetermines whether the device should assert its Tx LPI.\nadvertise\nN\nSets the speeds for which the device should advertise\nEEE capabilities.  Values are as for\n--change advertise\ntx-timer\nN\nSets the amount of time the device should stay in idle\nmode prior to asserting its Tx LPI (in microseconds).\nThis has meaning only when Tx LPI is enabled.\n--set-phy-tunable\nSets the PHY tunable parameters.\ndownshift on\n|\noff\nSpecifies whether downshift should be enabled.\ncount\nN\nSets the PHY downshift re-tries count.\nfast-link-down on\n|\noff\nSpecifies whether Fast Link Down should be enabled and\ntime until link down (if supported).\nmsecs\nN\nSets the period after which the link is reported as down. Note that the PHY may choose\nthe closest supported value. Only on reading back the tunable do you get the actual value.\nenergy-detect-power-down on\n|\noff\nSpecifies whether Energy Detect Power Down (EDPD)\nshould be enabled (if supported).  This will put the RX\nand TX circuit blocks into a low power mode, and the\nPHY will wake up periodically to send link pulses to\navoid any lock-up situation with a peer PHY that may\nalso have EDPD enabled. By default, this setting will\nalso enable the periodic transmission of TX pulses.\nmsecs\nN\nSome PHYs support configuration of the wake-up interval to send TX pulses.\nThis setting allows the control of this interval, and 0 disables TX pulses\nif the PHY supports this. Disabling TX pulses can create a lock-up situation\nwhere neither of the PHYs wakes the other one. If unspecified the default\nvalue (in milliseconds) will be used by the PHY.\n--get-phy-tunable\nGets the PHY tunable parameters.\ndownshift\nFor operation in cabling environments that are incomâ\npatible with 1000BASE-T, PHY device provides an autoâ\nmatic link speed downshift operation.  Link speed downâ\nshift after N failed 1000BASE-T auto-negotiation atâ\ntempts.  Downshift is useful where cable does not have\nthe 4 pairs instance.\nGets the PHY downshift count/status.\nfast-link-down\nDepending on the mode it may take 0.5s - 1s until a\nbroken link is reported as down.  In certain use cases\na link-down event needs to be reported as soon as posâ\nsible.  Some PHYs support a Fast Link Down Feature and\nmay allow configuration of the delay before a broken\nlink is reported as being down.\nGets the PHY Fast Link Down status / period.\nenergy-detect-power-down\nGets the current configured setting for Energy Detect\nPower Down (if supported).\n--get-tunable\nGet the tunable parameters.\nrx-copybreak\nGet the current rx copybreak value in bytes.\ntx-copybreak\nGet the current tx copybreak value in bytes.\ntx-buf-size\nGet the current tx copybreak buffer size in bytes.\npfc-prevention-tout\nGet the current pfc prevention timeout value in msecs.\n--set-tunable\nSet driver's tunable parameters.\nrx-copybreak\nN\nSet the rx copybreak value in bytes.\ntx-copybreak\nN\nSet the tx copybreak value in bytes.\ntx-buf-size\nN\nSet the tx copybreak buffer size in bytes.\npfc-prevention-tout\nN\nSet pfc prevention timeout in msecs. Value of 0 means\ndisable and 65535 means auto.\n--reset\nReset hardware components specified by flags and components\nlisted below\nflags\nN\nResets the components based on direct flags mask\nmgmt\nManagement processor\nirq\nInterrupt requester\ndma\nDMA engine\nfilter\nFiltering/flow direction\noffload\nProtocol offload\nmac\nMedia access controller\nphy\nTransceiver/PHY\nram\nRAM shared between multiple components\nap\nApplication\nProcessor\ndedicated\nAll components dedicated to this interface\nall\nAll components used by this interface, even if shared\n--show-fec\nQueries the specified network device for its support of\nForward Error Correction.\n--set-fec\nConfigures Forward Error Correction for the specified netâ\nwork device.\nForward Error Correction modes selected by a user are exâ\npected to be persisted after any hotplug events. If a modâ\nule is swapped that does not support the current FEC mode,\nthe driver or firmware must take the link down administraâ\ntively and report the problem in the system logs for users\nto correct.\nencoding auto\n|\noff\n|\nrs\n|\nbaser\n|\nllrs\n[...]\nSets the FEC encoding for the device.  Combinations of\noptions are specified as e.g.\nencoding auto rs\n; the\nsemantics of such combinations vary between drivers.\nauto\nUse the driver's default encoding\noff\nTurn off FEC\nRS\nForce RS-FEC encoding\nBaseR\nForce BaseR encoding\nLLRS\nForce LLRS-FEC encoding\n-Q|--per-queue\nApplies provided sub command to specific queues.\nqueue_mask %x\nSets the specific queues which the sub command is apâ\nplied to.  If queue_mask is not set, the sub command\nwill be applied to all queues.\nsub_command\nSub command to apply. The supported sub commands inâ\nclude --show-coalesce and --coalesce.\n--cable-test\nPerform a cable test and report the results. What results\nare returned depends on the capabilities of the network inâ\nterface. Typically open pairs and shorted pairs can be reâ\nported, along with pairs being O.K. When a fault is detectâ\ned the approximate distance to the fault may be reported.\n--cable-test-tdr\nPerform a cable test and report the raw Time Domain Reflecâ\ntometer data.  A pulse is sent down a cable pair and the\namplitude of the reflection, for a given distance, is reâ\nported. A break in the cable returns a big reflection. Miâ\nnor damage to the cable returns a small reflection. If the\ncable is shorted, the amplitude of the reflection can be\nnegative. By default, data is returned for lengths between\n0 and 150m at 1m steps, for all pairs. However parameters\ncan be passed to restrict the collection of data. It should\nbe noted, that the interface will round the distances to\nwhatever granularity is actually implemented. This is often\n0.8 of a meter. The results should include the actual\nrounded first and last distance and step size.\nfirst  N\nDistance along the cable, in meters, where the first\nmeasurement should be made.\nlast  N\nDistance along the cable, in meters, where the last\nmeasurement should be made.\nstep  N\nDistance, in meters, between each measurement.\npair  N\nWhich pair should be measured. Typically a cable has 4\npairs. 0 = Pair A, 1 = Pair B, ...\n--monitor\nListens to netlink notification and displays them.\ncommand\nIf argument matching a command is used, ethtool only\nshows notifications of this type. Without such argument\nor with --all, all notification types are shown.\ndevname\nIf a device name is used as argument, only notification\nfor this device are shown. Default is to show notificaâ\ntions for all devices.\n--show-tunnels\nShow tunnel-related device capabilities and state.  List\nUDP ports kernel has programmed the device to parse as\nVxLAN, or GENEVE tunnels.\n--show-module\nShow the transceiver module's parameters.\n--set-module\nSet the transceiver module's parameters.\npower-mode-policy high\n|\nauto\nSet the power mode policy for the module. When set to\nhigh\n, the module always operates at high power mode.\nWhen set to\nauto\n, the module is transitioned by the\nhost to high power mode when the first port using it is\nput administratively up and to low power mode when the\nlast port using it is put administratively down. The\npower mode policy can be set before a module is\nplugged-in.\n--get-plca-cfg\nShow the current PLCA parameters for the given interface.\n--set-plca-cfg\nChange the PLCA settings for the given interface.\nenable on\n|\noff\nEnables or disables the PLCA function. When the PLCA RS\nis disabled (default), the PHY operates in plain CSâ\nMA/CD mode. To enable PLCA, the PHY must be assigned a\nunique\nplca-id\nother than 255. This one can be configâ\nured concurrently with the enable parameter. The\nenable\nparameter maps to IEEE 802.3cg-2019 clause 30.16.1.1.1\n(aPLCAAdminState) and clause 30.16.1.2.1 (acPLCAAdminâ\nControl).\nnode-id\nN\nThe unique node identifier in the range [0 .. 255].\nNode ID 0 is reserved for the coordinator node, the one\ngenerating the BEACON signal. There must be exactly one\ncoordinator on a PLCA network. Setting the node ID to\n255 (default) disables the node. This parameter maps to\nIEEE 802.3cg-2019 clause 30.16.1.1.4 (aPLCALocalNâ\nodeID).\nnode-cnt\nN\nThe node-cnt [1 .. 255] should be set after the maximum\nnumber of nodes that can be plugged to the multi-drop\nnetwork. This parameter regulates the minimum length of\nthe PLCA cycle. Therefore, it is only meaningful for\nthe coordinator node (\nnod-id\n= 0). Setting this parameâ\nter on a follower node has no effect. The\nnode-cnt\npaâ\nrameter maps to IEEE 802.3cg-2019 clause 30.16.1.1.3\n(aPLCANodeCount).\nto-tmr\nN\nThe TO timer parameter sets the value of the transmit\nopportunity timer in bit-times, and shall be set equal\nacross all the nodes sharing the same medium for PLCA\nto work. The default value of 32 is enough to cover a\nlink of roughly 50 mt. This parameter maps to  IEEE\n802.3cg-2019 clause 30.16.1.1.5 (aPLCATransmitOpportuâ\nnityTimer).\nburst-cnt\nN\nThe\nburst-cnt\nparameter [0 .. 255] indicates the extra\nnumber of packets that the node is allowed to send durâ\ning a single transmit opportunity.  By default, this\nattribute is 0, meaning that the node can send a sigle\nframe per TO. When greater than 0, the PLCA RS keeps\nthe TO after any transmission, waiting for the MAC to\nsend a new frame for up to\nburst-tmr\nBTs. This can only\nhappen a number of times per PLCA cycle up to the value\nof this parameter.  After that, the burst is over and\nthe normal counting of TOs resumes.  This parameter\nmaps to IEEE 802.3cg-2019 clause 30.16.1.1.6 (aPLCAâ\nMaxBurstCount).\nburst-tmr\nN\nThe\nburst-tmr\nparameter [0 .. 255] sets how many bit-\ntimes the PLCA RS waits for the MAC to initiate a new\ntransmission when\nburst-cnt\nis greater than 0. If the\nMAC fails to send a new frame within this time, the\nburst ends and the counting of TOs resumes. Otherwise,\nthe new frame is sent as part of the current burst.\nThis parameter maps to IEEE 802.3cg-2019 clause\n30.16.1.1.7 (aPLCABurstTimer). The value of\nburst-tmr\nshould be set greater than the Inter-Frame-Gap (IFG)\ntime of the MAC (plus some margin) for PLCA burst mode\nto work as intended.\n--get-plca-status\nShow the current PLCA status for the given interface. If\non\n, the PHY is successfully receiving or generating the\nBEACON signal. If\noff\n, the PLCA function is temporarily\ndisabled and the PHY is operating in plain CSMA/CD mode.\n--show-mm\nShow the MAC Merge layer state. The ethtool argument\n-I\n--include-statistics\ncan be used with this command, and MAC\nMerge layer statistics counters will also be retrieved.\npmac-enabled\nShows whether the pMAC is enabled and capable of reâ\nceiving traffic and SMD-V frames (and responding to\nthem with SMD-R replies).\ntx-enabled\nShows whether transmission on the pMAC is administraâ\ntively enabled.\ntx-active\nShows whether transmission on the pMAC is active (veriâ\nfication is either successful, or was disabled).\ntx-min-frag-size\nShows the minimum size (in octets) of transmitted non-\nfinal fragments which can be received by the link partâ\nner. Corresponds to the standard addFragSize variable\nusing the formula:\ntx-min-frag-size = 64 * (1 + addFragSize) - 4\nrx-min-frag-size\nShows the minimum size (in octets) of non-final fragâ\nments which the local device supports receiving.\nverify-enabled\nShows whether the verification state machine is enâ\nabled. This process, if successful, ensures that preâ\nemptible frames transmitted by the local device will\nnot be dropped as error frames by the link partner.\nverify-time\nShows the interval in ms between verification attempts,\nrepresented as an integer between 1 and 128 ms. The\nstandard defines a fixed number of verification atâ\ntempts (verifyLimit) before failing the verification\nprocess.\nmax-verify-time\nShows the maximum value for verify-time accepted by the\nlocal device, which may be less than 128 ms.\nverify-status\nShows the current state of the verification state maâ\nchine of the local device.  Values can be\nINITIAL, VERâ\nIFYING, SUCCEEDED, FAILED\nor\nDISABLED.\n--set-mm\nSet the MAC Merge layer parameters.\npmac-enabled  on\n|\noff\nEnable reception for the pMAC.\ntx-enabled  on\n|\noff\nAdministatively enable transmission for the pMAC.\ntx-min-frag-size  N\nSet the minimum size (in octets) of transmitted non-fiâ\nnal fragments which can be received by the link partâ\nner.\nverify-enabled  on\n|\noff\nEnable or disable the verification state machine.\nverify-time  N\nSet the interval in ms between verification attempts.\n--show-pse\nShow the current Power Sourcing Equipment (PSE) status for\nthe given interface.\npodl-pse-admin-state\nThis attribute indicates the operational status of PoDL\nPSE functions, which can be modified using the\npodl-\npse-admin-control\nparameter. It corresponds to IEEE\n802.3-2018 30.15.1.1.2 (aPoDLPSEAdminState), with poâ\ntential values being\nenabled, disabled\npodl-pse-power-detection-status\nThis attribute indicates the power detection status of\nthe PoDL PSE. The status depend on internal PSE state\nmachine and automatic PD classification support. It\ncorresponds to IEEE 802.3-2018 30.15.1.1.3 (aPoDLPSEâ\nPowerDetectionStatus) with potential values being\ndisâ\nabled, searching, delivering power, sleep, idle, error\nc33-pse-admin-state\nThis attribute indicates the operational status of c33\nPSE functions, which can be modified using the\nc33-pse-\nadmin-control\nparameter. It corresponds to IEEE\n802.3-2022 30.9.1.1.2 (aPSEAdminState), with potential\nvalues being\nenabled, disabled\nc33-pse-power-detection-status\nThis attribute indicates the power detection status of\nthe c33 PSE. The status depend on internal PSE state\nmachine and automatic PD classification support. It\ncorresponds to IEEE 802.3-2022 30.9.1.1.5 (aPSEPowerDeâ\ntectionStatus) with potential values being\ndisabled,\nsearching, delivering power, test, fault, other fault\nc33-pse-extended-state\nThis attribute indicates the Extended state of the c33\nPSE. The extended state correlated with the c33 PSE Exâ\ntended Substate allows to have more detail on the c33\nPSE current error state.  It corresponds to IEEE\n802.3-2022 33.2.4.4 Variables.\nc33-pse-extended-substate\nThis attribute indicates the Extended substate of the\nc33 PSE. Correlated with the c33 PSE Extended state\nvalue, it allows to have more detail on the c33 PSE\ncurrent error state.\nc33-pse-power-class\nThis attribute identifies the power class of the c33\nPSE. It depends on the class negotiated between the PSE\nand the PD. It corresponds to IEEE 802.3-2022\n30.9.1.1.8 (aPSEPowerClassification).\nc33-pse-actual-power\nThis attribute identifies the actual power drawn by the\nc33 PSE. It corresponds to ``IEEE 802.3-2022``\n30.9.1.1.23 (aPSEActualPower). Actual power is reported\nin mW.\nc33-pse-available-power-limit\nThis attribute identifies the configured c33 PSE power\nlimit in mW.\nc33-pse-power-limit-ranges\nThis attribute specifies the allowed power limit ranges\nin mW for configuring the c33-pse-avail-pw-limit paraâ\nmeter. It defines the valid power levels that can be\nassigned to the c33 PSE in compliance with the c33\nstandard.\n--set-pse\nSet Power Sourcing Equipment (PSE) parameters.\npodl-pse-admin-control  enable\n|\ndisable\nThis parameter manages PoDL PSE Admin operations in acâ\ncordance with the IEEE 802.3-2018 30.15.1.2.1\n(acPoDLPSEAdminControl) specification.\nc33-pse-admin-control  enable\n|\ndisable\nThis parameter manages c33 PSE Admin operations in acâ\ncordance with the IEEE 802.3-2022 30.9.1.2.1 (acPSEAdâ\nminControl) specification.\nc33-pse-avail-pw-limit  N\nThis parameter manages c33 PSE Available Power Limit in\nmW, in accordance with the IEEE 802.3-2022 33.2.4.4\nVariables (pse_available_power) specification.\n--flash-module-firmware\nFlash the transceiver module's firmware. The firmware upâ\ndate process is composed from three logical steps. Downâ\nloading a firmware image to the transceiver module, running\nthe image and committing the image so that it is run upon\nreset. When flash command is given, the firmware update\nprocess is performed in its entirety in that order.\nfile\nFILE\nSpecifies the filename of the transceiver module\nfirmware image. The firmware must first be installed in\none of the directories where the kernel firmware loader\nor firmware agent will look, such as /lib/firmware. The\nfirmware image is downloaded to the transceiver module,\nvalidated, run and committed.\npass\nPASS\nOptional transceiver module password that might be reâ\nquired as part of the transceiver module firmware upâ\ndate process.\n--show-phys\nShow the PHY devices attached to an interface, and the way\nthey link together.\nphy_index\nThe PHY's index, that identifies it within the network\ninterface. If the interface has multiple PHYs, they\nwill each have a unique index on that interface. This\nindex can then be used for commands that targets PHYs.\ndrvname\nThe name of the driver bound to this PHY device.\nname\nThe PHY's device name, matching the name found in sysâ\nfs.\ndownstream_sfp_name\nIf the PHY drives an SFP cage, this field contains the\nname of the associated SFP bus.\nupstream_type  mac | phy\nIndicates the nature of the device the PHY is attached\nto.\nupstream_index\nIf the PHY's upstream_type is\nphy\n, this field indiâ\ncates the phy_index of the upstream phy.\nupstream_sfp_name\nIf the PHY is withing an SFP/SFF module, this field\ncontains the name of the upstream SFP bus.\nBUGS\ntop\nNot supported (in part or whole) on all network drivers.\nAUTHOR\ntop\nethtool\nwas written by David Miller.\nModifications by Jeff Garzik, Tim Hockin, Jakub Jelinek, Andre Maâ\njorel, Eli Kupermann, Scott Feldman, Andi Kleen, Alexander Duyck,\nSucheta Chakraborty, Jesse Brandeburg, Ben Hutchings, Scott Branâ\nden.\nAVAILABILITY\ntop\nethtool\nis available from\nâ¨\nhttp://www.kernel.org/pub/software/network/ethtool/\nâ©\nCOLOPHON\ntop\nThis page is part of the\nethtool\n(utility for controlling network\ndrivers and hardware) project.  Information about the project can\nbe found at\nâ¨\nhttps://www.kernel.org/pub/software/network/ethtool/\nâ©.  If you\nhave a bug report for this manual page, send it to bwh@kernel.org,\nnetdev@vger.kernel.org.  This page was obtained from the project's\nupstream Git repository\nâ¨git://git.kernel.org/pub/scm/network/ethtool/ethtool.gitâ© on\n2025-08-11.  (At that time, the date of the most recent commit\nthat was found in the repository was 2025-08-07.)  If you discover\nany rendering problems in this HTML version of the page, or you\nbelieve there is a better or more up-to-date source for the page,\nor you have corrections or improvements to the information in this\nCOLOPHON (which is\nnot\npart of the original manual page), send a\nmail to man-pages@man7.org\nEthtool version 6.15            June 2025\nETHTOOL\n(8)\nPages that refer to this page:\nveth(4)\n,\nip-link(8)\n,\novs-l3ping(8)\n,\novs-test(8)\n,\novs-vlan-test(8)\n,\ntc-mqprio(8)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man8/ethtool.8.html"}}
{"text": "brctl(8) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\nbrctl(8) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nINSTANCES\n|\nPORTS\n|\nAGEING\n|\nSPANNING TREE PROTOCOL\n|\nNOTES\n|\nSEE ALSO\n|\nAUTHOR\n|\nCOLOPHON\nBRCTL(8)                                                        BRCTL(8)\nNAME\ntop\nbrctl - ethernet bridge administration\nSYNOPSIS\ntop\nbrctl [command]\nDESCRIPTION\ntop\nbrctl\nis used to set up, maintain, and inspect the ethernet\nbridge configuration in the Linux kernel.\nAn ethernet bridge is a device commonly used to connect different\nnetworks of ethernets together, so that these ethernets will\nappear as one ethernet to the participants.\nEach of the ethernets being connected corresponds to one physical\ninterface in the bridge. These individual ethernets are bundled\ninto one bigger ('logical') ethernet, this bigger ethernet\ncorresponds to the bridge network interface.\nINSTANCES\ntop\nThe command\nbrctl addbr <name>\ncreates a new instance of the\nethernet bridge. The network interface corresponding to the\nbridge will be called <name>.\nThe command\nbrctl delbr <name>\ndeletes the instance <name> of the\nethernet bridge. The network interface corresponding to the\nbridge must be down before it can be deleted!\nThe command\nbrctl show\nshows all current instances of the\nethernet bridge.\nPORTS\ntop\nEach bridge has a number of ports attached to it. Network traffic\ncoming in on any of these ports will be forwarded to the other\nports transparently, so that the bridge is invisible to the rest\nof the network (i.e. it will not show up in\ntraceroute(8)\n).\nThe command\nbrctl addif <brname> <ifname>\nwill make the interface\n<ifname> a port of the bridge <brname>. This means that all\nframes received on <ifname> will be processed as if destined for\nthe bridge. Also, when sending frames on <brname>, <ifname> will\nbe considered as a potential output interface.\nThe command\nbrctl delif <brname> <ifname>\nwill detach the\ninterface <ifname> from the bridge <brname>.\nThe command\nbrctl show <brname>\nwill show some information on the\nbridge and its attached ports.\nAGEING\ntop\nThe bridge keeps track of ethernet addresses seen on each port.\nWhen it needs to forward a frame, and it happens to know on which\nport the destination ethernet address (specified in the frame) is\nlocated, it can 'cheat' by forwarding the frame to that port\nonly, thus saving a lot of redundant copies and transmits.\nHowever, the ethernet address location data is not static data.\nMachines can move to other ports, network cards can be replaced\n(which changes the machine's ethernet address), etc.\nbrctl showmacs <brname>\nshows a list of learned MAC addresses for\nthis bridge.\nbrctl setageing <brname> <time>\nsets the ethernet (MAC) address\nageing time, in seconds. After <time> seconds of not having seen\na frame coming from a certain address, the bridge will time out\n(delete) that address from the Forwarding DataBase (fdb).\nbrctl setgcint <brname> <time>\nsets the garbage collection\ninterval for the bridge <brname> to <time> seconds. This means\nthat the bridge will check the forwarding database for timed out\nentries every <time> seconds.\nSPANNING TREE PROTOCOL\ntop\nMultiple ethernet bridges can work together to create even larger\nnetworks of ethernets using the IEEE 802.1d spanning tree\nprotocol. This protocol is used for finding the shortest path\nbetween two ethernets, and for eliminating loops from the\ntopology. As this protocol is a standard, Linux bridges will\ninterwork properly with other third party bridge products.\nBridges communicate with each other by sending and receiving\nBPDUs (Bridge Protocol Data Units). These BPDUs can be recognised\nby an ethernet destination address of 01:80:c2:00:00:00.\nThe spanning tree protocol can also be turned off (for those\nsituations where it just doesn't make sense, for example when\nthis Linux box is the only bridge on the LAN, or when you know\nthat there are no loops in the topology.)\nbrctl(8)\ncan be used for configuring certain spanning tree\nprotocol parameters. For an explanation of these parameters, see\nthe IEEE 802.1d specification (or send me an email). The default\nvalues should be just fine. If you don't know what these\nparameters mean, you probably won't feel the desire to tweak\nthem.\nbrctl stp <bridge> <state>\ncontrols this bridge instance's\nparticipation in the spanning tree protocol. If <state> is \"on\"\nor \"yes\" the STP will be turned on, otherwise it will be turned\noff.  When turned off, the bridge will not send or receive BPDUs,\nand will thus not participate in the spanning tree protocol. If\nyour bridge isn't the only bridge on the LAN, or if there are\nloops in the LAN's topology, DO NOT turn this option off. If you\nturn this option off, please know what you are doing.\nbrctl setbridgeprio <bridge> <priority>\nsets the bridge's\npriority to <priority>. The priority value is an unsigned 16-bit\nquantity (a number between 0 and 65535), and has no dimension.\nLower priority values are 'better'. The bridge with the lowest\npriority will be elected 'root bridge'.\nbrctl setfd <bridge> <time>\nsets the bridge's 'bridge forward\ndelay' to <time> seconds.\nbrctl sethello <bridge> <time>\nsets the bridge's 'bridge hello\ntime' to <time> seconds.\nbrctl setmaxage <bridge> <time>\nsets the bridge's 'maximum\nmessage age' to <time> seconds.\nbrctl setpathcost <bridge> <port> <cost>\nsets the port cost of\nthe port <port> to <cost>. This is a dimensionless metric.\nbrctl setportprio <bridge> <port> <priority>\nsets the port\n<port>'s priority to <priority>. The priority value is an\nunsigned 8-bit quantity (a number between 0 and 255), and has no\ndimension. This metric is used in the designated port and root\nport selection algorithms.\nNOTES\ntop\nbrctl(8)\nis obsolete. Some features such as STP guard, harpin\nmode, fastleave and root block are intentionally not implemented\nin this command.  Instead use\nbridge\ncommand from\niproute2\npackage for a more full set of features.\nSEE ALSO\ntop\niptables(8)\nAUTHOR\ntop\nLennert Buytenhek <buytenh@gnu.org> Stephen Hemminger\n<stephen@networkplumber.org>\nCOLOPHON\ntop\nThis page is part of the\nbridge-utils\n(Ethernet bridge utilities)\nproject.  Information about the project can be found at [unknown\n-- if you know, please contact man-pages@man7.org] If you have a\nbug report for this manual page, send it to bridge@osdl.org.\nThis page was obtained from the project's upstream Git repository\nâ¨git://git.kernel.org/pub/scm/linux/kernel/git/shemminger/bridge-utils.gitâ©\non 2020-12-18.  (At that time, the date of the most recent commit\nthat was found in the repository was 2020-06-23.)  If you\ndiscover any rendering problems in this HTML version of the page,\nor you believe there is a better or more up-to-date source for\nthe page, or you have corrections or improvements to the\ninformation in this COLOPHON (which is\nnot\npart of the original\nmanual page), send a mail to man-pages@man7.org\nNovember 7, 2001                    BRCTL(8)\nPages that refer to this page:\nnetwork_namespaces(7)\n,\nbrctl(8)\nHTML rendering created 2020-12-21\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n,\nmaintainer of the\nLinux\nman-pages\nproject\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man8/brctl.8.html"}}
{"text": "arp(8) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\narp(8) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nMODES\n|\nOPTIONS\n|\nEXAMPLES\n|\nFILES\n|\nSEE ALSO\n|\nAUTHORS\n|\nCOLOPHON\nARP\n(8)             Linux System Administrator's Manual\nARP\n(8)\nNAME\ntop\narp - manipulate the system ARP cache\nSYNOPSIS\ntop\narp\n[\n-vn\n] [\n-H\ntype\n] [\n-i\nif\n] [\n-ae\n] [\nhostname\n]\narp\n[\n-v\n] [\n-i\nif\n]\n-d\nhostname\n[\npub\n]\narp\n[\n-v\n] [\n-H\ntype\n] [\n-i\nif\n]\n-s\nhostname hw_addr\n[\ntemp\n]\narp\n[\n-v\n] [\n-H\ntype\n] [\n-i\nif\n]\n-s\nhostname hw_addr\n[\nnetmask\nnm\n]\npub\narp\n[\n-v\n] [\n-H\ntype\n] [\n-i\nif\n]\n-Ds\nhostname ifname\n[\nnetmask\nnm\n]\npub\narp\n[\n-vnD\n] [\n-H\ntype\n] [\n-i\nif\n]\n-f\n[\nfilename\n]\nDESCRIPTION\ntop\nArp\nmanipulates or displays the kernel's IPv4 network neighbour\ncache. It can add entries to the table, delete one or display the\ncurrent content.\nARP\nstands for Address Resolution Protocol, which is used to find\nthe media access control address of a network neighbour for a\ngiven IPv4 Address.\nMODES\ntop\narp\nwith no mode specifier will print the current content of the\ntable. It is possible to limit the number of entries printed, by\nspecifying an hardware address type, interface name or host\naddress.\narp -d\naddress\nwill delete a ARP table entry. Root or netadmin\nprivilege is required to do this. The entry is found by IP\naddress. If a hostname is given, it will be resolved before\nlooking up the entry in the ARP table.\narp -s\naddress hw_addr\nis used to set up a new table entry. The\nformat of the\nhw_addr\nparameter is dependent on the hardware\nclass, but for most classes one can assume that the usual\npresentation can be used.  For the Ethernet class, this is 6 bytes\nin hexadecimal, separated by colons. When adding proxy arp entries\n(that is those with the\npub\nlish flag set) a\nnetmask\nmay be\nspecified to proxy arp for entire subnets. This is not good\npractice, but is supported by older kernels because it can be\nuseful. If the\ntemp\nflag is not supplied entries will be permanent\nstored into the ARP cache. To simplify setting up entries for one\nof your own network interfaces, you can use the\narp -Ds\naddress\nifname\nform. In that case the hardware address is taken from the\ninterface with the specified name.\nOPTIONS\ntop\n-v, --verbose\nTell the user what is going on by being verbose.\n-n, --numeric\nshows numerical addresses instead of trying to determine\nsymbolic host, port or user names.\n-H\ntype\n,\n--hw-type\ntype\n,\n-t\ntype\nWhen setting or reading the ARP cache, this optional\nparameter tells\narp\nwhich class of entries it should check\nfor.  The default value of this parameter is\nether\n(i.e.\nhardware code 0x01 for IEEE 802.3 10Mbps Ethernet).  Other\nvalues might include network technologies such as ARCnet\n(\narcnet\n) , PROnet (\npronet\n) , AX.25 (\nax25\n) and NET/ROM\n(\nnetrom\n).\n-a\nUse alternate BSD style output format (with no fixed\ncolumns).\n-e\nUse default Linux style output format (with fixed columns).\n-D, --use-device\nInstead of a hw_addr, the given argument is the name of an\ninterface.\narp\nwill use the MAC address of that interface\nfor the table entry. This is usually the best option to set\nup a proxy ARP entry to yourself.\n-i\nIf\n,\n--device\nIf\nSelect an interface. When dumping the ARP cache only\nentries matching the specified interface will be printed.\nWhen setting a permanent or\ntemp\nARP entry this interface\nwill be associated with the entry; if this option is not\nused, the kernel will guess based on the routing table. For\npub\nentries the specified interface is the interface on\nwhich ARP requests will be answered.\nNOTE:\nThis has to be different from the interface to which\nthe IP datagrams will be routed.\nNOTE:\nAs of kernel 2.2.0\nit is no longer possible to set an ARP entry for an entire\nsubnet. Linux instead does automagic proxy arp when a route\nexists and it is forwarding. See\narp(7)\nfor details. Also\nthe\ndontpub\noption which is available for delete and set\noperations cannot be used with 2.4 and newer kernels.\n-f\nfilename\n,\n--file\nfilename\nSimilar to the\n-s\noption, only this time the address info\nis taken from file\nfilename\n.  This can be used if ARP\nentries for a lot of hosts have to be set up.  The name of\nthe data file is very often\n/etc/ethers\n, but this is not\nofficial. If no filename is specified\n/etc/ethers\nis used\nas default.\nThe format of the file is simple; it only contains ASCII\ntext lines with a hostname, and a hardware address\nseparated by whitespace. Additionally the\npub\n,\ntemp\nand\nnetmask\nflags can be used.\nIn all places where a\nhostname\nis expected, one can also enter an\nIP address\nin dotted-decimal notation.\nAs a special case for compatibility the order of the hostname and\nthe hardware address can be exchanged.\nEach complete entry in the ARP cache will be marked with the\nC\nflag. Permanent entries are marked with\nM\nand published entries\nhave the\nP\nflag.\nEXAMPLES\ntop\n/usr/sbin/arp -i eth0 -Ds 10.0.0.2 eth1 pub\nThis will answer ARP requests for 10.0.0.2 on eth0 with the MAC\naddress for eth1.\n/usr/sbin/arp -i eth1 -d 10.0.0.1\nDelete the ARP table entry for 10.0.0.1 on interface eth1. This\nwill match published proxy ARP entries and permanent entries.\nFILES\ntop\n/proc/net/arp\n/etc/networks\n/etc/hosts\n/etc/ethers\nSEE ALSO\ntop\nethers(5)\n,\nrarp(8)\n,\nroute(8)\n,\nifconfig(8)\n,\nnetstat(8)\nAUTHORS\ntop\nFred N. van Kempen <waltje@uwalt.nl.mugnet.org>, Bernd Eckenfels\n<net-tools@lina.inka.de>.\nCOLOPHON\ntop\nThis page is part of the\nnet-tools\n(networking utilities) project.\nInformation about the project can be found at\nâ¨\nhttp://net-tools.sourceforge.net/\nâ©.  If you have a bug report for\nthis manual page, see â¨\nhttp://net-tools.sourceforge.net/\nâ©.  This\npage was obtained from the project's upstream Git repository\nâ¨git://git.code.sf.net/p/net-tools/codeâ© on 2025-08-11.  (At that\ntime, the date of the most recent commit that was found in the\nrepository was 2025-05-17.)  If you discover any rendering\nproblems in this HTML version of the page, or you believe there is\na better or more up-to-date source for the page, or you have\ncorrections or improvements to the information in this COLOPHON\n(which is\nnot\npart of the original manual page), send a mail to\nman-pages@man7.org\nnet-tools                       2008-10-03\nARP\n(8)\nPages that refer to this page:\nethers(5)\n,\nproc(5)\n,\nifconfig(8)\n,\nrarp(8)\n,\nroute(8)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man8/arp.8.html"}}
{"text": "tcpdump(8) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\ntcpdump(8) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nOPTIONS\n|\nEXAMPLES\n|\nOUTPUT FORMAT\n|\nBACKWARD COMPATIBILITY\n|\nSEE ALSO\n|\nAUTHORS\n|\nBUGS\n|\nCOLOPHON\nTCPDUMP\n(1)               General Commands Manual\nTCPDUMP\n(1)\nNAME\ntop\ntcpdump - dump traffic on a network\nSYNOPSIS\ntop\ntcpdump\n[\n-AbdDefghHIJKlLnNOpqStuUvxX#\n] [\n-B\nbuffer_size\n]\n[\n-c\ncount\n] [\n--count\n] [\n-C\nfile_size\n]\n[\n-E\nspi@ipaddr algo:secret,...\n]\n[\n-F\nfile\n] [\n-G\nrotate_seconds\n] [\n-i\ninterface\n]\n[\n--immediate-mode\n] [\n-j\ntstamp_type\n] [\n--lengths\n] [\n-m\nmodule\n]\n[\n-M\nsecret\n] [\n--number\n] [\n--print\n] [\n--print-sampling\nnth\n]\n[\n-Q\nin|out|inout\n] [\n-r\nfile\n] [\n-s\nsnaplen\n] [\n--skip\ncount\n]\n[\n-T\ntype\n] [\n--version\n] [\n-V\nfile\n] [\n-w\nfile\n] [\n-W\nfilecount\n]\n[\n-y\ndatalinktype\n] [\n-z\npostrotate-command\n] [\n-Z\nuser\n]\n[\n--time-stamp-precision=\ntstamp_precision\n] [\n--micro\n] [\n--nano\n]\n[\nexpression\n]\nDESCRIPTION\ntop\ntcpdump\nprints  out a description of the contents of packets on a\nnetwork  interface  that  match  the   Boolean\nexpression\n(see\npcap-filter\n(@MAN_MISC_INFO@)   for  the\nexpression\nsyntax);  the\ndescription is preceded by a time stamp, printed, by  default,  as\nhours, minutes, seconds, and fractions of a second since midnight.\nIt  can  also be run with the\n-w\nflag, which causes it to save the\npacket data to a file for later analysis, and/or with the\n-r\nflag,\nwhich causes it to read from a saved packet file  rather  than  to\nread  packets  from  a network interface.  It can also be run with\nthe\n-V\nflag, which causes it to read a list of saved packet files.\nIn all cases, only packets that match\nexpression\nwill be processed\nby\ntcpdump\n.\ntcpdump\nwill, if not run with  the\n-c\nflag,  continue  capturing\npackets until it is interrupted by a\nSIGINT\nsignal (generated, for\nexample,  by typing your interrupt character, typically control-C)\nor  a\nSIGTERM\nsignal  (typically  generated  with  the\nkill(1)\ncommand);  if  run with the\n-c\nflag, it will capture packets until\nit is interrupted by a\nSIGINT\nor\nSIGTERM\nsignal or  the  specified\nnumber of packets have been processed.\nWhen\ntcpdump\nfinishes capturing packets, it will report counts of:\npackets  ``captured''  (this  is the number of packets that\ntcpdump\nhas received and processed);\npackets ``received by filter'' (the meaning of this depends\non the OS on which you're running\ntcpdump\n, and possibly  on\nthe  way  the OS was configured - if a filter was specified\non the  command  line,  on  some  OSes  it  counts  packets\nregardless  of  whether  they  were  matched  by the filter\nexpression and, even if they were  matched  by  the  filter\nexpression,  regardless  of  whether\ntcpdump\nhas read and\nprocessed them yet, on other OSes it  counts  only  packets\nthat  were  matched  by the filter expression regardless of\nwhether\ntcpdump\nhas read and processed  them  yet,  and  on\nother  OSes it counts only packets that were matched by the\nfilter expression and were processed by\ntcpdump\n);\npackets ``dropped  by  kernel''  (this  is  the  number  of\npackets  that  were dropped, due to a lack of buffer space,\nby the packet capture mechanism in the OS on which\ntcpdump\nis   running,   if  the  OS  reports  that  information  to\napplications; if not, it will be reported as 0).\nOn platforms that support the\nSIGINFO\nsignal, such  as  most  BSDs\n(including  macOS), it will report those counts when it receives a\nSIGINFO\nsignal (generated, for example, by typing your  ``status''\ncharacter,  typically  control-T, although on some platforms, such\nas macOS, the ``status'' character is not set by default,  so  you\nmust  set  it  with\nstty(1)\nin order to use it) and will continue\ncapturing packets. On platforms that do not  support  the\nSIGINFO\nsignal, the same can be achieved by using the\nSIGUSR1\nsignal.\nUsing  the\nSIGUSR2\nsignal  along  with the\n-w\nflag will forcibly\nflush the packet buffer into the output file.\nReading packets from a network interface may require that you have\nspecial privileges; see the\npcap\n(3PCAP)  man  page  for  details.\nReading a saved packet file doesn't require special privileges.\nOPTIONS\ntop\n-A\nPrint each packet (minus its link level header) in ASCII.\nHandy for capturing web pages.  No effect when\n-x[x]\nor\n-X[X]\noptions are used.\n-b\nPrint the AS number in BGP packets using \"asdot\" rather\nthan \"asplain\" representation, in RFC 5396 terms.\n-B\nbuffer_size\n--buffer-size=\nbuffer_size\nSet the operating system capture buffer size to\nbuffer_size\n, in units of KiB (1024 bytes).\n-c\ncount\nExit after receiving or reading\ncount\npackets.  If the\n--skip\noption is used, the\ncount\nstarts after the skipped\npackets.\n--count\nPrint only on stdout the packet count when reading capture\nfile(s) instead of parsing/printing the packets. If a\nfilter is specified on the command line,\ntcpdump\ncounts\nonly packets that were matched by the filter expression.\n-C\nfile_size\nBefore writing a raw packet to a savefile, check whether\nthe file is currently larger than\nfile_size\nand, if so,\nclose the current savefile and open a new one.  Savefiles\nafter the first savefile will have the name specified with\nthe\n-w\nflag, with a number after it, starting at 1 and\ncontinuing upward.  The default unit of\nfile_size\nis\nmillions of bytes (1,000,000 bytes, not 1,048,576 bytes).\nBy adding a suffix of k/K, m/M or g/G to the value, the\nunit can be changed to 1,024 (KiB), 1,048,576 (MiB), or\n1,073,741,824 (GiB) respectively.\n-d\nDump the compiled packet-matching code in a human readable\nform to standard output and stop.\nPlease mind that although code compilation is always DLT-\nspecific, typically it is impossible (and unnecessary) to\nspecify which DLT to use for the dump because\ntcpdump\nuses\neither the DLT of the input pcap file specified with\n-r\n, or\nthe default DLT of the network interface specified with\n-i\n,\nor the particular DLT of the network interface specified\nwith\n-y\nand\n-i\nrespectively. In these cases the dump shows\nthe same exact code that would filter the input file or the\nnetwork interface without\n-d\n.\nHowever, when neither\n-r\nnor\n-i\nis specified, specifying\n-d\nprevents\ntcpdump\nfrom guessing a suitable network interface\n(see\n-i\n).  In this case the DLT defaults to EN10MB and can\nbe set to another valid value manually with\n-y\n.\n-dd\nDump packet-matching code as a C array of\nstruct bpf_insn\nstructures.\n-ddd\nDump packet-matching code as decimal numbers (preceded with\na count).\n-D\n--list-interfaces\nPrint the list of the network interfaces available on the\nsystem and on which\ntcpdump\ncan capture packets.  For each\nnetwork interface, a number and an interface name, possibly\nfollowed by a text description of the interface, are\nprinted.  The interface name or the number can be supplied\nto the\n-i\nflag to specify an interface on which to capture.\nThis can be useful on systems that don't have a command to\nlist them (e.g., Windows systems, or UNIX systems lacking\nifconfig -a\n); the number can be useful on Windows 2000 and\nlater systems, where the interface name is a somewhat\ncomplex string.\n-e\nPrint the link-level header on each dump line.  This can be\nused, for example, to print MAC layer addresses for\nprotocols such as Ethernet and IEEE 802.11.\n-E\nUse\nspi@ipaddr algo:secret\nfor decrypting IPsec ESP packets\nthat are addressed to\naddr\nand contain Security Parameter\nIndex value\nspi\n. This combination may be repeated with\ncomma or newline separation.\nNote that setting the secret for IPv4 ESP packets is\nsupported at this time.\nAlgorithms may be\ndes-cbc\n,\n3des-cbc\n,\nblowfish-cbc\n,\nrc3-cbc\n,\ncast128-cbc\n, or\nnone\n.  The default is\ndes-cbc\n.  The ability\nto decrypt packets is only present if\ntcpdump\nwas compiled\nwith cryptography enabled.\nsecret\nis the ASCII text for ESP secret key.  If preceded\nby 0x, then a hex value will be read.\nThe option assumes RFC 2406 ESP, not RFC 1827 ESP.  The\noption is only for debugging purposes, and the use of this\noption with a true `secret' key is discouraged.  By\npresenting IPsec secret key onto command line you make it\nvisible to others, via\nps(1)\nand other occasions.\nIn addition to the above syntax, the syntax\nfile name\nmay\nbe used to have tcpdump read the provided file in. The file\nis opened upon receiving the first ESP packet, so any\nspecial permissions that tcpdump may have been given should\nalready have been given up.\n-f\nPrint `foreign' IPv4 addresses numerically rather than\nsymbolically (this option is intended to get around serious\nbrain damage in Sun's NIS server â usually it hangs forever\ntranslating non-local internet numbers).\nThe test for `foreign' IPv4 addresses is done using the\nIPv4 address and netmask of the interface on that capture\nis being done.  If the interface has no IPv4 addresses\n(which by convention applies to the \"any\" pseudo-interface\n(see the\n-i\nflag below), the IPv4 netmask is assumed to be\n/0 and any IPv4 address is considered non-foreign.  If the\nIPv4 netmask is /32, all IPv4 addresses except the\ninterface's own address are considered foreign.  If the\ninterface has more than one IPv4 address, it is not trivial\nto predict which one will be used for the test.\nWithout the\n-f\nflag, or when the netmask is assumed to be\n/0 (as discussed above), the\nip broadcast\nprimitive in the\nfilter expression matches IPv4 packets that have either\n0.0.0.0 or 255.255.255.255 as the destination address.\nWith the flag, the primitive uses the same netmask (but not\nthe network address) to test the IPv4 destination address\nas the foreign address test.  One exception is the netmask\n/32, in which case the primitive is considered invalid for\nthe interface.\n-F\nfile\nUse\nfile\nas input for the filter expression.  An additional\nexpression given on the command line is ignored.\n-g\n--ip-oneline\nDo not insert a line break after the IP header in verbose\nmode.\n-G\nrotate_seconds\nIf specified, rotates the dump file specified with the\n-w\noption every\nrotate_seconds\nseconds.  Savefiles will have\nthe name specified by\n-w\nwhich should include a time format\nas defined by\nstrftime(3)\n.  If no time format is specified,\neach new file will overwrite the previous.  Whenever a\ngenerated filename is not unique, tcpdump will overwrite\nthe preexisting data; providing a time specification that\nis coarser than the capture period is therefore not\nadvised.\nIf used in conjunction with the\n-C\noption, filenames will\ntake the form of `\nfile\n<count>'.\n-h\n--help\nPrint the tcpdump and libpcap version strings, print a\nusage message, and exit.\n--version\nPrint the tcpdump and libpcap version strings and exit.\n-H\nAttempt to detect 802.11s draft mesh headers.\n-i\ninterface\n--interface=\ninterface\nListen, report the list of link-layer types, report the\nlist of time stamp types, or report the results of\ncompiling a filter expression on\ninterface\n.  If unspecified\nand if the\n-d\nflag is not given,\ntcpdump\nsearches the\nsystem interface list for the lowest numbered, configured\nup interface (excluding loopback), which may turn out to\nbe, for example, ``eth0''.\nOn all supported Linux systems, as well as on recent\nversions of macOS and Solaris, an\ninterface\nargument of\n``any'' means a special pseudo-interface, which captures\npackets from all regular network interfaces of the OS.\nWhat is considered a regular network interface is an\nimplementation detail of the OS (for example, on Linux this\nincludes SocketCAN devices), so packets captured on the\n``any'' pseudo-interface may represent more different\nnetwork protocols than expected.  Also all regular network\ninterfaces are a subset of all available capture devices as\nprinted by the\n-D\nflag.  The latter may also include\ncapture devices that libpcap implements by means other than\nthe OS network stack: Bluetooth, DAG, D-Bus, SNF and USB.\nNote that captures on the ``any'' pseudo-interface will not\nbe done in promiscuous mode.\nAn interface number as printed by the\n-D\nflag can be used\nas the\ninterface\nargument, if no interface on the system\nhas that number as a name.\n-I\n--monitor-mode\nPut the interface in \"monitor mode\"; this is supported only\non IEEE 802.11 Wi-Fi interfaces, and supported only on some\noperating systems.\nNote that in monitor mode the adapter might disassociate\nfrom the network with which it's associated, so that you\nwill not be able to use any wireless networks with that\nadapter.  This could prevent accessing files on a network\nserver, or resolving host names or network addresses, if\nyou are capturing in monitor mode and are not connected to\nanother network with another adapter.\nThis flag will affect the output of the\n-L\nflag.  If\n-I\nisn't specified, only those link-layer types available when\nnot in monitor mode will be shown; if\n-I\nis specified, only\nthose link-layer types available when in monitor mode will\nbe shown.\n--immediate-mode\nCapture in \"immediate mode\".  In this mode, packets are\ndelivered to tcpdump as soon as they arrive, rather than\nbeing buffered for efficiency.  This is the default when\nprinting packets rather than saving packets to a\n``savefile'' if the packets are being printed to a terminal\nrather than to a file or pipe.\n-j\ntstamp_type\n--time-stamp-type=\ntstamp_type\nSet the time stamp type for the capture to\ntstamp_type\n.\nThe names to use for the time stamp types are given in\npcap-tstamp\n(@MAN_MISC_INFO@); not all the types listed\nthere will necessarily be valid for any given interface.\n-J\n--list-time-stamp-types\nList the supported time stamp types for the interface and\nexit.  If the time stamp type cannot be set for the\ninterface, no time stamp types are listed.\n--time-stamp-precision=\ntstamp_precision\nWhen capturing, set the time stamp precision for the\ncapture to\ntstamp_precision\n.  Note that availability of\nhigh precision time stamps (nanoseconds) and their actual\naccuracy is platform and hardware dependent.  Also note\nthat when writing captures made with nanosecond accuracy to\na savefile, the time stamps are written with nanosecond\nresolution, and the file is written with a different magic\nnumber, to indicate that the time stamps are in seconds and\nnanoseconds; not all programs that read pcap savefiles will\nbe able to read those captures.\nWhen reading a savefile, convert time stamps to the\nprecision specified by\ntimestamp_precision\n, and display\nthem with that resolution.  If the precision specified is\nless than the precision of time stamps in the file, the\nconversion will lose precision.\nThe supported values for\ntimestamp_precision\nare\nmicro\nfor\nmicrosecond resolution and\nnano\nfor nanosecond resolution.\nThe default is microsecond resolution.\n--micro\n--nano\nShorthands for\n--time-stamp-precision=micro\nor\n--time-stamp-precision=nano\n, adjusting the time stamp\nprecision accordingly.  When reading packets from a\nsavefile, using\n--micro\ntruncates time stamps if the\nsavefile was created with nanosecond precision.  In\ncontrast, a savefile created with microsecond precision\nwill have trailing zeroes added to the time stamp when\n--nano\nis used.\n-K\n--dont-verify-checksums\nDon't attempt to verify IP, TCP, or UDP checksums.  This is\nuseful for interfaces that perform some or all of those\nchecksum calculation in hardware; otherwise, all outgoing\nTCP checksums will be flagged as bad.\n-l\nMake stdout line buffered.  Useful if you want to see the\ndata while capturing it.  E.g.,\ntcpdump -l | tee dat\nor\ntcpdump -l > dat & tail -f dat\nNote that on Windows,``line buffered'' means\n``unbuffered'', so that tcpdump will write each character\nindividually if\n-l\nis specified.\n-U\nis similar to\n-l\nin its behavior, but it will cause\noutput to be ``packet-buffered'', so that the output is\nwritten to stdout at the end of each packet rather than at\nthe end of each line; this is buffered on all platforms,\nincluding Windows.\n-L\n--list-data-link-types\nList the known data link types for the interface, in the\nspecified mode, and exit.  The list of known data link\ntypes may be dependent on the specified mode; for example,\non some platforms, a Wi-Fi interface might support one set\nof data link types when not in monitor mode (for example,\nit might support only fake Ethernet headers, or might\nsupport 802.11 headers but not support 802.11 headers with\nradio information) and another set of data link types when\nin monitor mode (for example, it might support 802.11\nheaders, or 802.11 headers with radio information, only in\nmonitor mode).\n--lengths\nPrint the captured and original packet lengths.  The\nlengths are printed at the beginning of the line or after\nthe packet number, if any.\ncaplen\nis the captured packet\nlength (see the\n-s\noption).\nlen\nis the original (on wire)\npacket length.\n-m\nmodule\nLoad SMI MIB module definitions from file\nmodule\n.  This\noption can be used several times to load several MIB\nmodules into\ntcpdump\n.\n-M\nsecret\nUse\nsecret\nas a shared secret for validating the digests\nfound in TCP segments with the TCP-MD5 option (RFC 2385),\nif present.\n-n\nDon't convert addresses (i.e., host addresses, port\nnumbers, etc.) to names.\n-N\nDon't print domain name qualification of host names.  E.g.,\nif you give this flag then\ntcpdump\nwill print ``nic''\ninstead of ``nic.ddn.mil''.\n-#\n--number\nPrint a packet number at the beginning of the line.\n-O\n--no-optimize\nDo not run the packet-matching code optimizer.  This is\nuseful only if you suspect a bug in the optimizer.\n-p\n--no-promiscuous-mode\nDon't\nput the interface into promiscuous mode.  Note that\nthe interface might be in promiscuous mode for some other\nreason; hence,\n-p\ncannot be used as an abbreviation for\nether host {local-hw-addr} or ether broadcast\n.\n--print\nPrint parsed packet output, even if the raw packets are\nbeing saved to a file with the\n-w\nflag.\n--print-sampling=\nnth\nPrint every\nnth\npacket. This option enables the\n--print\nflag.\nUnprinted packets are not parsed, which decreases\nprocessing time. Setting\nnth\nto\n100\nfor example, will\n(counting from 1) parse and print the 100th packet, 200th\npacket, 300th packet, and so on.\nThis option also enables the\n-S\nflag, as relative TCP\nsequence numbers are not tracked for unprinted packets.\n-Q\ndirection\n--direction=\ndirection\nChoose send/receive direction\ndirection\nfor which packets\nshould be captured. Possible values are `in', `out' and\n`inout'. Not available on all platforms.\n-q\nQuick output.  Print less protocol information so output\nlines are shorter.\n-r\nfile\nRead packets from\nfile\n(which was created with the\n-w\noption or by other tools that write pcap or pcapng files).\nStandard input is used if\nfile\nis ``-''.\n-S\n--absolute-tcp-sequence-numbers\nPrint absolute, rather than relative, TCP sequence numbers.\n-s\nsnaplen\n--snapshot-length=\nsnaplen\nSnarf\nsnaplen\nbytes of data from each packet rather than\nthe default of 262144 bytes.  Packets truncated because of\na limited snapshot are indicated in the output with\n``[|\nproto\n]'', where\nproto\nis the name of the protocol level\nat which the truncation has occurred.\nNote that taking larger snapshots both increases the amount\nof time it takes to process packets and, effectively,\ndecreases the amount of packet buffering.  This may cause\npackets to be lost.  Note also that taking smaller\nsnapshots will discard data from protocols above the\ntransport layer, which loses information that may be\nimportant.  NFS and AFS requests and replies, for example,\nare very large, and much of the detail won't be available\nif a too-short snapshot length is selected.\nIf you need to reduce the snapshot size below the default,\nyou should limit\nsnaplen\nto the smallest number that will\ncapture the protocol information you're interested in.\nSetting\nsnaplen\nto 0 sets it to the default of 262144, for\nbackwards compatibility with recent older versions of\ntcpdump\n.\n--skip\ncount\nSkip\ncount\npackets before writing or printing.\ncount\nwith\nvalue 0 is allowed.\n-T\ntype\nForce packets selected by \"\nexpression\n\" to be interpreted\nthe specified\ntype\n.  Currently known types are\naodv\n(Ad-hoc\nOn-demand Distance Vector protocol),\ncarp\n(Common Address\nRedundancy Protocol),\ncnfp\n(Cisco NetFlow protocol),\ndomain\n(Domain Name System),\nlmp\n(Link Management Protocol),\npgm\n(Pragmatic General Multicast),\npgm_zmtp1\n(ZMTP/1.0 inside\nPGM/EPGM),\nptp\n(Precision Time Protocol),\nquic\n(QUIC),\nradius\n(RADIUS),\nresp\n(REdis Serialization Protocol),\nrpc\n(Remote Procedure Call),\nrtcp\n(Real-Time Applications\ncontrol protocol),\nrtp\n(Real-Time Applications protocol),\nsnmp\n(Simple Network Management Protocol),\nsomeip\n(SOME/IP),\ntftp\n(Trivial File Transfer Protocol),\nvat\n(Visual Audio Tool),\nvxlan\n(Virtual eXtensible Local Area\nNetwork),\nwb\n(distributed White Board) and\nzmtp1\n(ZeroMQ\nMessage Transport Protocol 1.0).\nNote that the\npgm\ntype above affects UDP interpretation\nonly, the native PGM is always recognised as IP protocol\n113 regardless. UDP-encapsulated PGM is often called \"EPGM\"\nor \"PGM/UDP\".\nNote that the\npgm_zmtp1\ntype above affects interpretation\nof both native PGM and UDP at once. During the native PGM\ndecoding the application data of an ODATA/RDATA packet\nwould be decoded as a ZeroMQ datagram with ZMTP/1.0 frames.\nDuring the UDP decoding in addition to that any UDP packet\nwould be treated as an encapsulated PGM packet.\n-t\nDon't\nprint a timestamp on each dump line.\n-tt\nPrint the timestamp, as seconds since January 1, 1970,\n00:00:00, UTC, and fractions of a second since that time,\non each dump line.\n-ttt\nPrint a delta (microsecond or nanosecond resolution\ndepending on the\n--time-stamp-precision\noption) between\ncurrent and previous line on each dump line.  The default\nis microsecond resolution.\n-tttt\nPrint a timestamp, as hours, minutes, seconds, and\nfractions of a second since midnight, preceded by the date,\non each dump line.\n-ttttt\nPrint a delta (microsecond or nanosecond resolution\ndepending on the\n--time-stamp-precision\noption) between\ncurrent and first line on each dump line.  The default is\nmicrosecond resolution.\n-u\nPrint undecoded NFS handles.\n-U\n--packet-buffered\nIf the\n-w\noption is not specified, or if it is specified\nbut the\n--print\nflag is also specified, make the printed\npacket output ``packet-buffered''; i.e., as the description\nof the contents of each packet is printed, it will be\nwritten to the standard output, rather than, when not\nwriting to a terminal, being written only when the output\nbuffer fills.\nIf the\n-w\noption is specified, make the saved raw packet\noutput ``packet-buffered''; i.e., as each packet is saved,\nit will be written to the output file, rather than being\nwritten only when the output buffer fills.\n-v\nWhen parsing and printing, produce (slightly more) verbose\noutput.  For example, the time to live, identification,\ntotal length and options in an IP packet are printed.  Also\nenables additional packet integrity checks such as\nverifying the IP and ICMP header checksum.\nWhen writing to a file with the\n-w\noption and at the same\ntime not reading from a file with the\n-r\noption, report to\nstderr, once per second, the number of packets captured. In\nSolaris, FreeBSD and possibly other operating systems this\nperiodic update currently can cause loss of captured\npackets on their way from the kernel to tcpdump.\n-vv\nEven more verbose output.  For example, additional fields\nare printed from NFS reply packets, and SMB packets are\nfully decoded.\n-vvv\nEven more verbose output.  For example, telnet\nSB\n...\nSE\noptions are printed in full.  With\n-X\ntelnet options are\nprinted in hex as well.\n-V\nfile\nRead a list of filenames from\nfile\n. Standard input is used\nif\nfile\nis ``-''.\n-w\nfile\nWrite the raw packets to\nfile\nrather than parsing and\nprinting them out.  They can later be printed with the -r\noption.  Standard output is used if\nfile\nis ``-''.\nThis output will be buffered if written to a file or pipe,\nso a program reading from the file or pipe may not see\npackets for an arbitrary amount of time after they are\nreceived.  Use the\n-U\nflag to cause packets to be written\nas soon as they are received.\nThe MIME type\napplication/vnd.tcpdump.pcap\nhas been\nregistered with IANA for\npcap\nfiles. The filename extension\n.pcap\nappears to be the most commonly used along with\n.cap\nand\n.dmp\n.\ntcpdump\nitself doesn't check the extension when\nreading capture files and doesn't add an extension when\nwriting them (it uses magic numbers in the file header\ninstead). However, many operating systems and applications\nwill use the extension if it is present and adding one\n(e.g. .pcap) is recommended.\nSee\npcap-savefile\n(@MAN_FILE_FORMATS@) for a description of\nthe file format.\n-W\nfilecount\nUsed in conjunction with the\n-C\noption, this will limit the\nnumber of files created to the specified number, and begin\noverwriting files from the beginning, thus creating a\n'rotating' buffer.  In addition, it will name the files\nwith enough leading 0s to support the maximum number of\nfiles, allowing them to sort correctly.\nUsed in conjunction with the\n-G\noption, this will limit the\nnumber of rotated dump files that get created, exiting with\nstatus 0 when reaching the limit.\nIf used in conjunction with both\n-C\nand\n-G,\nthe\n-W\noption\nwill currently be ignored, and will only affect the file\nname.\n-x\nWhen parsing and printing, in addition to printing the\nheaders of each packet, print the data of each packet\n(minus its link level header) in hex.  The smaller of the\nentire packet or\nsnaplen\nbytes will be printed.  Note that\nthis is the entire link-layer packet, so for link layers\nthat pad (e.g. Ethernet), the padding bytes will also be\nprinted when the higher layer packet is shorter than the\nrequired padding.  In the current implementation this flag\nmay have the same effect as\n-xx\nif the packet is truncated.\nNo effect when\n-X[X]\noption is used.\n-xx\nWhen parsing and printing, in addition to printing the\nheaders of each packet, print the data of each packet,\nincluding\nits link level header, in hex.  No effect when\n-X[X]\noption is used.\n-X\nWhen parsing and printing, in addition to printing the\nheaders of each packet, print the data of each packet\n(minus its link level header) in hex and ASCII.  This is\nvery handy for analysing new protocols.  In the current\nimplementation this flag may have the same effect as\n-XX\nif\nthe packet is truncated.\n-XX\nWhen parsing and printing, in addition to printing the\nheaders of each packet, print the data of each packet,\nincluding\nits link level header, in hex and ASCII.\n-y\ndatalinktype\n--linktype=\ndatalinktype\nSet the data link type to use while capturing packets (see\n-L\n) or just compiling and dumping packet-matching code (see\n-d\n) to\ndatalinktype\n.\n-z\npostrotate-command\nUsed in conjunction with the\n-C\nor\n-G\noptions, this will\nmake\ntcpdump\nrun \"\npostrotate-command file\n\" where\nfile\nis\nthe savefile being closed after each rotation. For example,\nspecifying\n-z gzip\nor\n-z bzip2\nwill compress each savefile\nusing gzip or bzip2.\nThis option can only be used if fork subprocess is\nimplemented (e.g. not on Windows systems).\nNote that tcpdump will run the command in parallel to the\ncapture, using the lowest priority so that this doesn't\ndisturb the capture process.\nAnd in case you would like to use a command that itself\ntakes flags or different arguments, you can always write a\nshell script that will take the savefile name as the only\nargument, make the flags & arguments arrangements and\nexecute the command that you want.\n-Z\nuser\n--relinquish-privileges=\nuser\nIf\ntcpdump\nis running as root, after opening the capture\ndevice or input savefile, but before opening any savefiles\nfor output, change the user ID to\nuser\nand the group ID to\nthe primary group of\nuser\n.\nThis behavior can also be enabled by default at compile\ntime.\nexpression\nselects which packets will be dumped.  If no\nexpression\nis\ngiven, all packets on the net will be dumped.  Otherwise,\nonly packets for that\nexpression\nis `true' will be dumped.\nFor the\nexpression\nsyntax, see\npcap-filter\n(@MAN_MISC_INFO@).\nThe\nexpression\nargument can be passed to\ntcpdump\nas either\na single Shell argument, or as multiple Shell arguments,\nwhichever is more convenient.  Generally, if the expression\ncontains Shell metacharacters, such as backslashes used to\nescape protocol names, it is easier to pass it as a single,\nquoted argument rather than to escape the Shell\nmetacharacters.  Multiple arguments are concatenated with\nspaces before being parsed.\nEXAMPLES\ntop\nTo print all packets arriving at or departing from\nsundown\n:\ntcpdump host sundown\nTo print traffic between\nhelios\nand either\nhot\nor\nace\n:\ntcpdump host helios and \\( hot or ace \\)\nTo print all IP packets between\nace\nand any host except\nhelios\n:\ntcpdump ip host ace and not helios\nTo print all traffic between local hosts and hosts at Berkeley:\ntcpdump net ucb-ether\nTo print all ftp traffic through internet gateway\nsnup\n: (note that\nthe expression is quoted to prevent the shell from\n(mis-)interpreting the parentheses):\ntcpdump 'gateway snup and (port ftp or ftp-data)'\nTo print traffic neither sourced from nor destined for local hosts\n(if you gateway to one other net, this stuff should never make it\nonto your local net).\ntcpdump ip and not net\nlocalnet\nTo print the start and end packets (the SYN and FIN packets) of\neach TCP conversation that involves a non-local host.\ntcpdump 'tcp[tcpflags] & (tcp-syn|tcp-fin) != 0 and not src and dst net\nlocalnet\n'\nTo print the TCP packets with flags RST and ACK both set.  (i.e.\nselect only the RST and ACK flags in the flags field, and if the\nresult is \"RST and ACK both set\", match)\ntcpdump 'tcp[tcpflags] & (tcp-rst|tcp-ack) == (tcp-rst|tcp-ack)'\nTo print all IPv4 HTTP packets to and from port 80, i.e. print\nonly packets that contain data, not, for example, SYN and FIN\npackets and ACK-only packets.  (IPv6 is left as an exercise for\nthe reader.)\ntcpdump 'tcp port 80 and (((ip[2:2] - ((ip[0]&0xf)<<2)) - ((tcp[12]&0xf0)>>2)) != 0)'\nTo print IP packets longer than 576 bytes sent through gateway\nsnup\n:\ntcpdump 'gateway snup and ip[2:2] > 576'\nTo print IP broadcast or multicast packets that were\nnot\nsent via\nEthernet broadcast or multicast:\ntcpdump 'ether[0] & 1 = 0 and ip[16] >= 224'\nTo print all ICMP packets that are not echo requests/replies\n(i.e., not ping packets):\ntcpdump 'icmp[icmptype] != icmp-echo and icmp[icmptype] != icmp-echoreply'\nOUTPUT FORMAT\ntop\nThe output of\ntcpdump\nis protocol dependent.  The following gives\na brief description and examples of most of the formats.\nTimestamps\nBy default, all output lines are preceded by a timestamp.  The\ntimestamp is the current clock time in the form\nhh:mm:ss.frac\nand is as accurate as the kernel's clock.  The timestamp reflects\nthe time the kernel applied a time stamp to the packet.  No\nattempt is made to account for the time lag between when the\nnetwork interface finished receiving the packet from the network\nand when the kernel applied a time stamp to the packet; that time\nlag could include a delay between the time when the network\ninterface finished receiving a packet from the network and the\ntime when an interrupt was delivered to the kernel to get it to\nread the packet and a delay between the time when the kernel\nserviced the `new packet' interrupt and the time when it applied a\ntime stamp to the packet.\nInterface\nWhen the\nany\ninterface is selected on capture or when a\nLINKTYPE_LINUX_SLL2\ncapture file is read, the interface name is\nprinted after the timestamp. This is followed by the packet type\nwith\nIn\nand\nOut\ndenoting a packet destined for this host or\noriginating from this host respectively. Other possible values are\nB\nfor broadcast packets,\nM\nfor multicast packets, and\nP\nfor\npackets destined for other hosts.\nLink Level Headers\nIf the\n-e\noption is given, the link level header is printed out.\nOn Ethernets, the source and destination addresses, protocol, and\npacket length are printed.\nOn FDDI networks, the\n-e\noption causes\ntcpdump\nto print the `frame\ncontrol' field,  the source and destination addresses, and the\npacket length.  (The `frame control' field governs the\ninterpretation of the rest of the packet.  Normal packets (such as\nthose containing IP datagrams) are `async' packets, with a\npriority value between 0 and 7; for example, `\nasync4\n'.  Such\npackets are assumed to contain an 802.2 Logical Link Control (LLC)\npacket; the LLC header is printed if it is\nnot\nan ISO datagram or\na so-called SNAP packet.\nOn Token Ring networks, the\n-e\noption causes\ntcpdump\nto print the\n`access control' and `frame control' fields, the source and\ndestination addresses, and the packet length.  As on FDDI\nnetworks, packets are assumed to contain an LLC packet.\nRegardless of whether the\n-e\noption is specified or not, the\nsource routing information is printed for source-routed packets.\nOn 802.11 networks, the\n-e\noption causes\ntcpdump\nto print the\n`frame control' fields, all of the addresses in the 802.11 header,\nand the packet length.  As on FDDI networks, packets are assumed\nto contain an LLC packet.\n(N.B.: The following description assumes familiarity with the SLIP\ncompression algorithm described in RFC 1144.)\nOn SLIP links, a direction indicator (``I'' for inbound, ``O'' for\noutbound), packet type, and compression information are printed\nout.  The packet type is printed first.  The three types are\nip\n,\nutcp\n, and\nctcp\n.  No further link information is printed for\nip\npackets.  For TCP packets, the connection identifier is printed\nfollowing the type.  If the packet is compressed, its encoded\nheader is printed out.  The special cases are printed out as\n*S+\nn\nand\n*SA+\nn\n, where\nn\nis the amount by which the sequence number (or\nsequence number and ack) has changed.  If it is not a special\ncase, zero or more changes are printed.  A change is indicated by\nU (urgent pointer), W (window), A (ack), S (sequence number), and\nI (packet ID), followed by a delta (+n or -n), or a new value\n(=n).  Finally, the amount of data in the packet and compressed\nheader length are printed.\nFor example, the following line shows an outbound compressed TCP\npacket, with an implicit connection identifier; the ack has\nchanged by 6, the sequence number by 49, and the packet ID by 6;\nthere are 3 bytes of data and 6 bytes of compressed header:\nO ctcp * A+6 S+49 I+6 3 (6)\nARP/RARP Packets\nARP/RARP output shows the type of request and its arguments.  The\nformat is intended to be self explanatory.  Here is a short sample\ntaken from the start of an `rlogin' from host\nrtsg\nto host\ncsam\n:\narp who-has csam tell rtsg\narp reply csam is-at CSAM\nThe first line says that rtsg sent an ARP packet asking for the\nEthernet address of internet host csam.  Csam replies with its\nEthernet address (in this example, Ethernet addresses are in caps\nand internet addresses in lower case).\nThis would look less redundant if we had done\ntcpdump -n\n:\narp who-has 128.3.254.6 tell 128.3.254.68\narp reply 128.3.254.6 is-at 02:07:01:00:01:c4\nIf we had done\ntcpdump -e\n, the fact that the first packet is\nbroadcast and the second is point-to-point would be visible:\nRTSG Broadcast 0806  64: arp who-has csam tell rtsg\nCSAM RTSG 0806  64: arp reply csam is-at CSAM\nFor the first packet this says the Ethernet source address is\nRTSG, the destination is the Ethernet broadcast address, the type\nfield contained hex 0806 (\nETHERTYPE_ARP\n) and the total length was\n64 bytes.\nIPv4 Packets\nIf the link-layer header is not being printed, for IPv4 packets,\nIP\nis printed after the time stamp.\nIf the\n-v\nflag is specified, information from the IPv4 header is\nshown in parentheses after the\nIP\nor the link-layer header.  The\ngeneral format of this information is:\ntos\ntos\n, ttl\nttl\n, id\nid\n, offset\noffset\n, flags [\nflags\n], proto\nproto\n, length\nlength\n, options (\noptions\n)\ntos\nis the type of service field; if the ECN bits are non-zero,\nthose are reported as\nECT(1)\n,\nECT(0)\n, or\nCE\n.\nttl\nis the time-to-\nlive; it is not reported if it is zero.\nid\nis the IP\nidentification field.\noffset\nis the fragment offset field; it is\nprinted whether this is part of a fragmented datagram or not.\nflags\nare the MF and DF flags;\n+\nis reported if MF is set, and\nDF\nis reported if F is set.  If neither are set,\n.\nis reported.\nproto\nis the protocol ID field.\nlength\nis the total length field;\nif the packet is a presumed TSO (TCP Segmentation Offload) send,\n[was 0, presumed TSO] is reported.\noptions\nare the IP options, if\nany.\nNext, for TCP and UDP packets, the source and destination IP\naddresses and TCP or UDP ports, with a dot between each IP address\nand its corresponding port, will be printed, with a > separating\nthe source and destination.  For other protocols, the addresses\nwill be printed, with a > separating the source and destination.\nHigher level protocol information, if any, will be printed after\nthat.\nFor fragmented IP datagrams, the first fragment contains the\nhigher level protocol header; fragments after the first contain no\nhigher level protocol header.  Fragmentation information will be\nprinted only with the\n-v\nflag, in the IP header information, as\ndescribed above.\nTCP Packets\n(N.B.:The following description assumes familiarity with the TCP\nprotocol described in RFC 793.\nIf you are not familiar with the\nprotocol, this description will not be of much use to you.)\nThe general format of a TCP protocol line is:\nsrc\n>\ndst\n: Flags [\ntcpflags\n], seq\ndata-seqno\n, ack\nackno\n, win\nwindow\n, urg\nurgent\n, options [\nopts\n], length\nlen\nSrc\nand\ndst\nare the source and destination IP addresses and ports.\nTcpflags\nare some combination of S (SYN), F (FIN), P (PSH), R\n(RST), U (URG), W (CWR), E (ECE), e (AE) or `.' (ACK), or `none'\nif no flags are set.\nData-seqno\ndescribes the portion of sequence\nspace covered by the data in this packet (see example below).\nAckno\nis sequence number of the next data expected the other\ndirection on this connection.\nWindow\nis the number of bytes of\nreceive buffer space available the other direction on this\nconnection.\nUrg\nindicates there is `urgent' data in the packet.\nOpts\nare TCP options (e.g., mss 1024).\nLen\nis the length of\npayload data.\nIptype\n,\nSrc\n,\ndst\n, and\nflags\nare always present.  The other fields\ndepend on the contents of the packet's TCP protocol header and are\noutput only if appropriate.\nHere is the opening portion of an rlogin from host\nrtsg\nto host\ncsam\n.\nIP rtsg.1023 > csam.login: Flags [S], seq 768512:768512, win 4096, opts [mss 1024]\nIP csam.login > rtsg.1023: Flags [S.], seq, 947648:947648, ack 768513, win 4096, opts [mss 1024]\nIP rtsg.1023 > csam.login: Flags [.], ack 1, win 4096\nIP rtsg.1023 > csam.login: Flags [P.], seq 1:2, ack 1, win 4096, length 1\nIP csam.login > rtsg.1023: Flags [.], ack 2, win 4096\nIP rtsg.1023 > csam.login: Flags [P.], seq 2:21, ack 1, win 4096, length 19\nIP csam.login > rtsg.1023: Flags [P.], seq 1:2, ack 21, win 4077, length 1\nIP csam.login > rtsg.1023: Flags [P.], seq 2:3, ack 21, win 4077, urg 1, length 1\nIP csam.login > rtsg.1023: Flags [P.], seq 3:4, ack 21, win 4077, urg 1, length 1\nThe first line says that TCP port 1023 on rtsg sent a packet to\nport\nlogin\non csam.  The\nS\nindicates that the\nSYN\nflag was set.\nThe packet sequence number was 768512 and it contained no data.\n(The notation is `first:last' which means `sequence numbers\nfirst\nup to but not including\nlast\n'.)  There was no piggy-backed ACK,\nthe available receive window was 4096 bytes and there was a max-\nsegment-size option requesting an MSS of 1024 bytes.\nCsam replies with a similar packet except it includes a piggy-\nbacked ACK for rtsg's SYN.  Rtsg then ACKs csam's SYN.  The `.'\nmeans the ACK flag was set.  The packet contained no data so there\nis no data sequence number or length.  Note that the ACK sequence\nnumber is a small integer (1).  The first time\ntcpdump\nsees a TCP\n`conversation', it prints the sequence number from the packet.  On\nsubsequent packets of the conversation, the difference between the\ncurrent packet's sequence number and this initial sequence number\nis printed.  This means that sequence numbers after the first can\nbe interpreted as relative byte positions in the conversation's\ndata stream (with the first data byte each direction being `1').\n-S\nwill override this feature, causing the original sequence\nnumbers to be output.\nOn the 6th line, rtsg sends csam 19 bytes of data (bytes 2 through\n20 in the rtsg â csam side of the conversation).  The PSH flag is\nset in the packet.  On the 7th line, csam says it's received data\nsent by rtsg up to but not including byte 21.  Most of this data\nis apparently sitting in the socket buffer since csam's receive\nwindow has gotten 19 bytes smaller.  Csam also sends one byte of\ndata to rtsg in this packet.  On the 8th and 9th lines, csam sends\ntwo bytes of urgent, pushed data to rtsg.\nIf the snapshot was small enough that\ntcpdump\ndidn't capture the\nfull TCP header, it interprets as much of the header as it can and\nthen reports ``[|\ntcp\n]'' to indicate the remainder could not be\ninterpreted.  If the header contains a bogus option (one with a\nlength that's either too small or beyond the end of the header),\ntcpdump\nreports it as ``[\nbad opt\n]'' and does not interpret any\nfurther options (since it's impossible to tell where they start).\nIf the header length indicates options are present but the IP\ndatagram length is not long enough for the options to actually be\nthere,\ntcpdump\nreports it as ``[\nbad hdr length\n]''.\nParticular TCP Flag Combinations (SYN-ACK, URG-ACK, etc.)\nThere are 9 bits in the control bits section of the TCP header:\nAE(e) CWR(W) ECE(E) URG(U) ACK(.) PSH(P) RST(R) SYN(S) FIN(F)\nLet's assume that we want to watch packets used in establishing a\nTCP connection.  Recall that TCP uses a 3-way handshake protocol\nwhen it initializes a new connection; the connection sequence with\nregard to the TCP control bits is\n1) Caller sends SYN\n2) Recipient responds with SYN, ACK\n3) Caller sends ACK\nNow we're interested in capturing packets that have only the SYN\nbit set (Step 1).  Note that we don't want packets from step 2\n(SYN-ACK), just a plain initial SYN.  What we need is a correct\nfilter expression for\ntcpdump\n.\nRecall the structure of a TCP header without options:\n0                            15                              31\n-----------------------------------------------------------------\n|          source port          |       destination port        |\n-----------------------------------------------------------------\n|                        sequence number                        |\n-----------------------------------------------------------------\n|                     acknowledgment number                     |\n-----------------------------------------------------------------\n|header |re   |A|C|E|U|A|P|R|S|F|                               |\n|length |serv |E|W|C|R|C|S|S|Y|I|        window size            |\n|       |  ed | |R|E|G|K|H|T|N|N|                               |\n-----------------------------------------------------------------\n|         TCP checksum          |       urgent pointer          |\n-----------------------------------------------------------------\nA TCP header usually holds 20 octets of data, unless options are\npresent.  The first line of the graph contains octets 0 - 3, the\nsecond line shows octets 4 - 7 etc.\nStarting to count with 0, the relevant TCP control bits are\ncontained in octets 12 and 13:\n0             7|             15|             23|             31\n----------------|---------------|---------------|----------------\n|header |re   |A|C|E|U|A|P|R|S|F|                               |\n|length |serv |E|W|C|R|C|S|S|Y|I|        window size            |\n|       |  ed | |R|E|G|K|H|T|N|N|                               |\n----------------|---------------|---------------|----------------\n|               |  13th octet   |               |               |\nLet's have a closer look at octet no. 13:\n|               |\n|---------------|\n|C|E|U|A|P|R|S|F|\n|W|C|R|C|S|S|Y|I|\n|R|E|G|K|H|T|N|N|\n|---------------|\n|7   5   3     0|\nThese are the TCP control bits we are interested in.  We have\nnumbered the bits in this octet from 0 to 7, right to left, so the\nPSH bit is bit number 3, while the URG bit is number 5.\nRecall that we want to capture packets with only SYN set.  Let's\nsee what happens to octet 13 if a TCP datagram arrives with the\nSYN bit set in its header:\n|C|E|U|A|P|R|S|F|\n|W|C|R|C|S|S|Y|I|\n|R|E|G|K|H|T|N|N|\n|---------------|\n|0 0 0 0 0 0 1 0|\n|---------------|\n|7 6 5 4 3 2 1 0|\nLooking at the control bits section we see that only bit number 1\n(SYN) is set.\nAssuming that octet number 13 is an 8-bit unsigned integer in\nnetwork byte order, the binary value of this octet is\n00000010\nand its decimal representation is\n7     6     5     4     3     2     1     0\n0*2 + 0*2 + 0*2 + 0*2 + 0*2 + 0*2 + 1*2 + 0*2  =  2\nWe're almost done, because now we know that if only SYN is set,\nthe value of the 13th octet in the TCP header, when interpreted as\na 8-bit unsigned integer in network byte order, must be exactly 2.\nThis relationship can be expressed as\ntcp[13] == 2\nWe can use this expression as the filter for\ntcpdump\nin order to\nwatch packets which have only SYN set:\ntcpdump -i xl0 'tcp[13] == 2'\nThe expression says \"let the 13th octet of a TCP datagram have the\ndecimal value 2\", which is exactly what we want.\nNow, let's assume that we need to capture SYN packets, but we\ndon't care if ACK or any other TCP control bit is set at the same\ntime.  Let's see what happens to octet 13 when a TCP datagram with\nSYN-ACK set arrives:\n|C|E|U|A|P|R|S|F|\n|W|C|R|C|S|S|Y|I|\n|R|E|G|K|H|T|N|N|\n|---------------|\n|0 0 0 1 0 0 1 0|\n|---------------|\n|7 6 5 4 3 2 1 0|\nNow bits 1 and 4 are set in the 13th octet.  The binary value of\noctet 13 is\n00010010\nwhich translates to decimal\n7     6     5     4     3     2     1     0\n0*2 + 0*2 + 0*2 + 1*2 + 0*2 + 0*2 + 1*2 + 0*2   = 18\nNow we can't just use\ntcp[13] == 18\nin the\ntcpdump\nfilter\nexpression, because that would select only those packets that have\nSYN-ACK set, but not those with only SYN set.  Remember that we\ndon't care if ACK or any other control bit is set as long as SYN\nis set.\nIn order to achieve our goal, we need to logically AND the binary\nvalue of octet 13 with some other value to preserve the SYN bit.\nWe know that we want SYN to be set in any case, so we'll logically\nAND the value in the 13th octet with the binary value of a SYN:\n00010010 SYN-ACK              00000010 SYN\nAND  00000010 (we want SYN)   AND  00000010 (we want SYN)\n--------                      --------\n=    00000010                 =    00000010\nWe see that this AND operation delivers the same result regardless\nwhether ACK or another TCP control bit is set.  The decimal\nrepresentation of the AND value as well as the result of this\noperation is 2 (binary 00000010), so we know that for packets with\nSYN set the following relation must hold true:\n( ( value of octet 13 ) AND ( 2 ) ) == ( 2 )\nThis points us to the\ntcpdump\nfilter expression\ntcpdump -i xl0 'tcp[13] & 2 == 2'\nSome offsets and field values may be expressed as names rather\nthan as numeric values. For example,\ntcp[13]\nmay be replaced with\ntcp[tcpflags]\n.  The following TCP flag field values are also\navailable: tcp-fin, tcp-syn, tcp-rst, tcp-push, tcp-ack, tcp-urg,\ntcp-ece and tcp-cwr.\nThis can be demonstrated as:\ntcpdump -i xl0 'tcp[tcpflags] & tcp-push != 0'\nNote that you should use single quotes or a backslash in the\nexpression to hide the AND ('&') special character from the shell.\nUDP Packets\nUDP format is illustrated by this rwho packet:\nactinide.who > broadcast.who: udp 84\nThis says that port\nwho\non host\nactinide\nsent a UDP datagram to\nport\nwho\non host\nbroadcast\n, the Internet broadcast address.  The\npacket contained 84 bytes of user data.\nSome UDP services are recognized (from the source or destination\nport number) and the higher level protocol information printed.\nIn particular, Domain Name service requests (RFC 1034/1035) and\nSun RPC calls (RFC 1050) to NFS.\nTCP or UDP Name Server Requests\n(N.B.:The following description assumes familiarity with the\nDomain Service protocol described in RFC 1035.\nIf you are not\nfamiliar with the protocol, the following description will appear\nto be written in Greek.)\nName server requests are formatted as\nsrc > dst: id op? flags qtype qclass name (len)\nh2opolo.1538 > helios.domain: 3+ A? ucbvax.berkeley.edu. (37)\nHost\nh2opolo\nasked the domain server on\nhelios\nfor an address\nrecord (qtype=A) associated with the name\nucbvax.berkeley.edu.\nThe query id was `3'.  The `+' indicates the\nrecursion desired\nflag was set.  The query length was 37 bytes, excluding the TCP or\nUDP and IP protocol headers.  The query operation was the normal\none,\nQuery\n, so the op field was omitted.  If the op had been\nanything else, it would have been printed between the `3' and the\n`+'.  Similarly, the qclass was the normal one,\nC_IN\n, and omitted.\nAny other qclass would have been printed immediately after the\n`A'.\nA few anomalies are checked and may result in extra fields\nenclosed in square brackets:  If a query contains an answer,\nauthority records or additional records section,\nancount\n,\nnscount\n,\nor\narcount\nare printed as `[\nn\na]', `[\nn\nn]' or  `[\nn\nau]' where\nn\nis\nthe appropriate count.  If any of the response bits are set (AA,\nRA or rcode) or any of the `must be zero' bits are set in bytes\ntwo and three, `[b2&3=\nx\n]' is printed, where\nx\nis the hex value of\nheader bytes two and three.\nTCP or UDP Name Server Responses\nName server responses are formatted as\nsrc > dst:\nid op rcode flags a/n/au type class data (len)\nhelios.domain > h2opolo.1538: 3 3/3/7 A 128.32.137.3 (273)\nhelios.domain > h2opolo.1537: 2 NXDomain* 0/1/0 (97)\nIn the first example,\nhelios\nresponds to query id 3 from\nh2opolo\nwith 3 answer records, 3 name server records and 7 additional\nrecords.  The first answer record is type A (address) and its data\nis internet address 128.32.137.3.  The total size of the response\nwas 273 bytes, excluding TCP or UDP and IP headers.  The op\n(Query) and response code (NoError) were omitted, as was the class\n(\nC_IN\n) of the A record.\nIn the second example,\nhelios\nresponds to query 2 with a response\ncode of nonexistent domain (NXDomain) with no answers, one name\nserver and no authority records.  The `*' indicates that the\nauthoritative answer\nbit was set.  Since there were no answers, no\ntype, class or data were printed.\nOther flag characters that might appear are `-' (recursion\navailable, RA,\nnot\nset) and `|' (truncated message, TC, set).  If\nthe `question' section doesn't contain exactly one entry, `[\nn\nq]'\nis printed.\nSMB/CIFS Decoding\ntcpdump\nnow includes fairly extensive SMB/CIFS/NBT decoding for\ndata on UDP/137, UDP/138 and TCP/139.  Some primitive decoding of\nIPX and NetBEUI SMB data is also done.\nBy default a fairly minimal decode is done, with a much more\ndetailed decode done if\n-v\nis used.  Be warned that with\n-v\na\nsingle SMB packet may take up a page or more, so only use\n-v\nif\nyou really want all the gory details.\nFor information on SMB packet formats and what all the fields mean\nsee\nhttps://download.samba.org/pub/samba/specs/\nand other online\nresources.  The SMB patches were written by Andrew Tridgell\n(tridge@samba.org).\nNFS Requests and Replies\nNetwork File System requests and replies are printed as:\nsrc.sport > dst.nfs: NFS request xid xid len op args\nsrc.nfs > dst.dport: NFS reply xid xid reply stat len op results\nsushi.1023 > wrl.nfs: NFS request xid 26377\n112 readlink fh 21,24/10.73165\nwrl.nfs > sushi.1023: NFS reply xid 26377\nreply ok 40 readlink \"../var\"\nsushi.1022 > wrl.nfs: NFS request xid 8219\n144 lookup fh 9,74/4096.6878 \"xcolors\"\nwrl.nfs > sushi.1022: NFS reply xid 8219\nreply ok 128 lookup fh 9,74/4134.3150\nIn the first line, host\nsushi\nsends a transaction with id\n26377\nto\nwrl\n.  The request was 112 bytes, excluding the UDP and IP headers.\nThe operation was a\nreadlink\n(read symbolic link) on file handle\n(\nfh\n) 21,24/10.731657119.  (If one is lucky, as in this case, the\nfile handle can be interpreted as a major,minor device number\npair, followed by the inode number and generation number.) In the\nsecond line,\nwrl\nreplies `ok' with the same transaction id and the\ncontents of the link.\nIn the third line,\nsushi\nasks (using a new transaction id)\nwrl\nto\nlookup the name `\nxcolors\n' in directory file 9,74/4096.6878. In the\nfourth line,\nwrl\nsends a reply with the respective transaction id.\nNote that the data printed depends on the operation type.  The\nformat is intended to be self explanatory if read in conjunction\nwith an NFS protocol spec.  Also note that older versions of\ntcpdump printed NFS packets in a slightly different format: the\ntransaction id (xid) would be printed instead of the non-NFS port\nnumber of the packet.\nIf the\n-v\n(verbose) flag is given, additional information is\nprinted.  For example:\nsushi.1023 > wrl.nfs: NFS request xid 79658\n148 read fh 21,11/12.195 8192 bytes @ 24576\nwrl.nfs > sushi.1023: NFS reply xid 79658\nreply ok 1472 read REG 100664 ids 417/0 sz 29388\n(\n-v\nalso prints the IP header TTL, ID, length, and fragmentation\nfields, which have been omitted from this example.)  In the first\nline,\nsushi\nasks\nwrl\nto read 8192 bytes from file 21,11/12.195, at\nbyte offset 24576.\nWrl\nreplies `ok'; the packet shown on the\nsecond line is the first fragment of the reply, and hence is only\n1472 bytes long (the other bytes will follow in subsequent\nfragments, but these fragments do not have NFS or even UDP headers\nand so might not be printed, depending on the filter expression\nused).  Because the -v flag is given, some of the file attributes\n(which are returned in addition to the file data) are printed: the\nfile type (``REG'', for regular file), the file mode (in octal),\nthe UID and GID, and the file size.\nIf the\n-v\nflag is given more than once, even more details are\nprinted.\nNFS reply packets do not explicitly identify the RPC operation.\nInstead,\ntcpdump\nkeeps track of ``recent'' requests, and matches\nthem to the replies using the transaction ID.  If a reply does not\nclosely follow the corresponding request, it might not be\nparsable.\nAFS Requests and Replies\nAndrew File System requests and replies are printed as:\nsrc.sport > dst.dport: rx packet-type\nsrc.sport > dst.dport: rx packet-type service call call-name args\nsrc.sport > dst.dport: rx packet-type service reply call-name args\nelvis.7001 > pike.afsfs:\nrx data fs call rename old fid 536876964/1/1 \".newsrc.new\"\nnew fid 536876964/1/1 \".newsrc\"\npike.afsfs > elvis.7001: rx data fs reply rename\nIn the first line, host elvis sends a RX packet to pike.  This was\na RX data packet to the fs (fileserver) service, and is the start\nof an RPC call.  The RPC call was a rename, with the old directory\nfile id of 536876964/1/1 and an old filename of `.newsrc.new', and\na new directory file id of 536876964/1/1 and a new filename of\n`.newsrc'.  The host pike responds with a RPC reply to the rename\ncall (which was successful, because it was a data packet and not\nan abort packet).\nIn general, all AFS RPCs are decoded at least by RPC call name.\nMost AFS RPCs have at least some of the arguments decoded\n(generally only the `interesting' arguments, for some definition\nof interesting).\nThe format is intended to be self-describing, but it will probably\nnot be useful to people who are not familiar with the workings of\nAFS and RX.\nIf the\n-v\n(verbose) flag is given, acknowledgement packets and\nadditional header information is printed, such as the RX call ID,\ncall number, sequence number, serial number, and the RX packet\nflags.\nIf the\n-v\nflag is given twice, additional information is printed,\nsuch as the RX call ID, serial number, and the RX packet flags.\nThe MTU negotiation information is also printed from RX ack\npackets.\nIf the\n-v\nflag is given three times, the security index and\nservice id are printed.\nError codes are printed for abort packets, with the exception of\nUbik beacon packets (because abort packets are used to signify a\nyes vote for the Ubik protocol).\nAFS reply packets do not explicitly identify the RPC operation.\nInstead,\ntcpdump\nkeeps track of ``recent'' requests, and matches\nthem to the replies using the call number and service ID.  If a\nreply does not closely follow the corresponding request, it might\nnot be parsable.\nKIP AppleTalk (DDP in UDP)\nAppleTalk DDP packets encapsulated in UDP datagrams are de-\nencapsulated and dumped as DDP packets (i.e., all the UDP header\ninformation is discarded).  The file\n/etc/atalk.names\nis used to\ntranslate AppleTalk net and node numbers to names.  Lines in this\nfile have the form\nnumber\nname\n1.254          ether\n16.1      icsd-net\n1.254.110 ace\nThe first two lines give the names of AppleTalk networks.  The\nthird line gives the name of a particular host (a host is\ndistinguished from a net by the 3rd octet in the number - a net\nnumber\nmust\nhave two octets and a host number\nmust\nhave three\noctets.)  The number and name should be separated by whitespace\n(blanks or tabs).  The\n/etc/atalk.names\nfile may contain blank\nlines or comment lines (lines starting with a `#').\nAppleTalk addresses are printed in the form\nnet.host.port\n144.1.209.2 > icsd-net.112.220\noffice.2 > icsd-net.112.220\njssmag.149.235 > icsd-net.2\n(If the\n/etc/atalk.names\ndoesn't exist or doesn't contain an entry\nfor some AppleTalk host/net number, addresses are printed in\nnumeric form.)  In the first example, NBP (DDP port 2) on net\n144.1 node 209 is sending to whatever is listening on port 220 of\nnet icsd node 112.  The second line is the same except the full\nname of the source node is known (`office').  The third line is a\nsend from port 235 on net jssmag node 149 to broadcast on the\nicsd-net NBP port (note that the broadcast address (255) is\nindicated by a net name with no host number - for this reason it's\na good idea to keep node names and net names distinct in\n/etc/atalk.names).\nNBP (name binding protocol) and ATP (AppleTalk transaction\nprotocol) packets have their contents interpreted.  Other\nprotocols just dump the protocol name (or number if no name is\nregistered for the protocol) and packet size.\nNBP Packets\nNBP packets are formatted like the following examples:\nicsd-net.112.220 > jssmag.2: nbp-lkup 190: \"=:LaserWriter@*\"\njssmag.209.2 > icsd-net.112.220: nbp-reply 190: \"RM1140:LaserWriter@*\" 250\ntechpit.2 > icsd-net.112.220: nbp-reply 190: \"techpit:LaserWriter@*\" 186\nThe first line is a name lookup request for laserwriters sent by\nnet icsd host 112 and broadcast on net jssmag.  The nbp id for the\nlookup is 190.  The second line shows a reply for this request\n(note that it has the same id) from host jssmag.209 saying that it\nhas a laserwriter resource named \"RM1140\" registered on port 250.\nThe third line is another reply to the same request saying host\ntechpit has laserwriter \"techpit\" registered on port 186.\nATP Packets\nATP packet formatting is demonstrated by the following example:\njssmag.209.165 > helios.132: atp-req  12266<0-7> 0xae030001\nhelios.132 > jssmag.209.165: atp-resp 12266:0 (512) 0xae040000\nhelios.132 > jssmag.209.165: atp-resp 12266:1 (512) 0xae040000\nhelios.132 > jssmag.209.165: atp-resp 12266:2 (512) 0xae040000\nhelios.132 > jssmag.209.165: atp-resp 12266:3 (512) 0xae040000\nhelios.132 > jssmag.209.165: atp-resp 12266:4 (512) 0xae040000\nhelios.132 > jssmag.209.165: atp-resp 12266:5 (512) 0xae040000\nhelios.132 > jssmag.209.165: atp-resp 12266:6 (512) 0xae040000\nhelios.132 > jssmag.209.165: atp-resp*12266:7 (512) 0xae040000\njssmag.209.165 > helios.132: atp-req  12266<3,5> 0xae030001\nhelios.132 > jssmag.209.165: atp-resp 12266:3 (512) 0xae040000\nhelios.132 > jssmag.209.165: atp-resp 12266:5 (512) 0xae040000\njssmag.209.165 > helios.132: atp-rel  12266<0-7> 0xae030001\njssmag.209.133 > helios.132: atp-req* 12267<0-7> 0xae030002\nJssmag.209 initiates transaction id 12266 with host helios by\nrequesting up to 8 packets (the `<0-7>').  The hex number at the\nend of the line is the value of the `userdata' field in the\nrequest.\nHelios responds with 8 512-byte packets.  The `:digit' following\nthe transaction id gives the packet sequence number in the\ntransaction and the number in parens is the amount of data in the\npacket, excluding the ATP header.  The `*' on packet 7 indicates\nthat the EOM bit was set.\nJssmag.209 then requests that packets 3 & 5 be retransmitted.\nHelios resends them then jssmag.209 releases the transaction.\nFinally, jssmag.209 initiates the next request.  The `*' on the\nrequest indicates that XO (`exactly once') was\nnot\nset.\nBACKWARD COMPATIBILITY\ntop\nThe TCP flag names\ntcp-ece\nand\ntcp-cwr\nbecame available when\nlinking with libpcap 1.9.0 or later.\nThis version of tcpdump requires libpcap 1.0 or later.\nSEE ALSO\ntop\nstty(1)\n,\npcap\n(3PCAP),\npcap-savefile\n(@MAN_FILE_FORMATS@),\npcap-filter\n(@MAN_MISC_INFO@),\npcap-tstamp\n(@MAN_MISC_INFO@)\nhttps://www.iana.org/assignments/media-types/application/vnd.tcpdump.pcap\nAUTHORS\ntop\nThe original authors are:\nVan  Jacobson, Craig Leres and Steven McCanne, all of the Lawrence\nBerkeley National Laboratory, University of California,  Berkeley,\nCA.\nIt is currently maintained by The Tcpdump Group.\nThe current version is available via HTTPS:\nhttps://www.tcpdump.org/\nThe original distribution is available via anonymous FTP:\nftp://ftp.ee.lbl.gov/old/tcpdump.tar.Z\nIPv6/IPsec  support  is  added by WIDE/KAME project.  This program\nuses OpenSSL/LibreSSL, under specific configurations.\nBUGS\ntop\nTo  report  a  security   issue   please   send   an   e-mail   to\nsecurity@tcpdump.org.\nTo  report  bugs and other problems, contribute patches, request a\nfeature,  provide  generic  feedback  etc.  please  see  the  file\nCONTRIBUTING.md\nin the tcpdump source tree root.\nSome  attempt  should  be  made  to reassemble IP fragments or, at\nleast to compute the right length for the higher level protocol.\nName server inverse queries are not dumped correctly: the  (empty)\nquestion  section  is printed rather than real query in the answer\nsection.  Some believe that inverse queries are themselves  a  bug\nand prefer to fix the program generating them rather than\ntcpdump\n.\nA  packet  trace  that crosses a daylight savings time change will\ngive skewed time stamps (the time change is ignored).\nCOLOPHON\ntop\nThis page is part of the\ntcpdump\n(a  command-line  network  packet\nanalyzer)  project.  Information about the project can be found at\nâ¨\nhttp://www.tcpdump.org/\nâ©.  If you have  a  bug  report  for  this\nmanual page, see â¨\nhttp://www.tcpdump.org/#patches\nâ©.  This page was\nobtained    from    the    project's   upstream   Git   repository\nâ¨\nhttps://github.com/the-tcpdump-group/tcpdump\nâ© on 2025-08-11.  (At\nthat time, the date of the most recent commit that  was  found  in\nthe  repository  was  2025-08-01.)   If you discover any rendering\nproblems in this HTML version of the page, or you believe there is\na better or more up-to-date source  for  the  page,  or  you  have\ncorrections  or  improvements  to the information in this COLOPHON\n(which is\nnot\npart of the original manual page), send  a  mail  to\nman-pages@man7.org\n30 June 2025\nTCPDUMP\n(1)\nPages that refer to this page:\novs-pcap(1)\n,\novs-tcpundump(1)\n,\nsocket(7)\n,\ncsysdig(8)\n,\nnetsniff-ng(8)\n,\novs-tcpdump(8)\n,\nsysdig(8)\n,\ntc-bpf(8)\n,\ntraceroute(8)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man8/tcpdump.8.html"}}
{"text": "nmap(1) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\nnmap(1) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nOPTIONS SUMMARY\n|\nTARGET SPECIFICATION\n|\nHOST DISCOVERY\n|\nPORT SCANNING BASICS\n|\nPORT SCANNING TECHNIQUES\n|\nPORT SPECIFICATION AND SCAN ORDER\n|\nSERVICE AND VERSION DETECTION\n|\nOS DETECTION\n|\nNMAP SCRIPTING ENGINE (NSE)\n|\nTIMING AND PERFORMANCE\n|\nFIREWALL/IDS EVASION AND SPOOFING\n|\nOUTPUT\n|\nMISCELLANEOUS OPTIONS\n|\nRUNTIME INTERACTION\n|\nEXAMPLES\n|\nNMAP BOOK\n|\nBUGS\n|\nAUTHORS\n|\nLEGAL NOTICES\n|\nNOTES\n|\nCOLOPHON\nNMAP\n(1)                    Nmap Reference Guide\nNMAP\n(1)\nNAME\ntop\nnmap - Network exploration tool and security / port scanner\nSYNOPSIS\ntop\nnmap\n[\nScan Type\n...] [\nOptions\n] {\ntarget specification\n}\nDESCRIPTION\ntop\nNmap (âNetwork Mapperâ) is an open source tool for network\nexploration and security auditing. It was designed to rapidly scan\nlarge networks, although it works fine against single hosts. Nmap\nuses raw IP packets in novel ways to determine what hosts are\navailable on the network, what services (application name and\nversion) those hosts are offering, what operating systems (and OS\nversions) they are running, what type of packet filters/firewalls\nare in use, and dozens of other characteristics. While Nmap is\ncommonly used for security audits, many systems and network\nadministrators find it useful for routine tasks such as network\ninventory, managing service upgrade schedules, and monitoring host\nor service uptime.\nThe output from Nmap is a list of scanned targets, with\nsupplemental information on each depending on the options used.\nKey among that information is the âinteresting ports tableâ.  That\ntable lists the port number and protocol, service name, and state.\nThe state is either open, filtered, closed, or unfiltered.  Open\nmeans that an application on the target machine is listening for\nconnections/packets on that port.  Filtered means that a firewall,\nfilter, or other network obstacle is blocking the port so that\nNmap cannot tell whether it is open or closed.  Closed ports have\nno application listening on them, though they could open up at any\ntime. Ports are classified as unfiltered when they are responsive\nto Nmap's probes, but Nmap cannot determine whether they are open\nor closed. Nmap reports the state combinations open|filtered and\nclosed|filtered when it cannot determine which of the two states\ndescribe a port. The port table may also include software version\ndetails when version detection has been requested. When an IP\nprotocol scan is requested (\n-sO\n), Nmap provides information on\nsupported IP protocols rather than listening ports.\nIn addition to the interesting ports table, Nmap can provide\nfurther information on targets, including reverse DNS names,\noperating system guesses, device types, and MAC addresses.\nA typical Nmap scan is shown in Example 1. The only Nmap arguments\nused in this example are\n-A\n, to enable OS and version detection,\nscript scanning, and traceroute;\n-T4\nfor faster execution; and\nthen the hostname.\nExample 1. A representative Nmap scan\n#\nnmap -A -T4 scanme.nmap.org\nNmap scan report for scanme.nmap.org (74.207.244.221)\nHost is up (0.029s latency).\nrDNS record for 74.207.244.221: li86-221.members.linode.com\nNot shown: 995 closed ports\nPORT     STATE    SERVICE     VERSION\n22/tcp   open     ssh         OpenSSH 5.3p1 Debian 3ubuntu7 (protocol 2.0)\n| ssh-hostkey: 1024 8d:60:f1:7c:ca:b7:3d:0a:d6:67:54:9d:69:d9:b9:dd (DSA)\n|_2048 79:f8:09:ac:d4:e2:32:42:10:49:d3:bd:20:82:85:ec (RSA)\n80/tcp   open     http        Apache httpd 2.2.14 ((Ubuntu))\n|_http-title: Go ahead and ScanMe!\n646/tcp  filtered ldp\n1720/tcp filtered H.323/Q.931\n9929/tcp open     nping-echo  Nping echo\nDevice type: general purpose\nRunning: Linux 2.6.X\nOS CPE: cpe:/o:linux:linux_kernel:2.6.39\nOS details: Linux 2.6.39\nNetwork Distance: 11 hops\nService Info: OS: Linux; CPE: cpe:/o:linux:kernel\nTRACEROUTE (using port 53/tcp)\nHOP RTT      ADDRESS\n[Cut first 10 hops for brevity]\n11  17.65 ms li86-221.members.linode.com (74.207.244.221)\nNmap done: 1 IP address (1 host up) scanned in 14.40 seconds\nThe newest version of Nmap can be obtained from\nhttps://nmap.org\n.\nThe newest version of this man page is available at\nhttps://nmap.org/book/man.html\n.  It is also included as a chapter\nof Nmap Network Scanning: The Official Nmap Project Guide to\nNetwork Discovery and Security Scanning (see\nhttps://nmap.org/book/\n).\nOPTIONS SUMMARY\ntop\nThis options summary is printed when Nmap is run with no\narguments, and the latest version is always available at\nhttps://svn.nmap.org/nmap/docs/nmap.usage.txt\n. It helps people\nremember the most common options, but is no substitute for the\nin-depth documentation in the rest of this manual. Some obscure\noptions aren't even included here.\nNmap 7.98SVN (\nhttps://nmap.org\n)\nUsage: nmap [Scan Type(s)] [Options] {target specification}\nTARGET SPECIFICATION:\nCan pass hostnames, IP addresses, networks, etc.\nEx: scanme.nmap.org, microsoft.com/24, 192.168.0.1; 10.0.0-255.1-254\n-iL <inputfilename>: Input from list of hosts/networks\n-iR <num hosts>: Choose random targets\n--exclude <host1[,host2][,host3],...>: Exclude hosts/networks\n--excludefile <exclude_file>: Exclude list from file\nHOST DISCOVERY:\n-sL: List Scan - simply list targets to scan\n-sn: Ping Scan - disable port scan\n-Pn: Treat all hosts as online -- skip host discovery\n-PS/PA/PU/PY[portlist]: TCP SYN, TCP ACK, UDP or SCTP discovery to given ports\n-PE/PP/PM: ICMP echo, timestamp, and netmask request discovery probes\n-PO[protocol list]: IP Protocol Ping\n-n/-R: Never do DNS resolution/Always resolve [default: sometimes]\n--dns-servers <serv1[,serv2],...>: Specify custom DNS servers\n--system-dns: Use OS's DNS resolver\n--traceroute: Trace hop path to each host\nSCAN TECHNIQUES:\n-sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans\n-sU: UDP Scan\n-sN/sF/sX: TCP Null, FIN, and Xmas scans\n--scanflags <flags>: Customize TCP scan flags\n-sI <zombie host[:probeport]>: Idle scan\n-sY/sZ: SCTP INIT/COOKIE-ECHO scans\n-sO: IP protocol scan\n-b <FTP relay host>: FTP bounce scan\nPORT SPECIFICATION AND SCAN ORDER:\n-p <port ranges>: Only scan specified ports\nEx: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080,S:9\n--exclude-ports <port ranges>: Exclude the specified ports from scanning\n-F: Fast mode - Scan fewer ports than the default scan\n-r: Scan ports sequentially - don't randomize\n--top-ports <number>: Scan <number> most common ports\n--port-ratio <ratio>: Scan ports more common than <ratio>\nSERVICE/VERSION DETECTION:\n-sV: Probe open ports to determine service/version info\n--version-intensity <level>: Set from 0 (light) to 9 (try all probes)\n--version-light: Limit to most likely probes (intensity 2)\n--version-all: Try every single probe (intensity 9)\n--version-trace: Show detailed version scan activity (for debugging)\nSCRIPT SCAN:\n-sC: equivalent to --script=default\n--script=<Lua scripts>: <Lua scripts> is a comma separated list of\ndirectories, script-files or script-categories\n--script-args=<n1=v1,[n2=v2,...]>: provide arguments to scripts\n--script-args-file=filename: provide NSE script args in a file\n--script-trace: Show all data sent and received\n--script-updatedb: Update the script database.\n--script-help=<Lua scripts>: Show help about scripts.\n<Lua scripts> is a comma-separated list of script-files or\nscript-categories.\nOS DETECTION:\n-O: Enable OS detection\n--osscan-limit: Limit OS detection to promising targets\n--osscan-guess: Guess OS more aggressively\nTIMING AND PERFORMANCE:\nOptions which take <time> are in seconds, or append 'ms' (milliseconds),\n's' (seconds), 'm' (minutes), or 'h' (hours) to the value (e.g. 30m).\n-T<0-5>: Set timing template (higher is faster)\n--min-hostgroup/max-hostgroup <size>: Parallel host scan group sizes\n--min-parallelism/max-parallelism <numprobes>: Probe parallelization\n--min-rtt-timeout/max-rtt-timeout/initial-rtt-timeout <time>: Specifies\nprobe round trip time.\n--max-retries <tries>: Caps number of port scan probe retransmissions.\n--host-timeout <time>: Give up on target after this long\n--scan-delay/--max-scan-delay <time>: Adjust delay between probes\n--min-rate <number>: Send packets no slower than <number> per second\n--max-rate <number>: Send packets no faster than <number> per second\nFIREWALL/IDS EVASION AND SPOOFING:\n-f; --mtu <val>: fragment packets (optionally w/given MTU)\n-D <decoy1,decoy2[,ME],...>: Cloak a scan with decoys\n-S <IP_Address>: Spoof source address\n-e <iface>: Use specified interface\n-g/--source-port <portnum>: Use given port number\n--proxies <url1,[url2],...>: Relay connections through HTTP/SOCKS4 proxies\n--data <hex string>: Append a custom payload to sent packets\n--data-string <string>: Append a custom ASCII string to sent packets\n--data-length <num>: Append random data to sent packets\n--ip-options <options>: Send packets with specified ip options\n--ttl <val>: Set IP time-to-live field\n--spoof-mac <mac address/prefix/vendor name>: Spoof your MAC address\n--badsum: Send packets with a bogus TCP/UDP/SCTP checksum\nOUTPUT:\n-oN/-oX/-oS/-oG <file>: Output scan in normal, XML, s|<rIpt kIddi3,\nand Grepable format, respectively, to the given filename.\n-oA <basename>: Output in the three major formats at once\n-v: Increase verbosity level (use -vv or more for greater effect)\n-d: Increase debugging level (use -dd or more for greater effect)\n--reason: Display the reason a port is in a particular state\n--open: Only show open (or possibly open) ports\n--packet-trace: Show all packets sent and received\n--iflist: Print host interfaces and routes (for debugging)\n--append-output: Append to rather than clobber specified output files\n--resume <filename>: Resume an aborted scan\n--noninteractive: Disable runtime interactions via keyboard\n--stylesheet <path/URL>: XSL stylesheet to transform XML output to HTML\n--webxml: Reference stylesheet from Nmap.Org for more portable XML\n--no-stylesheet: Prevent associating of XSL stylesheet w/XML output\nMISC:\n-6: Enable IPv6 scanning\n-A: Enable OS detection, version detection, script scanning, and traceroute\n--datadir <dirname>: Specify custom Nmap data file location\n--send-eth/--send-ip: Send using raw ethernet frames or IP packets\n--privileged: Assume that the user is fully privileged\n--unprivileged: Assume the user lacks raw socket privileges\n-V: Print version number\n-h: Print this help summary page.\nEXAMPLES:\nnmap -v -A scanme.nmap.org\nnmap -v -sn 192.168.0.0/16 10.0.0.0/8\nnmap -v -iR 10000 -Pn -p 80\nSEE THE MAN PAGE (\nhttps://nmap.org/book/man.html\n) FOR MORE OPTIONS AND EXAMPLES\nTARGET SPECIFICATION\ntop\nEverything on the Nmap command-line that isn't an option (or\noption argument) is treated as a target host specification. The\nsimplest case is to specify a target IP address or hostname for\nscanning.\nWhen a hostname is given as a target, it is resolved via the\nDomain Name System (DNS) to determine the IP address to scan. If\nthe name resolves to more than one IP address, only the first one\nwill be scanned. To make Nmap scan all the resolved addresses\ninstead of only the first one, use the\n--resolve-all\noption.\nSometimes you wish to scan a whole network of adjacent hosts. For\nthis, Nmap supports CIDR-style addressing. You can append /\nnumbits\nto an IP address or hostname and Nmap will scan every IP address\nfor which the first\nnumbits\nare the same as for the reference IP\nor hostname given. For example, 192.168.10.0/24 would scan the 256\nhosts between 192.168.10.0 (binary: 11000000 10101000 00001010\n00000000) and 192.168.10.255 (binary: 11000000 10101000 00001010\n11111111), inclusive.  192.168.10.40/24 would scan exactly the\nsame targets. Given that the host scanme.nmap.org is at the IP\naddress 64.13.134.52, the specification scanme.nmap.org/16 would\nscan the 65,536 IP addresses between 64.13.0.0 and 64.13.255.255.\nThe smallest allowed value is /0, which targets the whole\nInternet. The largest value for IPv4 is /32, which scans just the\nnamed host or IP address because all address bits are fixed. The\nlargest value for IPv6 is /128, which does the same thing.\nCIDR notation is short but not always flexible enough. For\nexample, you might want to scan 192.168.0.0/16 but skip any IPs\nending with .0 or .255 because they may be used as subnet network\nand broadcast addresses. Nmap supports this through octet range\naddressing. Rather than specify a normal IP address, you can\nspecify a comma-separated list of numbers or ranges for each\noctet. For example, 192.168.0-255.1-254 will skip all addresses in\nthe range that end in .0 or .255, and 192.168.3-5,7.1 will scan\nthe four addresses 192.168.3.1, 192.168.4.1, 192.168.5.1, and\n192.168.7.1. Either side of a range may be omitted; the default\nvalues are 0 on the left and 255 on the right. Using - by itself\nis the same as 0-255, but remember to use 0- in the first octet so\nthe target specification doesn't look like a command-line option.\nRanges need not be limited to the final octets: the specifier\n0-255.0-255.13.37 will perform an Internet-wide scan for all IP\naddresses ending in 13.37. This sort of broad sampling can be\nuseful for Internet surveys and research.\nIPv6 addresses can be specified by their fully qualified IPv6\naddress or hostname or with CIDR notation for subnets. Octet\nranges aren't yet supported for IPv6.\nIPv6 addresses with non-global scope need to have a zone ID\nsuffix. On Unix systems, this is a percent sign followed by an\ninterface name; a complete address might be\nfe80::a8bb:ccff:fedd:eeff%eth0. On Windows, use an interface index\nnumber in place of an interface name: fe80::a8bb:ccff:fedd:eeff%1.\nYou can see a list of interface indexes by running the command\nnetsh.exe interface ipv6 show interface\n.\nNmap accepts multiple host specifications on the command line, and\nthey don't need to be the same type. The command\nnmap\nscanme.nmap.org 192.168.0.0/8 10.0.0,1,3-7.-\ndoes what you would\nexpect.\nWhile targets are usually specified on the command lines, the\nfollowing options are also available to control target selection:\n-iL\ninputfilename\n(Input from list)\nReads target specifications from\ninputfilename\n. Passing a huge\nlist of hosts is often awkward on the command line, yet it is\na common desire. For example, your DHCP server might export a\nlist of 10,000 current leases that you wish to scan. Or maybe\nyou want to scan all IP addresses\nexcept\nfor those to locate\nhosts using unauthorized static IP addresses. Simply generate\nthe list of hosts to scan and pass that filename to Nmap as an\nargument to the\n-iL\noption. Entries can be in any of the\nformats accepted by Nmap on the command line (IP address,\nhostname, CIDR, IPv6, or octet ranges). Each entry must be\nseparated by one or more spaces, tabs, or newlines. You can\nspecify a hyphen (-) as the filename if you want Nmap to read\nhosts from standard input rather than an actual file.\nThe input file may contain comments that start with # and\nextend to the end of the line.\n-iR\nnum hosts\n(Choose random targets)\nFor Internet-wide surveys and other research, you may want to\nchoose targets at random. The\nnum hosts\nargument tells Nmap\nhow many IPs to generate. Undesirable IPs such as those in\ncertain private, multicast, or unallocated address ranges are\nautomatically skipped. The argument 0 can be specified for a\nnever-ending scan. Keep in mind that some network\nadministrators bristle at unauthorized scans of their networks\nand may complain. Use this option at your own risk! If you\nfind yourself really bored one rainy afternoon, try the\ncommand\nnmap -Pn -sS -p 80 -iR 0 --open\nto locate random web\nservers for browsing.\n--exclude\nhost1\n[,\nhost2\n[,...]] (Exclude hosts/networks)\nSpecifies a comma-separated list of targets to be excluded\nfrom the scan even if they are part of the overall network\nrange you specify. The list you pass in uses normal Nmap\nsyntax, so it can include hostnames, CIDR netblocks, octet\nranges, etc. This can be useful when the network you wish to\nscan includes untouchable mission-critical servers, systems\nthat are known to react adversely to port scans, or subnets\nadministered by other people.\n--excludefile\nexclude_file\n(Exclude list from file)\nThis offers the same functionality as the\n--exclude\noption,\nexcept that the excluded targets are provided in a newline-,\nspace-, or tab-delimited\nexclude_file\nrather than on the\ncommand line.\nThe exclude file may contain comments that start with # and\nextend to the end of the line.\n-n\n(No reverse DNS resolution)\nTells Nmap to\nnever\ndo reverse DNS resolution on the active IP\naddresses it finds. Since DNS can be slow even with Nmap's\nbuilt-in parallel stub resolver, this option can slash\nscanning times.\n-R\n(Reverse DNS resolution for all targets)\nTells Nmap to\nalways\ndo reverse DNS resolution on the target\nIP addresses. Normally reverse DNS is only performed against\nresponsive (online) hosts.\n--resolve-all\n(Scan each resolved address)\nIf a hostname target resolves to more than one address, scan\nall of them. The default behavior is to only scan the first\nresolved address. Regardless, only addresses in the\nappropriate address family will be scanned: IPv4 by default,\nIPv6 with\n-6\n.\n--unique\n(Scan each address only once)\nScan each IP address only once. The default behavior is to\nscan each address as many times as it is specified in the\ntarget list, such as when network ranges overlap or different\nhostnames resolve to the same address.\n--system-dns\n(Use system DNS resolver)\nBy default, Nmap resolves names to IP addresses (and IP\naddresses to names) by sending queries directly to the name\nservers configured on your host and then listening for\nresponses. Many requests (often dozens) are performed in\nparallel to improve performance. Specify this option to use\nyour system resolver instead (one IP at a time via the\ngetnameinfo\ncall). This is slower and rarely useful unless you\nfind a bug in the Nmap parallel resolver (please let us know\nif you do).\n--dns-servers\nserver1\n[,\nserver2\n[,...]]  (Servers to use for DNS\nqueries)\nBy default, Nmap determines your DNS servers from your\nresolv.conf file (Unix) or the Registry (Win32).\nAlternatively, you may use this option to specify alternate\nservers. This option is not honored if you are using\n--system-dns\n. Using multiple DNS servers is often faster,\nespecially if you choose authoritative servers for your target\nIP space. This option can also improve stealth, as your\nrequests can be bounced off just about any recursive DNS\nserver on the Internet.\nThis option also comes in handy when scanning private\nnetworks. Sometimes only a few name servers provide proper DNS\ninformation, and you may not even know where they are. You can\nscan the network for port 53 (perhaps with version detection),\nthen try Nmap list scans (\n-sL\n) specifying each name server one\nat a time with\n--dns-servers\nuntil you find one which works.\nThis option might not be honored if the DNS response exceeds\nthe size of a UDP packet. In such a situation our DNS resolver\nwill make the best effort to extract a response from the\ntruncated packet, and if not successful it will fall back to\nusing the system resolver.\nHOST DISCOVERY\ntop\nOne of the very first steps in any network reconnaissance mission\nis to reduce a (sometimes huge) set of IP ranges into a list of\nactive or interesting hosts. Scanning every port of every single\nIP address is slow and usually unnecessary. Of course what makes a\nhost interesting depends greatly on the scan purposes. Network\nadministrators may only be interested in hosts running a certain\nservice, while security auditors may care about every single\ndevice with an IP address. An administrator may be comfortable\nusing just an ICMP ping to locate hosts on his internal network,\nwhile an external penetration tester may use a diverse set of\ndozens of probes in an attempt to evade firewall restrictions.\nBecause host discovery needs are so diverse, Nmap offers a wide\nvariety of options for customizing the techniques used. Host\ndiscovery is sometimes called ping scan, but it goes well beyond\nthe simple ICMP echo request packets associated with the\nubiquitous ping tool. Users can skip the discovery step entirely\nwith a list scan (\n-sL\n) or by disabling host discovery (\n-Pn\n), or\nengage the network with arbitrary combinations of multi-port TCP\nSYN/ACK, UDP, SCTP INIT and ICMP probes. The goal of these probes\nis to solicit responses which demonstrate that an IP address is\nactually active (is being used by a host or network device). On\nmany networks, only a small percentage of IP addresses are active\nat any given time. This is particularly common with private\naddress space such as 10.0.0.0/8. That network has 16 million IPs,\nbut I have seen it used by companies with less than a thousand\nmachines. Host discovery can find those machines in a sparsely\nallocated sea of IP addresses.\nIf no host discovery options are given, Nmap sends an ICMP echo\nrequest, a TCP SYN packet to port 443, a TCP ACK packet to port\n80, and an ICMP timestamp request. (For IPv6, the ICMP timestamp\nrequest is omitted because it is not part of ICMPv6.) These\ndefaults are equivalent to the\n-PE -PS443 -PA80 -PP\noptions. The\nexceptions to this are the ARP (for IPv4) and Neighbor Discovery\n(for IPv6) scans which are used for any targets on a local\nethernet network. For unprivileged Unix shell users, the default\nprobes are a SYN packet to ports 80 and 443 using the\nconnect\nsystem call.  This host discovery is often sufficient when\nscanning local networks, but a more comprehensive set of discovery\nprobes is recommended for security auditing.\nThe\n-P*\noptions (which select ping types) can be combined. You can\nincrease your odds of penetrating strict firewalls by sending many\nprobe types using different TCP ports/flags and ICMP codes. Also\nnote that ARP/Neighbor Discovery is done by default against\ntargets on a local Ethernet network even if you specify other\n-P*\noptions, because it is almost always faster and more effective.\nBy default, Nmap does host discovery and then performs a port scan\nagainst each host it determines is online. This is true even if\nyou specify non-default host discovery types such as UDP probes\n(\n-PU\n). Read about the\n-sn\noption to learn how to perform only host\ndiscovery, or use\n-Pn\nto skip host discovery and port scan all\ntarget addresses. The following options control host discovery:\n-sL\n(List Scan)\nThe list scan is a degenerate form of host discovery that\nsimply lists each host of the network(s) specified, without\nsending any packets to the target hosts. By default, Nmap\nstill does reverse-DNS resolution on the hosts to learn their\nnames. It is often surprising how much useful information\nsimple hostnames give out. For example, fw.chi is the name of\none company's Chicago firewall.\nNmap also reports the total number of IP addresses at the end.\nThe list scan is a good sanity check to ensure that you have\nproper IP addresses for your targets. If the hosts sport\ndomain names you do not recognize, it is worth investigating\nfurther to prevent scanning the wrong company's network.\nSince the idea is to simply print a list of target hosts,\noptions for higher level functionality such as port scanning,\nOS detection, or host discovery cannot be combined with this.\nIf you wish to disable host discovery while still performing\nsuch higher level functionality, read up on the\n-Pn\n(skip host\ndiscovery) option.\n-sn\n(No port scan)\nThis option tells Nmap not to do a port scan after host\ndiscovery, and only print out the available hosts that\nresponded to the host discovery probes. This is often known as\na âping scanâ, but you can also request that traceroute and\nNSE host scripts be run. This is by default one step more\nintrusive than the list scan, and can often be used for the\nsame purposes. It allows light reconnaissance of a target\nnetwork without attracting much attention. Knowing how many\nhosts are up is more valuable to attackers than the list\nprovided by list scan of every single IP and host name.\nSystems administrators often find this option valuable as\nwell. It can easily be used to count available machines on a\nnetwork or monitor server availability. This is often called a\nping sweep, and is more reliable than pinging the broadcast\naddress because many hosts do not reply to broadcast queries.\nThe default host discovery done with\n-sn\nconsists of an ICMP\necho request, TCP SYN to port 443, TCP ACK to port 80, and an\nICMP timestamp request by default. When executed by an\nunprivileged user, only SYN packets are sent (using a\nconnect\ncall) to ports 80 and 443 on the target. When a privileged\nuser tries to scan targets on a local ethernet network, ARP\nrequests are used unless\n--send-ip\nwas specified. The\n-sn\noption can be combined with any of the discovery probe types\n(the\n-P*\noptions) for greater flexibility. If any of those\nprobe type and port number options are used, the default\nprobes are overridden. When strict firewalls are in place\nbetween the source host running Nmap and the target network,\nusing those advanced techniques is recommended. Otherwise\nhosts could be missed when the firewall drops probes or their\nresponses.\nIn previous releases of Nmap,\n-sn\nwas known as\n-sP\n.\n-Pn\n(No ping)\nThis option skips the host discovery stage altogether.\nNormally, Nmap uses this stage to determine active machines\nfor heavier scanning and to gauge the speed of the network. By\ndefault, Nmap only performs heavy probing such as port scans,\nversion detection, or OS detection against hosts that are\nfound to be up. Disabling host discovery with\n-Pn\ncauses Nmap\nto attempt the requested scanning functions against\nevery\ntarget IP address specified. So if a /16 sized network is\nspecified on the command line, all 65,536 IP addresses are\nscanned. Proper host discovery is skipped as with the list\nscan, but instead of stopping and printing the target list,\nNmap continues to perform requested functions as if each\ntarget IP is active. Default timing parameters are used, which\nmay result in slower scans. To skip host discovery\nand\nport\nscan, while still allowing NSE to run, use the two options\n-Pn\n-sn\ntogether.\nFor machines on a local ethernet network, ARP scanning will\nstill be performed (unless\n--disable-arp-ping\nor\n--send-ip\nis\nspecified) because Nmap needs MAC addresses to further scan\ntarget hosts. In previous versions of Nmap,\n-Pn\nwas\n-P0\nand\n-PN\n.\n-PS\nport list\n(TCP SYN Ping)\nThis option sends an empty TCP packet with the SYN flag set.\nThe default destination port is 80 (configurable at compile\ntime by changing\nDEFAULT_TCP_PROBE_PORT_SPEC\nin nmap.h).\nAlternate ports can be specified as a parameter. The syntax is\nthe same as for the\n-p\nexcept that port type specifiers like\nT: are not allowed. Examples are\n-PS22\nand\n-PS22-25,80,113,1050,35000\n. Note that there can be no space\nbetween\n-PS\nand the port list. If multiple probes are\nspecified they will be sent in parallel.\nThe SYN flag suggests to the remote system that you are\nattempting to establish a connection. Normally the destination\nport will be closed, and a RST (reset) packet sent back. If\nthe port happens to be open, the target will take the second\nstep of a TCP three-way-handshake by responding with a SYN/ACK\nTCP packet. The machine running Nmap then tears down the\nnascent connection by responding with a RST rather than\nsending an ACK packet which would complete the\nthree-way-handshake and establish a full connection. The RST\npacket is sent by the kernel of the machine running Nmap in\nresponse to the unexpected SYN/ACK, not by Nmap itself.\nNmap does not care whether the port is open or closed. Either\nthe RST or SYN/ACK response discussed previously tell Nmap\nthat the host is available and responsive.\nOn Unix boxes, only the privileged user root is generally able\nto send and receive raw TCP packets.  For unprivileged users,\na workaround is automatically employed whereby the\nconnect\nsystem call is initiated against each target port. This has\nthe effect of sending a SYN packet to the target host, in an\nattempt to establish a connection. If\nconnect\nreturns with a\nquick success or an ECONNREFUSED failure, the underlying TCP\nstack must have received a SYN/ACK or RST and the host is\nmarked available. If the connection attempt is left hanging\nuntil a timeout is reached, the host is marked as down.\n-PA\nport list\n(TCP ACK Ping)\nThe TCP ACK ping is quite similar to the just-discussed SYN\nping. The difference, as you could likely guess, is that the\nTCP ACK flag is set instead of the SYN flag. Such an ACK\npacket purports to be acknowledging data over an established\nTCP connection, but no such connection exists. So remote hosts\nshould always respond with a RST packet, disclosing their\nexistence in the process.\nThe\n-PA\noption uses the same default port as the SYN probe\n(80) and can also take a list of destination ports in the same\nformat. If an unprivileged user tries this, the\nconnect\nworkaround discussed previously is used. This workaround is\nimperfect because\nconnect\nis actually sending a SYN packet\nrather than an ACK.\nThe reason for offering both SYN and ACK ping probes is to\nmaximize the chances of bypassing firewalls. Many\nadministrators configure routers and other simple firewalls to\nblock incoming SYN packets except for those destined for\npublic services like the company web site or mail server. This\nprevents other incoming connections to the organization, while\nallowing users to make unobstructed outgoing connections to\nthe Internet. This non-stateful approach takes up few\nresources on the firewall/router and is widely supported by\nhardware and software filters. The Linux Netfilter/iptables\nfirewall software offers the\n--syn\nconvenience option to\nimplement this stateless approach. When stateless firewall\nrules such as this are in place, SYN ping probes (\n-PS\n) are\nlikely to be blocked when sent to closed target ports. In such\ncases, the ACK probe shines as it cuts right through these\nrules.\nAnother common type of firewall uses stateful rules that drop\nunexpected packets. This feature was initially found mostly on\nhigh-end firewalls, though it has become much more common over\nthe years. The Linux Netfilter/iptables system supports this\nthrough the\n--state\noption, which categorizes packets based on\nconnection state. A SYN probe is more likely to work against\nsuch a system, as unexpected ACK packets are generally\nrecognized as bogus and dropped. A solution to this quandary\nis to send both SYN and ACK probes by specifying\n-PS\nand\n-PA\n.\n-PU\nport list\n(UDP Ping)\nAnother host discovery option is the UDP ping, which sends a\nUDP packet to the given ports. For most ports, the packet will\nbe empty, though some use a protocol-specific payload that is\nmore likely to elicit a response.\nThe payloads are the same probes used in service and version\ndetection and are defined in the nmap-service-probes\nfile. Packet content can also be affected with the\n--data\n,\n--data-string\n, and\n--data-length\noptions.\nThe port list takes the same format as with the previously\ndiscussed\n-PS\nand\n-PA\noptions. If no ports are specified, the\ndefault is 40125.  This default can be configured at\ncompile-time by changing\nDEFAULT_UDP_PROBE_PORT_SPEC\nin\nnmap.h.  A highly uncommon port is used by default because\nsending to open ports is often undesirable for this particular\nscan type.\nUpon hitting a closed port on the target machine, the UDP\nprobe should elicit an ICMP port unreachable packet in return.\nThis signifies to Nmap that the machine is up and available.\nMany other types of ICMP errors, such as host/network\nunreachables or TTL exceeded are indicative of a down or\nunreachable host. A lack of response is also interpreted this\nway. If an open port is reached, most services simply ignore\nthe empty packet and fail to return any response. This is why\nthe default probe port is 40125, which is highly unlikely to\nbe in use. A few services, such as the Character Generator\n(chargen) protocol, will respond to an empty UDP packet, and\nthus disclose to Nmap that the machine is available.\nThe primary advantage of this scan type is that it bypasses\nfirewalls and filters that only screen TCP. For example, I\nonce owned a Linksys BEFW11S4 wireless broadband router. The\nexternal interface of this device filtered all TCP ports by\ndefault, but UDP probes would still elicit port unreachable\nmessages and thus give away the device.\n-PY\nport list\n(SCTP INIT Ping)\nThis option sends an SCTP packet containing a minimal INIT\nchunk. The default destination port is 80 (configurable at\ncompile time by changing\nDEFAULT_SCTP_PROBE_PORT_SPEC\nin\nnmap.h). Alternate ports can be specified as a parameter. The\nsyntax is the same as for the\n-p\nexcept that port type\nspecifiers like S: are not allowed. Examples are\n-PY22\nand\n-PY22,80,179,5060\n. Note that there can be no space between\n-PY\nand the port list. If multiple probes are specified they will\nbe sent in parallel.\nThe INIT chunk suggests to the remote system that you are\nattempting to establish an association. Normally the\ndestination port will be closed, and an ABORT chunk will be\nsent back. If the port happens to be open, the target will\ntake the second step of an SCTP four-way-handshake by\nresponding with an INIT-ACK chunk. If the machine running Nmap\nhas a functional SCTP stack, then it tears down the nascent\nassociation by responding with an ABORT chunk rather than\nsending a COOKIE-ECHO chunk which would be the next step in\nthe four-way-handshake. The ABORT packet is sent by the kernel\nof the machine running Nmap in response to the unexpected\nINIT-ACK, not by Nmap itself.\nNmap does not care whether the port is open or closed. Either\nthe ABORT or INIT-ACK response discussed previously tell Nmap\nthat the host is available and responsive.\nOn Unix boxes, only the privileged user root is generally able\nto send and receive raw SCTP packets.  Using SCTP INIT Pings\nis currently not possible for unprivileged users.\n-PE\n;\n-PP\n;\n-PM\n(ICMP Ping Types)\nIn addition to the unusual TCP, UDP and SCTP host discovery\ntypes discussed previously, Nmap can send the standard packets\nsent by the ubiquitous ping program. Nmap sends an ICMP type 8\n(echo request) packet to the target IP addresses, expecting a\ntype 0 (echo reply) in return from available hosts.\nUnfortunately for network explorers, many hosts and firewalls\nnow block these packets, rather than responding as required by\nRFC 1122\n[2].  For this reason, ICMP-only scans are rarely\nreliable enough against unknown targets over the Internet. But\nfor system administrators monitoring an internal network, they\ncan be a practical and efficient approach. Use the\n-PE\noption\nto enable this echo request behavior.\nWhile echo request is the standard ICMP ping query, Nmap does\nnot stop there. The ICMP standards (\nRFC 792\n[3] and\nRFC 950\n[4]\n) also specify timestamp request, information request, and\naddress mask request packets as codes 13, 15, and 17,\nrespectively. While the ostensible purpose for these queries\nis to learn information such as address masks and current\ntimes, they can easily be used for host discovery. A system\nthat replies is up and available. Nmap does not currently\nimplement information request packets, as they are not widely\nsupported. RFC 1122 insists that âa host SHOULD NOT implement\nthese messagesâ. Timestamp and address mask queries can be\nsent with the\n-PP\nand\n-PM\noptions, respectively. A timestamp\nreply (ICMP code 14) or address mask reply (code 18) discloses\nthat the host is available. These two queries can be valuable\nwhen administrators specifically block echo request packets\nwhile forgetting that other ICMP queries can be used for the\nsame purpose.\n-PO\nprotocol list\n(IP Protocol Ping)\nOne of the newer host discovery options is the IP protocol\nping, which sends IP packets with the specified protocol\nnumber set in their IP header. The protocol list takes the\nsame format as do port lists in the previously discussed TCP,\nUDP and SCTP host discovery options. If no protocols are\nspecified, the default is to send multiple IP packets for ICMP\n(protocol 1), IGMP (protocol 2), and IP-in-IP (protocol 4).\nThe default protocols can be configured at compile-time by\nchanging\nDEFAULT_PROTO_PROBE_PORT_SPEC\nin nmap.h. Note that\nfor the ICMP, IGMP, TCP (protocol 6), UDP (protocol 17) and\nSCTP (protocol 132), the packets are sent with the proper\nprotocol headers while other protocols are sent with no\nadditional data beyond the IP header (unless any of\n--data\n,\n--data-string\n, or\n--data-length\noptions are specified).\nThis host discovery method looks for either responses using\nthe same protocol as a probe, or ICMP protocol unreachable\nmessages which signify that the given protocol isn't supported\non the destination host. Either type of response signifies\nthat the target host is alive.\n--disable-arp-ping\n(No ARP or ND Ping)\nNmap normally does ARP or IPv6 Neighbor Discovery (ND)\ndiscovery of locally connected ethernet hosts, even if other\nhost discovery options such as\n-Pn\nor\n-PE\nare used. To disable\nthis implicit behavior, use the\n--disable-arp-ping\noption.\nThe default behavior is normally faster, but this option is\nuseful on networks using proxy ARP, in which a router\nspeculatively replies to all ARP requests, making every target\nappear to be up according to ARP scan.\n--discovery-ignore-rst\nIn some cases, firewalls may spoof TCP reset (RST) replies in\nresponse to probes to unoccupied or disallowed addresses.\nSince Nmap ordinarily considers RST replies to be proof that\nthe target is up, this can lead to wasted time scanning\ntargets that aren't there. Using the\n--discovery-ignore-rst\nwill prevent Nmap from considering these replies during host\ndiscovery. You may need to select extra host discovery options\nto ensure you don't miss targets in this case.\n--traceroute\n(Trace path to host)\nTraceroutes are performed post-scan using information from the\nscan results to determine the port and protocol most likely to\nreach the target. It works with all scan types except connect\nscans (\n-sT\n) and idle scans (\n-sI\n). All traces use Nmap's\ndynamic timing model and are performed in parallel.\nTraceroute works by sending packets with a low TTL\n(time-to-live) in an attempt to elicit ICMP Time Exceeded\nmessages from intermediate hops between the scanner and the\ntarget host. Standard traceroute implementations start with a\nTTL of 1 and increment the TTL until the destination host is\nreached. Nmap's traceroute starts with a high TTL and then\ndecrements the TTL until it reaches zero. Doing it backwards\nlets Nmap employ clever caching algorithms to speed up traces\nover multiple hosts. On average Nmap sends 5â10 fewer packets\nper host, depending on network conditions. If a single subnet\nis being scanned (i.e. 192.168.0.0/24) Nmap may only have to\nsend two packets to most hosts.\nPORT SCANNING BASICS\ntop\nWhile Nmap has grown in functionality over the years, it began as\nan efficient port scanner, and that remains its core function. The\nsimple command\nnmap\ntarget\nscans 1,000 TCP ports on the host\ntarget\n. While many port scanners have traditionally lumped all\nports into the open or closed states, Nmap is much more granular.\nIt divides ports into six states: open, closed, filtered,\nunfiltered, open|filtered, or closed|filtered.\nThese states are not intrinsic properties of the port itself, but\ndescribe how Nmap sees them. For example, an Nmap scan from the\nsame network as the target may show port 135/tcp as open, while a\nscan at the same time with the same options from across the\nInternet might show that port as filtered.\nThe six port states recognized by Nmap\nopen\nAn application is actively accepting TCP connections, UDP\ndatagrams or SCTP associations on this port. Finding these is\noften the primary goal of port scanning. Security-minded\npeople know that each open port is an avenue for attack.\nAttackers and pen-testers want to exploit the open ports,\nwhile administrators try to close or protect them with\nfirewalls without thwarting legitimate users. Open ports are\nalso interesting for non-security scans because they show\nservices available for use on the network.\nclosed\nA closed port is accessible (it receives and responds to Nmap\nprobe packets), but there is no application listening on it.\nThey can be helpful in showing that a host is up on an IP\naddress (host discovery, or ping scanning), and as part of OS\ndetection. Because closed ports are reachable, it may be worth\nscanning later in case some open up. Administrators may want\nto consider blocking such ports with a firewall. Then they\nwould appear in the filtered state, discussed next.\nfiltered\nNmap cannot determine whether the port is open because packet\nfiltering prevents its probes from reaching the port. The\nfiltering could be from a dedicated firewall device, router\nrules, or host-based firewall software. These ports frustrate\nattackers because they provide so little information.\nSometimes they respond with ICMP error messages such as type 3\ncode 13 (destination unreachable: communication\nadministratively prohibited), but filters that simply drop\nprobes without responding are far more common. This forces\nNmap to retry several times just in case the probe was dropped\ndue to network congestion rather than filtering. This slows\ndown the scan dramatically.\nunfiltered\nThe unfiltered state means that a port is accessible, but Nmap\nis unable to determine whether it is open or closed. Only the\nACK scan, which is used to map firewall rulesets, classifies\nports into this state. Scanning unfiltered ports with other\nscan types such as Window scan, SYN scan, or FIN scan, may\nhelp resolve whether the port is open.\nopen|filtered\nNmap places ports in this state when it is unable to determine\nwhether a port is open or filtered. This occurs for scan types\nin which open ports give no response. The lack of response\ncould also mean that a packet filter dropped the probe or any\nresponse it elicited. So Nmap does not know for sure whether\nthe port is open or being filtered. The UDP, IP protocol, FIN,\nNULL, and Xmas scans classify ports this way.\nclosed|filtered\nThis state is used when Nmap is unable to determine whether a\nport is closed or filtered. It is only used for the IP ID idle\nscan.\nPORT SCANNING TECHNIQUES\ntop\nAs a novice performing automotive repair, I can struggle for hours\ntrying to fit my rudimentary tools (hammer, duct tape, wrench,\netc.) to the task at hand. When I fail miserably and tow my jalopy\nto a real mechanic, he invariably fishes around in a huge tool\nchest until pulling out the perfect gizmo which makes the job seem\neffortless. The art of port scanning is similar. Experts\nunderstand the dozens of scan techniques and choose the\nappropriate one (or combination) for a given task. Inexperienced\nusers and script kiddies, on the other hand, try to solve every\nproblem with the default SYN scan. Since Nmap is free, the only\nbarrier to port scanning mastery is knowledge. That certainly\nbeats the automotive world, where it may take great skill to\ndetermine that you need a strut spring compressor, then you still\nhave to pay thousands of dollars for it.\nMost of the scan types are only available to privileged users.\nThis is because they send and receive raw packets, which requires\nroot access on Unix systems. Using an administrator account on\nWindows is recommended, though Nmap sometimes works for\nunprivileged users on that platform when Npcap has already been\nloaded into the OS. Requiring root privileges was a serious\nlimitation when Nmap was released in 1997, as many users only had\naccess to shared shell accounts. Now, the world is different.\nComputers are cheaper, far more people have always-on direct\nInternet access, and desktop Unix systems (including Linux and Mac\nOS X) are prevalent. A Windows version of Nmap is now available,\nallowing it to run on even more desktops. For all these reasons,\nusers have less need to run Nmap from limited shared shell\naccounts. This is fortunate, as the privileged options make Nmap\nfar more powerful and flexible.\nWhile Nmap attempts to produce accurate results, keep in mind that\nall of its insights are based on packets returned by the target\nmachines (or firewalls in front of them). Such hosts may be\nuntrustworthy and send responses intended to confuse or mislead\nNmap. Much more common are non-RFC-compliant hosts that do not\nrespond as they should to Nmap probes. FIN, NULL, and Xmas scans\nare particularly susceptible to this problem. Such issues are\nspecific to certain scan types and so are discussed in the\nindividual scan type entries.\nThis section documents the dozen or so port scan techniques\nsupported by Nmap. Only one method may be used at a time, except\nthat UDP scan (\n-sU\n) and any one of the SCTP scan types (\n-sY\n,\n-sZ\n)\nmay be combined with any one of the TCP scan types. As a memory\naid, port scan type options are of the form\n-s\nC\n, where\nC\nis a\nprominent character in the scan name, usually the first. The one\nexception to this is the deprecated FTP bounce scan (\n-b\n). By\ndefault, Nmap performs a SYN Scan, though it substitutes a connect\nscan if the user does not have proper privileges to send raw\npackets (requires root access on Unix). Of the scans listed in\nthis section, unprivileged users can only execute connect and FTP\nbounce scans.\n-sS\n(TCP SYN scan)\nSYN scan is the default and most popular scan option for good\nreasons. It can be performed quickly, scanning thousands of\nports per second on a fast network not hampered by restrictive\nfirewalls. It is also relatively unobtrusive and stealthy\nsince it never completes TCP connections. SYN scan works\nagainst any compliant TCP stack rather than depending on\nidiosyncrasies of specific platforms as Nmap's FIN/NULL/Xmas,\nMaimon and idle scans do. It also allows clear, reliable\ndifferentiation between the open, closed, and filtered states.\nThis technique is often referred to as half-open scanning,\nbecause you don't open a full TCP connection. You send a SYN\npacket, as if you are going to open a real connection and then\nwait for a response. A SYN/ACK indicates the port is listening\n(open), while a RST (reset) is indicative of a non-listener.\nIf no response is received after several retransmissions, the\nport is marked as filtered. The port is also marked filtered\nif an ICMP unreachable error (type 3, code 0, 1, 2, 3, 9, 10,\nor 13) is received. The port is also considered open if a SYN\npacket (without the ACK flag) is received in response. This\ncan be due to an extremely rare TCP feature known as a\nsimultaneous open or split handshake connection (see\nhttps://nmap.org/misc/split-handshake.pdf\n).\n-sT\n(TCP connect scan)\nTCP connect scan is the default TCP scan type when SYN scan is\nnot an option. This is the case when a user does not have raw\npacket privileges. Instead of writing raw packets as most\nother scan types do, Nmap asks the underlying operating system\nto establish a connection with the target machine and port by\nissuing the\nconnect\nsystem call. This is the same high-level\nsystem call that web browsers, P2P clients, and most other\nnetwork-enabled applications use to establish a connection. It\nis part of a programming interface known as the Berkeley\nSockets API. Rather than read raw packet responses off the\nwire, Nmap uses this API to obtain status information on each\nconnection attempt.\nWhen SYN scan is available, it is usually a better choice.\nNmap has less control over the high level\nconnect\ncall than\nwith raw packets, making it less efficient. The system call\ncompletes connections to open target ports rather than\nperforming the half-open reset that SYN scan does. Not only\ndoes this take longer and require more packets to obtain the\nsame information, but target machines are more likely to log\nthe connection. A decent IDS will catch either, but most\nmachines have no such alarm system. Many services on your\naverage Unix system will add a note to syslog, and sometimes a\ncryptic error message, when Nmap connects and then closes the\nconnection without sending data. Truly pathetic services crash\nwhen this happens, though that is uncommon. An administrator\nwho sees a bunch of connection attempts in her logs from a\nsingle system should know that she has been connect scanned.\n-sU\n(UDP scans)\nWhile most popular services on the Internet run over the TCP\nprotocol,\nUDP\n[5] services are widely deployed. DNS, SNMP, and\nDHCP (registered ports 53, 161/162, and 67/68) are three of\nthe most common. Because UDP scanning is generally slower and\nmore difficult than TCP, some security auditors ignore these\nports. This is a mistake, as exploitable UDP services are\nquite common and attackers certainly don't ignore the whole\nprotocol. Fortunately, Nmap can help inventory UDP ports.\nUDP scan is activated with the\n-sU\noption. It can be combined\nwith a TCP scan type such as SYN scan (\n-sS\n) to check both\nprotocols during the same run.\nUDP scan works by sending a UDP packet to every targeted port.\nFor some common ports such as 53 and 161, a protocol-specific\npayload is sent to increase response rate, but for most ports\nthe packet is empty unless the\n--data\n,\n--data-string\n, or\n--data-length\noptions are specified. If an ICMP port\nunreachable error (type 3, code 3) is returned, the port is\nclosed. Other ICMP unreachable errors (type 3, codes 0, 1, 2,\n9, 10, or 13) mark the port as filtered. Occasionally, a\nservice will respond with a UDP packet, proving that it is\nopen. If no response is received after retransmissions, the\nport is classified as open|filtered. This means that the port\ncould be open, or perhaps packet filters are blocking the\ncommunication. Version detection (\n-sV\n) can be used to help\ndifferentiate the truly open ports from the filtered ones.\nA big challenge with UDP scanning is doing it quickly. Open\nand filtered ports rarely send any response, leaving Nmap to\ntime out and then conduct retransmissions just in case the\nprobe or response were lost. Closed ports are often an even\nbigger problem. They usually send back an ICMP port\nunreachable error. But unlike the RST packets sent by closed\nTCP ports in response to a SYN or connect scan, many hosts\nrate limit ICMP port unreachable messages by default. Linux\nand Solaris are particularly strict about this. For example,\nthe Linux 2.4.20 kernel limits destination unreachable\nmessages to one per second (in net/ipv4/icmp.c).\nNmap detects rate limiting and slows down accordingly to avoid\nflooding the network with useless packets that the target\nmachine will drop. Unfortunately, a Linux-style limit of one\npacket per second makes a 65,536-port scan take more than 18\nhours. Ideas for speeding your UDP scans up include scanning\nmore hosts in parallel, doing a quick scan of just the popular\nports first, scanning from behind the firewall, and using\n--host-timeout\nto skip slow hosts.\n-sY\n(SCTP INIT scan)\nSCTP\n[6] is a relatively new alternative to the TCP and UDP\nprotocols, combining most characteristics of TCP and UDP, and\nalso adding new features like multi-homing and\nmulti-streaming. It is mostly being used for SS7/SIGTRAN\nrelated services but has the potential to be used for other\napplications as well. SCTP INIT scan is the SCTP equivalent of\na TCP SYN scan. It can be performed quickly, scanning\nthousands of ports per second on a fast network not hampered\nby restrictive firewalls. Like SYN scan, INIT scan is\nrelatively unobtrusive and stealthy, since it never completes\nSCTP associations. It also allows clear, reliable\ndifferentiation between the open, closed, and filtered states.\nThis technique is often referred to as half-open scanning,\nbecause you don't open a full SCTP association. You send an\nINIT chunk, as if you are going to open a real association and\nthen wait for a response. An INIT-ACK chunk indicates the port\nis listening (open), while an ABORT chunk is indicative of a\nnon-listener. If no response is received after several\nretransmissions, the port is marked as filtered. The port is\nalso marked filtered if an ICMP unreachable error (type 3,\ncode 0, 1, 2, 3, 9, 10, or 13) is received.\n-sN\n;\n-sF\n;\n-sX\n(TCP NULL, FIN, and Xmas scans)\nThese three scan types (even more are possible with the\n--scanflags\noption described in the next section) exploit a\nsubtle loophole in the\nTCP RFC\n[7] to differentiate between\nopen and closed ports. Page 65 of RFC 793 says that âif the\n[destination] port state is CLOSED .... an incoming segment\nnot containing a RST causes a RST to be sent in response.â\nThen the next page discusses packets sent to open ports\nwithout the SYN, RST, or ACK bits set, stating that: âyou are\nunlikely to get here, but if you do, drop the segment, and\nreturn.â\nWhen scanning systems compliant with this RFC text, any packet\nnot containing SYN, RST, or ACK bits will result in a returned\nRST if the port is closed and no response at all if the port\nis open. As long as none of those three bits are included, any\ncombination of the other three (FIN, PSH, and URG) are OK.\nNmap exploits this with three scan types:\nNull scan (\n-sN\n)\nDoes not set any bits (TCP flag header is 0)\nFIN scan (\n-sF\n)\nSets just the TCP FIN bit.\nXmas scan (\n-sX\n)\nSets the FIN, PSH, and URG flags, lighting the packet up\nlike a Christmas tree.\nThese three scan types are exactly the same in behavior except\nfor the TCP flags set in probe packets. If a RST packet is\nreceived, the port is considered closed, while no response\nmeans it is open|filtered. The port is marked filtered if an\nICMP unreachable error (type 3, code 0, 1, 2, 3, 9, 10, or 13)\nis received.\nThe key advantage to these scan types is that they can sneak\nthrough certain non-stateful firewalls and packet filtering\nrouters. Another advantage is that these scan types are a\nlittle more stealthy than even a SYN scan. Don't count on this\nthoughâmost modern IDS products can be configured to detect\nthem. The big downside is that not all systems follow RFC 793\nto the letter. A number of systems send RST responses to the\nprobes regardless of whether the port is open or not. This\ncauses all of the ports to be labeled closed. Major operating\nsystems that do this are Microsoft Windows, many Cisco\ndevices, BSDI, and IBM OS/400. This scan does work against\nmost Unix-based systems though. Another downside of these\nscans is that they can't distinguish open ports from certain\nfiltered ones, leaving you with the response open|filtered.\n-sA\n(TCP ACK scan)\nThis scan is different than the others discussed so far in\nthat it never determines open (or even open|filtered) ports.\nIt is used to map out firewall rulesets, determining whether\nthey are stateful or not and which ports are filtered.\nThe ACK scan probe packet has only the ACK flag set (unless\nyou use\n--scanflags\n). When scanning unfiltered systems, open\nand closed ports will both return a RST packet. Nmap then\nlabels them as unfiltered, meaning that they are reachable by\nthe ACK packet, but whether they are open or closed is\nundetermined. Ports that don't respond, or send certain ICMP\nerror messages back (type 3, code 0, 1, 2, 3, 9, 10, or 13),\nare labeled filtered.\n-sW\n(TCP Window scan)\nWindow scan is exactly the same as ACK scan except that it\nexploits an implementation detail of certain systems to\ndifferentiate open ports from closed ones, rather than always\nprinting unfiltered when a RST is returned. It does this by\nexamining the TCP Window field of the RST packets returned. On\nsome systems, open ports use a positive window size (even for\nRST packets) while closed ones have a zero window. So instead\nof always listing a port as unfiltered when it receives a RST\nback, Window scan lists the port as open or closed if the TCP\nWindow value in that reset is positive or zero, respectively.\nThis scan relies on an implementation detail of a minority of\nsystems out on the Internet, so you can't always trust it.\nSystems that don't support it will usually return all ports\nclosed. Of course, it is possible that the machine really has\nno open ports. If most scanned ports are closed but a few\ncommon port numbers (such as 22, 25, 53) are filtered, the\nsystem is most likely susceptible. Occasionally, systems will\neven show the exact opposite behavior. If your scan shows\n1,000 open ports and three closed or filtered ports, then\nthose three may very well be the truly open ones.\n-sM\n(TCP Maimon scan)\nThe Maimon scan is named after its discoverer, Uriel Maimon.\nHe described the technique in Phrack Magazine issue #49\n(November 1996).  Nmap, which included this technique, was\nreleased two issues later. This technique is exactly the same\nas NULL, FIN, and Xmas scans, except that the probe is\nFIN/ACK. According to\nRFC 793\n[7] (TCP), a RST packet should be\ngenerated in response to such a probe whether the port is open\nor closed. However, Uriel noticed that many BSD-derived\nsystems simply drop the packet if the port is open.\n--scanflags\n(Custom TCP scan)\nTruly advanced Nmap users need not limit themselves to the\ncanned scan types offered. The\n--scanflags\noption allows you\nto design your own scan by specifying arbitrary TCP flags.\nLet your creative juices flow, while evading intrusion\ndetection systems whose vendors simply paged through the Nmap\nman page adding specific rules!\nThe\n--scanflags\nargument can be a numerical flag value such as\n9 (PSH and FIN), but using symbolic names is easier. Just mash\ntogether any combination of URG, ACK, PSH, RST, SYN, and FIN.\nFor example,\n--scanflags URGACKPSHRSTSYNFIN\nsets everything,\nthough it's not very useful for scanning. The order these are\nspecified in is irrelevant.\nIn addition to specifying the desired flags, you can specify a\nTCP scan type (such as\n-sA\nor\n-sF\n). That base type tells Nmap\nhow to interpret responses. For example, a SYN scan considers\nno-response to indicate a filtered port, while a FIN scan\ntreats the same as open|filtered. Nmap will behave the same\nway it does for the base scan type, except that it will use\nthe TCP flags you specify instead. If you don't specify a base\ntype, SYN scan is used.\n-sZ\n(SCTP COOKIE ECHO scan)\nSCTP COOKIE ECHO scan is a more advanced SCTP scan. It takes\nadvantage of the fact that SCTP implementations should\nsilently drop packets containing COOKIE ECHO chunks on open\nports, but send an ABORT if the port is closed. The advantage\nof this scan type is that it is not as obvious a port scan\nthan an INIT scan. Also, there may be non-stateful firewall\nrulesets blocking INIT chunks, but not COOKIE ECHO chunks.\nDon't be fooled into thinking that this will make a port scan\ninvisible; a good IDS will be able to detect SCTP COOKIE ECHO\nscans too. The downside is that SCTP COOKIE ECHO scans cannot\ndifferentiate between open and filtered ports, leaving you\nwith the state open|filtered in both cases.\n-sI\nzombie host\n[:\nprobeport\n] (idle scan)\nThis advanced scan method allows for a truly blind TCP port\nscan of the target (meaning no packets are sent to the target\nfrom your real IP address). Instead, a unique side-channel\nattack exploits predictable IP fragmentation ID sequence\ngeneration on the zombie host to glean information about the\nopen ports on the target. IDS systems will display the scan as\ncoming from the zombie machine you specify (which must be up\nand meet certain criteria).  This fascinating scan type is too\ncomplex to fully describe in this reference guide, so I wrote\nand posted an informal paper with full details at\nhttps://nmap.org/book/idlescan.html\n.\nBesides being extraordinarily stealthy (due to its blind\nnature), this scan type permits mapping out IP-based trust\nrelationships between machines. The port listing shows open\nports\nfrom the perspective of the zombie host.\nSo you can try\nscanning a target using various zombies that you think might\nbe trusted (via router/packet filter rules).\nYou can add a colon followed by a port number to the zombie\nhost if you wish to probe a particular port on the zombie for\nIP ID changes. Otherwise Nmap will use the port it uses by\ndefault for TCP pings (80).\n-sO\n(IP protocol scan)\nIP protocol scan allows you to determine which IP protocols\n(TCP, ICMP, IGMP, etc.) are supported by target machines. This\nisn't technically a port scan, since it cycles through IP\nprotocol numbers rather than TCP or UDP port numbers. Yet it\nstill uses the\n-p\noption to select scanned protocol numbers,\nreports its results within the normal port table format, and\neven uses the same underlying scan engine as the true port\nscanning methods. So it is close enough to a port scan that it\nbelongs here.\nBesides being useful in its own right, protocol scan\ndemonstrates the power of open-source software. While the\nfundamental idea is pretty simple, I had not thought to add it\nnor received any requests for such functionality. Then in the\nsummer of 2000, Gerhard Rieger conceived the idea, wrote an\nexcellent patch implementing it, and sent it to the announce\nmailing list (then called nmap-hackers).  I incorporated that\npatch into the Nmap tree and released a new version the next\nday. Few pieces of commercial software have users enthusiastic\nenough to design and contribute their own improvements!\nProtocol scan works in a similar fashion to UDP scan. Instead\nof iterating through the port number field of a UDP packet, it\nsends IP packet headers and iterates through the eight-bit IP\nprotocol field. The headers are usually empty, containing no\ndata and not even the proper header for the claimed protocol.\nThe exceptions are TCP, UDP, ICMP, SCTP, and IGMP. A proper\nprotocol header for those is included since some systems won't\nsend them otherwise and because Nmap already has functions to\ncreate them. Instead of watching for ICMP port unreachable\nmessages, protocol scan is on the lookout for ICMP\nprotocol\nunreachable messages. If Nmap receives any response in any\nprotocol from the target host, Nmap marks that protocol as\nopen. An ICMP protocol unreachable error (type 3, code 2)\ncauses the protocol to be marked as closed while port\nunreachable (type 3, code 3) marks the protocol open. Other\nICMP unreachable errors (type 3, code 0, 1, 9, 10, or 13)\ncause the protocol to be marked filtered (though they prove\nthat ICMP is open at the same time). If no response is\nreceived after retransmissions, the protocol is marked\nopen|filtered\n-b\nFTP relay host\n(FTP bounce scan)\nAn interesting feature of the FTP protocol (\nRFC 959\n[8]) is\nsupport for so-called proxy FTP connections. This allows a\nuser to connect to one FTP server, then ask that files be sent\nto a third-party server. Such a feature is ripe for abuse on\nmany levels, so most servers have ceased supporting it. One of\nthe abuses this feature allows is causing the FTP server to\nport scan other hosts. Simply ask the FTP server to send a\nfile to each interesting port of a target host in turn. The\nerror message will describe whether the port is open or not.\nThis is a good way to bypass firewalls because organizational\nFTP servers are often placed where they have more access to\nother internal hosts than any old Internet host would. Nmap\nsupports FTP bounce scan with the\n-b\noption. It takes an\nargument of the form\nusername\n:\npassword\n@\nserver\n:\nport\n.\nServer\nis\nthe name or IP address of a vulnerable FTP server. As with a\nnormal URL, you may omit\nusername\n:\npassword\n, in which case\nanonymous login credentials (user: anonymous\npassword:-wwwuser@) are used. The port number (and preceding\ncolon) may be omitted as well, in which case the default FTP\nport (21) on\nserver\nis used.\nThis vulnerability was widespread in 1997 when Nmap was\nreleased, but has largely been fixed. Vulnerable servers are\nstill around, so it is worth trying when all else fails. If\nbypassing a firewall is your goal, scan the target network for\nport 21 (or even for any FTP services if you scan all ports\nwith version detection) and use the ftp-bounce NSE script.\nNmap will tell you whether the host is vulnerable or not. If\nyou are just trying to cover your tracks, you don't need to\n(and, in fact, shouldn't) limit yourself to hosts on the\ntarget network. Before you go scanning random Internet\naddresses for vulnerable FTP servers, consider that sysadmins\nmay not appreciate you abusing their servers in this way.\nPORT SPECIFICATION AND SCAN ORDER\ntop\nIn addition to all of the scan methods discussed previously, Nmap\noffers options for specifying which ports are scanned and whether\nthe scan order is randomized or sequential. By default, Nmap scans\nthe most common 1,000 ports for each protocol.\n-p\nport ranges\n(Only scan specified ports)\nThis option specifies which ports you want to scan and\noverrides the default. Individual port numbers are OK, as are\nranges separated by a hyphen (e.g.  1-1023). The beginning\nand/or end values of a range may be omitted, causing Nmap to\nuse 1 and 65535, respectively. So you can specify\n-p-\nto scan\nports from 1 through 65535. Scanning port zero is allowed if\nyou specify it explicitly. For IP protocol scanning (\n-sO\n),\nthis option specifies the protocol numbers you wish to scan\nfor (0â255).\nWhen scanning a combination of protocols (e.g. TCP and UDP),\nyou can specify a particular protocol by preceding the port\nnumbers by T: for TCP, U: for UDP, S: for SCTP, or P: for IP\nProtocol. The qualifier lasts until you specify another\nqualifier. For example, the argument\n-p\nU:53,111,137,T:21-25,80,139,8080\nwould scan UDP ports 53,\n111,and 137, as well as the listed TCP ports. Note that to\nscan both UDP and TCP, you have to specify\n-sU\nand at least\none TCP scan type (such as\n-sS\n,\n-sF\n, or\n-sT\n). If no protocol\nqualifier is given, the port numbers are added to all protocol\nlists.  Ports can also be specified by name according to what\nthe port is referred to in the nmap-services. You can even use\nthe wildcards * and ?  with the names. For example, to scan\nFTP and all ports whose names begin with âhttpâ, use\n-p\nftp,http*\n. Be careful about shell expansions and quote the\nargument to\n-p\nif unsure.\nRanges of ports can be surrounded by square brackets to\nindicate ports inside that range that appear in nmap-services.\nFor example, the following will scan all ports in\nnmap-services equal to or below 1024:\n-p [-1024]\n. Be careful\nwith shell expansions and quote the argument to\n-p\nif unsure.\n--exclude-ports\nport ranges\n(Exclude the specified ports from\nscanning)\nThis option specifies which ports you do want Nmap to exclude\nfrom scanning. The\nport ranges\nare specified similar to\n-p\n.\nFor IP protocol scanning (\n-sO\n), this option specifies the\nprotocol numbers you wish to exclude (0â255).\nWhen ports are asked to be excluded, they are excluded from\nall types of scans (i.e. they will not be scanned under any\ncircumstances). This also includes the discovery phase.\n-F\n(Fast (limited port) scan)\nSpecifies that you wish to scan fewer ports than the default.\nNormally Nmap scans the most common 1,000 ports for each\nscanned protocol. With\n-F\n, this is reduced to 100.\nNmap needs an nmap-services file with frequency information in\norder to know which ports are the most common. If port\nfrequency information isn't available, perhaps because of the\nuse of a custom nmap-services file, Nmap scans all named ports\nplus ports 1-1024. In that case,\n-F\nmeans to scan only ports\nthat are named in the services file.\n-r\n(Don't randomize ports)\nBy default, Nmap randomizes the scanned port order (except\nthat certain commonly accessible ports are moved near the\nbeginning for efficiency reasons). This randomization is\nnormally desirable, but you can specify\n-r\nfor sequential\n(sorted from lowest to highest) port scanning instead.\n--port-ratio\nratio\n<decimal number between 0 and 1>\nScans all ports in nmap-services file with a ratio greater\nthan the one given.\nratio\nmust be between 0.0 and 1.0.\n--top-ports\nn\nScans the\nn\nhighest-ratio ports found in nmap-services file\nafter excluding all ports specified by\n--exclude-ports\n.\nn\nmust be 1 or greater.\nSERVICE AND VERSION DETECTION\ntop\nPoint Nmap at a remote machine and it might tell you that ports\n25/tcp, 80/tcp, and 53/udp are open. Using its nmap-services\ndatabase of about 2,200 well-known services, Nmap would report\nthat those ports probably correspond to a mail server (SMTP), web\nserver (HTTP), and name server (DNS) respectively. This lookup is\nusually accurateâthe vast majority of daemons listening on TCP\nport 25 are, in fact, mail servers. However, you should not bet\nyour security on this! People can and do run services on strange\nports.\nEven if Nmap is right, and the hypothetical server above is\nrunning SMTP, HTTP, and DNS servers, that is not a lot of\ninformation. When doing vulnerability assessments (or even simple\nnetwork inventories) of your companies or clients, you really want\nto know which mail and DNS servers and versions are running.\nHaving an accurate version number helps dramatically in\ndetermining which exploits a server is vulnerable to. Version\ndetection helps you obtain this information.\nAfter TCP and/or UDP ports are discovered using one of the other\nscan methods, version detection interrogates those ports to\ndetermine more about what is actually running. The\nnmap-service-probes database contains probes for querying various\nservices and match expressions to recognize and parse responses.\nNmap tries to determine the service protocol (e.g. FTP, SSH,\nTelnet, HTTP), the application name (e.g. ISC BIND, Apache httpd,\nSolaris telnetd), the version number, hostname, device type (e.g.\nprinter, router), the OS family (e.g. Windows, Linux). When\npossible, Nmap also gets the Common Platform Enumeration (CPE)\nrepresentation of this information. Sometimes miscellaneous\ndetails like whether an X server is open to connections, the SSH\nprotocol version, or the KaZaA user name, are available. Of\ncourse, most services don't provide all of this information. If\nNmap was compiled with OpenSSL support, it will connect to SSL\nservers to deduce the service listening behind that encryption\nlayer.  Some UDP ports are left in the open|filtered state after a\nUDP port scan is unable to determine whether the port is open or\nfiltered. Version detection will try to elicit a response from\nthese ports (just as it does with open ports), and change the\nstate to open if it succeeds.  open|filtered TCP ports are treated\nthe same way. Note that the Nmap\n-A\noption enables version\ndetection among other things.  A paper documenting the workings,\nusage, and customization of version detection is available at\nhttps://nmap.org/book/vscan.html\n.\nWhen RPC services are discovered, the Nmap RPC grinder is\nautomatically used to determine the RPC program and version\nnumbers. It takes all the TCP/UDP ports detected as RPC and floods\nthem with SunRPC program NULL commands in an attempt to determine\nwhether they are RPC ports, and if so, what program and version\nnumber they serve up. Thus you can effectively obtain the same\ninfo as\nrpcinfo -p\neven if the target's portmapper is behind a\nfirewall (or protected by TCP wrappers). Decoys do not currently\nwork with RPC scan.\nWhen Nmap receives responses from a service but cannot match them\nto its database, it prints out a special fingerprint and a URL for\nyou to submit it to if you know for sure what is running on the\nport. Please take a couple minutes to make the submission so that\nyour find can benefit everyone. Thanks to these submissions, Nmap\nhas about 6,500 pattern matches for more than 650 protocols such\nas SMTP, FTP, HTTP, etc.\nVersion detection is enabled and controlled with the following\noptions:\n-sV\n(Version detection)\nEnables version detection, as discussed above. Alternatively,\nyou can use\n-A\n, which enables version detection among other\nthings.\n-sR\nis an alias for\n-sV\n. Prior to March 2011, it was used to\nactive the RPC grinder separately from version detection, but\nnow these options are always combined.\n--allports\n(Don't exclude any ports from version detection)\nBy default, Nmap version detection skips TCP port 9100 because\nsome printers simply print anything sent to that port, leading\nto dozens of pages of HTTP GET requests, binary SSL session\nrequests, etc. This behavior can be changed by modifying or\nremoving the Exclude directive in nmap-service-probes, or you\ncan specify\n--allports\nto scan all ports regardless of any\nExclude directive.\n--version-intensity\nintensity\n(Set version scan intensity)\nWhen performing a version scan (\n-sV\n), Nmap sends a series of\nprobes, each of which is assigned a rarity value between one\nand nine. The lower-numbered probes are effective against a\nwide variety of common services, while the higher-numbered\nones are rarely useful. The intensity level specifies which\nprobes should be applied. The higher the number, the more\nlikely it is the service will be correctly identified.\nHowever, high intensity scans take longer. The intensity must\nbe between 0 and 9.  The default is 7.  When a probe is\nregistered to the target port via the nmap-service-probes\nports directive, that probe is tried regardless of intensity\nlevel. This ensures that the DNS probes will always be\nattempted against any open port 53, the SSL probe will be done\nagainst 443, etc.\n--version-light\n(Enable light mode)\nThis is a convenience alias for\n--version-intensity 2\n. This\nlight mode makes version scanning much faster, but it is\nslightly less likely to identify services.\n--version-all\n(Try every single probe)\nAn alias for\n--version-intensity 9\n, ensuring that every single\nprobe is attempted against each port.\n--version-trace\n(Trace version scan activity)\nThis causes Nmap to print out extensive debugging info about\nwhat version scanning is doing. It is a subset of what you get\nwith\n--packet-trace\n.\nOS DETECTION\ntop\nOne of Nmap's best-known features is remote OS detection using\nTCP/IP stack fingerprinting. Nmap sends a series of TCP and UDP\npackets to the remote host and examines practically every bit in\nthe responses. After performing dozens of tests such as TCP ISN\nsampling, TCP options support and ordering, IP ID sampling, and\nthe initial window size check, Nmap compares the results to its\nnmap-os-db database of more than 2,600 known OS fingerprints and\nprints out the OS details if there is a match. Each fingerprint\nincludes a freeform textual description of the OS, and a\nclassification which provides the vendor name (e.g. Sun),\nunderlying OS (e.g. Solaris), OS generation (e.g. 10), and device\ntype (general purpose, router, switch, game console, etc). Most\nfingerprints also have a Common Platform Enumeration (CPE)\nrepresentation, like cpe:/o:linux:linux_kernel:2.6.\nIf Nmap is unable to guess the OS of a machine, and conditions are\ngood (e.g. at least one open port and one closed port were found),\nNmap will provide a URL you can use to submit the fingerprint if\nyou know (for sure) the OS running on the machine. By doing this\nyou contribute to the pool of operating systems known to Nmap and\nthus it will be more accurate for everyone.\nOS detection enables some other tests which make use of\ninformation that is gathered during the process anyway. One of\nthese is TCP Sequence Predictability Classification. This measures\napproximately how hard it is to establish a forged TCP connection\nagainst the remote host. It is useful for exploiting source-IP\nbased trust relationships (rlogin, firewall filters, etc) or for\nhiding the source of an attack. This sort of spoofing is rarely\nperformed any more, but many machines are still vulnerable to it.\nThe actual difficulty number is based on statistical sampling and\nmay fluctuate. It is generally better to use the English\nclassification such as âworthy challengeâ or âtrivial jokeâ. This\nis only reported in normal output in verbose (\n-v\n) mode. When\nverbose mode is enabled along with\n-O\n, IP ID sequence generation\nis also reported. Most machines are in the âincrementalâ class,\nwhich means that they increment the ID field in the IP header for\neach packet they send. This makes them vulnerable to several\nadvanced information gathering and spoofing attacks.\nAnother bit of extra information enabled by OS detection is a\nguess at a target's uptime. This uses the TCP timestamp option\n(\nRFC 1323\n[9]) to guess when a machine was last rebooted. The guess\ncan be inaccurate due to the timestamp counter not being\ninitialized to zero or the counter overflowing and wrapping\naround, so it is printed only in verbose mode.\nA paper documenting the workings, usage, and customization of OS\ndetection is available at\nhttps://nmap.org/book/osdetect.html\n.\nOS detection is enabled and controlled with the following options:\n-O\n(Enable OS detection)\nEnables OS detection, as discussed above. Alternatively, you\ncan use\n-A\nto enable OS detection along with other things.\n--osscan-limit\n(Limit OS detection to promising targets)\nOS detection is far more effective if at least one open and\none closed TCP port are found. Set this option and Nmap will\nnot even try OS detection against hosts that do not meet this\ncriteria. This can save substantial time, particularly on\n-Pn\nscans against many hosts. It only matters when OS detection is\nrequested with\n-O\nor\n-A\n.\n--osscan-guess\n;\n--fuzzy\n(Guess OS detection results)\nWhen Nmap is unable to detect a perfect OS match, it sometimes\noffers up near-matches as possibilities. The match has to be\nvery close for Nmap to do this by default. Either of these\n(equivalent) options make Nmap guess more aggressively. Nmap\nwill still tell you when an imperfect match is printed and\ndisplay its confidence level (percentage) for each guess.\n--max-os-tries\n(Set the maximum number of OS detection tries\nagainst a target)\nWhen Nmap performs OS detection against a target and fails to\nfind a perfect match, it usually repeats the attempt. By\ndefault, Nmap tries five times if conditions are favorable for\nOS fingerprint submission, and twice when conditions aren't so\ngood. Specifying a lower\n--max-os-tries\nvalue (such as 1)\nspeeds Nmap up, though you miss out on retries which could\npotentially identify the OS. Alternatively, a high value may\nbe set to allow even more retries when conditions are\nfavorable. This is rarely done, except to generate better\nfingerprints for submission and integration into the Nmap OS\ndatabase.\nNMAP SCRIPTING ENGINE (NSE)\ntop\nThe Nmap Scripting Engine (NSE) is one of Nmap's most powerful and\nflexible features. It allows users to write (and share) simple\nscripts (using the\nLua programming language\n[10]\n) to automate a wide variety of networking tasks. Those scripts\nare executed in parallel with the speed and efficiency you expect\nfrom Nmap. Users can rely on the growing and diverse set of\nscripts distributed with Nmap, or write their own to meet custom\nneeds.\nTasks we had in mind when creating the system include network\ndiscovery, more sophisticated version detection, vulnerability\ndetection. NSE can even be used for vulnerability exploitation.\nTo reflect those different uses and to simplify the choice of\nwhich scripts to run, each script contains a field associating it\nwith one or more categories. Currently defined categories are\nauth, broadcast, default.  discovery, dos, exploit, external,\nfuzzer, intrusive, malware, safe, version, and vuln. These are all\ndescribed at\nhttps://nmap.org/book/nse-usage.html#nse-categories\n.\nScripts are not run in a sandbox and thus could accidentally or\nmaliciously damage your system or invade your privacy. Never run\nscripts from third parties unless you trust the authors or have\ncarefully audited the scripts yourself.\nThe Nmap Scripting Engine is described in detail at\nhttps://nmap.org/book/nse.html\nand is controlled by the following options:\n-sC\nPerforms a script scan using the default set of scripts. It is\nequivalent to\n--script=default\n. Some of the scripts in this\ncategory are considered intrusive and should not be run\nagainst a target network without permission.\nNote that this shorthand option is ignored whenever at least\none\n--script\nis also specified.\n--script\nfilename\n|\ncategory\n|\ndirectory\n/|\nexpression\n[,...]\nRuns a script scan using the comma-separated list of\nfilenames, script categories, and directories. Each element in\nthe list may also be a Boolean expression describing a more\ncomplex set of scripts. Each element is interpreted first as\nan expression, then as a category, and finally as a file or\ndirectory name.\nThere are two special features for advanced users only. One is\nto prefix script names and expressions with + to force them to\nrun even if they normally wouldn't (e.g. the relevant service\nwasn't detected on the target port). The other is that the\nargument all may be used to specify every script in Nmap's\ndatabase. Be cautious with this because NSE contains dangerous\nscripts such as exploits, brute force authentication crackers,\nand denial of service attacks.\nFile and directory names may be relative or absolute. Absolute\nnames are used directly. Relative paths are looked for in the\nscripts of each of the following places until found:\n--datadir\n$NMAPDIR\n~/.nmap (not searched on Windows)\nAPPDATA\n\\nmap (only on Windows)\nthe directory containing the nmap executable\nthe directory containing the nmap executable, followed by\n../share/nmap (not searched on Windows)\nNMAPDATADIR\n(not searched on Windows)\nthe current directory.\nWhen a directory name ending in / is given, Nmap loads every\nfile in the directory whose name ends with .nse. All other\nfiles are ignored and directories are not searched\nrecursively. When a filename is given, it does not have to\nhave the .nse extension; it will be added automatically if\nnecessary.  Nmap scripts are stored in a scripts subdirectory\nof the Nmap data directory by default (see\nhttps://nmap.org/book/data-files.html\n).\nFor efficiency, scripts are indexed in a database stored in\nscripts/script.db, which lists the category or categories in\nwhich each script belongs.  When referring to scripts from\nscript.db by name, you can use a shell-style â*â wildcard.\nnmap --script \"http-*\"\nLoads all scripts whose name starts with http-, such as\nhttp-auth and http-open-proxy. The argument to\n--script\nhad to be in quotes to protect the wildcard from the\nshell.\nMore complicated script selection can be done using the and,\nor, and not operators to build Boolean expressions. The\noperators have the same\nprecedence\n[11] as in Lua: not is the\nhighest, followed by and and then or. You can alter precedence\nby using parentheses. Because expressions contain space\ncharacters it is necessary to quote them.\nnmap --script \"not intrusive\"\nLoads every script except for those in the intrusive\ncategory.\nnmap --script \"default or safe\"\nThis is functionally equivalent to\nnmap --script\n\"default,safe\"\n. It loads all scripts that are in the\ndefault category or the safe category or both.\nnmap --script \"default and safe\"\nLoads those scripts that are in\nboth\nthe default and safe\ncategories.\nnmap --script \"(default or safe or intrusive) and not http-*\"\nLoads scripts in the default, safe, or intrusive\ncategories, except for those whose names start with http-.\n--script-args\nn1\n=\nv1\n,\nn2\n={\nn3\n=\nv3\n},\nn4\n={\nv4\n,\nv5\n}\nLets you provide arguments to NSE scripts. Arguments are a\ncomma-separated list of name=value pairs. Names and values may\nbe strings not containing whitespace or the characters â{â,\nâ}â, â=â, or â,â. To include one of these characters in a\nstring, enclose the string in single or double quotes. Within\na quoted string, â\\â escapes a quote. A backslash is only used\nto escape quotation marks in this special case; in all other\ncases a backslash is interpreted literally. Values may also be\ntables enclosed in {}, just as in Lua. A table may contain\nsimple string values or more name-value pairs, including\nnested tables. Many scripts qualify their arguments with the\nscript name, as in xmpp-info.server_name. You may use that\nfull qualified version to affect just the specified script, or\nyou may pass the unqualified version (server_name in this\ncase) to affect all scripts using that argument name. A script\nwill first check for its fully qualified argument name (the\nname specified in its documentation) before it accepts an\nunqualified argument name. A complex example of script\narguments is\n--script-args\n'user=foo,pass=\",{}=bar\",whois={whodb=nofollow+ripe},xmpp-info.server_name=localhost'\n.\nThe online NSE Documentation Portal at\nhttps://nmap.org/nsedoc/\nlists the arguments that each script\naccepts.\n--script-args-file\nfilename\nLets you load arguments to NSE scripts from a file. Any\narguments on the command line supersede ones in the file. The\nfile can be an absolute path, or a path relative to Nmap's\nusual search path (NMAPDIR, etc.) Arguments can be\ncomma-separated or newline-separated, but otherwise follow the\nsame rules as for\n--script-args\n, without requiring special\nquoting and escaping, since they are not parsed by the shell.\n--script-help\nfilename\n|\ncategory\n|\ndirectory\n|\nexpression\n|all[,...]\nShows help about scripts. For each script matching the given\nspecification, Nmap prints the script name, its categories,\nand its description. The specifications are the same as those\naccepted by\n--script\n; so for example if you want help about\nthe ftp-anon script, you would run\nnmap --script-help\nftp-anon\n. In addition to getting help for individual scripts,\nyou can use this as a preview of what scripts will be run for\na specification, for example with\nnmap --script-help default\n.\n--script-trace\nThis option does what\n--packet-trace\ndoes, just one ISO layer\nhigher. If this option is specified all incoming and outgoing\ncommunication performed by a script is printed. The displayed\ninformation includes the communication protocol, the source,\nthe target and the transmitted data. If more than 5% of all\ntransmitted data is not printable, then the trace output is in\na hex dump format. Specifying\n--packet-trace\nenables script\ntracing too.\n--script-updatedb\nThis option updates the script database found in\nscripts/script.db which is used by Nmap to determine the\navailable default scripts and categories. It is only necessary\nto update the database if you have added or removed NSE\nscripts from the default scripts directory or if you have\nchanged the categories of any script. This option is generally\nused by itself:\nnmap --script-updatedb\n.\nTIMING AND PERFORMANCE\ntop\nOne of my highest Nmap development priorities has always been\nperformance. A default scan (\nnmap\nhostname\n) of a host on my local\nnetwork takes a fifth of a second. That is barely enough time to\nblink, but adds up when you are scanning hundreds or thousands of\nhosts. Moreover, certain scan options such as UDP scanning and\nversion detection can increase scan times substantially. So can\ncertain firewall configurations, particularly response rate\nlimiting. While Nmap utilizes parallelism and many advanced\nalgorithms to accelerate these scans, the user has ultimate\ncontrol over how Nmap runs. Expert users carefully craft Nmap\ncommands to obtain only the information they care about while\nmeeting their time constraints.\nTechniques for improving scan times include omitting non-critical\ntests, and upgrading to the latest version of Nmap (performance\nenhancements are made frequently). Optimizing timing parameters\ncan also make a substantial difference. Those options are listed\nbelow.\nSome options accept a time parameter. This is specified in seconds\nby default, though you can append âmsâ, âsâ, âmâ, or âhâ to the\nvalue to specify milliseconds, seconds, minutes, or hours. So the\n--host-timeout\narguments 900000ms, 900, 900s, and 15m all do the\nsame thing.\n--min-hostgroup\nnumhosts\n;\n--max-hostgroup\nnumhosts\n(Adjust\nparallel scan group sizes)\nNmap has the ability to port scan or version scan multiple\nhosts in parallel. Nmap does this by dividing the target IP\nspace into groups and then scanning one group at a time. In\ngeneral, larger groups are more efficient. The downside is\nthat host results can't be provided until the whole group is\nfinished. So if Nmap started out with a group size of 50, the\nuser would not receive any reports (except for the updates\noffered in verbose mode) until the first 50 hosts are\ncompleted.\nBy default, Nmap takes a compromise approach to this conflict.\nIt starts out with a group size as low as five so the first\nresults come quickly and then increases the groupsize to as\nhigh as 1024. The exact default numbers depend on the options\ngiven. For efficiency reasons, Nmap uses larger group sizes\nfor UDP or few-port TCP scans.\nWhen a maximum group size is specified with\n--max-hostgroup\n,\nNmap will never exceed that size. Specify a minimum size with\n--min-hostgroup\nand Nmap will try to keep group sizes above\nthat level. Nmap may have to use smaller groups than you\nspecify if there are not enough target hosts left on a given\ninterface to fulfill the specified minimum. Both may be set to\nkeep the group size within a specific range, though this is\nrarely desired.\nThese options do not have an effect during the host discovery\nphase of a scan. This includes plain ping scans (\n-sn\n). Host\ndiscovery always works in large groups of hosts to improve\nspeed and accuracy.\nThe primary use of these options is to specify a large minimum\ngroup size so that the full scan runs more quickly. A common\nchoice is 256 to scan a network in /24 sized chunks. For a\nscan with many ports, exceeding that number is unlikely to\nhelp much. For scans of just a few port numbers, host group\nsizes of 2048 or more may be helpful.\n--min-parallelism\nnumprobes\n;\n--max-parallelism\nnumprobes\n(Adjust\nprobe parallelization)\nThese options control the total number of probes that may be\noutstanding for a host group. They are used for port scanning\nand host discovery. By default, Nmap calculates an\never-changing ideal parallelism based on network performance.\nIf packets are being dropped, Nmap slows down and allows fewer\noutstanding probes. The ideal probe number slowly rises as the\nnetwork proves itself worthy. These options place minimum or\nmaximum bounds on that variable. By default, the ideal\nparallelism can drop to one if the network proves unreliable\nand rise to several hundred in perfect conditions.\nThe most common usage is to set\n--min-parallelism\nto a number\nhigher than one to speed up scans of poorly performing hosts\nor networks. This is a risky option to play with, as setting\nit too high may affect accuracy. Setting this also reduces\nNmap's ability to control parallelism dynamically based on\nnetwork conditions. A value of 10 might be reasonable, though\nI only adjust this value as a last resort.\nThe\n--max-parallelism\noption is sometimes set to one to\nprevent Nmap from sending more than one probe at a time to\nhosts. The\n--scan-delay\noption, discussed later, is another\nway to do this.\n--min-rtt-timeout\ntime\n,\n--max-rtt-timeout\ntime\n,\n--initial-rtt-timeout\ntime\n(Adjust probe timeouts)\nNmap maintains a running timeout value for determining how\nlong it will wait for a probe response before giving up or\nretransmitting the probe. This is calculated based on the\nresponse times of previous probes.\nIf the network latency shows itself to be significant and\nvariable, this timeout can grow to several seconds. It also\nstarts at a conservative (high) level and may stay that way\nfor a while when Nmap scans unresponsive hosts.\nSpecifying a lower\n--max-rtt-timeout\nand\n--initial-rtt-timeout\nthan the defaults can cut scan times significantly. This is\nparticularly true for pingless (\n-Pn\n) scans, and those against\nheavily filtered networks. Don't get too aggressive though.\nThe scan can end up taking longer if you specify such a low\nvalue that many probes are timing out and retransmitting while\nthe response is in transit.\nIf all the hosts are on a local network, 100 milliseconds\n(\n--max-rtt-timeout 100ms\n) is a reasonable aggressive value. If\nrouting is involved, ping a host on the network first with the\nICMP ping utility, or with a custom packet crafter such as\nNping that is more likely to get through a firewall. Look at\nthe maximum round trip time out of ten packets or so. You\nmight want to double that for the\n--initial-rtt-timeout\nand\ntriple or quadruple it for the\n--max-rtt-timeout\n. I generally\ndo not set the maximum RTT below 100 ms, no matter what the\nping times are. Nor do I exceed 1000 ms.\n--min-rtt-timeout\nis a rarely used option that could be useful\nwhen a network is so unreliable that even Nmap's default is\ntoo aggressive. Since Nmap only reduces the timeout down to\nthe minimum when the network seems to be reliable, this need\nis unusual and should be reported as a bug to the nmap-dev\nmailing list.\n--max-retries\nnumtries\n(Specify the maximum number of port scan\nprobe retransmissions)\nWhen Nmap receives no response to a port scan probe, it could\nmean the port is filtered. Or maybe the probe or response was\nsimply lost on the network. It is also possible that the\ntarget host has rate limiting enabled that temporarily blocked\nthe response. So Nmap tries again by retransmitting the\ninitial probe. If Nmap detects poor network reliability, it\nmay try many more times before giving up on a port. While this\nbenefits accuracy, it also lengthens scan times. When\nperformance is critical, scans may be sped up by limiting the\nnumber of retransmissions allowed. You can even specify\n--max-retries 0\nto prevent any retransmissions, though that is\nonly recommended for situations such as informal surveys where\noccasional missed ports and hosts are acceptable.\nThe default (with no\n-T\ntemplate) is to allow ten\nretransmissions. If a network seems reliable and the target\nhosts aren't rate limiting, Nmap usually only does one\nretransmission. So most target scans aren't even affected by\ndropping\n--max-retries\nto a low value such as three. Such\nvalues can substantially speed scans of slow (rate limited)\nhosts. You usually lose some information when Nmap gives up on\nports early, though that may be preferable to letting the\n--host-timeout\nexpire and losing all information about the\ntarget.\n--host-timeout\ntime\n(Give up on slow target hosts)\nSome hosts simply take a\nlong\ntime to scan. This may be due to\npoorly performing or unreliable networking hardware or\nsoftware, packet rate limiting, or a restrictive firewall. The\nslowest few percent of the scanned hosts can eat up a majority\nof the scan time. Sometimes it is best to cut your losses and\nskip those hosts initially. Specify\n--host-timeout\nwith the\nmaximum amount of time you are willing to wait. For example,\nspecify 30m to ensure that Nmap doesn't waste more than half\nan hour on a single host. Note that Nmap may be scanning other\nhosts at the same time during that half an hour, so it isn't a\ncomplete loss. A host that times out is skipped. No port\ntable, OS detection, or version detection results are printed\nfor that host.\nThe special value 0 can be used to mean âno timeoutâ, which\ncan be used to override the\nT5\ntiming template, which sets the\nhost timeout to 15 minutes.\n--script-timeout\ntime\nWhile some scripts complete in fractions of a second, others\ncan take hours or more depending on the nature of the script,\narguments passed in, network and application conditions, and\nmore. The\n--script-timeout\noption sets a ceiling on script\nexecution time. Any script instance which exceeds that time\nwill be terminated and no output will be shown. If debugging\n(\n-d\n) is enabled, Nmap will report on each timeout. For host\nand service scripts, a script instance only scans a single\ntarget host or port and the timeout period will be reset for\nthe next instance.\nThe special value 0 can be used to mean âno timeoutâ, which\ncan be used to override the\nT5\ntiming template, which sets the\nscript timeout to 10 minutes.\n--scan-delay\ntime\n;\n--max-scan-delay\ntime\n(Adjust delay between\nprobes)\nThis option causes Nmap to wait at least the given amount of\ntime between each probe it sends to a given host. This is\nparticularly useful in the case of rate limiting.  Solaris\nmachines (among many others) will usually respond to UDP scan\nprobe packets with only one ICMP message per second. Any more\nthan that sent by Nmap will be wasteful. A\n--scan-delay\nof 1s\nwill keep Nmap at that slow rate. Nmap tries to detect rate\nlimiting and adjust the scan delay accordingly, but it doesn't\nhurt to specify it explicitly if you already know what rate\nworks best.\nWhen Nmap adjusts the scan delay upward to cope with rate\nlimiting, the scan slows down dramatically. The\n--max-scan-delay\noption specifies the largest delay that Nmap\nwill allow. A low\n--max-scan-delay\ncan speed up Nmap, but it\nis risky. Setting this value too low can lead to wasteful\npacket retransmissions and possible missed ports when the\ntarget implements strict rate limiting.\nAnother use of\n--scan-delay\nis to evade threshold based\nintrusion detection and prevention systems (IDS/IPS).\n--min-rate\nnumber\n;\n--max-rate\nnumber\n(Directly control the\nscanning rate)\nNmap's dynamic timing does a good job of finding an\nappropriate speed at which to scan. Sometimes, however, you\nmay happen to know an appropriate scanning rate for a network,\nor you may have to guarantee that a scan will be finished by a\ncertain time. Or perhaps you must keep Nmap from scanning too\nquickly. The\n--min-rate\nand\n--max-rate\noptions are designed\nfor these situations.\nWhen the\n--min-rate\noption is given Nmap will do its best to\nsend packets as fast as or faster than the given rate. The\nargument is a positive real number representing a packet rate\nin packets per second. For example, specifying\n--min-rate 300\nmeans that Nmap will try to keep the sending rate at or above\n300 packets per second. Specifying a minimum rate does not\nkeep Nmap from going faster if conditions warrant.\nLikewise,\n--max-rate\nlimits a scan's sending rate to a given\nmaximum. Use\n--max-rate 100\n, for example, to limit sending to\n100 packets per second on a fast network. Use\n--max-rate 0.1\nfor a slow scan of one packet every ten seconds. Use\n--min-rate\nand\n--max-rate\ntogether to keep the rate inside a\ncertain range.\nThese two options are global, affecting an entire scan, not\nindividual hosts. They only affect port scans and host\ndiscovery scans. Other features like OS detection implement\ntheir own timing.\nThere are two conditions when the actual scanning rate may\nfall below the requested minimum. The first is if the minimum\nis faster than the fastest rate at which Nmap can send, which\nis dependent on hardware. In this case Nmap will simply send\npackets as fast as possible, but be aware that such high rates\nare likely to cause a loss of accuracy. The second case is\nwhen Nmap has nothing to send, for example at the end of a\nscan when the last probes have been sent and Nmap is waiting\nfor them to time out or be responded to. It's normal to see\nthe scanning rate drop at the end of a scan or in between\nhostgroups. The sending rate may temporarily exceed the\nmaximum to make up for unpredictable delays, but on average\nthe rate will stay at or below the maximum.\nSpecifying a minimum rate should be done with care. Scanning\nfaster than a network can support may lead to a loss of\naccuracy. In some cases, using a faster rate can make a scan\ntake\nlonger\nthan it would with a slower rate. This is because\nNmap's adaptive retransmission algorithms will detect the\nnetwork congestion caused by an excessive scanning rate and\nincrease the number of retransmissions in order to improve\naccuracy. So even though packets are sent at a higher rate,\nmore packets are sent overall. Cap the number of\nretransmissions with the\n--max-retries\noption if you need to\nset an upper limit on total scan time.\n--defeat-rst-ratelimit\nMany hosts have long used rate limiting to reduce the number\nof ICMP error messages (such as port-unreachable errors) they\nsend. Some systems now apply similar rate limits to the RST\n(reset) packets they generate. This can slow Nmap down\ndramatically as it adjusts its timing to reflect those rate\nlimits. You can tell Nmap to ignore those rate limits (for\nport scans such as SYN scan which\ndon't\ntreat non-responsive\nports as open) by specifying\n--defeat-rst-ratelimit\n.\nUsing this option can reduce accuracy, as some ports will\nappear non-responsive because Nmap didn't wait long enough for\na rate-limited RST response. With a SYN scan, the non-response\nresults in the port being labeled filtered rather than the\nclosed state we see when RST packets are received. This option\nis useful when you only care about open ports, and\ndistinguishing between closed and filtered ports isn't worth\nthe extra time.\n--defeat-icmp-ratelimit\nSimilar to\n--defeat-rst-ratelimit\n, the\n--defeat-icmp-ratelimit\noption trades accuracy for speed, increasing UDP scanning\nspeed against hosts that rate-limit ICMP error messages.\nBecause this option causes Nmap to not delay in order to\nreceive the port unreachable messages, a non-responsive port\nwill be labeled closed|filtered instead of the default\nopen|filtered. This has the effect of only treating ports\nwhich actually respond via UDP as open. Since many UDP\nservices do not respond in this way, the chance for inaccuracy\nis greater with this option than with\n--defeat-rst-ratelimit\n.\n--nsock-engine iocp|epoll|kqueue|poll|select\nEnforce use of a given nsock IO multiplexing engine. Only the\nselect(2)-based fallback engine is guaranteed to be available\non your system. Engines are named after the name of the IO\nmanagement facility they leverage. Engines currently\nimplemented are epoll, kqueue, poll, and select, but not all\nwill be present on any platform. By default, Nmap will use the\n\"best\" engine, i.e. the first one in this list that is\nsupported. Use\nnmap -V\nto see which engines are supported on\nyour platform.\n-T paranoid|sneaky|polite|normal|aggressive|insane\n(Set a timing\ntemplate)\nWhile the fine-grained timing controls discussed in the\nprevious section are powerful and effective, some people find\nthem confusing. Moreover, choosing the appropriate values can\nsometimes take more time than the scan you are trying to\noptimize. Fortunately, Nmap offers a simpler approach, with\nsix timing templates. You can specify them with the\n-T\noption\nand their number (0â5) or their name. The template names are\nparanoid\n(\n0\n),\nsneaky\n(\n1\n),\npolite\n(\n2\n),\nnormal\n(\n3\n),\naggressive\n(\n4\n), and\ninsane\n(\n5\n). The first two are for IDS\nevasion. Polite mode slows down the scan to use less bandwidth\nand target machine resources. Normal mode is the default and\nso\n-T3\ndoes nothing. Aggressive mode speeds scans up by making\nthe assumption that you are on a reasonably fast and reliable\nnetwork. Finally insane mode assumes that you are on an\nextraordinarily fast network or are willing to sacrifice some\naccuracy for speed.\nThese templates allow the user to specify how aggressive they\nwish to be, while leaving Nmap to pick the exact timing\nvalues. The templates also make some minor speed adjustments\nfor which fine-grained control options do not currently exist.\nFor example,\n-T4\nprohibits the dynamic scan delay from\nexceeding 10 ms for TCP ports and\n-T5\ncaps that value at 5 ms.\nTemplates can be used in combination with fine-grained\ncontrols, and the fine-grained controls that you specify will\ntake precedence over the timing template default for that\nparameter. I recommend using\n-T4\nwhen scanning reasonably\nmodern and reliable networks. Keep that option even when you\nadd fine-grained controls so that you benefit from those extra\nminor optimizations that it enables.\nIf you are on a decent broadband or ethernet connection, I\nwould recommend always using\n-T4\n. Some people love\n-T5\nthough\nit is too aggressive for my taste. People sometimes specify\n-T2\nbecause they think it is less likely to crash hosts or\nbecause they consider themselves to be polite in general. They\noften don't realize just how slow\n-T polite\nreally is. Their\nscan may take ten times longer than a default scan. Machine\ncrashes and bandwidth problems are rare with the default\ntiming options (\n-T3\n) and so I normally recommend that for\ncautious scanners. Omitting version detection is far more\neffective than playing with timing values at reducing these\nproblems.\nWhile\n-T0\nand\n-T1\nmay be useful for avoiding IDS alerts, they\nwill take an extraordinarily long time to scan thousands of\nmachines or ports. For such a long scan, you may prefer to set\nthe exact timing values you need rather than rely on the\ncanned\n-T0\nand\n-T1\nvalues.\nThe main effects of\nT0\nare serializing the scan so only one\nport is scanned at a time, and waiting five minutes between\nsending each probe.\nT1\nand\nT2\nare similar but they only wait\n15 seconds and 0.4 seconds, respectively, between probes.\nT3\nis Nmap's default behavior, which includes parallelization.\n-T4\ndoes the equivalent of\n--max-rtt-timeout 1250ms --min-rtt-timeout 100ms\n--initial-rtt-timeout 500ms --max-retries 6\nand sets the\nmaximum TCP and SCTP scan delay to 10ms.\nT5\ndoes the\nequivalent of\n--max-rtt-timeout 300ms --min-rtt-timeout 50ms\n--initial-rtt-timeout 250ms --max-retries 2 --host-timeout 15m\n--script-timeout 10m\nas well as setting the maximum TCP and\nSCTP scan delay to 5ms. Maximum UDP scan delay is not set by\nT4\nor\nT5\n, but it can be set with the\n--max-scan-delay\noption.\nFIREWALL/IDS EVASION AND SPOOFING\ntop\nMany Internet pioneers envisioned a global open network with a\nuniversal IP address space allowing virtual connections between\nany two nodes. This allows hosts to act as true peers, serving and\nretrieving information from each other. People could access all of\ntheir home systems from work, changing the climate control\nsettings or unlocking the doors for early guests. This vision of\nuniversal connectivity has been stifled by address space shortages\nand security concerns. In the early 1990s, organizations began\ndeploying firewalls for the express purpose of reducing\nconnectivity. Huge networks were cordoned off from the unfiltered\nInternet by application proxies, network address translation, and\npacket filters. The unrestricted flow of information gave way to\ntight regulation of approved communication channels and the\ncontent that passes over them.\nNetwork obstructions such as firewalls can make mapping a network\nexceedingly difficult. It will not get any easier, as stifling\ncasual reconnaissance is often a key goal of implementing the\ndevices. Nevertheless, Nmap offers many features to help\nunderstand these complex networks, and to verify that filters are\nworking as intended. It even supports mechanisms for bypassing\npoorly implemented defenses. One of the best methods of\nunderstanding your network security posture is to try to defeat\nit. Place yourself in the mind-set of an attacker, and deploy\ntechniques from this section against your networks. Launch an FTP\nbounce scan, idle scan, fragmentation attack, or try to tunnel\nthrough one of your own proxies.\nIn addition to restricting network activity, companies are\nincreasingly monitoring traffic with intrusion detection systems\n(IDS). All of the major IDSs ship with rules designed to detect\nNmap scans because scans are sometimes a precursor to attacks.\nMany of these products have recently morphed into intrusion\nprevention\nsystems (IPS) that actively block traffic deemed\nmalicious. Unfortunately for network administrators and IDS\nvendors, reliably detecting bad intentions by analyzing packet\ndata is a tough problem. Attackers with patience, skill, and the\nhelp of certain Nmap options can usually pass by IDSs undetected.\nMeanwhile, administrators must cope with large numbers of false\npositive results where innocent activity is misdiagnosed and\nalerted on or blocked.\nOccasionally people suggest that Nmap should not offer features\nfor evading firewall rules or sneaking past IDSs. They argue that\nthese features are just as likely to be misused by attackers as\nused by administrators to enhance security. The problem with this\nlogic is that these methods would still be used by attackers, who\nwould just find other tools or patch the functionality into Nmap.\nMeanwhile, administrators would find it that much harder to do\ntheir jobs. Deploying only modern, patched FTP servers is a far\nmore powerful defense than trying to prevent the distribution of\ntools implementing the FTP bounce attack.\nThere is no magic bullet (or Nmap option) for detecting and\nsubverting firewalls and IDS systems. It takes skill and\nexperience. A tutorial is beyond the scope of this reference\nguide, which only lists the relevant options and describes what\nthey do.\n-f\n(fragment packets);\n--mtu\n(using the specified MTU)\nThe\n-f\noption causes the requested scan (including host\ndiscovery scans) to use tiny fragmented IP packets. The idea\nis to split up the TCP header over several packets to make it\nharder for packet filters, intrusion detection systems, and\nother annoyances to detect what you are doing. Be careful with\nthis! Some programs have trouble handling these tiny packets.\nThe old-school sniffer named Sniffit segmentation faulted\nimmediately upon receiving the first fragment. Specify this\noption once, and Nmap splits the packets into eight bytes or\nless after the IP header. So a 20-byte TCP header would be\nsplit into three packets. Two with eight bytes of the TCP\nheader, and one with the final four. Of course each fragment\nalso has an IP header. Specify\n-f\nagain to use 16 bytes per\nfragment (reducing the number of fragments).  Or you can\nspecify your own offset size with the\n--mtu\noption. Don't also\nspecify\n-f\nif you use\n--mtu\n. The offset must be a multiple of\neight. While fragmented packets won't get by packet filters\nand firewalls that queue all IP fragments, such as the\nCONFIG_IP_ALWAYS_DEFRAG\noption in the Linux kernel, some\nnetworks can't afford the performance hit this causes and thus\nleave it disabled. Others can't enable this because fragments\nmay take different routes into their networks. Some source\nsystems defragment outgoing packets in the kernel. Linux with\nthe iptables connection tracking module is one such example.\nDo a scan while a sniffer such as Wireshark is running to\nensure that sent packets are fragmented. If your host OS is\ncausing problems, try the\n--send-eth\noption to bypass the IP\nlayer and send raw ethernet frames.\nFragmentation is only supported for Nmap's raw packet\nfeatures, which includes TCP and UDP port scans (except\nconnect scan and FTP bounce scan) and OS detection. Features\nsuch as version detection and the Nmap Scripting Engine\ngenerally don't support fragmentation because they rely on\nyour host's TCP stack to communicate with target services.\n-D\ndecoy1\n[,\ndecoy2\n]\n[,ME][,...]\n(Cloak a scan with decoys)\nCauses a decoy scan to be performed, which makes it appear to\nthe remote host that the host(s) you specify as decoys are\nscanning the target network too. Thus their IDS might report\n5â10 port scans from unique IP addresses, but they won't know\nwhich IP was scanning them and which were innocent decoys.\nWhile this can be defeated through router path tracing,\nresponse-dropping, and other active mechanisms, it is\ngenerally an effective technique for hiding your IP address.\nSeparate each decoy host with commas, and you can optionally\nuse ME as one of the decoys to represent the position for your\nreal IP address. If you put ME in the sixth position or later,\nsome common port scan detectors (such as Solar Designer's\nexcellent Scanlogd) are unlikely to show your IP address at\nall. If you don't use ME, Nmap will put you in a random\nposition. You can also use RND to generate a random,\nnon-reserved IP address, or RND:\nnumber\nto generate\nnumber\naddresses.\nNote that the hosts you use as decoys should be up or you\nmight accidentally SYN flood your targets. Also it will be\npretty easy to determine which host is scanning if only one is\nactually up on the network. You might want to use IP addresses\ninstead of names (so the decoy networks don't see you in their\nnameserver logs). Right now random IP address generation is\nonly supported with IPv4\nDecoys are used both in the initial host discovery scan (using\nICMP, SYN, ACK, or whatever) and during the actual port\nscanning phase. Decoys are also used during remote OS\ndetection (\n-O\n). Decoys do not work with version detection or\nTCP connect scan. When a scan delay is in effect, the delay is\nenforced between each batch of spoofed probes, not between\neach individual probe. Because decoys are sent as a batch all\nat once, they may temporarily violate congestion control\nlimits.\nIt is worth noting that using too many decoys may slow your\nscan and potentially even make it less accurate. Also, some\nISPs will filter out your spoofed packets, but many do not\nrestrict spoofed IP packets at all.\n-S\nIP_Address\n(Spoof source address)\nIn some circumstances, Nmap may not be able to determine your\nsource address (Nmap will tell you if this is the case). In\nthis situation, use\n-S\nwith the IP address of the interface\nyou wish to send packets through.\nAnother possible use of this flag is to spoof the scan to make\nthe targets think that\nsomeone else\nis scanning them. Imagine\na company being repeatedly port scanned by a competitor! The\n-e\noption and\n-Pn\nare generally required for this sort of\nusage. Note that you usually won't receive reply packets back\n(they will be addressed to the IP you are spoofing), so Nmap\nwon't produce useful reports.\n-e\ninterface\n(Use specified interface)\nTells Nmap what interface to send and receive packets on. Nmap\nshould be able to detect this automatically, but it will tell\nyou if it cannot.\n--source-port\nportnumber\n; -g\nportnumber\n(Spoof source port number)\nOne surprisingly common misconfiguration is to trust traffic\nbased only on the source port number. It is easy to understand\nhow this comes about. An administrator will set up a shiny new\nfirewall, only to be flooded with complaints from ungrateful\nusers whose applications stopped working. In particular, DNS\nmay be broken because the UDP DNS replies from external\nservers can no longer enter the network. FTP is another common\nexample. In active FTP transfers, the remote server tries to\nestablish a connection back to the client to transfer the\nrequested file.\nSecure solutions to these problems exist, often in the form of\napplication-level proxies or protocol-parsing firewall\nmodules. Unfortunately there are also easier, insecure\nsolutions. Noting that DNS replies come from port 53 and\nactive FTP from port 20, many administrators have fallen into\nthe trap of simply allowing incoming traffic from those ports.\nThey often assume that no attacker would notice and exploit\nsuch firewall holes. In other cases, administrators consider\nthis a short-term stop-gap measure until they can implement a\nmore secure solution. Then they forget the security upgrade.\nOverworked network administrators are not the only ones to\nfall into this trap. Numerous products have shipped with these\ninsecure rules. Even Microsoft has been guilty. The IPsec\nfilters that shipped with Windows 2000 and Windows XP contain\nan implicit rule that allows all TCP or UDP traffic from port\n88 (Kerberos). In another well-known case, versions of the\nZone Alarm personal firewall up to 2.1.25 allowed any incoming\nUDP packets with the source port 53 (DNS) or 67 (DHCP).\nNmap offers the\n-g\nand\n--source-port\noptions (they are\nequivalent) to exploit these weaknesses. Simply provide a port\nnumber and Nmap will send packets from that port where\npossible. Most scanning operations that use raw sockets,\nincluding SYN and UDP scans, support the option completely.\nThe option notably doesn't have an effect for any operations\nthat use normal operating system sockets, including DNS\nrequests, TCP\nconnect\nscan, version detection, and script\nscanning. Setting the source port also doesn't work for OS\ndetection, because Nmap must use different port numbers for\ncertain OS detection tests to work properly.\n--data\nhex string\n(Append custom binary data to sent packets)\nThis option lets you include binary data as payload in sent\npackets.\nhex string\nmay be specified in any of the following\nformats: 0xAABBCCDDEEFF\n...\n, AABBCCDDEEFF\n...\nor\n\\xAA\\xBB\\xCC\\xDD\\xEE\\xFF\n...\n. Examples of use are\n--data\n0xdeadbeef\nand\n--data \\xCA\\xFE\\x09\n. Note that if you specify a\nnumber like 0x00ff no byte-order conversion is performed. Make\nsure you specify the information in the byte order expected by\nthe receiver.\n--data-string\nstring\n(Append custom string to sent packets)\nThis option lets you include a regular string as payload in\nsent packets.\nstring\ncan contain any string. However, note\nthat some characters may depend on your system's locale and\nthe receiver may not see the same information. Also, make sure\nyou enclose the string in double quotes and escape any special\ncharacters from the shell. Examples:\n--data-string \"Scan\nconducted by Security Ops, extension 7192\"\nor\n--data-string\n\"Ph34r my l33t skills\"\n. Keep in mind that nobody is likely to\nactually see any comments left by this option unless they are\ncarefully monitoring the network with a sniffer or custom IDS\nrules.\n--data-length\nnumber\n(Append random data to sent packets)\nNormally Nmap sends minimalist packets containing only a\nheader. So its TCP packets are generally 40 bytes and ICMP\necho requests are just 28. Some UDP ports and IP protocols get\na custom payload by default. This option tells Nmap to append\nthe given number of random bytes to most of the packets it\nsends, and not to use any protocol-specific payloads. (Use\n--data-length 0\nfor no random or protocol-specific payloads.)\nOS detection (\n-O\n) packets are not affected because accuracy\nthere requires probe consistency, but most pinging and\nportscan packets support this. It slows things down a little,\nbut can make a scan slightly less conspicuous.\n--ip-options\nR|S [route]|L [route]|T|U ...\n; --ip-options\nhex\nstring\n(Send packets with specified ip options)\nThe\nIP protocol\n[12] offers several options which may be placed\nin packet headers. Unlike the ubiquitous TCP options, IP\noptions are rarely seen due to practicality and security\nconcerns. In fact, many Internet routers block the most\ndangerous options such as source routing. Yet options can\nstill be useful in some cases for determining and manipulating\nthe network route to target machines. For example, you may be\nable to use the record route option to determine a path to a\ntarget even when more traditional traceroute-style approaches\nfail. Or if your packets are being dropped by a certain\nfirewall, you may be able to specify a different route with\nthe strict or loose source routing options.\nThe most powerful way to specify IP options is to simply pass\nin values as the argument to\n--ip-options\n. Precede each hex\nnumber with \\x then the two digits. You may repeat certain\ncharacters by following them with an asterisk and then the\nnumber of times you wish them to repeat. For example,\n\\x01\\x07\\x04\\x00*36\\x01 is a hex string containing 36 NUL\nbytes.\nNmap also offers a shortcut mechanism for specifying options.\nSimply pass the letter R, T, or U to request record-route,\nrecord-timestamp, or both options together, respectively.\nLoose or strict source routing may be specified with an L or S\nfollowed by a space and then a space-separated list of IP\naddresses.\nIf you wish to see the options in packets sent and received,\nspecify\n--packet-trace\n. For more information and examples of\nusing IP options with Nmap, see\nhttps://seclists.org/nmap-dev/2006/q3/52\n.\n--ttl\nvalue\n(Set IP time-to-live field)\nSets the IPv4 time-to-live field in sent packets to the given\nvalue.\n--randomize-hosts\n(Randomize target host order)\nTells Nmap to shuffle each group of up to 16384 hosts before\nit scans them. This can make the scans less obvious to various\nnetwork monitoring systems, especially when you combine it\nwith slow timing options. If you want to randomize over larger\ngroup sizes, increase\nPING_GROUP_SZ\nin nmap.h and recompile.\nAn alternative solution is to generate the target IP list with\na list scan (\n-sL -n -oN\nfilename\n), randomize it with a Perl\nscript, then provide the whole list to Nmap with\n-iL\n.\n--spoof-mac\nMAC address, prefix, or vendor name\n(Spoof MAC\naddress)\nAsks Nmap to use the given MAC address\nfor all of the raw ethernet frames it sends. This option\nimplies\n--send-eth\nto ensure that Nmap actually sends\nethernet-level packets. The MAC given can take several\nformats. If it is simply the number 0, Nmap chooses a\ncompletely random MAC address for the session. If the given\nstring is an even number of hex digits (with the pairs\noptionally separated by a colon), Nmap will use those as the\nMAC. If fewer than 12 hex digits are provided, Nmap fills in\nthe remainder of the six bytes with random values. If the\nargument isn't a zero or hex string, Nmap looks through\nnmap-mac-prefixes to find a vendor name containing the given\nstring (it is case insensitive). If a match is found, Nmap\nuses the vendor's OUI (three-byte prefix) and fills out the\nremaining three bytes randomly. Valid\n--spoof-mac\nargument\nexamples are Apple, 0, 01:02:03:04:05:06, deadbeefcafe,\n0020F2, and Cisco. This option only affects raw packet scans\nsuch as SYN scan or OS detection, not connection-oriented\nfeatures such as version detection or the Nmap Scripting\nEngine.\n--proxies\nComma-separated list of proxy URLs\n(Relay TCP\nconnections through a chain of proxies)\nAsks Nmap to establish TCP connections with a final target\nthrough supplied chain of one or more HTTP or SOCKS4 proxies.\nProxies can help hide the true source of a scan or evade\ncertain firewall restrictions, but they can hamper scan\nperformance by increasing latency. Users may need to adjust\nNmap timeouts and other scan parameters accordingly. In\nparticular, a lower\n--max-parallelism\nmay help because some\nproxies refuse to handle as many concurrent connections as\nNmap opens by default.\nThis option takes a list of proxies as argument, expressed as\nURLs in the format proto://host:port. Use commas to separate\nnode URLs in a chain. No authentication is supported yet.\nValid protocols are HTTP and SOCKS4.\nWarning: this feature is still under development and has\nlimitations. It is implemented within the nsock library and\nthus has no effect on the ping, port scanning and OS discovery\nphases of a scan. Only NSE and version scan benefit from this\noption so farâother features may disclose your true address.\nSSL connections are not yet supported, nor is proxy-side DNS\nresolution (hostnames are always resolved by Nmap).\n--badsum\n(Send packets with bogus TCP/UDP checksums)\nAsks Nmap to use an invalid TCP, UDP or SCTP checksum for\npackets sent to target hosts. Since virtually all host IP\nstacks properly drop these packets, any responses received are\nlikely coming from a firewall or IDS that didn't bother to\nverify the checksum. For more details on this technique, see\nhttps://nmap.org/p60-12.html\n--adler32\n(Use deprecated Adler32 instead of CRC32C for SCTP\nchecksums)\nAsks Nmap to use the deprecated Adler32 algorithm for\ncalculating the SCTP checksum. If\n--adler32\nis not given,\nCRC-32C (Castagnoli) is used.\nRFC 2960\n[13] originally defined\nAdler32 as checksum algorithm for SCTP;\nRFC 4960\n[6] later\nredefined the SCTP checksums to use CRC-32C. Current SCTP\nimplementations should be using CRC-32C, but in order to\nelicit responses from old, legacy SCTP implementations, it may\nbe preferable to use Adler32.\nOUTPUT\ntop\nAny security tool is only as useful as the output it generates.\nComplex tests and algorithms are of little value if they aren't\npresented in an organized and comprehensible fashion. Given the\nnumber of ways Nmap is used by people and other software, no\nsingle format can please everyone. So Nmap offers several formats,\nincluding the interactive mode for humans to read directly and XML\nfor easy parsing by software.\nIn addition to offering different output formats, Nmap provides\noptions for controlling the verbosity of output as well as\ndebugging messages. Output types may be sent to standard output or\nto named files, which Nmap can append to or clobber. Output files\nmay also be used to resume aborted scans.\nNmap makes output available in five different formats. The default\nis called interactive output, and it is sent to standard output\n(stdout).  There is also normal output, which is similar to\ninteractive except that it displays less runtime information and\nwarnings since it is expected to be analyzed after the scan\ncompletes rather than interactively.\nXML output is one of the most important output types, as it can be\nconverted to HTML, easily parsed by programs such as Nmap\ngraphical user interfaces, or imported into databases.\nThe two remaining output types are the simple grepable output\nwhich includes most information for a target host on a single\nline, and sCRiPt KiDDi3 0utPUt for users who consider themselves\n|<-r4d.\nWhile interactive output is the default and has no associated\ncommand-line options, the other four format options use the same\nsyntax. They take one argument, which is the filename that results\nshould be stored in. Multiple formats may be specified, but each\nformat may only be specified once. For example, you may wish to\nsave normal output for your own review while saving XML of the\nsame scan for programmatic analysis. You might do this with the\noptions\n-oX myscan.xml -oN myscan.nmap\n. While this chapter uses\nthe simple names like myscan.xml for brevity, more descriptive\nnames are generally recommended. The names chosen are a matter of\npersonal preference, though I use long ones that incorporate the\nscan date and a word or two describing the scan, placed in a\ndirectory named after the company I'm scanning.\nWhile these options save results to files, Nmap still prints\ninteractive output to stdout as usual. For example, the command\nnmap -oX myscan.xml target\nprints XML to myscan.xml and fills\nstandard output with the same interactive results it would have\nprinted if\n-oX\nwasn't specified at all. You can change this by\npassing a hyphen character as the argument to one of the format\ntypes. This causes Nmap to deactivate interactive output, and\ninstead print results in the format you specified to the standard\noutput stream. So the command\nnmap -oX - target\nwill send only XML\noutput to stdout.  Serious errors may still be printed to the\nnormal error stream, stderr.\nUnlike some Nmap arguments, the space between the logfile option\nflag (such as\n-oX\n) and the filename or hyphen is mandatory. If you\nomit the flags and give arguments such as\n-oG-\nor\n-oXscan.xml\n, a\nbackwards compatibility feature of Nmap will cause the creation of\nnormal format\noutput files named G- and Xscan.xml respectively.\nAll of these arguments support\nstrftime\n-like conversions in the\nfilename.  %H, %M, %S, %m, %d, %y, and %Y are all exactly the same\nas in\nstrftime\n.  %T is the same as %H%M%S, %R is the same as %H%M,\nand %D is the same as %m%d%y. A % followed by any other character\njust yields that character (%% gives you a percent symbol). So\n-oX\n'scan-%T-%D.xml'\nwill use an XML file with a name in the form of\nscan-144840-121307.xml.\nNmap also offers options to control scan verbosity and to append\nto output files rather than clobbering them. All of these options\nare described below.\nNmap Output Formats\n-oN\nfilespec\n(normal output)\nRequests that normal output be directed to the given filename.\nAs discussed above, this differs slightly from interactive\noutput.\n-oX\nfilespec\n(XML output)\nRequests that XML output be directed to the given filename.\nNmap includes a document type definition (DTD) which allows\nXML parsers to validate Nmap XML output. While it is primarily\nintended for programmatic use, it can also help humans\ninterpret Nmap XML output. The DTD defines the legal elements\nof the format, and often enumerates the attributes and values\nthey can take on. The latest version is always available from\nhttps://svn.nmap.org/nmap/docs/nmap.dtd\n.\nXML offers a stable format that is easily parsed by software.\nFree XML parsers are available for all major computer\nlanguages, including C/C++, Perl, Python, and Java. People\nhave even written bindings for most of these languages to\nhandle Nmap output and execution specifically. Examples are\nNmap::Scanner\n[14] and\nNmap::Parser\n[15] in Perl CPAN. In almost\nall cases that a non-trivial application interfaces with Nmap,\nXML is the preferred format.\nThe XML output references an XSL stylesheet which can be used\nto format the results as HTML. The easiest way to use this is\nsimply to load the XML output in a web browser such as Firefox\nor IE. By default, this will only work on the machine you ran\nNmap on (or a similarly configured one) due to the hard-coded\nnmap.xsl filesystem path. Use the\n--webxml\nor\n--stylesheet\noptions to create portable XML files that render as HTML on\nany web-connected machine.\n-oS\nfilespec\n(ScRipT KIdd|3 oUTpuT)\nScript kiddie output is like interactive output, except that\nit is post-processed to better suit the l33t HaXXorZ who\npreviously looked down on Nmap due to its consistent\ncapitalization and spelling. Humor impaired people should note\nthat this option is making fun of the script kiddies before\nflaming me for supposedly âhelping themâ.\n-oG\nfilespec\n(grepable output)\nThis output format is covered last because it is deprecated.\nThe XML output format is far more powerful, and is nearly as\nconvenient for experienced users. XML is a standard for which\ndozens of excellent parsers are available, while grepable\noutput is my own simple hack. XML is extensible to support new\nNmap features as they are released, while I often must omit\nthose features from grepable output for lack of a place to put\nthem.\nNevertheless, grepable output is still quite popular. It is a\nsimple format that lists each host on one line and can be\ntrivially searched and parsed with standard Unix tools such as\ngrep, awk, cut, sed, diff, and Perl. Even I usually use it for\none-off tests done at the command line. Finding all the hosts\nwith the SSH port open or that are running Solaris takes only\na simple grep to identify the hosts, piped to an awk or cut\ncommand to print the desired fields.\nGrepable output consists of comments (lines starting with a\npound (#)) and target lines. A target line includes a\ncombination of six labeled fields, separated by tabs and\nfollowed with a colon. The fields are Host, Ports, Protocols,\nIgnored State, OS, Seq Index, IP ID, and Status.\nThe most important of these fields is generally Ports, which\ngives details on each interesting port. It is a comma\nseparated list of port entries. Each port entry represents one\ninteresting port, and takes the form of seven slash (/)\nseparated subfields. Those subfields are: Port number, State,\nProtocol, Owner, Service, SunRPC info, and Version info.\nAs with XML output, this man page does not allow for\ndocumenting the entire format. A more detailed look at the\nNmap grepable output format is available from\nhttps://nmap.org/book/output-formats-grepable-output.html\n.\n-oA\nbasename\n(Output to all formats)\nAs a convenience, you may specify\n-oA\nbasename\nto store scan\nresults in normal, XML, and grepable formats at once. They are\nstored in\nbasename\n.nmap,\nbasename\n.xml, and\nbasename\n.gnmap,\nrespectively. As with most programs, you can prefix the\nfilenames with a directory path, such as ~/nmaplogs/foocorp/\non Unix or c:\\hacking\\sco on Windows.\nVerbosity and debugging options\n-v\n(Increase verbosity level),\n-v\nlevel\n(Set verbosity level)\nIncreases the verbosity level, causing Nmap to print more\ninformation about the scan in progress. Open ports are shown\nas they are found and completion time estimates are provided\nwhen Nmap thinks a scan will take more than a few minutes. Use\nit twice or more for even greater verbosity:\n-vv\n, or give a\nverbosity level directly, for example\n-v3\n.\nMost changes only affect interactive output, and some also\naffect normal and script kiddie output. The other output types\nare meant to be processed by machines, so Nmap can give\nsubstantial detail by default in those formats without\nfatiguing a human user. However, there are a few changes in\nother modes where output size can be reduced substantially by\nomitting some detail. For example, a comment line in the\ngrepable output that provides a list of all ports scanned is\nonly printed in verbose mode because it can be quite long.\n-d\n(Increase debugging level),\n-d\nlevel\n(Set debugging level)\nWhen even verbose mode doesn't provide sufficient data for\nyou, debugging is available to flood you with much more! As\nwith the verbosity option (\n-v\n), debugging is enabled with a\ncommand-line flag (\n-d\n) and the debug level can be increased by\nspecifying it multiple times, as in\n-dd\n, or by setting a level\ndirectly. For example,\n-d9\nsets level nine. That is the\nhighest effective level and will produce thousands of lines\nunless you run a very simple scan with very few ports and\ntargets.\nDebugging output is useful when a bug is suspected in Nmap, or\nif you are simply confused as to what Nmap is doing and why.\nAs this feature is mostly intended for developers, debug lines\naren't always self-explanatory. You may get something like:\nTimeout vals: srtt: -1 rttvar: -1 to: 1000000 delta 14987 ==>\nsrtt: 14987 rttvar: 14987 to: 100000. If you don't understand\na line, your only recourses are to ignore it, look it up in\nthe source code, or request help from the development list\n(nmap-dev).  Some lines are self explanatory, but the messages\nbecome more obscure as the debug level is increased.\n--reason\n(Host and port state reasons)\nShows the reason each port is set to a specific state and the\nreason each host is up or down. This option displays the type\nof the packet that determined a port or hosts state. For\nexample, A RST packet from a closed port or an echo reply from\nan alive host. The information Nmap can provide is determined\nby the type of scan or ping. The SYN scan and SYN ping (\n-sS\nand\n-PS\n) are very detailed, but the TCP connect scan (\n-sT\n) is\nlimited by the implementation of the\nconnect\nsystem call. This\nfeature is automatically enabled by the debug option (\n-d\n) and\nthe results are stored in XML log files even if this option is\nnot specified.\n--stats-every\ntime\n(Print periodic timing stats)\nPeriodically prints a timing status message after each\ninterval of\ntime\n. The time is a specification of the kind\ndescribed in the section called âTIMING AND PERFORMANCEâ; so\nfor example, use\n--stats-every 10s\nto get a status update\nevery 10 seconds. Updates are printed to interactive output\n(the screen) and XML output.\n--packet-trace\n(Trace packets and data sent and received)\nCauses Nmap to print a summary of every packet sent or\nreceived. This is often used for debugging, but is also a\nvaluable way for new users to understand exactly what Nmap is\ndoing under the covers. To avoid printing thousands of lines,\nyou may want to specify a limited number of ports to scan,\nsuch as\n-p20-30\n. If you only care about the goings on of the\nversion detection subsystem, use\n--version-trace\ninstead. If\nyou only care about script tracing, specify\n--script-trace\n.\nWith\n--packet-trace\n, you get all of the above.\n--open\n(Show only open (or possibly open) ports)\nSometimes you only care about ports you can actually connect\nto (open ones), and don't want results cluttered with closed,\nfiltered, and closed|filtered ports. Output customization is\nnormally done after the scan using tools such as grep, awk,\nand Perl, but this feature was added due to overwhelming\nrequests. Specify\n--open\nto only see hosts with at least one\nopen, open|filtered, or unfiltered port, and only see ports in\nthose states. These three states are treated just as they\nnormally are, which means that open|filtered and unfiltered\nmay be condensed into counts if there are an overwhelming\nnumber of them.\nBeginning with Nmap 7.40, the\n--open\noption implies\n--defeat-rst-ratelimit\n, because that option only affects\nclosed and filtered ports, which are hidden by\n--open\n.\n--iflist\n(List interfaces and routes)\nPrints the interface list and system routes as detected by\nNmap and quits. This is useful for debugging routing problems\nor device mischaracterization (such as Nmap treating a PPP\nconnection as ethernet).\nMiscellaneous output options\n--append-output\n(Append to rather than clobber output files)\nWhen you specify a filename to an output format flag such as\n-oX\nor\n-oN\n, that file is overwritten by default. If you prefer\nto keep the existing content of the file and append the new\nresults, specify the\n--append-output\noption. All output\nfilenames specified in that Nmap execution will then be\nappended to rather than clobbered. This doesn't work well for\nXML (\n-oX\n) scan data as the resultant file generally won't\nparse properly until you fix it up by hand.\n--resume\nfilename\n(Resume aborted scan)\nSome extensive Nmap runs take a very long timeâon the order of\ndays. Such scans don't always run to completion. Restrictions\nmay prevent Nmap from being run during working hours, the\nnetwork could go down, the machine Nmap is running on might\nsuffer a planned or unplanned reboot, or Nmap itself could\ncrash. The administrator running Nmap could cancel it for any\nother reason as well, by pressing ctrl-C. Restarting the whole\nscan from the beginning may be undesirable. Fortunately, if\nscan output files were kept, the user can ask Nmap to resume\nscanning with the target it was working on when execution\nceased. Simply specify the\n--resume\noption and pass the output\nfile as its argument. No other arguments are permitted, as\nNmap parses the output file to use the same ones specified\npreviously. Simply call Nmap as\nnmap --resume\nlogfilename\n.\nNmap will append new results to the data files specified in\nthe previous execution. Scans can be resumed from any of the 3\nmajor output formats: Normal, Grepable, or XML\n--noninteractive\n(Disable runtime interactions)\nAt times, such as when running Nmap in a shell background, it\nmight be undesirable for Nmap to monitor and respond to user\nkeyboard input when running. (See the section called âRUNTIME\nINTERACTIONâ about how to control Nmap during a scan.) Use\noption\n--noninteractive\nto prevent Nmap taking control of the\nterminal.\n--stylesheet\npath or URL\n(Set XSL stylesheet to transform XML\noutput)\nNmap ships with an XSL stylesheet named nmap.xsl for viewing\nor translating XML output to HTML.  The XML output includes an\nxml-stylesheet directive which points to nmap.xml where it was\ninitially installed by Nmap. Run the XML file through an XSLT\nprocessor such as\nxsltproc\n[16] to produce an HTML file.\nDirectly opening the XML file in a browser no longer works\nwell because modern browsers limit the locations a stylesheet\nmay be loaded from. If you wish to use a different stylesheet,\nspecify it as the argument to\n--stylesheet\n. You must pass the\nfull pathname or URL. One common invocation is\n--stylesheet\nhttps://nmap.org/svn/docs/nmap.xsl\n. This tells an XSLT\nprocessor to load the latest version of the stylesheet from\nNmap.Org. The\n--webxml\noption does the same thing with less\ntyping and memorization. Loading the XSL from Nmap.Org makes\nit easier to view results on a machine that doesn't have Nmap\n(and thus nmap.xsl) installed. So the URL is often more\nuseful, but the local filesystem location of nmap.xsl is used\nby default for privacy reasons.\n--webxml\n(Load stylesheet from Nmap.Org)\nThis is a convenience option, nothing more than an alias for\n--stylesheet\nhttps://nmap.org/svn/docs/nmap.xsl\n.\n--no-stylesheet\n(Omit XSL stylesheet declaration from XML)\nSpecify this option to prevent Nmap from associating any XSL\nstylesheet with its XML output. The xml-stylesheet directive\nis omitted.\nMISCELLANEOUS OPTIONS\ntop\nThis section describes some important (and not-so-important)\noptions that don't really fit anywhere else.\n-6\n(Enable IPv6 scanning)\nNmap has IPv6 support for its most popular features. Ping\nscanning, port scanning, version detection, and the Nmap\nScripting Engine all support IPv6. The command syntax is the\nsame as usual except that you also add the\n-6\noption. Of\ncourse, you must use IPv6 syntax if you specify an address\nrather than a hostname. An address might look like\n3ffe:7501:4819:2000:210:f3ff:fe03:14d0, so hostnames are\nrecommended. The output looks the same as usual, with the IPv6\naddress on the âinteresting portsâ line being the only IPv6\ngiveaway.\nWhile IPv6 hasn't exactly taken the world by storm, it gets\nsignificant use in some (usually Asian) countries and most\nmodern operating systems support it. To use Nmap with IPv6,\nboth the source and target of your scan must be configured for\nIPv6. If your ISP (like most of them) does not allocate IPv6\naddresses to you, free tunnel brokers are widely available and\nwork fine with Nmap. I use the free IPv6 tunnel broker service\nat\nhttp://www.tunnelbroker.net\n. Other tunnel brokers are\nlisted at Wikipedia\n[17]. 6to4 tunnels are another popular,\nfree approach.\nOn Windows, raw-socket IPv6 scans are supported only on\nethernet devices (not tunnels), and only on Windows Vista and\nlater. Use the\n--unprivileged\noption in other situations.\n-A\n(Aggressive scan options)\nThis option enables additional advanced and aggressive\noptions. Presently this enables OS detection (\n-O\n), version\nscanning (\n-sV\n), script scanning (\n-sC\n) and traceroute\n(\n--traceroute\n).  More features may be added in the future. The\npoint is to enable a comprehensive set of scan options without\npeople having to remember a large set of flags. However,\nbecause script scanning with the default set is considered\nintrusive, you should not use\n-A\nagainst target networks\nwithout permission. This option only enables features, and not\ntiming options (such as\n-T4\n) or verbosity options (\n-v\n) that\nyou might want as well. Options which require privileges (e.g.\nroot access) such as OS detection and traceroute will only be\nenabled if those privileges are available.\n--datadir\ndirectoryname\n(Specify custom Nmap data file location)\nNmap obtains some special data at runtime in files named\nnmap-service-probes, nmap-services, nmap-protocols, nmap-rpc,\nnmap-mac-prefixes, and nmap-os-db. If the location of any of\nthese files has been specified (using the\n--servicedb\nor\n--versiondb\noptions), that location is used for that file.\nAfter that, Nmap searches these files in the directory\nspecified with the\n--datadir\noption (if any). Any files not\nfound there, are searched for in the directory specified by\nthe\nNMAPDIR\nenvironment variable. Next comes ~/.nmap for real\nand effective UIDs; or on Windows,\nHOME\n\\AppData\\Roaming\\nmap\n(where\nHOME\nis the user's home directory, like C:\\Users\\user).\nThis is followed by the location of the nmap executable and\nthe same location with ../share/nmap appended. Then a\ncompiled-in location such as /usr/local/share/nmap or\n/usr/share/nmap.\n--servicedb\nservices file\n(Specify custom services file)\nAsks Nmap to use the specified services file rather than the\nnmap-services data file that comes with Nmap. Using this\noption also causes a fast scan (\n-F\n) to be used. See the\ndescription for\n--datadir\nfor more information on Nmap's data\nfiles.\n--versiondb\nservice probes file\n(Specify custom service probes\nfile)\nAsks Nmap to use the specified service probes file rather than\nthe nmap-service-probes data file that comes with Nmap. See\nthe description for\n--datadir\nfor more information on Nmap's\ndata files.\n--send-eth\n(Use raw ethernet sending)\nAsks Nmap to send packets at the raw ethernet (data link)\nlayer rather than the higher IP (network) layer. By default,\nNmap chooses the one which is generally best for the platform\nit is running on. Raw sockets (IP layer) are generally most\nefficient for Unix machines, while ethernet frames are\nrequired for Windows operation since Microsoft disabled raw\nsocket support. Nmap still uses raw IP packets on Unix despite\nthis option when there is no other choice (such as\nnon-ethernet connections).\n--send-ip\n(Send at raw IP level)\nAsks Nmap to send packets via raw IP sockets rather than\nsending lower level ethernet frames. It is the complement to\nthe\n--send-eth\noption discussed previously.\n--privileged\n(Assume that the user is fully privileged)\nTells Nmap to simply assume that it is privileged enough to\nperform raw socket sends, packet sniffing, and similar\noperations that usually require root privileges on Unix\nsystems. By default Nmap quits if such operations are\nrequested but\ngeteuid\nis not zero.\n--privileged\nis useful\nwith Linux kernel capabilities and similar systems that may be\nconfigured to allow unprivileged users to perform raw-packet\nscans. Be sure to provide this option flag before any flags\nfor options that require privileges (SYN scan, OS detection,\netc.). The\nNMAP_PRIVILEGED\nenvironment variable may be set as\nan equivalent alternative to\n--privileged\n.\n--unprivileged\n(Assume that the user lacks raw socket privileges)\nThis option is the opposite of\n--privileged\n. It tells Nmap to\ntreat the user as lacking network raw socket and sniffing\nprivileges. This is useful for testing, debugging, or when the\nraw network functionality of your operating system is somehow\nbroken. The\nNMAP_UNPRIVILEGED\nenvironment variable may be set\nas an equivalent alternative to\n--unprivileged\n.\n--release-memory\n(Release memory before quitting)\nThis option is only useful for memory-leak debugging. It\ncauses Nmap to release allocated memory just before it quits\nso that actual memory leaks are easier to spot. Normally Nmap\nskips this as the OS does this anyway upon process\ntermination.\n-V\n;\n--version\n(Print version number)\nPrints the Nmap version number and exits.\n-h\n;\n--help\n(Print help summary page)\nPrints a short help screen with the most common command flags.\nRunning Nmap without any arguments does the same thing.\nRUNTIME INTERACTION\ntop\nDuring the execution of Nmap, all key presses are captured. This\nallows you to interact with the program without aborting and\nrestarting it. Certain special keys will change options, while any\nother keys will print out a status message telling you about the\nscan. The convention is that\nlowercase letters increase\nthe amount\nof printing, and\nuppercase letters decrease\nthe printing. You may\nalso press â\n?\nâ for help.\nv\n/\nV\nIncrease / decrease the verbosity level\nd\n/\nD\nIncrease / decrease the debugging Level\np\n/\nP\nTurn on / off packet tracing\n?\nPrint a runtime interaction help screen\nAnything else\nPrint out a status message like this:\nStats: 0:00:07 elapsed; 20 hosts completed (1 up), 1 undergoing Service Scan\nService scan Timing: About 33.33% done; ETC: 20:57 (0:00:12 remaining)\nEXAMPLES\ntop\nHere are some Nmap usage examples, from the simple and routine to\na little more complex and esoteric. Some actual IP addresses and\ndomain names are used to make things more concrete. In their place\nyou should substitute addresses/names from\nyour own network\n. While\nI don't think port scanning other networks is or should be\nillegal, some network administrators don't appreciate unsolicited\nscanning of their networks and may complain. Getting permission\nfirst is the best approach.\nFor testing purposes, you have permission to scan the host\nscanme.nmap.org.  This permission only includes scanning via Nmap\nand not testing exploits or denial of service attacks. To conserve\nbandwidth, please do not initiate more than a dozen scans against\nthat host per day. If this free scanning target service is abused,\nit will be taken down and Nmap will report Failed to resolve given\nhostname/IP: scanme.nmap.org. These permissions also apply to the\nhosts scanme2.nmap.org, scanme3.nmap.org, and so on, though those\nhosts do not currently exist.\nnmap -v scanme.nmap.org\nThis option scans all reserved TCP ports on the machine\nscanme.nmap.org . The\n-v\noption enables verbose mode.\nnmap -sS -O scanme.nmap.org/24\nLaunches a stealth SYN scan against each machine that is up out of\nthe 256 IPs on the /24 sized network where Scanme resides. It also\ntries to determine what operating system is running on each host\nthat is up and running. This requires root privileges because of\nthe SYN scan and OS detection.\nnmap -sV -p 22,53,110,143,4564 198.116.0-255.1-127\nLaunches host enumeration and a TCP scan at the first half of each\nof the 255 possible eight-bit subnets in the 198.116.0.0/16\naddress space. This tests whether the systems run SSH, DNS, POP3,\nor IMAP on their standard ports, or anything on port 4564. For any\nof these ports found open, version detection is used to determine\nwhat application is running.\nnmap -v -iR 100000 -Pn -p 80\nAsks Nmap to choose 100,000 hosts at random and scan them for web\nservers (port 80). Host enumeration is disabled with\n-Pn\nsince\nfirst sending a couple probes to determine whether a host is up is\nwasteful when you are only probing one port on each target host\nanyway.\nnmap -Pn -p80 -oX logs/pb-port80scan.xml -oG\nlogs/pb-port80scan.gnmap 216.163.128.20/20\nThis scans 4096 IPs for any web servers (without pinging them) and\nsaves the output in grepable and XML formats.\nNMAP BOOK\ntop\nWhile this reference guide details all material Nmap options, it\ncan't fully demonstrate how to apply those features to quickly\nsolve real-world tasks. For that, we released Nmap Network\nScanning: The Official Nmap Project Guide to Network Discovery and\nSecurity Scanning.  Topics include subverting firewalls and\nintrusion detection systems, optimizing Nmap performance, and\nautomating common networking tasks with the Nmap Scripting Engine.\nHints and instructions are provided for common Nmap tasks such as\ntaking network inventory, penetration testing, detecting rogue\nwireless access points, and quashing network worm outbreaks.\nExamples and diagrams show actual communication on the wire. More\nthan half of the book is available free online. See\nhttps://nmap.org/book\nfor more information.\nBUGS\ntop\nLike its author, Nmap isn't perfect. But you can help make it\nbetter by sending bug reports or even writing patches. If Nmap\ndoesn't behave the way you expect, first upgrade to the latest\nversion available from\nhttps://nmap.org\n. If the problem persists,\ndo some research to determine whether it has already been\ndiscovered and addressed. Try searching for the problem or error\nmessage on Google since that aggregates so many forums. If nothing\ncomes of this, create an Issue on our tracker (â\nhttp://issues.nmap.org\n) and/or mail a bug report to\n<dev@nmap.org>. If you subscribe to the nmap-dev list before\nposting, your message will bypass moderation and get through more\nquickly. Subscribe at\nhttps://nmap.org/mailman/listinfo/dev\n.\nPlease include everything you have learned about the problem, as\nwell as what version of Nmap you are using and what operating\nsystem version it is running on. Other suggestions for improving\nNmap may be sent to the Nmap dev mailing list as well.\nIf you are able to write a patch improving Nmap or fixing a bug,\nthat is even better! Instructions for submitting patches or git\npull requests are available from\nhttps://github.com/nmap/nmap/blob/master/CONTRIBUTING.md\nParticularly sensitive issues such as a security reports may be\nsent directly to Nmap's author Fyodor directly at\n<fyodor@nmap.org>. All other reports and comments should use the\ndev list or issue tracker instead because more people read,\nfollow, and respond to those.\nAUTHORS\ntop\nGordon âFyodorâ Lyon <fyodor@nmap.org> wrote and released Nmap in\n1997. Since then, hundreds of people have made valuable\ncontributions, as detailed in the CHANGELOG file distributed with\nNmap and also available from\nhttps://nmap.org/changelog.html\n.\nDavid Fifield and Daniel Miller deserve special recognition for\ntheir enormous multi-year contributions!\nLEGAL NOTICES\ntop\nNmap Copyright and Licensing\nThe Nmap Security Scanner is (C) 1996â2022 Nmap Software LLC (\"The\nNmap Project\"). Nmap is also a registered trademark of the Nmap\nProject. It is published under the\nNmap Public Source License\n[18].\nThis generally allows end users to download and use Nmap for free.\nIt doesn't allow Nmap to be used and redistributed within\ncommercial software or hardware products (including appliances,\nvirtual machines, and traditional applications). We fund the\nproject by selling a special Nmap OEM Edition for this purpose, as\ndescribed at\nhttps://nmap.org/oem\n. Hundreds of large and small\nsoftware vendors have already purchased OEM licenses to embed Nmap\ntechnology such as host discovery, port scanning, OS detection,\nversion detection, and the Nmap Scripting Engine within their\nproducts.\nThe Nmap Project has permission to redistribute Npcap, a packet\ncapturing driver and library for the Microsoft Windows platform.\nNpcap is a separate work with it's own license rather than this\nNmap license. Since the Npcap license does not permit\nredistribution without special permission, our Nmap Windows binary\npackages which contain Npcap may not be redistributed without\nspecial permission.\nEven though the NPSL is based on GPLv2, it contains different\nprovisions and is not directly compatible. It is incompatible with\nsome other open source licenses as well. In some cases we can\nrelicense portions of Nmap or grant special permissions to use it\nin other open source software. Please contact fyodor@nmap.org with\nany such requests. Similarly, we don't incorporate incompatible\nopen source software into Nmap without special permission from the\ncopyright holders.\nIf you have received a written license agreement or contract for\nNmap (such as an\nNmap OEM license\n[19]) stating terms other than\nthese, you may choose to use and redistribute Nmap under those\nterms instead.\nCreative Commons License for this Nmap Guide\nThis Nmap Reference Guide is (C) 2005â2022 Nmap Software LLC. It\nis hereby placed under version 3.0 of the\nCreative Commons\nAttribution License\n[20]. This allows you redistribute and modify\nthe work as you desire, as long as you credit the original source.\nAlternatively, you may choose to treat this document as falling\nunder the same license as Nmap itself (discussed previously).\nSource Code Availability and Community Contributions\nSource is provided to this software because we believe users have\na right to know exactly what a program is going to do before they\nrun it. This also allows you to audit the software for security\nholes.\nSource code also allows you to port Nmap to new platforms, fix\nbugs, and add new features. You are highly encouraged to submit\nyour changes as Github Pull Requests (PR) or send them to\n<dev@nmap.org> for possible incorporation into the main\ndistribution. By submitting such changes, it is assumed that you\nare offering the Nmap Project the unlimited, non-exclusive right\nto reuse, modify, and relicense the code. This is important\nbecause the inability to relicense code has caused devastating\nproblems for other Free Software projects (such as KDE and NASM).\nWe also sell commercial licenses to\nNmap OEM\n[21]. If you wish to\nspecify special license conditions of your contributions, just say\nso when you send them.\nNo Warranty\nThis program is distributed in the hope that it will be useful,\nbut WITHOUT ANY WARRANTY; without even the implied warranty of\nMERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\nIt should also be noted that Nmap has occasionally been known to\ncrash poorly written applications, TCP/IP stacks, and even\noperating systems.  While this is extremely rare, it is important\nto keep in mind.\nNmap should never be run against mission\ncritical systems\nunless you are prepared to suffer downtime. We\nacknowledge here that Nmap may crash your systems or networks and\nwe disclaim all liability for any damage or problems Nmap could\ncause.\nInappropriate Usage\nBecause of the slight risk of crashes and because a few black hats\nlike to use Nmap for reconnaissance prior to attacking systems,\nthere are administrators who become upset and may complain when\ntheir system is scanned. Thus, it is often advisable to request\npermission before doing even a light scan of a network.\nNmap should never be installed with special privileges (e.g. suid\nroot).  That would open up a major security vulnerability as other\nusers on the system (or attackers) could use it for privilege\nescalation.\nNmap is not designed, manufactured, or intended for use in\nhazardous environments requiring fail- safe performance where the\nfailure of the software could lead directly to death, personal\ninjury, or significant physical or environmental damage.\nThird-Party Software and Funding Notices\nThis product includes software developed by the\nApache Software\nFoundation\n[22]. A modified version of the\nLibpcap portable packet\ncapture library\n[23] is distributed along with Nmap. The Windows\nversion of Nmap utilizes the Libpcap-derived\nNcap library\n[24]\ninstead. Regular expression support is provided by the\nPCRE\nlibrary\n[25], which is open-source software, written by Philip\nHazel.  Certain raw networking functions use the\nLibdnet\n[26]\nnetworking library, which was written by Dug Song.  A modified\nversion is distributed with Nmap. Nmap can optionally link with\nthe\nOpenSSL cryptography toolkit\n[27] for SSL version detection\nsupport. The Nmap Scripting Engine uses an embedded version of the\nLua programming language\n[10].  The\nLiblinear linear classification\nlibrary\n[28] is used for our\nIPv6 OS detection machine learning\ntechniques\n[29].\nAll of the third-party software described in this paragraph is\nfreely redistributable under BSD-style software licenses.\nBinary packages for Windows and Mac OS X include support libraries\nnecessary to run Zenmap and Ndiff with Python and PyGTK. (Unix\nplatforms commonly make these libraries easy to install, so they\nare not part of the packages.) A listing of these support\nlibraries and their licenses is included in the LICENSES files.\nThis software was supported in part through the\nGoogle Summer of\nCode\n[30] and the\nDARPA CINDER program\n[31] (DARPA-BAA-10-84).\nUnited States Export Control\nNmap only uses encryption when compiled with the optional OpenSSL\nsupport and linked with OpenSSL. When compiled without OpenSSL\nsupport, the Nmap Project believes that Nmap is not subject to\nU.S.\nExport Administration Regulations (EAR)\n[32] export control.\nAs such, there is no applicable ECCN (export control\nclassification number) and exportation does not require any\nspecial license, permit, or other governmental authorization.\nWhen compiled with OpenSSL support or distributed as source code,\nthe Nmap Project believes that Nmap falls under U.S. ECCN\n5D002\n[33] (âInformation Security Softwareâ). We distribute Nmap\nunder the TSU exception for publicly available encryption software\ndefined in\nEAR 740.13(e)\n[34].\nNOTES\ntop\n1. Nmap Network Scanning: The Official Nmap Project Guide to\nNetwork Discovery and Security Scanning\nhttps://nmap.org/book/\n2. RFC 1122\nhttp://www.rfc-editor.org/rfc/rfc1122.txt\n3. RFC 792\nhttp://www.rfc-editor.org/rfc/rfc792.txt\n4. RFC 950\nhttp://www.rfc-editor.org/rfc/rfc950.txt\n5. UDP\nhttp://www.rfc-editor.org/rfc/rfc768.txt\n6. SCTP\nhttp://www.rfc-editor.org/rfc/rfc4960.txt\n7. TCP RFC\nhttp://www.rfc-editor.org/rfc/rfc793.txt\n8. RFC 959\nhttp://www.rfc-editor.org/rfc/rfc959.txt\n9. RFC 1323\nhttp://www.rfc-editor.org/rfc/rfc1323.txt\n10. Lua programming language\nhttps://lua.org\n11. precedence\nhttp://www.lua.org/manual/5.4/manual.html#3.4.8\n12. IP protocol\nhttp://www.rfc-editor.org/rfc/rfc791.txt\n13. RFC 2960\nhttp://www.rfc-editor.org/rfc/rfc2960.txt\n14. Nmap::Scanner\nhttp://sourceforge.net/projects/nmap-scanner/\n15. Nmap::Parser\nhttp://nmapparser.wordpress.com/\n16. xsltproc\nhttp://xmlsoft.org/XSLT/\n17. listed at Wikipedia\nhttp://en.wikipedia.org/wiki/List_of_IPv6_tunnel_brokers\n18. Nmap Public Source License\nhttps://nmap.org/npsl\n19. Nmap OEM license\nhttps://nmap.org/oem/\n20. Creative Commons Attribution License\nhttp://creativecommons.org/licenses/by/3.0/\n21. Nmap OEM\nhttps://nmap.org/oem\n22. Apache Software Foundation\nhttps://www.apache.org\n23. Libpcap portable packet capture library\nhttps://www.tcpdump.org\n24. Ncap library\nhttps://npcap.com\n25. PCRE library\nhttps://pcre.org\n26. Libdnet\nhttp://libdnet.sourceforge.net\n27. OpenSSL cryptography toolkit\nhttps://openssl.org\n28. Liblinear linear classification library\nhttps://www.csie.ntu.edu.tw/~cjlin/liblinear/\n29. IPv6 OS detection machine learning techniques\nhttps://nmap.org/book/osdetect-guess.html#osdetect-guess-ipv6\n30. Google Summer of Code\nhttps://nmap.org/soc/\n31. DARPA CINDER program\nhttps://www.fbo.gov/index?s=opportunity&mode=form&id=585e02a51f77af5cb3c9e06b9cc82c48&tab=core&_cview=1\n32. Export Administration Regulations (EAR)\nhttps://www.bis.doc.gov/index.php/regulations/export-administration-regulations-ear\n33. 5D002\nhttps://www.bis.doc.gov/index.php/documents/regulations-docs/federal-register-notices/federal-register-2014/951-ccl5-pt2/file\n34. EAR 740.13(e)\nhttps://www.bis.doc.gov/index.php/documents/regulations-docs/2341-740-2/file\nCOLOPHON\ntop\nThis page is part of the\nnmap\n(a network scanner) project.\nInformation about the project can be found at â¨\nhttp://nmap.org/\nâ©.\nIf you have a bug report for this manual page, send it to\ndev@nmap.org.  This page was obtained from the project's upstream\nGit mirror of the Subversion repository\nâ¨\nhttps://github.com/nmap/nmap\nâ© on 2025-09-06.  (At that time, the\ndate of the most recent commit that was found in the repository\nwas 2025-09-03.)  If you discover any rendering problems in this\nHTML version of the page, or you believe there is a better or more\nup-to-date source for the page, or you have corrections or\nimprovements to the information in this COLOPHON (which is\nnot\npart of the original manual page), send a mail to\nman-pages@man7.org\nNmap                            08/21/2025\nNMAP\n(1)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man1/nmap.1.html"}}
{"text": "lsof(8) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\nlsof(8) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nOPTIONS\n|\nAFS\n|\nSECURITY\n|\nOUTPUT\n|\nLOCKS\n|\nOUTPUT FOR OTHER PROGRAMS\n|\nBLOCKS AND TIMEOUTS\n|\nAVOIDING KERNEL BLOCKS\n|\nALTERNATE DEVICE NUMBERS\n|\nKERNEL NAME CACHE\n|\nDEVICE CACHE FILE\n|\nLSOF PERMISSIONS THAT AFFECT DEVICE CACHE FILE ACCESS\n|\nDEVICE CACHE FILE PATH FROM THE -D OPTION\n|\nDEVICE CACHE PATH FROM AN ENVIRONMENT VARIABLE\n|\nSYSTEM-WIDE DEVICE CACHE PATH\n|\nPERSONAL DEVICE CACHE PATH (DEFAULT)\n|\nMODIFIED PERSONAL DEVICE CACHE PATH\n|\nDIAGNOSTICS\n|\nEXAMPLES\n|\nBUGS\n|\nENVIRONMENT\n|\nFAQ\n|\nFILES\n|\nAUTHORS\n|\nDISTRIBUTION\n|\nSEE ALSO\n|\nCOLOPHON\nLSOF\n(8)                  System Manager's Manual\nLSOF\n(8)\nNAME\ntop\nlsof - list open files\nSYNOPSIS\ntop\nlsof\n[\n-?abChHlnNOPQRtUvVX\n] [\n-A\nA\n] [\n-c\nc\n] [\n+c\nc\n] [\n+|-d\nd\n]\n[\n+|-D\nD\n] [\n+|-e\ns\n] [\n+|-E\n] [\n+|-f [cfgGn]\n] [\n-F\n[f]\n] [\n-g\n[s]\n] [\n-i\n[i]\n] [\n-k\nk\n] [\n-K\nk\n] [\n+|-L\n[l]\n] [\n+|-m\nm\n] [\n+|-M\n] [\n-o\n[o]\n] [\n-p\ns\n] [\n+|-r\n[t[m<fmt>]]\n] [\n-s\n[p:s]\n] [\n-S\n[t]\n]\n[\n-T\n[t]\n] [\n-u\ns\n] [\n+|-w\n] [\n-x\n[fl]\n] [\n-z\n[z]\n] [\n-Z\n[Z]\n] [\n--\n] [\nnames\n]\nDESCRIPTION\ntop\nLsof\nrevision  lists on its standard output file information about\nfiles opened by processes for the following UNIX dialects:\n(See the\nDISTRIBUTION\nsection of this manual page for information\non how to obtain the latest\nlsof\nrevision.)\nAn open file may be a regular file, a directory, a block special\nfile, a character special file, an executing text reference, a\nlibrary, a stream or a network file (Internet socket, NFS file or\nUNIX domain socket.)  A specific file or all the files in a file\nsystem may be selected by path.\nInstead of a formatted display,\nlsof\nwill produce output that can\nbe parsed by other programs.  See the\n-F\n, option description, and\nthe\nOUTPUT FOR OTHER PROGRAMS\nsection for more information.\nIn addition to producing a single output list,\nlsof\nwill run in\nrepeat mode.  In repeat mode it will produce output, delay, then\nrepeat the output operation until stopped with an interrupt or\nquit signal.  See the\n+|-r\n[t[m<fmt>]]\noption description for more\ninformation.\nOPTIONS\ntop\nIn the absence of any options,\nlsof\nlists all open files belonging\nto all active processes.\nIf any list request option is specified, other list requests must\nbe specifically requested - e.g., if\n-U\nis specified for the\nlisting of UNIX socket files, NFS files won't be listed unless\n-N\nis also specified; or if a user list is specified with the\n-u\noption, UNIX domain socket files, belonging to users not in the\nlist, won't be listed unless the\n-U\noption is also specified.\nNormally, list options that are specifically stated are ORed -\ni.e., specifying the\n-i\noption without an address and the\n-u\nfoo\noption produces a listing of all network files OR files belonging\nto processes owned by user ``foo''.  The exceptions are:\n1) the `^' (negated) login name or user ID (UID), specified with\nthe\n-u\noption;\n2) the `^' (negated) process ID (PID), specified with the\n-p\noption;\n3) the `^' (negated) process group ID (PGID), specified with the\n-g\noption;\n4) the `^' (negated) command, specified with the\n-c\noption;\n5) the (`^') negated TCP or UDP protocol state names, specified\nwith the\n-s\n[p:s]\noption.\nSince they represent exclusions, they are applied without ORing or\nANDing and take effect before any other selection criteria are\napplied.\nThe\n-a\noption may be used to AND the selections.  For example,\nspecifying\n-a\n,\n-U\n, and\n-u\nfoo produces a listing of only UNIX\nsocket files that belong to processes owned by user ``foo''.\nCaution: the\n-a\noption causes all list selection options to be\nANDed; it can't be used to cause ANDing of selected pairs of\nselection options by placing it between them, even though its\nplacement there is acceptable.  Wherever\n-a\nis placed, it causes\nthe ANDing of all selection options.\nItems of the same selection set - command names, file descriptors,\nnetwork addresses, process identifiers, user identifiers, zone\nnames, security contexts - are joined in a single ORed set and\napplied before the result participates in ANDing.  Thus, for\nexample, specifying\n-i\n@aaa.bbb,\n-i\n@ccc.ddd,\n-a\n, and\n-u\nfff,ggg will\nselect the listing of files that belong to either login ``fff'' OR\n``ggg'' AND have network connections to either host aaa.bbb OR\nccc.ddd.\nOptions may be grouped together following a single prefix -- e.g.,\nthe option set ``\n-a -b -C\n'' may be stated as\n-abC\n.  However, since\nvalues are optional following\n+|-f\n,\n-F\n,\n-g\n,\n-i\n,\n+|-L\n,\n-o\n,\n+|-r\n,\n-s\n,\n-S\n,\n-T\n,\n-x\nand\n-z\n.  when you have no values for them be\ncareful that the following character isn't ambiguous.  For\nexample,\n-Fn\nmight represent the\n-F\nand\n-n\noptions, or it might\nrepresent the\nn\nfield identifier character following the\n-F\noption.  When ambiguity is possible, start a new option with a `-'\ncharacter - e.g., ``\n-F -n\n''.  If the next option is a file name,\nfollow the possibly ambiguous option with ``--'' - e.g., ``\n-F --\nname\n''.\nEither the `+' or the `-' prefix may be applied to a group of\noptions.  Options that don't take on separate meanings for each\nprefix - e.g.,\n-i\n- may be grouped under either prefix.  Thus, for\nexample, ``+M -i'' may be stated as ``+Mi'' and the group means\nthe same as the separate options.  Be careful of prefix grouping\nwhen one or more options in the group does take on separate\nmeanings under different prefixes - e.g.,\n+|-M\n; ``-iM'' is not the\nsame request as ``-i +M''.  When in doubt, use separate options\nwith appropriate prefixes.\n-? -h\nThese two equivalent options select a usage (help) output\nlist.\nLsof\ndisplays a shortened form of this output when\nit detects an error in the options supplied to it, after it\nhas displayed messages explaining each error.  (Escape the\n`?' character as your shell requires.)\n-a\ncauses list selection options to be ANDed, as described\nabove.\n-A\nA\nis available on systems configured for AFS whose AFS kernel\ncode is implemented via dynamic modules.  It allows the\nlsof\nuser to specify\nA\nas an alternate name list file where\nthe kernel addresses of the dynamic modules might be found.\nSee the\nlsof\nFAQ (The\nFAQ\nsection gives its location.)  for\nmore information about dynamic modules, their symbols, and\nhow they affect\nlsof\n.\n-b\ncauses\nlsof\nto avoid kernel functions that might block -\nlstat(2)\n,\nreadlink(2)\n, and\nstat(2)\n.\nSee the\nBLOCKS AND TIMEOUTS\nand\nAVOIDING KERNEL BLOCKS\nsections for information on using this option.\n-c\nc\nselects the listing of files for processes executing the\ncommand that begins with the characters of\nc\n.  Multiple\ncommands may be specified, using multiple\n-c\noptions.  They\nare joined in a single ORed set before participating in AND\noption selection.\nIf\nc\nbegins with a `^', then the following characters\nspecify a command name whose processes are to be ignored\n(excluded.)\nIf\nc\nbegins and ends with a slash ('/'), the characters\nbetween the slashes are interpreted as a regular\nexpression.  Shell meta-characters in the regular\nexpression must be quoted to prevent their interpretation\nby the shell.  The closing slash may be followed by these\nmodifiers:\nb    the regular expression is a basic one.\ni    ignore the case of letters.\nx    the regular expression is an extended one\n(default).\nSee the\nlsof\nFAQ (The\nFAQ\nsection gives its location.)  for\nmore information on basic and extended regular expressions.\nThe simple command specification is tested first.  If that\ntest fails, the command regular expression is applied.  If\nthe simple command test succeeds, the command regular\nexpression test isn't made.  This may result in ``no\ncommand found for regex:'' messages when lsof's\n-V\noption\nis specified.\n+c\nw\ndefines the maximum number of initial characters of the\nname, supplied by the UNIX dialect, of the UNIX command\nassociated with a process to be printed in the COMMAND\ncolumn.  (The\nlsof\ndefault is nine.)\nNote that many UNIX dialects do not supply all command name\ncharacters to\nlsof\nin the files and structures from which\nlsof\nobtains command name.  Often dialects limit the number\nof characters supplied in those sources.  For example,\nLinux 2.4.27 and Solaris 9 both limit command name length\nto 16 characters.\nIf\nw\nis zero ('0'), all command characters supplied to\nlsof\nby the UNIX dialect will be printed.\nIf\nw\nis less than the length of the column title,\n``COMMAND'', it will be raised to that length.\n-C\ndisables the reporting of any path name components from the\nkernel's name cache.  See the\nKERNEL NAME CACHE\nsection for\nmore information.\n+d\ns\ncauses\nlsof\nto search for all open instances of directory\ns\nand the files and directories it contains at its top level.\n+d\ndoes NOT descend the directory tree, rooted at\ns\n.  The\n+D\nD\noption may be used to request a full-descent directory\ntree search, rooted at directory\nD\n.\nProcessing of the\n+d\noption does not follow symbolic links\nwithin\ns\nunless the\n-x\nor\n-x  l\noption is also specified.\nNor does it search for open files on file system mount\npoints on subdirectories of\ns\nunless the\n-x\nor\n-x  f\noption\nis also specified.\nNote: the authority of the user of this option limits it to\nsearching for files that the user has permission to examine\nwith the system\nstat(2)\nfunction.\n-d\ns\nspecifies a list of file descriptors (FDs) to exclude from\nor include in the output listing.  The file descriptors are\nspecified in the comma-separated set\ns\n- e.g., ``cwd,1,3'',\n``^6,^2''.  (There should be no spaces in the set.)\nThe list is an exclusion list if all entries of the set\nbegin with `^'.  It is an inclusion list if no entry begins\nwith `^'.  Mixed lists are not permitted.\nA file descriptor number range may be in the set as long as\nneither member is empty, both members are numbers, and the\nending member is larger than the starting one - e.g.,\n``0-7'' or ``3-10''.  Ranges may be specified for exclusion\nif they have the `^' prefix - e.g., ``^0-7'' excludes all\nfile descriptors 0 through 7.\nMultiple file descriptor numbers are joined in a single\nORed set before participating in AND option selection.\nWhen there are exclusion and inclusion members in the set,\nlsof\nreports them as errors and exits with a non-zero\nreturn code.\nSee the description of File Descriptor (FD) output values\nin the\nOUTPUT\nsection for more information on file\ndescriptor names.\nfd\nis a pseudo file descriptor name for specifying the\nwhole range of possible file descriptor numbers.\nfd\ndoes\nnot appear in FD column of output.\n+D\nD\ncauses\nlsof\nto search for all open instances of directory\nD\nand all the files and directories it contains to its\ncomplete depth.\nProcessing of the\n+D\noption does not follow symbolic links\nwithin\nD\nunless the\n-x\nor\n-x  l\noption is also specified.\nNor does it search for open files on file system mount\npoints on subdirectories of\nD\nunless the\n-x\nor\n-x  f\noption\nis also specified.\nNote: the authority of the user of this option limits it to\nsearching for files that the user has permission to examine\nwith the system\nstat(2)\nfunction.\nFurther note:\nlsof\nmay process this option slowly and\nrequire a large amount of dynamic memory to do it.  This is\nbecause it must descend the entire directory tree, rooted\nat\nD\n, calling\nstat(2)\nfor each file and directory, building\na list of all the files it finds, and searching that list\nfor a match with every open file.  When directory\nD\nis\nlarge, these steps can take a long time, so use this option\nprudently.\n-D\nD\ndirects\nlsof's\nuse of the device cache file.  The use of\nthis option is sometimes restricted.  See the\nDEVICE CACHE\nFILE\nsection and the sections that follow it for more\ninformation on this option.\n-D\nmust be followed by a function letter; the function\nletter may optionally be followed by a path name.\nLsof\nrecognizes these function letters:\n?\n- report device cache file paths\nb\n- build the device cache file\ni\n- ignore the device cache file\nr\n- read the device cache file\nu\n- read and update the device cache file\nThe\nb\n,\nr\n, and\nu\nfunctions, accompanied by a path name, are\nsometimes restricted.  When these functions are restricted,\nthey will not appear in the description of the\n-D\noption\nthat accompanies\n-h\nor\n-?\noption output.  See the\nDEVICE\nCACHE FILE\nsection and the sections that follow it for more\ninformation on these functions and when they're restricted.\nThe\n?\nfunction reports the read-only and write paths that\nlsof can use for the device cache file, the names of any\nenvironment variables whose values\nlsof\nwill examine when\nforming the device cache file path, and the format for the\npersonal device cache file path.  (Escape the `?' character\nas your shell requires.)\nWhen available, the\nb\n,\nr\n, and\nu\nfunctions may be followed\nby the device cache file's path.  The standard default is\n.lsof_hostname\nin the home directory of the real user ID\nthat executes\nlsof\n, but this could have been changed when\nlsof\nwas configured and compiled.  (The output of the\n-h\nand\n-?\noptions show the current default prefix - e.g.,\n``.lsof''.)  The suffix,\nhostname\n, is the first component\nof the host's name returned by\ngethostname(2)\n.\nWhen available, the\nb\nfunction directs\nlsof\nto build a new\ndevice cache file at the default or specified path.\nThe\ni\nfunction directs\nlsof\nto ignore the default device\ncache file and obtain its information about devices via\ndirect calls to the kernel.\nThe\nr\nfunction directs\nlsof\nto read the device cache at the\ndefault or specified path, but prevents it from creating a\nnew device cache file when none exists or the existing one\nis improperly structured.  The\nr\nfunction, when specified\nwithout a path name, prevents\nlsof\nfrom updating an\nincorrect or outdated device cache file, or creating a new\none in its place.  The\nr\nfunction is always available when\nit is specified without a path name argument; it may be\nrestricted by the permissions of the\nlsof\nprocess.\nWhen available, the\nu\nfunction directs\nlsof\nto read the\ndevice cache file at the default or specified path, if\npossible, and to rebuild it, if necessary.  This is the\ndefault device cache file function when no\n-D\noption has\nbeen specified.\n+|-e\ns\nexempts the file system whose path name is\ns\nfrom being\nsubjected to kernel function calls that might block.  The\n+e\noption exempts\nstat(2)\n,\nlstat(2)\nand most\nreadlink(2)\nkernel function calls.  The\n-e\noption exempts only\nstat(2)\nand\nlstat(2)\nkernel function calls.  Multiple file systems\nmay be specified with separate\n+|-e\nspecifications and each\nmay have\nreadlink(2)\ncalls exempted or not.\nThis option is currently implemented only for Linux.\nCAUTION:\nthis option can easily be mis-applied to other\nthan the file system of interest, because it uses path name\nrather than the more reliable device and inode numbers.\n(Device and inode numbers are acquired via the potentially\nblocking\nstat(2)\nkernel call and are thus not available,\nbut see the\n+|-m\nm\noption as a possible alternative way to\nsupply device numbers.)\nUse this option with great care\nand fully specify the path name of the file system to be\nexempted.\nWhen open files on exempted file systems are reported, it\nmay not be possible to obtain all their information.\nTherefore, some information columns will be blank, the\ncharacters ``UNKN'' preface the values in the TYPE column,\nand the applicable exemption option is added in parentheses\nto the end of the NAME column.  (Some device number\ninformation might be made available via the\n+|-m\nm\noption.)\n+|-E   +E\nspecifies that Linux pipe, Linux UNIX socket, Linux\nINET(6) socket closed in a local host, Linux pseudoterminal\nfiles, POSIX Message Queueue implementation in Linux, and\nLinux eventfd should be displayed with endpoint information\nand the files of the endpoints should also be displayed.\nNote 1: UNIX socket file endpoint information is only\navailable when the features enabled line of\n-v\noutput\ncontains uxsockept, and psudoterminal endpoint information\nis only available when the features enabled line contains\nptyept.\nNote 2: POSIX Message Queue file endpoint information is\nonly available when mqueue file system is mounted.\nPipe endpoint information is displayed in the NAME column\nin the form ``\nPID,cmd,FDmode\n'', where\nPID\nis the endpoint\nprocess ID;\ncmd\nis the endpoint process command;\nFD\nis the\nendpoint file's descriptor; and\nmode\nis the endpoint file's\naccess mode.\nPseudoterminal endpoint information is displayed in the\nNAME column as ``->/dev/pts\nmin PID,cmd,FDmode\n'' or\n``\nPID,cmd,FDmode\n''.  The first form is for a master device;\nthe second, for a slave device.\nmin\nis a slave device's\nminor device number; and\nPID, cmd, FD\nand\nmode\nare the same\nas with pipe endpoint information.  Note: psudoterminal\nendpoint information is only available when the features\nenabled line of\n-v\noutput contains ptyept. In addition,\nthis feature works on Linux kernels above 4.13.0.\nUNIX socket file endpoint information is displayed in the\nNAME column in the form\n``type=\nTYPE\n->INO=\nINODE PID,cmd,FDmode\n'', where\nTYPE\nis the\nsocket type;\nINODE\nis the i-node number of the connected\nsocket; and\nPID, cmd, FD\nand\nmode\nare the same as with pipe\nendpoint information.  Note: UNIX socket file endpoint\ninformation is available only when the features enabled\nline of\n-v\noutput contains uxsockept.\nINET socket file endpoint information is inserted to the\nvalue at the NAME column in the form\n`` ->\nPID,cmd,FDmode\n'', where\nPID, cmd, FD\nand\nmode\nare the\nsame as with pipe endpoint information. The endpoint\ninformation is available only if the socket is used for\nlocal IPC; both endpoints bind to the same local IPv4 or\nIPv6 address.\nPOSIX Message Queue file endpoint information is displayed\nin the NAME column in the same form as that of pipe.\neventfd endpoint information is displayed in the NAME\ncolumn in the same form as that of pipe. This feature works\non Linux kernels above 5.2.0.\nMultiple occurrences of this information can appear in a\nfile's NAME column.\n-E\nspecifies that endpoint supported files should be\ndisplayed with endpoint information, but not the files of\nthe endpoints.\n+|-f [cfgGn]\nf\nby itself clarifies how path name arguments are to be\ninterpreted.  When followed by\nc\n,\nf\n,\ng\n,\nG\n, or\nn\nin any\ncombination it specifies that the listing of kernel file\nstructure information is to be enabled (`+') or inhibited\n(`-').\nNormally a path name argument is taken to be a file system\nname if it matches a mounted-on directory name reported by\nmount(8)\n, or if it represents a block device, named in the\nmount\noutput and associated with a mounted directory name.\nWhen\n+f\nis specified, all path name arguments will be taken\nto be file system names, and\nlsof\nwill complain if any are\nnot.  This can be useful, for example, when the file system\nname (mounted-on device) isn't a block device.  This\nhappens for some CD-ROM file systems.\nWhen\n-f\nis specified by itself, all path name arguments\nwill be taken to be simple files.  Thus, for example, the\n``\n-f\n-- /'' arguments direct lsof to search for open files\nwith a `/' path name, not all open files in the `/' (root)\nfile system.\nBe careful to make sure\n+f\nand\n-f\nare properly terminated\nand aren't followed by a character (e.g., of the file or\nfile system name) that might be taken as a parameter.  For\nexample, use ``--'' after\n+f\nand\n-f\nas in these examples.\n$ lsof +f -- /file/system/name\n$ lsof -f -- /file/name\nThe listing of information from kernel file structures,\nrequested with the\n+f [cfgGn]\noption form, is normally\ninhibited, and is not available in whole or part for some\ndialects - e.g., /proc-based Linux kernels below 2.6.22.\nWhen the prefix to\nf\nis a plus sign (`+'), these characters\nrequest file structure information:\nc\nfile structure use count (not Linux)\nf\nfile structure address (not Linux)\ng\nfile flag abbreviations (Linux 2.6.22 and up)\nAbbrev.   Flag in C code (see open(2))\nW\nO_WRONLY\nRW\nO_RDWR\nCR\nO_CREAT\nEXCL\nO_EXCL\nNTTY\nO_NOCTTY\nTR\nO_TRUNC\nAP\nO_APPEND\nND\nO_NDELAY\nSYN\nO_SYNC\nASYN\nO_ASYNC\nDIR\nO_DIRECT\nDTY\nO_DIRECTORY\nNFLK\nO_NOFOLLOW\nNATM\nO_NOATIME\nDSYN\nO_DSYNC\nRSYN\nO_RSYNC\nLG\nO_LARGEFILE\nCX\nO_CLOEXEC\nTMPF\nO_TMPFILE\nG\nfile flags in hexadecimal (Linux 2.6.22 and up)\nn\nfile structure node address (not Linux)\nWhen the prefix is minus (`-') the same characters disable\nthe listing of the indicated values.\nFile structure addresses, use counts, flags, and node\naddresses may be used to detect more readily identical\nfiles inherited by child processes and identical files in\nuse by different processes.\nLsof\ncolumn output can be\nsorted by output columns holding the values and listed to\nidentify identical file use, or\nlsof\nfield output can be\nparsed by an AWK or Perl post-filter script, or by a C\nprogram.\n-F\nf\nspecifies a character list,\nf\n, that selects the fields to\nbe output for processing by another program, and the\ncharacter that terminates each output field.  Each field to\nbe output is specified with a single character in\nf\n.  The\nfield terminator defaults to NL, but may be changed to NUL\n(000).  See the\nOUTPUT FOR OTHER PROGRAMS\nsection for a\ndescription of the field identification characters and the\nfield output process.\nWhen the field selection character list is empty, all\nstandard fields are selected (except the raw device field,\nsecurity context and zone field for compatibility reasons)\nand the NL field terminator is used.\nWhen the field selection character list contains only a\nzero (`0'), all fields are selected (except the raw device\nfield for compatibility reasons) and the NUL terminator\ncharacter is used.\nOther combinations of fields and their associated field\nterminator character must be set with explicit entries in\nf\n, as described in the\nOUTPUT FOR OTHER PROGRAMS\nsection.\nWhen a field selection character identifies an item\nlsof\ndoes not normally list - e.g., PPID, selected with\n-R\n-\nspecification of the field character - e.g., ``\n-FR\n'' - also\nselects the listing of the item.\nWhen the field selection character list contains the single\ncharacter `?',\nlsof\nwill display a help list of the field\nidentification characters.  (Escape the `?' character as\nyour shell requires.)\n-g\n[s]\nexcludes or selects the listing of files for the processes\nwhose optional process group IDentification (PGID) numbers\nare in the comma-separated set\ns\n- e.g., ``123'' or\n``123,^456''.  (There should be no spaces in the set.)\nPGID numbers that begin with `^' (negation) represent\nexclusions.\nMultiple PGID numbers are joined in a single ORed set\nbefore participating in AND option selection.  However,\nPGID exclusions are applied without ORing or ANDing and\ntake effect before other selection criteria are applied.\nThe\n-g\noption also enables the output display of PGID\nnumbers.  When specified without a PGID set that's all it\ndoes.\n-H\ndirects lsof to print human readable sizes, e.g. 123.4K\n456.7M.\n-i\n[i]\nselects the listing of files any of whose Internet address\nmatches the address specified in\ni\n.  If no address is\nspecified, this option selects the listing of all Internet\nand x.25 (HP-UX) network files.\nIf\n-i\n4\nor\n-i\n6\nis specified with no following address, only\nfiles of the indicated IP version, IPv4 or IPv6, are\ndisplayed.  (An IPv6 specification may be used only if the\ndialects supports IPv6, as indicated by ``[46]'' and\n``IPv[46]'' in\nlsof's\n-h\nor\n-?\noutput.)  Sequentially\nspecifying\n-i\n4, followed by\n-i\n6 is the same as specifying\n-i\n, and vice-versa.  Specifying\n-i\n4, or\n-i\n6 after\n-i\nis the\nsame as specifying\n-i\n4 or\n-i\n6 by itself.\nMultiple addresses (up to a limit of 100) may be specified\nwith multiple\n-i\noptions.  (A port number or service name\nrange is counted as one address.)  They are joined in a\nsingle ORed set before participating in AND option\nselection.\nAn Internet address is specified in the form (Items in\nsquare brackets are optional.):\n[\n46\n][\nprotocol\n][@\nhostname\n|\nhostaddr\n][:\nservice\n|\nport\n]\nwhere:\n46\nspecifies the IP version, IPv4 or IPv6\nthat applies to the following address.\n'6' may be be specified only if the UNIX\ndialect supports IPv6.  If neither '4' nor\n'6' is specified, the following address\napplies to all IP versions.\nprotocol\nis a protocol name -\nTCP\n,\nUDP\nor\nUDPLITE\n.\nhostname\nis an Internet host name.  Unless a\nspecific IP version is specified, open\nnetwork files associated with host names\nof all versions will be selected.\nhostaddr\nis a numeric Internet IPv4 address in\ndot form; or an IPv6 numeric address in\ncolon form, enclosed in brackets, if the\nUNIX dialect supports IPv6.  When an IP\nversion is selected, only its numeric\naddresses may be specified.\nservice\nis an\n/etc/services\nname - e.g.,\nsmtp\n-\nor a list of them.\nport\nis a port number, or a list of them.\nIPv6 options may be used only if the UNIX dialect supports\nIPv6.  To see if the dialect supports IPv6, run\nlsof\nand\nspecify the\n-h\nor\n-?\n(help) option.  If the displayed\ndescription of the\n-i\noption contains ``[46]'' and\n``IPv[46]'', IPv6 is supported.\nIPv4 host names and addresses may not be specified if\nnetwork file selection is limited to IPv6 with\n-i\n6.  IPv6\nhost names and addresses may not be specified if network\nfile selection is limited to IPv4 with\n-i\n4.  When an open\nIPv4 network file's address is mapped in an IPv6 address,\nthe open file's type will be IPv6, not IPv4, and its\ndisplay will be selected by '6', not '4'.\nAt least one address component -\n4, 6,\nprotocol\n,\nhostname\n,\nhostaddr\n, or\nservice\n- must be supplied.  The `@'\ncharacter, leading the host specification, is always\nrequired; as is the `:', leading the port specification.\nSpecify either\nhostname\nor\nhostaddr\n.  Specify either\nservice\nname list or\nport\nnumber list.  If a\nservice\nname\nlist is specified, the\nprotocol\nmay also need to be\nspecified if the TCP, UDP and UDPLITE port numbers for the\nservice name are different.  Use any case - lower or upper\n- for\nprotocol\n.\nService\nnames and\nport\nnumbers may be combined in a list\nwhose entries are separated by commas and whose numeric\nrange entries are separated by minus signs.  There may be\nno embedded spaces, and all service names must belong to\nthe specified\nprotocol\n.  Since service names may contain\nembedded minus signs, the starting entry of a range can't\nbe a service name; it can be a port number, however.\nHere are some sample addresses:\n-i6 - IPv6 only\nTCP:25 - TCP and port 25\n@1.2.3.4 - Internet IPv4 host address 1.2.3.4\n@[3ffe:1ebc::1]:1234 - Internet IPv6 host address\n3ffe:1ebc::1, port 1234\nUDP:who - UDP who service port\nTCP@lsof.itap:513 - TCP, port 513 and host name lsof.itap\ntcp@foo:1-10,smtp,99 - TCP, ports 1 through 10,\nservice name\nsmtp\n, port 99, host name foo\ntcp@bar:1-smtp - TCP, ports 1 through\nsmtp\n, host bar\n:time - either TCP, UDP or UDPLITE time service port\n-K\nk\nselects the listing of tasks (threads) of processes, on\ndialects where task (thread) reporting is supported.  (If\nhelp output - i.e., the output of the\n-h\nor\n-?\noptions -\nshows this option, then task (thread) reporting is\nsupported by the dialect.)\nIf\n-K\nis followed by a value,\nk\n, it must be ``i''.  That\ncauses\nlsof\nto ignore tasks, particularly in the default,\nlist-everything case when no other options are specified.\nWhen\n-K\nand\n-a\nare both specified on Linux, and the tasks\nof a main process are selected by other options, the main\nprocess will also be listed as though it were a task, but\nwithout a task ID.  (See the description of the TID column\nin the\nOUTPUT\nsection.)\nWhere the FreeBSD version supports threads, all threads\nwill be listed with their IDs.\nIn general threads and tasks inherit the files of the\ncaller, but may close some and open others, so\nlsof\nalways\nreports all the open files of threads and tasks.\n-k\nk\nspecifies a kernel name list file,\nk\n, in place of /vmunix,\n/mach, etc.\n-k\nis not available under AIX on the IBM\nRISC/System 6000.\n-l\ninhibits the conversion of user ID numbers to login names.\nIt is also useful when login name lookup is working\nimproperly or slowly.\n+|-L\n[l]\nenables (`+') or disables (`-') the listing of file link\ncounts, where they are available - e.g., they aren't\navailable for sockets, or most FIFOs and pipes.\nWhen\n+L\nis specified without a following number, all link\ncounts will be listed.  When\n-L\nis specified (the default),\nno link counts will be listed.\nWhen\n+L\nis followed by a number, only files having a link\ncount less than that number will be listed.  (No number may\nfollow\n-L\n.)  A specification of the form ``\n+L1\n'' will\nselect open files that have been unlinked.  A specification\nof the form ``\n+aL1\n<file_system>\n'' will select unlinked\nopen files on the specified file system.\nFor other link count comparisons, use field output (\n-F\n) and\na post-processing script or program.\n+|-m\nm\nspecifies an alternate kernel memory file or activates\nmount table supplement processing.\nThe option form\n-m\nm\nspecifies a kernel memory file,\nm\n, in\nplace of\n/dev/kmem\nor\n/dev/mem\n- e.g., a crash dump file.\nThe option form\n+m\nrequests that a mount supplement file be\nwritten to the standard output file.  All other options are\nsilently ignored.\nThere will be a line in the mount supplement file for each\nmounted file system, containing the mounted file system\ndirectory, followed by a single space, followed by the\ndevice number in hexadecimal \"0x\" format - e.g.,\n/ 0x801\nLsof\ncan use the mount supplement file to get device\nnumbers for file systems when it can't get them via\nstat(2)\nor\nlstat(2)\n.\nThe option form\n+m\nm\nidentifies\nm\nas a mount supplement\nfile.\nNote: the\n+m\nand\n+m\nm\noptions are not available for all\nsupported dialects.  Check the output of\nlsof's\n-h\nor\n-?\noptions to see if the\n+m\nand\n+m\nm\noptions are available.\n+|-M\nEnables (\n+\n) or disables (\n-\n) the reporting of portmapper\nregistrations for local TCP, UDP and UDPLITE ports, where\nport mapping is supported.  (See the last paragraph of this\noption description for information about where portmapper\nregistration reporting is supported.)\nThe default reporting mode is set by the\nlsof\nbuilder with\nthe HASPMAPENABLED #define in the dialect's machine.h\nheader file;\nlsof\nis distributed with the HASPMAPENABLED\n#define deactivated, so portmapper reporting is disabled by\ndefault and must be requested with\n+M\n.  Specifying\nlsof's\n-h\nor\n-?\noption will report the default mode.  Disabling\nportmapper registration when it is already disabled or\nenabling it when already enabled is acceptable.  When\nportmapper registration reporting is enabled,\nlsof\ndisplays\nthe portmapper registration (if any) for local TCP, UDP or\nUDPLITE ports in square brackets immediately following the\nport numbers or service names - e.g., ``:1234[name]'' or\n``:name[100083]''.  The registration information may be a\nname or number, depending on what the registering program\nsupplied to the portmapper when it registered the port.\nWhen portmapper registration reporting is enabled,\nlsof\nmay\nrun a little more slowly or even become blocked when access\nto the portmapper becomes congested or stopped.  Reverse\nthe reporting mode to determine if portmapper registration\nreporting is slowing or blocking\nlsof\n.\nFor purposes of portmapper registration reporting\nlsof\nconsiders a TCP, UDP or UDPLITE port local if: it is found\nin the local part of its containing kernel structure; or if\nit is located in the foreign part of its containing kernel\nstructure and the local and foreign Internet addresses are\nthe same; or if it is located in the foreign part of its\ncontaining kernel structure and the foreign Internet\naddress is INADDR_LOOPBACK (127.0.0.1).  This rule may make\nlsof\nignore some foreign ports on machines with multiple\ninterfaces when the foreign Internet address is on a\ndifferent interface from the local one.\nSee the\nlsof\nFAQ (The\nFAQ\nsection gives its location.)  for\nfurther discussion of portmapper registration reporting\nissues.\nPortmapper registration reporting is supported only on\ndialects that have RPC header files.  (Some Linux\ndistributions with GlibC 2.14 do not have them.)  When\nportmapper registration reporting is supported, the\n-h\nor\n-?\nhelp output will show the\n+|-M\noption.\n-n\ninhibits the conversion of network numbers to host names\nfor network files.  Inhibiting conversion may make\nlsof\nrun\nfaster.  It is also useful when host name lookup is not\nworking properly.\n-N\nselects the listing of NFS files.\n-o\ndirects\nlsof\nto display file offset at all times.  It\ncauses the SIZE/OFF output column title to be changed to\nOFFSET.  Note: on some UNIX dialects\nlsof\ncan't obtain\naccurate or consistent file offset information from its\nkernel data sources, sometimes just for particular kinds of\nfiles (e.g., socket files.)  Consult the\nlsof\nFAQ (The\nFAQ\nsection gives its location.)  for more information.\nThe\n-o\nand\n-s\noptions are mutually exclusive; they can't\nboth be specified.  When neither is specified,\nlsof\ndisplays whatever value - size or offset - is appropriate\nand available for the type of the file.\n-o\no\ndefines the number of decimal digits (\no\n) to be printed\nafter the ``0t'' for a file offset before the form is\nswitched to ``0x...''.  An\no\nvalue of zero (unlimited)\ndirects\nlsof\nto use the ``0t'' form for all offset output.\nThis option does NOT direct\nlsof\nto display offset at all\ntimes; specify\n-o\n(without a trailing number) to do that.\n-o\no\nonly specifies the number of digits after ``0t'' in\neither mixed size and offset or offset-only output.  Thus,\nfor example, to direct\nlsof\nto display offset at all times\nwith a decimal digit count of 10, use:\n-o -o 10\nor\n-oo10\nThe default number of digits allowed after ``0t'' is\nnormally 8, but may have been changed by the lsof builder.\nConsult the description of the\n-o\no\noption in the output of\nthe\n-h\nor\n-?\noption to determine the default that is in\neffect.\n-O\ndirects\nlsof\nto bypass the strategy it uses to avoid being\nblocked by some kernel operations - i.e., doing them in\nforked child processes.  See the\nBLOCKS AND TIMEOUTS\nand\nAVOIDING KERNEL BLOCKS\nsections for more information on\nkernel operations that may block\nlsof\n.\nWhile use of this option will reduce\nlsof\nstartup overhead,\nit may also cause\nlsof\nto hang when the kernel doesn't\nrespond to a function.  Use this option cautiously.\n-p\ns\nexcludes or selects the listing of files for the processes\nwhose optional process IDentification (PID) numbers are in\nthe comma-separated set\ns\n- e.g., ``123'' or ``123,^456''.\n(There should be no spaces in the set.)\nPID numbers that begin with `^' (negation) represent\nexclusions.\nMultiple process ID numbers are joined in a single ORed set\nbefore participating in AND option selection.  However, PID\nexclusions are applied without ORing or ANDing and take\neffect before other selection criteria are applied.\n-P\ninhibits the conversion of port numbers to port names for\nnetwork files (the mapping is commonly learned from\n/etc/services).  Inhibiting the conversion may make\nlsof\nrun a little faster.  It is also useful when port name\nlookup is not working properly.\n-Q\nignore failed search terms. When\nlsof\nis told to search for\nusers of a file, or for users of a device, or for a\nspecific PID, or for certain protocols in use by that PID,\nand so on,\nlsof\nwill return an error if any of the search\nresults are empty. The\n-Q\noption will change this behavior\nso that\nlsof\nwill instead return a successful exit code (0)\neven if any of the search results are empty. In addition,\nmissing search terms will not be reported to stderr.\n+|-r\n[t[c<N>][m<fmt>]]\nputs\nlsof\nin repeat mode.  There\nlsof\nlists open files as\nselected by other options, delays\nt\nseconds (default\nfifteen), then repeats the listing, delaying and listing\nrepetitively until stopped by a condition defined by the\nprefix to the option.\nIf the prefix is a `-', repeat mode is endless.\nLsof\nmust\nbe terminated with an interrupt or quit signal.  `c<N>' is\nfor specifying the limits of repeating; if the number of\niterations reaches at `<N>',\nLsof\nstops itself.\nIf the prefix is `+', repeat mode will end the first cycle\nno open files are listed - and of course when\nlsof\nis\nstopped with an interrupt or quit signal.  When repeat mode\nends because no files are listed, the process exit code\nwill be zero if any open files were ever listed; one, if\nnone were ever listed.\nLsof\nmarks the end of each listing: if field output is in\nprogress (the\n-F\n, option has been specified), the default\nmarker is `m'; otherwise the default marker is\n``========''.  The marker is followed by a NL character.\nThe optional \"m<fmt>\" argument specifies a format for the\nmarker line.  The <fmt> characters following `m' are\ninterpreted as a format specification to the\nstrftime(3)\nfunction, when both it and the\nlocaltime(3)\nfunction are\navailable in the dialect's C library.  Consult the\nstrftime(3)\ndocumentation for what may appear in its format\nspecification.  Note that when field output is requested\nwith the\n-F\noption, <fmt> cannot contain the NL format,\n``%n''.  Note also that when <fmt> contains spaces or other\ncharacters that affect the shell's interpretation of\narguments, <fmt> must be quoted appropriately.\nRepeat mode reduces\nlsof\nstartup overhead, so it is more\nefficient to use this mode than to call\nlsof\nrepetitively\nfrom a shell script, for example.\nTo use repeat mode most efficiently, accompany\n+|-r\nwith\nspecification of other\nlsof\nselection options, so the\namount of kernel memory access\nlsof\ndoes will be kept to a\nminimum.  Options that filter at the process level - e.g.,\n-c\n,\n-g\n,\n-p\n,\n-u\n- are the most efficient selectors.\nRepeat mode is useful when coupled with field output (see\nthe\n-F\n, option description) and a supervising\nawk\nor\nPerl\nscript, or a C program.\n-R\ndirects lsof to list the Parent Process IDentification\nnumber in the PPID column.\n-s\n[p:s]\ns\nalone directs\nlsof\nto display file size at all times.  It\ncauses the SIZE/OFF output column title to be changed to\nSIZE.  If the file does not have a size, nothing is\ndisplayed.\nThe optional\n-s\np:s\nform is available only for selected\ndialects, and only when the\n-h\nor\n-?\nhelp output lists it.\nWhen the optional form is available, the\ns\nmay be followed\nby a protocol name (\np\n), either TCP or UDP, a colon (`:')\nand a comma-separated protocol state name list, the option\ncauses open TCP and UDP files to be excluded if their state\nname(s) are in the list (\ns\n) preceded by a `^'; or included\nif their name(s) are not preceded by a `^'.\nDialects that support this option may support only one\nprotocol.  When an unsupported protocol is specified, a\nmessage will be displayed indicating state names for the\nprotocol are unavailable.\nWhen an inclusion list is defined, only network files with\nstate names in the list will be present in the\nlsof\noutput.\nThus, specifying one state name means that only network\nfiles with that lone state name will be listed.\nCase is unimportant in the protocol or state names, but\nthere may be no spaces and the colon (`:') separating the\nprotocol name (\np\n) and the state name list (\ns\n) is required.\nIf only TCP and UDP files are to be listed, as controlled\nby the specified exclusions and inclusions, the\n-i\noption\nmust be specified, too.  If only a single protocol's files\nare to be listed, add its name as an argument to the\n-i\noption.\nFor example, to list only network files with TCP state\nLISTEN, use:\n-iTCP -sTCP:LISTEN\nOr, for example, to list network files with all UDP states\nexcept Idle, use:\n-iUDP -sUDP:^Idle\nState names vary with UNIX dialects, so it's not possible\nto provide a complete list.  Some common TCP state names\nare: CLOSED, IDLE, BOUND, LISTEN, ESTABLISHED, SYN_SENT,\nSYN_RCDV, ESTABLISHED, CLOSE_WAIT, FIN_WAIT1, CLOSING,\nLAST_ACK, FIN_WAIT_2, and TIME_WAIT.  Two common UDP state\nnames are Unbound and Idle.\nSee the\nlsof\nFAQ (The\nFAQ\nsection gives its location.)  for\nmore information on how to use protocol state exclusion and\ninclusion, including examples.\nThe\n-o\n(without a following decimal digit count) and\n-s\noption (without a following protocol and state name list)\nare mutually exclusive; they can't both be specified.  When\nneither is specified,\nlsof\ndisplays whatever value - size\nor offset - is appropriate and available for the type of\nfile.\nSince some types of files don't have true sizes - sockets,\nFIFOs, pipes, etc. - lsof displays for their sizes the\ncontent amounts in their associated kernel buffers, if\npossible.\n-S\n[t]\nspecifies an optional time-out seconds value for kernel\nfunctions -\nlstat(2)\n,\nreadlink(2)\n, and\nstat(2)\n- that might\notherwise deadlock.  The minimum for\nt\nis two; the default,\nfifteen; when no value is specified, the default is used.\nSee the\nBLOCKS AND TIMEOUTS\nsection for more information.\n-T\n[t]\ncontrols the reporting of some TCP/TPI information, also\nreported by\nnetstat\n(1), following the network addresses.\nIn normal output the information appears in parentheses,\neach item except TCP or TPI state name identified by a\nkeyword, followed by `=', separated from others by a single\nspace:\n<TCP or TPI state name>\nQR=<read queue length>\nQS=<send queue length>\nSO=<socket options and values>\nSS=<socket states>\nTF=<TCP flags and values>\nWR=<window read length>\nWW=<window write length>\nNot all values are reported for all UNIX dialects.  Items\nvalues (when available) are reported after the item name\nand '='.\nWhen the field output mode is in effect (See\nOUTPUT FOR\nOTHER PROGRAMS\n.)  each item appears as a field with a `T'\nleading character.\n-T\nwith no following key characters disables TCP/TPI\ninformation reporting.\n-T\nwith following characters selects the reporting of\nspecific TCP/TPI information:\nf\nselects reporting of socket options,\nstates and values, and TCP flags and\nvalues.\nq\nselects queue length reporting.\ns\nselects connection state reporting.\nw\nselects window size reporting.\nNot all selections are enabled for some UNIX dialects.\nState may be selected for all dialects and is reported by\ndefault.  The\n-h\nor\n-?\nhelp output for the\n-T\noption will\nshow what selections may be used with the UNIX dialect.\nWhen\n-T\nis used to select information - i.e., it is\nfollowed by one or more selection characters - the\ndisplaying of state is disabled by default, and it must be\nexplicitly selected again in the characters following\n-T\n.\n(In effect, then, the default is equivalent to\n-Ts\n.)  For\nexample, if queue lengths and state are desired, use\n-Tqs\n.\nSocket options, socket states, some socket values, TCP\nflags and one TCP value may be reported (when available in\nthe UNIX dialect) in the form of the names that commonly\nappear after SO_, so_, SS_, TCP_  and TF_ in the dialect's\nheader files - most often <sys/socket.h>, <sys/socketvar.h>\nand <netinet/tcp_var.h>.  Consult those header files for\nthe meaning of the flags, options, states and values.\n``SO='' precedes socket options and values; ``SS='', socket\nstates; and ``TF='', TCP flags and values.\nIf a flag or option has a value, the value will follow an\n'=' and the name -- e.g., ``SO=LINGER=5'', ``SO=QLIM=5'',\n``TF=MSS=512''.  The following seven values may be\nreported:\nName\nReported  Description (Common Symbol)\nKEEPALIVE keep alive time (SO_KEEPALIVE)\nLINGER    linger time (SO_LINGER)\nMSS       maximum segment size (TCP_MAXSEG)\nPQLEN          partial listen queue connections\nQLEN      established listen queue connections\nQLIM      established listen queue limit\nRCVBUF    receive buffer length (SO_RCVBUF)\nSNDBUF    send buffer length (SO_SNDBUF)\nDetails on what socket options and values, socket states,\nand TCP flags and values may be displayed for particular\nUNIX dialects may be found in the answer to the ``Why\ndoesn't lsof report socket options, socket states, and TCP\nflags and values for my dialect?'' and ``Why doesn't lsof\nreport the partial listen queue connection count for my\ndialect?''  questions in the\nlsof\nFAQ (The\nFAQ\nsection\ngives its location.)  On Linux this option also prints the\nstate of UNIX domain sockets.\n-t\nproduce terse output comprising only process identifiers\n(without a header), so that it is easy to use\nprogrammatically. e.g.\n# reload anything using old SSL\nlsof -t /lib/*/libssl.so.* | xargs -r kill -HUP\n# get list of processes and then iterate over them (Bash only)\nmapfile -t pids < <(\nlsof -wt /var/log/your.log\n)\nfor pid in \"${pids[@]}\" ; do\nyour_command -p \"$pid\"\ndone\nThe\n-t\noption implies the\n-w\noption.\n-u\ns\nselects the listing of files for the user whose login names\nor user ID numbers are in the comma-separated set\ns\n- e.g.,\n``abe'', or ``548,root''.  (There should be no spaces in\nthe set.)\nMultiple login names or user ID numbers are joined in a\nsingle ORed set before participating in AND option\nselection.\nIf a login name or user ID is preceded by a `^', it becomes\na negation - i.e., files of processes owned by the login\nname or user ID will never be listed.  A negated login name\nor user ID selection is neither ANDed nor ORed with other\nselections; it is applied before all other selections and\nabsolutely excludes the listing of the files of the\nprocess.  For example, to direct\nlsof\nto exclude the\nlisting of files belonging to root processes, specify\n``-u^root'' or ``-u^0''.\n-U\nselects the listing of UNIX domain socket files.\n-v\nselects the listing of\nlsof\nversion information, including:\nrevision number; when the\nlsof\nbinary was constructed; who\nconstructed the binary and where; the name of the compiler\nused to construct the\nlsof binary;\nthe version number of\nthe compiler when readily available; the compiler and\nloader flags used to construct the\nlsof\nbinary; and system\ninformation, typically the output of\nuname\n's\n-a\noption.\n-V\ndirects\nlsof\nto indicate the items it was asked to list and\nfailed to find - command names, file names, Internet\naddresses or files, login names, NFS files, PIDs, PGIDs,\nand UIDs.\nWhen other options are ANDed to search options, or\ncompile-time options restrict the listing of some files,\nlsof\nmay not report that it failed to find a search item\nwhen an ANDed option or compile-time option prevents the\nlisting of the open file containing the located search\nitem.\nFor example, ``lsof -V -iTCP@foobar -a -d 999'' may not\nreport a failure to locate open files at ``TCP@foobar'' and\nmay not list any, if none have a file descriptor number of\n999.  A similar situation arises when HASSECURITY and\nHASNOSOCKSECURITY are defined at compile time and they\nprevent the listing of open files.\n+|-w\nEnables (\n+\n) or disables (\n-\n) the suppression of warning\nmessages.\nThe\nlsof\nbuilder may choose to have warning messages\ndisabled or enabled by default.  The default warning\nmessage state is indicated in the output of the\n-h\nor\n-?\noption.  Disabling warning messages when they are already\ndisabled or enabling them when already enabled is\nacceptable.\nThe\n-t\noption implies the\n-w\noption.\n-x\n[fl]\nmay accompany the\n+d\nand\n+D\noptions to direct their\nprocessing to cross over symbolic links and|or file system\nmount points encountered when scanning the directory (\n+d\n)\nor directory tree (\n+D\n).\nIf\n-x\nis specified by itself without a following parameter,\ncross-over processing of both symbolic links and file\nsystem mount points is enabled.  Note that when\n-x\nis\nspecified without a parameter, the next argument must begin\nwith '-' or '+'.\nThe optional 'f' parameter enables file system mount point\ncross-over processing; 'l', symbolic link cross-over\nprocessing.\nThe\n-x\noption may not be supplied without also supplying a\n+d\nor\n+D\noption.\n-X\nThis is a dialect-specific option.\nAIX:\nThis IBM AIX RISC/System 6000 option requests the\nreporting of executed text file and shared library\nreferences.\nWARNING:\nbecause this option uses the kernel readx()\nfunction, its use on a busy AIX system might cause an\napplication process to hang so completely that it can\nneither be killed nor stopped.  I have never seen this\nhappen or had a report of its happening, but I think\nthere is a remote possibility it could happen.\nBy default use of readx() is disabled.  On AIX 5L and\nabove\nlsof\nmay need setuid-root permission to perform the\nactions this option requests.\nThe\nlsof\nbuilder may specify that the\n-X\noption be\nrestricted to processes whose real UID is root.  If that\nhas been done, the\n-X\noption will not appear in the\n-h\nor\n-?\nhelp output unless the real UID of the\nlsof\nprocess\nis root.  The default\nlsof\ndistribution allows any UID to\nspecify\n-X,\nso by default it will appear in the help\noutput.\nWhen AIX readx() use is disabled,\nlsof\nmay not be able to\nreport information for all text and loader file\nreferences, but it may also avoid exacerbating an AIX\nkernel directory search kernel error, known as the Stale\nSegment ID bug.\nThe readx() function, used by\nlsof\nor any other program\nto access some sections of kernel virtual memory, can\ntrigger the Stale Segment ID bug.  It can cause the\nkernel's dir_search() function to believe erroneously\nthat part of an in-memory copy of a file system directory\nhas been zeroed.  Another application process, distinct\nfrom\nlsof\n, asking the kernel to search the directory -\ne.g., by using\nopen\n(2) - can cause dir_search() to loop\nforever, thus hanging the application process.\nConsult the\nlsof\nFAQ (The\nFAQ\nsection gives its\nlocation.)  and the\n00README\nfile of the\nlsof\ndistribution for a more complete description of the Stale\nSegment ID bug, its APAR, and methods for defining\nreadx() use when compiling\nlsof\n.\nLinux:\nThis Linux option requests that\nlsof\nskip the reporting\nof information on all open TCP, UDP and UDPLITE IPv4 and\nIPv6 files.\nThis Linux option is most useful when the system has an\nextremely large number of open TCP, UDP and UDPLITE\nfiles, the processing of whose information in the\n/proc/net/tcp*\nand\n/proc/net/udp*\nfiles would take\nlsof\na\nlong time, and whose reporting is not of interest.\nUse this option with care and only when you are sure that\nthe information you want\nlsof\nto display isn't associated\nwith open TCP, UDP or UDPLITE socket files.\nSolaris 10 and above:\nThis Solaris 10 and above option requests the reporting\nof cached paths for files that have been deleted - i.e.,\nremoved with\nrm(1)\nor\nunlink(2)\n.\nThe cached path is followed by the string `` (deleted)''\nto indicate that the path by which the file was opened\nhas been deleted.\nBecause intervening changes made to the path - i.e.,\nrenames with\nmv(1)\nor\nrename(2)\n- are not recorded in the\ncached path, what\nlsof\nreports is only the path by which\nthe file was opened, not its possibly different final\npath.\n-z\n[z]\nspecifies how Solaris 10 and higher zone information is\nto be handled.\nWithout a following argument - e.g., NO\nz\n- the option\nspecifies that zone names are to be listed in the ZONE\noutput column.\nThe\n-z\noption may be followed by a zone name,\nz\n.\nThat\ncauses lsof to list only open files for processes in that\nzone.  Multiple\n-z\nz\noption and argument pairs may be\nspecified to form a list of named zones.  Any open file\nof any process in any of the zones will be listed,\nsubject to other conditions specified by other options\nand arguments.\n-Z\n[Z]\nspecifies how SELinux security contexts are to be\nhandled.  It and 'Z' field output character support are\ninhibited when SELinux is disabled in the running Linux\nkernel.  See\nOUTPUT FOR OTHER PROGRAMS\nfor more\ninformation on the 'Z' field output character.\nWithout a following argument - e.g., NO\nZ\n- the option\nspecifies that security contexts are to be listed in the\nSECURITY-CONTEXT output column.\nThe\n-Z\noption may be followed by a wildcard security\ncontext name,\nZ\n.\nThat causes lsof to list only open\nfiles for processes in that security context.  Multiple\n-Z\nZ\noption and argument pairs may be specified to form a\nlist of security contexts.  Any open file of any process\nin any of the security contexts will be listed, subject\nto other conditions specified by other options and\narguments.  Note that\nZ\ncan be A:B:C or *:B:C or A:B:* or\n*:*:C to match against the A:B:C context.\n--\nThe double minus sign option is a marker that signals the\nend of the keyed options.  It may be used, for example,\nwhen the first file name begins with a minus sign.  It\nmay also be used when the absence of a value for the last\nkeyed option must be signified by the presence of a minus\nsign in the following option and before the start of the\nfile names.\nnames\nThese are path names of specific files to list.  Symbolic\nlinks are resolved before use.  The first name may be\nseparated from the preceding options with the ``--''\noption.\nIf a\nname\nis the mounted-on directory of a file system or\nthe device of the file system,\nlsof\nwill list all the\nfiles open on the file system.  To be considered a file\nsystem, the\nname\nmust match a mounted-on directory name\nin\nmount(8)\noutput, or match the name of a block device\nassociated with a mounted-on directory name.  The\n+|-f\noption may be used to force\nlsof\nto consider a\nname\na\nfile system identifier (\n+f\n) or a simple file (\n-f\n).\nIf\nname\nis a path to a directory that is not the\nmounted-on directory name of a file system, it is treated\njust as a regular file is treated - i.e., its listing is\nrestricted to processes that have it open as a file or as\na process-specific directory, such as the root or current\nworking directory.  To request that\nlsof\nlook for open\nfiles inside a directory name, use the\n+d\ns\nand\n+D\nD\noptions.\nIf a\nname\nis the base name of a family of multiplexed\nfiles - e.g, AIX's\n/dev/pt[cs]\n-\nlsof\nwill list all the\nassociated multiplexed files on the device that are open\n- e.g.,\n/dev/pt[cs]/1\n,\n/dev/pt[cs]/2\n, etc.\nIf a\nname\nis a UNIX domain socket name,\nlsof\nwill usually\nsearch for it by the characters of the name alone -\nexactly as it is specified and is recorded in the kernel\nsocket structure.  (See the next paragraph for an\nexception to that rule for Linux.)  Specifying a relative\npath - e.g.,\n./file\n- in place of the file's absolute\npath - e.g.,\n/tmp/file\n- won't work because\nlsof\nmust\nmatch the characters you specify with what it finds in\nthe kernel UNIX domain socket structures.\nIf a\nname\nis a Linux UNIX domain socket name, in one case\nlsof\nis able to search for it by its device and inode\nnumber, allowing\nname\nto be a relative path.  The case\nrequires that the absolute path -- i.e., one beginning\nwith a slash ('/') be used by the process that created\nthe socket, and hence be stored in the\n/proc/net/unix\nfile; and it requires that\nlsof\nbe able to obtain the\ndevice and node numbers of both the absolute path in\n/proc/net/unix\nand\nname\nvia successful\nstat(2)\nsystem\ncalls.  When those conditions are met,\nlsof\nwill be able\nto search for the UNIX domain socket when some path to it\nis is specified in\nname\n.  Thus, for example, if the path\nis\n/dev/log\n, and an\nlsof\nsearch is initiated when the\nworking directory is\n/dev\n, then\nname\ncould be\n./log\n.\nIf a\nname\nis none of the above,\nlsof\nwill list any open\nfiles whose device and inode match that of the specified\npath\nname\n.\nIf you have also specified the\n-b\noption, the only\nnames\nyou may safely specify are file systems for which your\nmount table supplies alternate device numbers.  See the\nAVOIDING KERNEL BLOCKS\nand\nALTERNATE DEVICE NUMBERS\nsections for more information.\nMultiple file names are joined in a single ORed set\nbefore participating in AND option selection.\nAFS\ntop\nLsof\nsupports the recognition of AFS files for these dialects (and\nAFS versions):\nAIX 4.1.4 (AFS 3.4a)\nHP-UX 9.0.5 (AFS 3.4a)\nLinux 1.2.13 (AFS 3.3)\nSolaris 2.[56] (AFS 3.4a)\nIt may recognize AFS files on other versions of these dialects,\nbut has not been tested there.  Depending on how AFS is\nimplemented,\nlsof\nmay recognize AFS files in other dialects, or\nmay have difficulties recognizing AFS files in the supported\ndialects.\nLsof\nmay have trouble identifying all aspects of AFS files in\nsupported dialects when AFS kernel support is implemented via\ndynamic modules whose addresses do not appear in the kernel's\nvariable name list.  In that case,\nlsof\nmay have to guess at the\nidentity of AFS files, and might not be able to obtain volume\ninformation from the kernel that is needed for calculating AFS\nvolume node numbers.  When\nlsof\ncan't compute volume node numbers,\nit reports blank in the NODE column.\nThe\n-A\nA\noption is available in some dialect implementations of\nlsof\nfor specifying the name list file where dynamic module kernel\naddresses may be found.  When this option is available, it will be\nlisted in the\nlsof\nhelp output, presented in response to the\n-h\nor\n-?\nSee the\nlsof\nFAQ (The\nFAQ\nsection gives its location.)  for more\ninformation about dynamic modules, their symbols, and how they\naffect\nlsof\noptions.\nBecause AFS path lookups don't seem to participate in the kernel's\nname cache operations,\nlsof\ncan't identify path name components\nfor AFS files.\nSECURITY\ntop\nLsof\nhas three features that may cause security concerns.  First,\nits default compilation mode allows anyone to list all open files\nwith it.  Second, by default it creates a user-readable and\nuser-writable device cache file in the home directory of the real\nuser ID that executes\nlsof\n.  (The list-all-open-files and device\ncache features may be disabled when\nlsof\nis compiled.)  Third, its\n-k\nand\n-m\noptions name alternate kernel name list or memory files.\nRestricting the listing of all open files is controlled by the\ncompile-time HASSECURITY and HASNOSOCKSECURITY options.  When\nHASSECURITY is defined,\nlsof\nwill allow only the root user to list\nall open files.  The non-root user may list only open files of\nprocesses with the same user IDentification number as the real\nuser ID number of the\nlsof\nprocess (the one that its user logged\non with).\nHowever, if HASSECURITY and HASNOSOCKSECURITY are both defined,\nanyone may list open socket files, provided they are selected with\nthe\n-i\noption.\nWhen HASSECURITY is not defined, anyone may list all open files.\nHelp output, presented in response to the\n-h\nor\n-?\noption, gives\nthe status of the HASSECURITY and HASNOSOCKSECURITY definitions.\nSee the\nSecurity\nsection of the\n00README\nfile of the\nlsof\ndistribution for information on building\nlsof\nwith the HASSECURITY\nand HASNOSOCKSECURITY options enabled.\nCreation and use of a user-readable and user-writable device cache\nfile is controlled by the compile-time HASDCACHE option.  See the\nDEVICE CACHE FILE\nsection and the sections that follow it for\ndetails on how its path is formed.  For security considerations it\nis important to note that in the default\nlsof\ndistribution, if the\nreal user ID under which\nlsof\nis executed is root, the device\ncache file will be written in root's home directory - e.g.,\n/\nor\n/root\n.  When HASDCACHE is not defined,\nlsof\ndoes not write or\nattempt to read a device cache file.\nWhen HASDCACHE is defined, the\nlsof\nhelp output, presented in\nresponse to the\n-h\n,\n-D?\n, or\n-?\noptions, will provide device cache\nfile handling information.  When HASDCACHE is not defined, the\n-h\nor\n-?\noutput will have no\n-D\noption description.\nBefore you decide to disable the device cache file feature -\nenabling it improves the performance of\nlsof\nby reducing the\nstartup overhead of examining all the nodes in\n/dev\n(or\n/devices\n)\n- read the discussion of it in the\n00DCACHE\nfile of the\nlsof\ndistribution and the\nlsof\nFAQ (The\nFAQ\nsection gives its\nlocation.)\nWHEN IN DOUBT, YOU CAN TEMPORARILY DISABLE THE USE OF THE DEVICE\nCACHE FILE WITH THE\n-Di\nOPTION.\nWhen\nlsof\nuser declares alternate kernel name list or memory files\nwith the\n-k\nand\n-m\noptions,\nlsof\nchecks the user's authority to\nread them with\naccess(2)\n.  This is intended to prevent whatever\nspecial power\nlsof's\nmodes might confer on it from letting it read\nfiles not normally accessible via the authority of the real user\nID.\nOUTPUT\ntop\nThis section describes the information\nlsof\nlists for each open\nfile.  See the\nOUTPUT FOR OTHER PROGRAMS\nsection for additional\ninformation on output that can be processed by another program.\nLsof\nonly outputs printable (declared so by\nisprint(3)\n) 8 bit\ncharacters.  Non-printable characters are printed in one of three\nforms: the C ``\\[bfrnt]'' form; the control character `^' form\n(e.g., ``^@''); or hexadecimal leading ``\\x'' form (e.g.,\n``\\xab'').  Space is non-printable in the COMMAND column\n(``\\x20'') and printable elsewhere.\nFor some dialects - if HASSETLOCALE is defined in the dialect's\nmachine.h header file -\nlsof\nwill print the extended 8 bit\ncharacters of a language locale.  The\nlsof\nprocess must be\nsupplied a language locale environment variable (e.g., LANG) whose\nvalue represents a known language locale in which the extended\ncharacters are considered printable by\nisprint(3)\n.  Otherwise\nlsof\nconsiders the extended characters non-printable and prints them\naccording to its rules for non-printable characters, stated above.\nConsult your dialect's\nsetlocale(3)\nman page for the names of\nother environment variables that may be used in place of LANG -\ne.g., LC_ALL, LC_CTYPE, etc.\nLsof's\nlanguage locale support for a dialect also covers wide\ncharacters - e.g., UTF-8 - when HASSETLOCALE and HASWIDECHAR are\ndefined in the dialect's machine.h header file, and when a\nsuitable language locale has been defined in the appropriate\nenvironment variable for the\nlsof\nprocess.  Wide characters are\nprintable under those conditions if\niswprint(3)\nreports them to\nbe.  If HASSETLOCALE, HASWIDECHAR and a suitable language locale\naren't defined, or if\niswprint(3)\nreports wide characters that\naren't printable,\nlsof\nconsiders the wide characters non-printable\nand prints each of their 8 bits according to its rules for\nnon-printable characters, stated above.\nConsult the answers to the \"Language locale support\" questions in\nthe lsof FAQ (The\nFAQ\nsection gives its location.) for more\ninformation.\nLsof\ndynamically sizes the output columns each time it runs,\nguaranteeing that each column is a minimum size.  It also\nguarantees that each column is separated from its predecessor by\nat least one space.\nCOMMAND\ncontains the first nine characters of the name of the UNIX\ncommand associated with the process.  If a non-zero\nw\nvalue\nis specified to the\n+c\nw\noption, the column contains the\nfirst\nw\ncharacters of the name of the UNIX command\nassociated with the process up to the limit of characters\nsupplied to\nlsof\nby the UNIX dialect.  (See the description\nof the\n+c\nw\ncommand or the\nlsof\nFAQ for more information.\nThe\nFAQ\nsection gives its location.)\nIf\nw\nis less than the length of the column title,\n``COMMAND'', it will be raised to that length.\nIf a zero\nw\nvalue is specified to the\n+c\nw\noption, the\ncolumn contains all the characters of the name of the UNIX\ncommand associated with the process.\nAll command name characters maintained by the kernel in its\nstructures are displayed in field output when the command\nname descriptor (`c') is specified.  See the\nOUTPUT FOR\nOTHER COMMANDS\nsection for information on selecting field\noutput and the associated command name descriptor.\nPID    is the Process IDentification number of the process.\nTID    is the task (thread) IDentification number, if task\n(thread) reporting is supported by the dialect and a task\n(thread) is being listed.  (If help output - i.e., the\noutput of the\n-h\nor\n-?\noptions - shows this option, then\ntask (thread) reporting is supported by the dialect.)\nA blank TID column in Linux indicates a process - i.e., a\nnon-task.\nTASKCMD\nis the task command name.  Generally this will be the same\nas the process named in the COMMAND column, but some task\nimplementations (e.g., Linux) permit a task to change its\ncommand name.\nThe TASKCMD column width is subject to the same size\nlimitation as the COMMAND column.\nZONE   is the Solaris 10 and higher zone name.  This column must\nbe selected with the\n-z\noption.\nSECURITY-CONTEXT\nis the SELinux security context.  This column must be\nselected with the\n-Z\noption.  Note that the\n-Z\noption is\ninhibited when SELinux is disabled in the running Linux\nkernel.\nPPID   is the Parent Process IDentification number of the process.\nIt is only displayed when the\n-R\noption has been specified.\nPGID   is the process group IDentification number associated with\nthe process.  It is only displayed when the\n-g\noption has\nbeen specified.\nUSER   is the user ID number or login name of the user to whom the\nprocess belongs, usually the same as reported by\nps(1)\n.\nHowever, on Linux USER is the user ID number or login that\nowns the directory in /proc where\nlsof\nfinds information\nabout the process.  Usually that is the same value reported\nby\nps(1)\n, but may differ when the process has changed its\neffective user ID.  (See the\n-l\noption description for\ninformation on when a user ID number or login name is\ndisplayed.)\nFD     is the File Descriptor number of the file or:\ncwd\ncurrent working directory;\nL\nnn\nlibrary references (AIX);\nctty\ncharacter tty;\nDEL\ndeleted file;\nerr\nFD information error (see NAME column);\nfp.\nFileport (Darwin);\njld\njail directory (FreeBSD);\nltx\nshared library text (code and data);\nM\nxx\nhex memory-mapped type number xx.\nm86\nDOS Merge mapped file;\nmem\nmemory-mapped file;\nmmap\nmemory-mapped device;\nNOFD\nfor a Linux /proc/<PID>/fd directory that can't be opened --\nthe directory path appears in the NAME column, followed by an error\nmessage;\npd\nparent directory;\nR\nnn\nunknown pregion number (HP-UX);\nrtd\nroot directory;\ntwd\nper task current working directory;\ntxt\nprogram text (code and data);\nv86\nVP/ix mapped file;\nFD is followed by one of these characters, describing the\nmode under which the file is open:\nr\nfor read access;\nw\nfor write access;\nu\nfor read and write access;\nspace if mode unknown and no lock\ncharacter follows;\n`-' if mode unknown and lock\ncharacter follows.\nThe mode character is followed by one of these lock\ncharacters, describing the type of lock applied to the\nfile:\nN\nfor a Solaris NFS lock of unknown type;\nr\nfor read lock on part of the file;\nR\nfor a read lock on the entire file;\nw\nfor a write lock on part of the file;\nW\nfor a write lock on the entire file;\nu\nfor a read and write lock of any length;\nU\nfor a lock of unknown type;\nx\nfor an SCO OpenServer Xenix lock on part of the\nfile;\nX\nfor an SCO OpenServer Xenix lock on the entire file;\nspace if there is no lock.\nSee the\nLOCKS\nsection for more information on the lock\ninformation character.\nThe FD column contents constitutes a single field for\nparsing in post-processing scripts. FD numbers larger than\n9999 are abbreviated to a ``*'' followed by the last three\ndigits. E.g., 10001 appears as ``*001''\nTYPE   is the type of the node associated with the file - e.g.,\nVDIR, VREG, etc.\nor ``ax25'' for a Linux AX.25 socket;\nor ``a_inode'' for anonymous inode;\nor ``icmp'' for an ICMP socket;\nor ``inet'' for an Internet domain socket;\nor ``ipx'' for an IPX socket;\nor ``key'' for an internal key management socket;\nor ``lla'' for a HP-UX link level access file;\nor ``ndrv'' for a net driver socket;\nor ``netlink'' for a netlink socket;\nor ``pack'' for a packet socket;\nor ``ppp'' for a PPP socket;\nor ``raw'' for a raw socket;\nor ``raw6'' for a raw IPv6 socket;\nor ``rte'' for an AF_ROUTE socket;\nor ``sock'' for a socket of unknown domain;\nor ``systm'' for a system socket;\nor ``unix'' for a UNIX domain socket;\nor ``x.25'' for an HP-UX x.25 socket;\nor ``ATALK'' for an AppleTalk socket;\nor ``BLK'' for a block special file;\nor ``CHR'' for a character special file;\nor ``DEL'' for a Linux map file that has been deleted;\nor ``DIR'' for a directory;\nor ``DOOR'' for a VDOOR file;\nor ``EVENTFD'' for an eventfd;\nor ``FIFO'' for a FIFO special file;\nor ``FSEVENTS'' for fsevents;\nor ``IPv4'' for an IPv4 socket;\nor ``IPv6'' for an open IPv6 network file - even if its\naddress is IPv4, mapped in an IPv6 address;\nor ``KQUEUE'' for a BSD style kernel event queue file;\nor ``LINK'' for a symbolic link file;\nor ``MPB'' for a multiplexed block file;\nor ``MPC'' for a multiplexed character file;\nor ``PAS'' for a\n/proc/as\nfile;\nor ``PAXV'' for a\n/proc/auxv\nfile;\nor ``PCRE'' for a\n/proc/cred\nfile;\nor ``PCTL'' for a\n/proc\ncontrol file;\nor ``PCUR'' for the current\n/proc\nprocess;\nor ``PCWD'' for a\n/proc\ncurrent working directory;\nor ``PDIR'' for a\n/proc\ndirectory;\nor ``PETY'' for a\n/proc\nexecutable type (\netype\n);\nor ``PFD'' for a\n/proc\nfile descriptor;\nor ``PFDR'' for a\n/proc\nfile descriptor directory;\nor ``PFIL'' for an executable\n/proc\nfile;\nor ``PFPR'' for a\n/proc\nFP register set;\nor ``PGD'' for a\n/proc/pagedata\nfile;\nor ``PGID'' for a\n/proc\ngroup notifier file;\nor ``PIPE'' for pipes;\nor ``PLC'' for a\n/proc/lwpctl\nfile;\nor ``PLDR'' for a\n/proc/lpw\ndirectory;\nor ``PLDT'' for a\n/proc/ldt\nfile;\nor ``PLPI'' for a\n/proc/lpsinfo\nfile;\nor ``PLST'' for a\n/proc/lstatus\nfile;\nor ``PLU'' for a\n/proc/lusage\nfile;\nor ``PLWG'' for a\n/proc/gwindows\nfile;\nor ``PLWI'' for a\n/proc/lwpsinfo\nfile;\nor ``PLWS'' for a\n/proc/lwpstatus\nfile;\nor ``PLWU'' for a\n/proc/lwpusage\nfile;\nor ``PLWX'' for a\n/proc/xregs\nfile;\nor ``PMAP'' for a\n/proc\nmap file (\nmap\n);\nor ``PMPS'' for a\n/proc/maps\nfile;\nor ``PMEM'' for a\n/proc\nmemory image file;\nor ``PNTF'' for a\n/proc\nprocess notifier file;\nor ``POBJ'' for a\n/proc/object\nfile;\nor ``PODR'' for a\n/proc/object\ndirectory;\nor ``POLP'' for an old format\n/proc\nlight weight process\nfile;\nor ``POPF'' for an old format\n/proc\nPID file;\nor ``POPG'' for an old format\n/proc\npage data file;\nor ``PORT'' for a SYSV named pipe;\nor ``PREG'' for a\n/proc\nregister file;\nor ``PRMP'' for a\n/proc/rmap\nfile;\nor ``PROCDSC'' for a processor descriptor;\nor ``PRTD'' for a\n/proc\nroot directory;\nor ``PSGA'' for a\n/proc/sigact\nfile;\nor ``PSIN'' for a\n/proc/psinfo\nfile;\nor ``PSTA'' for a\n/proc\nstatus file;\nor ``PSXMQ'' for a POSIX message queue file;\nor ``PSXSEM'' for a POSIX semaphore file;\nor ``PSXSHM'' for a POSIX shared memory file;\nor ``PTS'' for a\n/dev/pts\nfile;\nor ``PUSG'' for a\n/proc/usage\nfile;\nor ``PW'' for a\n/proc/watch\nfile;\nor ``PXMP'' for a\n/proc/xmap\nfile;\nor ``REG'' for a regular file;\nor ``SHM'' for a shared memory file;\nor ``SMT'' for a shared memory transport file;\nor ``STR'' for streams;\nor ``STSO'' for a stream socket;\nor ``UNKN'' for an unknown file;\nor ``UNKNcwd'' for unknown current working directory;\nor ``UNKNdel'' for unknown deleted file;\nor ``UNKNfd'' for unknown file descriptor;\nor ``UNKNmem'' for unknown memory-mapped file;\nor ``UNKNrtd'' for unknown root directory;\nor ``UNKNtxt'' for unknown program text;\nor ``UNNM'' for an unnamed type file;\nor ``XNAM'' for an OpenServer Xenix special file of unknown\ntype;\nor ``XSEM'' for an OpenServer Xenix semaphore file;\nor ``XSD'' for an OpenServer Xenix shared data file;\nor ``UNSP'' for an unsupported file;\nor the four type number octets if the corresponding name\nisn't known.\nFILE-ADDR\ncontains the kernel file structure address when\nf\nhas been\nspecified to\n+f\n;\nFCT    contains the file reference count from the kernel file\nstructure when\nc\nhas been specified to\n+f\n;\nFILE-FLAG\nwhen\ng\nor\nG\nhas been specified to\n+f\n, this field contains\nthe contents of the f_flag[s] member of the kernel file\nstructure and the kernel's per-process open file flags (if\navailable); `G' causes them to be displayed in hexadecimal;\n`g', as short-hand names; two lists may be displayed with\nentries separated by commas, the lists separated by a\nsemicolon (`;'); the first list may contain short-hand\nnames for f_flag[s] values from the following table:\nAIO       asynchronous I/O (e.g., FAIO)\nAP        append\nASYN      asynchronous I/O (e.g., FASYNC)\nBAS       block, test, and set in use\nBKIU      block if in use\nBL        use block offsets\nBSK       block seek\nCA        copy avoid\nCIO       concurrent I/O\nCLON      clone\nCLRD      CL read\nCR        create\nDF        defer\nDFI       defer IND\nDFLU      data flush\nDIR       direct\nDLY       delay\nDOCL      do clone\nDSYN      data-only integrity\nDTY       must be a directory\nEVO       event only\nEX        open for exec\nEXCL      exclusive open\nFSYN      synchronous writes\nGCDF      defer during unp_gc() (AIX)\nGCMK      mark during unp_gc() (AIX)\nGTTY      accessed via /dev/tty\nHUP       HUP in progress\nKERN      kernel\nKIOC      kernel-issued ioctl\nLCK       has lock\nLG        large file\nMBLK      stream message block\nMK        mark\nMNT       mount\nMSYN      multiplex synchronization\nNATM      don't update atime\nNB        non-blocking I/O\nNBDR      no BDRM check\nNBIO      SYSV non-blocking I/O\nNBF       n-buffering in effect\nNC        no cache\nND        no delay\nNDSY      no data synchronization\nNET       network\nNFLK      don't follow links\nNMFS      NM file system\nNOTO      disable background stop\nNSH       no share\nNTTY      no controlling TTY\nOLRM      OLR mirror\nPAIO      POSIX asynchronous I/O\nPATH      path\nPP        POSIX pipe\nR         read\nRC        file and record locking cache\nREV       revoked\nRSH       shared read\nRSYN      read synchronization\nRW        read and write access\nSL        shared lock\nSNAP      cooked snapshot\nSOCK      socket\nSQSH      Sequent shared set on open\nSQSV      Sequent SVM set on open\nSQR       Sequent set repair on open\nSQS1      Sequent full shared open\nSQS2      Sequent partial shared open\nSTPI      stop I/O\nSWR       synchronous read\nSYN       file integrity while writing\nTCPM      avoid TCP collision\nTMPF      temporary file\nTR        truncate\nW         write\nWKUP      parallel I/O synchronization\nWTG       parallel I/O synchronization\nVH        vhangup pending\nVTXT      virtual text\nXL        exclusive lock\nthis list of names was derived from F* #define's in dialect\nheader files <fcntl.h>, <linux</fs.h>, <sys/fcntl.c>,\n<sys/fcntlcom.h>, and <sys/file.h>; see the common.h header\nfile for a list showing the correspondence between the\nabove short-hand names and the header file definitions;\nthe second list (after the semicolon) may contain short-\nhand names for kernel per-process open file flags from this\ntable:\nALLC      allocated\nBR        the file has been read\nBHUP      activity stopped by SIGHUP\nBW        the file has been written\nCLSG      closing\nCX        close-on-exec (see fcntl(F_SETFD))\nLCK       lock was applied\nMP        memory-mapped\nOPIP      open pending - in progress\nRSVW      reserved wait\nSHMT      UF_FSHMAT set (AIX)\nUSE       in use (multi-threaded)\nNODE-ID\n(or INODE-ADDR for some dialects) contains a unique\nidentifier for the file node (usually the kernel vnode or\ninode address, but also occasionally a concatenation of\ndevice and node number) when\nn\nhas been specified to\n+f\n;\nDEVICE contains the device numbers, separated by commas, for a\ncharacter special, block special, regular, directory or NFS\nfile;\nor ``memory'' for a memory file system node under Tru64\nUNIX;\nor the address of the private data area of a Solaris socket\nstream;\nor a kernel reference address that identifies the file (The\nkernel reference address may be used for FIFO's, for\nexample.);\nor the base address or device name of a Linux AX.25 socket\ndevice.\nUsually only the lower thirty two bits of Tru64 UNIX kernel\naddresses are displayed.\nSIZE, SIZE/OFF, or OFFSET\nis the size of the file or the file offset in bytes.  A\nvalue is displayed in this column only if it is available.\nLsof\ndisplays whatever value - size or offset - is\nappropriate for the type of the file and the version of\nlsof\n.\nOn some UNIX dialects\nlsof\ncan't obtain accurate or\nconsistent file offset information from its kernel data\nsources, sometimes just for particular kinds of files\n(e.g., socket files.)  In other cases, files don't have\ntrue sizes - e.g., sockets, FIFOs, pipes - so\nlsof\ndisplays\nfor their sizes the content amounts it finds in their\nkernel buffer descriptors (e.g., socket buffer size counts\nor TCP/IP window sizes.)  Consult the\nlsof\nFAQ (The\nFAQ\nsection gives its location.)  for more information.\nThe file size is displayed in decimal; the offset is\nnormally displayed in decimal with a leading ``0t'' if it\ncontains 8 digits or less; in hexadecimal with a leading\n``0x'' if it is longer than 8 digits.  (Consult the\n-o\no\noption description for information on when 8 might default\nto some other value.)\nThus the leading ``0t'' and ``0x'' identify an offset when\nthe column may contain both a size and an offset (i.e., its\ntitle is SIZE/OFF).\nIf the\n-o\noption is specified,\nlsof\nalways displays the\nfile offset (or nothing if no offset is available) and\nlabels the column OFFSET.  The offset always begins with\n``0t'' or ``0x'' as described above.\nThe\nlsof\nuser can control the switch from ``0t'' to ``0x''\nwith the\n-o\no\noption.  Consult its description for more\ninformation.\nIf the\n-s\noption is specified,\nlsof\nalways displays the\nfile size (or nothing if no size is available) and labels\nthe column SIZE.  The\n-o\nand\n-s\noptions are mutually\nexclusive; they can't both be specified.\nIf the\n-H\noption is specified,\nlsof\ndisplays file size in\nhuman readable form.\nFor files that don't have a fixed size - e.g., don't reside\non a disk device -\nlsof\nwill display appropriate\ninformation about the current size or position of the file\nif it is available in the kernel structures that define the\nfile.\nNLINK  contains the file link count when\n+L\nhas been specified;\nNODE   is the node number of a local file;\nor the inode number of an NFS file in the server host;\nor the Internet protocol type - e.g, ``TCP'';\nor ``STR'' for a stream;\nor ``CCITT'' for an HP-UX x.25 socket;\nor the IRQ or inode number of a Linux AX.25 socket device.\nNAME   is the name of the mount point and file system on which the\nfile resides;\nor the name of a file specified in the\nnames\noption (after\nany symbolic links have been resolved);\nor the name of a character special or block special device;\nor the local and remote Internet addresses of a network\nfile; the local host name or IP number is followed by a\ncolon (':'), the port, ``->'', and the two-part remote\naddress; IP addresses may be reported as numbers or names,\ndepending on the\n+|-M\n,\n-n\n, and\n-P\noptions; colon-separated\nIPv6 numbers are enclosed in square brackets; IPv4\nINADDR_ANY and IPv6 IN6_IS_ADDR_UNSPECIFIED addresses, and\nzero port numbers are represented by an asterisk ('*'); a\nUDP destination address may be followed by the amount of\ntime elapsed since the last packet was sent to the\ndestination; TCP, UDP and UDPLITE remote addresses may be\nfollowed by TCP/TPI information in parentheses - state\n(e.g., ``(ESTABLISHED)'', ``(Unbound)''), queue sizes, and\nwindow sizes (not all dialects) - in a fashion similar to\nwhat\nnetstat\n(1) reports; see the\n-T\noption description or\nthe description of the TCP/TPI field in\nOUTPUT FOR OTHER\nPROGRAMS\nfor more information on state, queue size, and\nwindow size;\nor the address or name of a UNIX domain socket, possibly\nincluding a stream clone device name, a file system\nobject's path name, local and foreign kernel addresses,\nsocket pair information, and a bound vnode address;\nor the local and remote mount point names of an NFS file;\nor ``STR'', followed by the stream name;\nor a stream character device name, followed by ``->'' and\nthe stream name or a list of stream module names, separated\nby ``->'';\nor ``STR:'' followed by the SCO OpenServer stream device\nand module names, separated by ``->'';\nor system directory name, `` -- '', and as many components\nof the path name as\nlsof\ncan find in the kernel's name\ncache for selected dialects (See the\nKERNEL NAME CACHE\nsection for more information.);\nor ``PIPE->'', followed by a Solaris kernel pipe\ndestination address;\nor ``COMMON:'', followed by the vnode device information\nstructure's device name, for a Solaris common vnode;\nor the address family, followed by a slash (`/'), followed\nby fourteen comma-separated bytes of a non-Internet raw\nsocket address;\nor the HP-UX x.25 local address, followed by the virtual\nconnection number (if any), followed by the remote address\n(if any);\nor ``(dead)'' for disassociated Tru64 UNIX files -\ntypically terminal files that have been flagged with the\nTIOCNOTTY ioctl and closed by daemons;\nor ``rd=<offset>'' and ``wr=<offset>'' for the values of\nthe read and write offsets of a FIFO;\nor ``clone\nn\n:/dev/event'' for SCO OpenServer file clones of\nthe\n/dev/event\ndevice, where\nn\nis the minor device number\nof the file;\nor ``(socketpair: n)'' for a Solaris 2.6, 8, 9  or 10 UNIX\ndomain socket, created by the\nsocketpair\n(3N) network\nfunction;\nor ``no PCB'' for socket files that do not have a protocol\nblock associated with them, optionally followed by ``,\nCANTSENDMORE'' if sending on the socket has been disabled,\nor ``, CANTRCVMORE'' if receiving on the socket has been\ndisabled (e.g., by the\nshutdown(2)\nfunction);\nor the local and remote addresses of a Linux IPX socket\nfile in the form <net>:[<node>:]<port>, followed in\nparentheses by the transmit and receive queue sizes, and\nthe connection state;\nor ``dgram'' or ``stream'' for the type UnixWare 7.1.1 and\nabove in-kernel UNIX domain sockets, followed by a colon\n(':') and the local path name when available, followed by\n``->'' and the remote path name or kernel socket address in\nhexadecimal when available;\nor the association value, association index, endpoint\nvalue, local address, local port, remote address and remote\nport for Linux SCTP sockets;\nor ``protocol: '' followed by the Linux socket's protocol\nattribute.\nFor dialects that support a ``namefs'' file system, allowing one\nfile to be attached to another with\nfattach\n(3C),\nlsof\nwill add\n``(FA:<address1><direction><address2>)'' to the NAME column.\n<address1> and <address2> are hexadecimal vnode addresses.\n<direction> will be ``<-'' if <address2> has been fattach'ed to\nthis vnode whose address is <address1>; and ``->'' if <address1>,\nthe vnode address of this vnode, has been fattach'ed to\n<address2>.  <address1> may be omitted if it already appears in\nthe DEVICE column.\nLsof\nmay add two parenthetical notes to the NAME column for open\nSolaris 10 files: ``(?)'' if\nlsof\nconsiders the path name of\nquestionable accuracy; and ``(deleted)'' if the\n-X\noption has been\nspecified and\nlsof\ndetects the open file's path name has been\ndeleted.  Consult the\nlsof\nFAQ (The\nFAQ\nsection gives its\nlocation.)  for more information on these NAME column additions.\nLOCKS\ntop\nLsof\ncan't adequately report the wide variety of UNIX dialect file\nlocks in a single character.  What it reports in a single\ncharacter is a compromise between the information it finds in the\nkernel and the limitations of the reporting format.\nMoreover, when a process holds several byte level locks on a file,\nlsof\nonly reports the status of the first lock it encounters.  If\nit is a byte level lock, then the lock character will be reported\nin lower case - i.e., `r', `w', or `x' - rather than the upper\ncase equivalent reported for a full file lock.\nGenerally\nlsof\ncan only report on locks held by local processes on\nlocal files.  When a local process sets a lock on a remotely\nmounted (e.g., NFS) file, the remote server host usually records\nthe lock state.  One exception is Solaris - at some patch levels\nof 2.3, and in all versions above 2.4, the Solaris kernel records\ninformation on remote locks in local structures.\nLsof\nhas trouble reporting locks for some UNIX dialects.  Consult\nthe\nBUGS\nsection of this manual page or the\nlsof\nFAQ (The\nFAQ\nsection gives its location.)  for more information.\nOUTPUT FOR OTHER PROGRAMS\ntop\nWhen the\n-F\noption is specified,\nlsof\nproduces output that is\nsuitable for processing by another program - e.g, an\nawk\nor\nPerl\nscript, or a C program.\nEach unit of information is output in a field that is identified\nwith a leading character and terminated by a NL (012) (or a NUL\n(000) if the 0 (zero) field identifier character is specified.)\nThe data of the field follows immediately after the field\nidentification character and extends to the field terminator.\nIt is possible to think of field output as process and file sets.\nA process set begins with a field whose identifier is `p' (for\nprocess IDentifier (PID)).  It extends to the beginning of the\nnext PID field or the beginning of the first file set of the\nprocess, whichever comes first.  Included in the process set are\nfields that identify the command, the process group IDentification\n(PGID) number, the task (thread) ID (TID), and the user ID (UID)\nnumber or login name.\nA file set begins with a field whose identifier is `f' (for file\ndescriptor).  It is followed by lines that describe the file's\naccess mode, lock state, type, device, size, offset, inode,\nprotocol, name and stream module names.  It extends to the\nbeginning of the next file or process set, whichever comes first.\nWhen the NUL (000) field terminator has been selected with the 0\n(zero) field identifier character,\nlsof\nends each process and file\nset with a NL (012) character.\nLsof\nalways produces one field, the PID (`p') field.  In repeat\nmode, the marker (`m') is also produced.  All other fields may be\ndeclared optionally in the field identifier character list that\nfollows the\n-F\noption.  When a field selection character\nidentifies an item\nlsof\ndoes not normally list - e.g., PPID,\nselected with\n-R\n- specification of the field character - e.g.,\n``\n-FR\n'' - also selects the listing of the item.\nLsof\nversion from 4.88 to 4.93.2 always produced one more field,\nthe file descriptor (`f') field. However,\nlsof\nin this version\ndoesn't produce it. This change is for supporting the use case\nthat a user needs only the PID field, and doesn't need the file\ndescriptor field. Specify `f' explicitly if you need the field.\nIt is entirely possible to select a set of fields that cannot\neasily be parsed - e.g., if the field descriptor field is not\nselected, it may be difficult to identify file sets.  To help you\navoid this difficulty,\nlsof\nsupports the\n-F\noption; it selects the\noutput of all fields with NL terminators (the\n-F0\noption pair\nselects the output of all fields with NUL terminators).  For\ncompatibility reasons neither\n-F\nnor\n-F0\nselect the raw device\nfield.\nThese are the fields that\nlsof\nwill produce.  The single character\nlisted first is the field identifier.\na    file access mode\nc    process command name (all characters from proc or\nuser structure)\nC    file structure share count\nd    file's device character code\nD    file's major/minor device number (0x<hexadecimal>)\nf    file descriptor\nF    file structure address (0x<hexadecimal>)\nG    file flaGs (0x<hexadecimal>; names if\n+fg\nfollows)\ng    process group ID\ni    file's inode number\nK    tasK ID\nk    link count\nl    file's lock status\nL    process login name\nm    marker between repeated output (always selected in repeat mode)\nM    the task comMand name\nn    file name, comment, Internet address\nN    node identifier (ox<hexadecimal>\no    file's offset (0t<decimal> or 0x<hexadecimal>, see\n-o\no\n)\np    process ID (always selected)\nP    protocol name\nr    raw device number (0x<hexadecimal>)\nR    parent process ID\ns    file's size (decimal)\nS    file's stream identification\nt    file's type\nT    TCP/TPI information, identified by prefixes (the\n`=' is part of the prefix):\nQR=<read queue size>\nQS=<send queue size>\nSO=<socket options and values> (not all dialects)\nSS=<socket states> (not all dialects)\nST=<connection state>\nTF=<TCP flags and values> (not all dialects)\nWR=<window read size>  (not all dialects)\nWW=<window write size>  (not all dialects)\n(TCP/TPI information isn't reported for all supported\nUNIX dialects. The\n-h\nor\n-?\nhelp output for the\n-T\noption will show what TCP/TPI reporting can be\nrequested.)\nu    process user ID\nz    Solaris 10 and higher zone name\nZ    SELinux security context (inhibited when SELinux is disabled)\n0    use NUL field terminator character in place of NL\n1-9  dialect-specific field identifiers (The output\nof\n-F?\nidentifies the information to be found\nin dialect-specific fields.)\nYou can get on-line help information on these characters and their\ndescriptions by specifying the\n-F?\noption pair.  (Escape the `?'\ncharacter as your shell requires.)  Additional information on\nfield content can be found in the\nOUTPUT\nsection.\nAs an example, ``\n-F pcfn\n'' will select the process ID (`p'),\ncommand name (`c'), file descriptor (`f') and file name (`n')\nfields with an NL field terminator character; ``\n-F pcfn0\n'' selects\nthe same output with a NUL (000) field terminator character.\nLsof\ndoesn't produce all fields for every process or file set,\nonly those that are available.  Some fields are mutually\nexclusive: file device characters and file major/minor device\nnumbers; file inode number and protocol name; file name and stream\nidentification; file size and offset.  One or the other member of\nthese mutually exclusive sets will appear in field output, but not\nboth.\nNormally\nlsof\nends each field with a NL (012) character.  The 0\n(zero) field identifier character may be specified to change the\nfield terminator character to a NUL (000).  A NUL terminator may\nbe easier to process with\nxargs(1)\n, for example, or with programs\nwhose quoting mechanisms may not easily cope with the range of\ncharacters in the field output.  When the NUL field terminator is\nin use,\nlsof\nends each process and file set with a NL (012).\nThree aids to producing programs that can process\nlsof\nfield\noutput are included in the\nlsof\ndistribution.  The first is a C\nheader file,\nlsof_fields.h\n, that contains symbols for the field\nidentification characters, indexes for storing them in a table,\nand explanation strings that may be compiled into programs.\nLsof\nuses this header file.\nThe second aid is a set of sample scripts that process field\noutput, written in\nawk\n,\nPerl\n4, and\nPerl\n5.  They're located in\nthe\nscripts\nsubdirectory of the\nlsof\ndistribution.\nThe third aid is the C library used for the\nlsof\ntest suite.  The\ntest suite is written in C and uses field output to validate the\ncorrect operation of\nlsof\n.  The library can be found in the\ntests/LTlib.c\nfile of the\nlsof\ndistribution.  The library uses the\nfirst aid, the\nlsof_fields.h\nheader file.\nBLOCKS AND TIMEOUTS\ntop\nLsof\ncan be blocked by some kernel functions that it uses -\nlstat(2)\n,\nreadlink(2)\n, and\nstat(2)\n.  These functions are stalled\nin the kernel, for example, when the hosts where mounted NFS file\nsystems reside become inaccessible.\nLsof\nattempts to break these blocks with timers and child\nprocesses, but the techniques are not wholly reliable.  When\nlsof\ndoes manage to break a block, it will report the break with an\nerror message.  The messages may be suppressed with the\n-t\nand\n-w\noptions.\nThe default timeout value may be displayed with the\n-h\nor\n-?\noption, and it may be changed with the\n-S\n[t]\noption.  The minimum\nfor\nt\nis two seconds, but you should avoid small values, since\nslow system responsiveness can cause short timeouts to expire\nunexpectedly and perhaps stop\nlsof\nbefore it can produce any\noutput.\nWhen\nlsof\nhas to break a block during its access of mounted file\nsystem information, it normally continues, although with less\ninformation available to display about open files.\nLsof\ncan also be directed to avoid the protection of timers and\nchild processes when using the kernel functions that might block\nby specifying the\n-O\noption.  While this will allow\nlsof\nto start\nup with less overhead, it exposes\nlsof\ncompletely to the kernel\nsituations that might block it.  Use this option cautiously.\nAVOIDING KERNEL BLOCKS\ntop\nYou can use the\n-b\noption to tell\nlsof\nto avoid using kernel\nfunctions that would block.  Some cautions apply.\nFirst, using this option usually requires that your system supply\nalternate device numbers in place of the device numbers that\nlsof\nwould normally obtain with the\nlstat(2)\nand\nstat(2)\nkernel\nfunctions.  See the\nALTERNATE DEVICE NUMBERS\nsection for more\ninformation on alternate device numbers.\nSecond, you can't specify\nnames\nfor\nlsof\nto locate unless they're\nfile system names.  This is because\nlsof\nneeds to know the device\nand inode numbers of files listed with\nnames\nin the\nlsof\noptions,\nand the\n-b\noption prevents\nlsof\nfrom obtaining them.  Moreover,\nsince\nlsof\nonly has device numbers for the file systems that have\nalternates, its ability to locate files on file systems depends\ncompletely on the availability and accuracy of the alternates.  If\nno alternates are available, or if they're incorrect,\nlsof\nwon't\nbe able to locate files on the named file systems.\nThird, if the names of your file system directories that\nlsof\nobtains from your system's mount table are symbolic links,\nlsof\nwon't be able to resolve the links.  This is because the\n-b\noption\ncauses\nlsof\nto avoid the kernel\nreadlink(2)\nfunction it uses to\nresolve symbolic links.\nFinally, using the\n-b\noption causes\nlsof\nto issue warning messages\nwhen it needs to use the kernel functions that the\n-b\noption\ndirects it to avoid.  You can suppress these messages by\nspecifying the\n-w\noption, but if you do, you won't see the\nalternate device numbers reported in the warning messages.\nALTERNATE DEVICE NUMBERS\ntop\nOn some dialects, when\nlsof\nhas to break a block because it can't\nget information about a mounted file system via the\nlstat(2)\nand\nstat(2)\nkernel functions, or because you specified the\n-b\noption,\nlsof\ncan obtain some of the information it needs - the device\nnumber and possibly the file system type - from the system mount\ntable.  When that is possible,\nlsof\nwill report the device number\nit obtained.  (You can suppress the report by specifying the\n-w\noption.)\nYou can assist this process if your mount table is supported with\nan\n/etc/mtab\nor\n/etc/mnttab\nfile that contains an options field by\nadding a ``dev=xxxx'' field for mount points that do not have one\nin their options strings.  Note: you must be able to edit the file\n- i.e., some mount tables like recent Solaris /etc/mnttab or Linux\n/proc/mounts are read-only and can't be modified.\nYou may also be able to supply device numbers using the\n+m\nand\n+m\nm\noptions, provided they are supported by your dialect.  Check the\noutput of\nlsof's\n-h\nor\n-?\noptions to see if the\n+m\nand\n+m\nm\noptions are available.\nThe ``xxxx'' portion of the field is the hexadecimal value of the\nfile system's device number.  (Consult the\nst_dev\nfield of the\noutput of the\nlstat(2)\nand\nstat(2)\nfunctions for the appropriate\nvalues for your file systems.)  Here's an example from a Sun\nSolaris 2.6\n/etc/mnttab\nfor a file system remotely mounted via\nNFS:\nnfs  ignore,noquota,dev=2a40001\nThere's an advantage to having ``dev=xxxx'' entries in your mount\ntable file, especially for file systems that are mounted from\nremote NFS servers.  When a remote server crashes and you want to\nidentify its users by running\nlsof\non one of its clients,\nlsof\nprobably won't be able to get output from the\nlstat(2)\nand\nstat(2)\nfunctions for the file system.  If it can obtain the file system's\ndevice number from the mount table, it will be able to display the\nfiles open on the crashed NFS server.\nSome dialects that do not use an ASCII\n/etc/mtab\nor\n/etc/mnttab\nfile for the mount table may still provide an alternative device\nnumber in their internal mount tables.  This includes AIX, Apple\nDarwin, FreeBSD, NetBSD, OpenBSD, and Tru64 UNIX.\nLsof\nknows how\nto obtain the alternative device number for these dialects and\nuses it when its attempt to\nlstat(2)\nor\nstat(2)\nthe file system is\nblocked.\nIf you're not sure your dialect supplies alternate device numbers\nfor file systems from its mount table, use this\nlsof\nincantation\nto see if it reports any alternate device numbers:\nlsof -b\nLook for standard error file warning messages that begin\n``assuming \"dev=xxxx\" from ...''.\nKERNEL NAME CACHE\ntop\nLsof\nis able to examine the kernel's name cache or use other\nkernel facilities (e.g., the ADVFS 4.x tag_to_path() function\nunder Tru64 UNIX) on some dialects for most file system types,\nexcluding AFS, and extract recently used path name components from\nit.  (AFS file system path lookups don't use the kernel's name\ncache; some Solaris VxFS file system operations apparently don't\nuse it, either.)\nLsof\nreports the complete paths it finds in the NAME column.  If\nlsof\ncan't report all components in a path, it reports in the NAME\ncolumn the file system name, followed by a space, two `-'\ncharacters, another space, and the name components it has located,\nseparated by the `/' character.\nWhen\nlsof\nis run in repeat mode - i.e., with the\n-r\noption\nspecified - the extent to which it can report path name components\nfor the same file may vary from cycle to cycle.  That's because\nother running processes can cause the kernel to remove entries\nfrom its name cache and replace them with others.\nLsof's\nuse of the kernel name cache to identify the paths of files\ncan lead it to report incorrect components under some\ncircumstances.  This can happen when the kernel name cache uses\ndevice and node number as a key (e.g., SCO OpenServer) and a key\non a rapidly changing file system is reused.  If the UNIX\ndialect's kernel doesn't purge the name cache entry for a file\nwhen it is unlinked,\nlsof\nmay find a reference to the wrong entry\nin the cache.  The\nlsof\nFAQ (The\nFAQ\nsection gives its location.)\nhas more information on this situation.\nLsof\ncan report path name components for these dialects:\nFreeBSD\nHP-UX\nLinux\nNetBSD\nSCO OpenServer\nSCO|Caldera UnixWare\nSolaris\nTru64 UNIX\nLsof\ncan't report path name components for these dialects:\nAIX\nOpenBSD\nIf you want to know why\nlsof\ncan't report path name components for\nsome dialects, see the\nlsof\nFAQ (The\nFAQ\nsection gives its\nlocation.)\nDEVICE CACHE FILE\ntop\nExamining all members of the\n/dev\n(or\n/devices\n) node tree with\nstat(2)\nfunctions can be time consuming.  What's more, the\ninformation that\nlsof\nneeds - device number, inode number, and\npath - rarely changes.\nConsequently,\nlsof\nnormally maintains an ASCII text file of cached\n/dev\n(or\n/devices\n) information (exception: the /proc-based Linux\nlsof\nwhere it's not needed.)  The local system administrator who\nbuilds\nlsof\ncan control the way the device cache file path is\nformed, selecting from these options:\nPath from the\n-D\noption;\nPath from an environment variable;\nSystem-wide path;\nPersonal path (the default);\nPersonal path, modified by an environment variable.\nConsult the output of the\n-h\n,\n-D? ,\nor\n-?\nhelp options for the\ncurrent state of device cache support.  The help output lists the\ndefault read-mode device cache file path that is in effect for the\ncurrent invocation of\nlsof\n.  The\n-D?\noption output lists the\nread-only and write device cache file paths, the names of any\napplicable environment variables, and the personal device cache\npath format.\nLsof\ncan detect that the current device cache file has been\naccidentally or maliciously modified by integrity checks,\nincluding the computation and verification of a sixteen bit Cyclic\nRedundancy Check (CRC) sum on the file's contents.  When\nlsof\nsenses something wrong with the file, it issues a warning and\nattempts to remove the current cache file and create a new copy,\nbut only to a path that the process can legitimately write.\nThe path from which a\nlsof\nprocess may attempt to read a device\ncache file may not be the same as the path to which it can\nlegitimately write.  Thus when\nlsof\nsenses that it needs to update\nthe device cache file, it may choose a different path for writing\nit from the path from which it read an incorrect or outdated\nversion.\nIf available, the\n-Dr\noption will inhibit the writing of a new\ndevice cache file.  (It's always available when specified without\na path name argument.)\nWhen a new device is added to the system, the device cache file\nmay need to be recreated.  Since\nlsof\ncompares the mtime of the\ndevice cache file with the mtime and ctime of the\n/dev\n(or\n/devices\n) directory, it usually detects that a new device has been\nadded; in that case\nlsof\nissues a warning message and attempts to\nrebuild the device cache file.\nWhenever\nlsof\nwrites a device cache file, it sets its ownership to\nthe real UID of the executing process, and its permission modes to\n0600, this restricting its reading and writing to the file's\nowner.\nLSOF PERMISSIONS THAT AFFECT DEVICE CACHE FILE ACCESS\ntop\nTwo permissions of the\nlsof\nexecutable affect its ability to\naccess device cache files.  The permissions are set by the local\nsystem administrator when\nlsof\nis installed.\nThe first and rarer permission is setuid-root.  It comes into\neffect when\nlsof\nis executed; its effective UID is then root,\nwhile its real (i.e., that of the logged-on user) UID is not.  The\nlsof\ndistribution recommends that versions for these dialects run\nsetuid-root.\nHP-UX 11.11 and 11.23\nLinux\nThe second and more common permission is setgid.  It comes into\neffect when the effective group IDentification number (GID) of the\nlsof\nprocess is set to one that can access kernel memory devices -\ne.g., ``kmem'', ``sys'', or ``system''.\nAn\nlsof\nprocess that has setgid permission usually surrenders the\npermission after it has accessed the kernel memory devices.  When\nit does that,\nlsof\ncan allow more liberal device cache path\nformations.  The\nlsof\ndistribution recommends that versions for\nthese dialects run setgid and be allowed to surrender setgid\npermission.\nAIX 5.[12] and 5.3-ML1\nApple Darwin 7.x Power Macintosh systems\nFreeBSD 4.x, 4.1x, 5.x and [6789].x for x86-based systems\nFreeBSD 5.x, [6789].x and 1[012].8for Alpha, AMD64 and Sparc64\nbased systems\nHP-UX 11.00\nNetBSD 1.[456], 2.x and 3.x for Alpha, x86, and SPARC-based\nsystems\nOpenBSD 2.[89] and 3.[0-9] for x86-based systems\nSCO OpenServer Release 5.0.6 for x86-based systems\nSCO|Caldera UnixWare 7.1.4 for x86-based systems\nSolaris 2.6, 8, 9 and 10\nTru64 UNIX 5.1\n(Note:\nlsof\nfor AIX 5L and above needs setuid-root permission if\nits\n-X\noption is used.)\nLsof\nfor these dialects does not support a device cache, so the\npermissions given to the executable don't apply to the device\ncache file.\nLinux\nDEVICE CACHE FILE PATH FROM THE -D OPTION\ntop\nThe\n-D\noption provides limited means for specifying the device\ncache file path.  Its\n?\nfunction will report the read-only and\nwrite device cache file paths that\nlsof\nwill use.\nWhen the\n-D b\n,\nr\n, and\nu\nfunctions are available, you can use them\nto request that the cache file be built in a specific location\n(\nb\n[\npath\n]); read but not rebuilt (\nr\n[\npath\n]); or read and rebuilt\n(\nu\n[\npath\n]).  The\nb\n,\nr\n, and\nu\nfunctions are restricted under some\nconditions.  They are restricted when the\nlsof\nprocess is\nsetuid-root.  The path specified with the\nr\nfunction is always\nread-only, even when it is available.\nThe\nb\n,\nr\n, and\nu\nfunctions are also restricted when the\nlsof\nprocess runs setgid and\nlsof\ndoesn't surrender the setgid\npermission.  (See the\nLSOF PERMISSIONS THAT AFFECT DEVICE CACHE\nFILE ACCESS\nsection for a list of implementations that normally\ndon't surrender their setgid permission.)\nA further\n-D\nfunction,\ni\n(for ignore), is always available.\nWhen available, the\nb\nfunction tells\nlsof\nto read device\ninformation from the kernel with the\nstat(2)\nfunction and build a\ndevice cache file at the indicated path.\nWhen available, the\nr\nfunction tells\nlsof\nto read the device cache\nfile, but not update it.  When a path argument accompanies\n-Dr\n, it\nnames the device cache file path.  The\nr\nfunction is always\navailable when it is specified without a path name argument.  If\nlsof\nis not running setuid-root and surrenders its setgid\npermission, a path name argument may accompany the\nr\nfunction.\nWhen available, the\nu\nfunction tells\nlsof\nto attempt to read and\nuse the device cache file.  If it can't read the file, or if it\nfinds the contents of the file incorrect or outdated, it will read\ninformation from the kernel, and attempt to write an updated\nversion of the device cache file, but only to a path it considers\nlegitimate for the\nlsof\nprocess effective and real UIDs.\nDEVICE CACHE PATH FROM AN ENVIRONMENT VARIABLE\ntop\nLsof's\nsecond choice for the device cache file is the contents of\nthe LSOFDEVCACHE environment variable.  It avoids this choice if\nthe\nlsof\nprocess is setuid-root, or the real UID of the process is\nroot.\nA further restriction applies to a device cache file path taken\nfrom the LSOFDEVCACHE environment variable:\nlsof\nwill not write a\ndevice cache file to the path if the\nlsof\nprocess doesn't\nsurrender its setgid permission.  (See the\nLSOF PERMISSIONS THAT\nAFFECT DEVICE CACHE FILE ACCESS\nsection for information on\nimplementations that don't surrender their setgid permission.)\nThe local system administrator can disable the use of the\nLSOFDEVCACHE environment variable or change its name when building\nlsof\n.  Consult the output of\n-D?\nfor the environment variable's\nname.\nSYSTEM-WIDE DEVICE CACHE PATH\ntop\nThe local system administrator may choose to have a system-wide\ndevice cache file when building\nlsof\n.  That file will generally be\nconstructed by a special system administration procedure when the\nsystem is booted or when the contents of\n/dev\nor\n/devices\n)\nchanges.  If defined, it is\nlsof's\nthird device cache file path\nchoice.\nYou can tell that a system-wide device cache file is in effect for\nyour local installation by examining the\nlsof\nhelp option output -\ni.e., the output from the\n-h\nor\n-?\noption.\nLsof\nwill never write to the system-wide device cache file path by\ndefault.  It must be explicitly named with a\n-D\nfunction in a\nroot-owned procedure.  Once the file has been written, the\nprocedure must change its permission modes to 0644 (owner-read and\nowner-write, group-read, and other-read).\nPERSONAL DEVICE CACHE PATH (DEFAULT)\ntop\nThe default device cache file path of the\nlsof\ndistribution is one\nrecorded in the home directory of the real UID that executes\nlsof\n.\nAdded to the home directory is a second path component of the form\n.lsof_hostname\n.\nThis is\nlsof's\nfourth device cache file path choice, and is\nusually the default.  If a system-wide device cache file path was\ndefined when\nlsof\nwas built, this fourth choice will be applied\nwhen\nlsof\ncan't find the system-wide device cache file.  This is\nthe\nonly\ntime\nlsof\nuses two paths when reading the device cache\nfile.\nThe\nhostname\npart of the second component is the base name of the\nexecuting host, as returned by\ngethostname(2)\n.  The base name is\ndefined to be the characters preceding the first `.'  in the\ngethostname(2)\noutput, or all the\ngethostname(2)\noutput if it\ncontains no `.'.\nThe device cache file belongs to the user ID and is readable and\nwritable by the user ID alone - i.e., its modes are 0600.  Each\ndistinct real user ID on a given host that executes\nlsof\nhas a\ndistinct device cache file.  The\nhostname\npart of the path\ndistinguishes device cache files in an NFS-mounted home directory\ninto which device cache files are written from several different\nhosts.\nThe personal device cache file path formed by this method\nrepresents a device cache file that\nlsof\nwill attempt to read, and\nwill attempt to write should it not exist or should its contents\nbe incorrect or outdated.\nThe\n-Dr\noption without a path name argument will inhibit the\nwriting of a new device cache file.\nThe\n-D?\noption will list the format specification for\nconstructing the personal device cache file.  The conversions used\nin the format specification are described in the\n00DCACHE\nfile of\nthe\nlsof\ndistribution.\nMODIFIED PERSONAL DEVICE CACHE PATH\ntop\nIf this option is defined by the local system administrator when\nlsof\nis built, the LSOFPERSDCPATH environment variable contents\nmay be used to add a component of the personal device cache file\npath.\nThe LSOFPERSDCPATH variable contents are inserted in the path at\nthe place marked by the local system administrator with the ``%p''\nconversion in the HASPERSDC format specification of the dialect's\nmachine.h\nheader file.  (It's placed right after the home\ndirectory in the default\nlsof\ndistribution.)\nThus, for example, if LSOFPERSDCPATH contains ``LSOF'', the home\ndirectory is ``/Homes/abe'', the host name is\n``lsof.itap.purdue.edu'', and the HASPERSDC format is the default\n(``%h/%p.lsof_%L''), the modified personal device cache file path\nis:\n/Homes/abe/LSOF/.lsof_vic\nThe LSOFPERSDCPATH environment variable is ignored when the\nlsof\nprocess is setuid-root or when the real UID of the process is\nroot.\nLsof\nwill not write to a modified personal device cache file path\nif the\nlsof\nprocess doesn't surrender setgid permission.  (See the\nLSOF PERMISSIONS THAT AFFECT DEVICE CACHE FILE ACCESS\nsection for\na list of implementations that normally don't surrender their\nsetgid permission.)\nIf, for example, you want to create a sub-directory of personal\ndevice cache file paths by using the LSOFPERSDCPATH environment\nvariable to name it, and\nlsof\ndoesn't surrender its setgid\npermission, you will have to allow\nlsof\nto create device cache\nfiles at the standard personal path and move them to your\nsubdirectory with shell commands.\nThe local system administrator may: disable this option when\nlsof\nis built; change the name of the environment variable from\nLSOFPERSDCPATH to something else; change the HASPERSDC format to\ninclude the personal path component in another place; or exclude\nthe personal path component entirely.  Consult the output of the\n-D?\noption for the environment variable's name and the HASPERSDC\nformat specification.\nDIAGNOSTICS\ntop\nErrors are identified with messages on the standard error file.\nLsof\nreturns a one (1) if any error was detected, including the\nfailure to locate command names, file names, Internet addresses or\nfiles, login names, NFS files, PIDs, PGIDs, or UIDs it was asked\nto list.  If the\n-V\noption is specified,\nlsof\nwill indicate the\nsearch items it failed to list.  If the\n-Q\noption is specified,\nlsof\nwill ignore any search item failures and only return an error\nif something unusual and unrecoverable happened.\nIt returns a zero (0) if no errors were detected and if either the\n-Q\noption was specified or it was able to list some information\nabout all the specified search arguments.\nWhen\nlsof\ncannot open access to\n/dev\n(or\n/devices\n) or one of its\nsubdirectories, or get information on a file in them with\nstat(2)\n,\nit issues a warning message and continues.  That\nlsof\nwill issue\nwarning messages about inaccessible files in\n/dev\n(or\n/devices\n) is\nindicated in its help output - requested with the\n-h\nor >B -?\noptions -  with the message:\nInaccessible /dev warnings are enabled.\nThe warning message may be suppressed with the\n-w\noption.  It may\nalso have been suppressed by the system administrator when\nlsof\nwas compiled by the setting of the WARNDEVACCESS definition.  In\nthis case, the output from the help options will include the\nmessage:\nInaccessible /dev warnings are disabled.\nInaccessible device warning messages usually disappear after\nlsof\nhas created a working device cache file.\nEXAMPLES\ntop\nFor a more extensive set of examples, documented more fully, see\nthe\n00QUICKSTART\nfile of the\nlsof\ndistribution.\nTo list all open files, use:\nlsof\nTo list all open Internet, x.25 (HP-UX), and UNIX domain files,\nuse:\nlsof -i -U\nTo list all open IPv4 network files in use by the process whose\nPID is 1234, use:\nlsof -i 4 -a -p 1234\nIf it's okay for PID 1234 to not exist, or for PID 1234 to not\nhave any open IPv4 network files, add\n-Q\n:\nlsof -Q -i 4 -a -p 1234\nPresuming the UNIX dialect supports IPv6, to list only open IPv6\nnetwork files, use:\nlsof -i 6\nTo list all files using any protocol on ports 513, 514, or 515 of\nhost wonderland.cc.purdue.edu, use:\nlsof -i @wonderland.cc.purdue.edu:513-515\nTo list all files using any protocol on any port of\nmace.cc.purdue.edu (cc.purdue.edu is the default domain), use:\nlsof -i @mace\nTo list all open files for login name ``abe'', or user ID 1234, or\nprocess 456, or process 123, or process 789, use:\nlsof -p 456,123,789 -u 1234,abe\nTo list all open files on device /dev/hd4, use:\nlsof /dev/hd4\nTo find the process that has /u/abe/foo open without worrying if\nthere are none, use:\nlsof -Q /u/abe/foo\nTo take action only if a process has /u/abe/foo open, use:\nlsof /u/abe/foo  echo \"still in use\"\nTo send a SIGHUP to the processes that have /u/abe/bar open, use:\nkill -HUP `lsof -t /u/abe/bar`\nTo find any open file, including an open UNIX domain socket file,\nwith the name\n/dev/log\n, use:\nlsof /dev/log\nTo find processes with open files on the NFS file system named\n/nfs/mount/point\nwhose server is inaccessible, and presuming your\nmount table supplies the device number for\n/nfs/mount/point\n, use:\nlsof -b /nfs/mount/point\nTo do the preceding search with warning messages suppressed, use:\nlsof -bw /nfs/mount/point\nTo ignore the device cache file, use:\nlsof -Di\nTo obtain PID and command name field output for each process, file\ndescriptor, file device number, and file inode number for each\nfile of each process, use:\nlsof -FpcfDi\nTo list the files at descriptors 1 and 3 of every process running\nthe\nlsof\ncommand for login ID ``abe'' every 10 seconds, use:\nlsof -c lsof -a -d 1 -d 3 -u abe -r10\nTo list the current working directory of processes running a\ncommand that is exactly four characters long and has an 'o' or 'O'\nin character three, use this regular expression form of the\n-c\nc\noption:\nlsof -c /^..o.$/i -a -d cwd\nTo find an IP version 4 socket file by its associated numeric\ndot-form address, use:\nlsof -i@128.210.15.17\nTo find an IP version 6 socket file (when the UNIX dialect\nsupports IPv6) by its associated numeric colon-form address, use:\nlsof -i@[0:1:2:3:4:5:6:7]\nTo find an IP version 6 socket file (when the UNIX dialect\nsupports IPv6) by an associated numeric colon-form address that\nhas a run of zeroes in it - e.g., the loop-back address - use:\nlsof -i@[::1]\nTo obtain a repeat mode marker line that contains the current\ntime, use:\nlsof -rm====%T====\nTo add spaces to the previous marker line, use:\nlsof -r \"m==== %T ====\"\nBUGS\ntop\nSince\nlsof\nreads kernel memory in its search for open files, rapid\nchanges in kernel memory may produce unpredictable results.\nWhen a file has multiple record locks, the lock status character\n(following the file descriptor) is derived from a test of the\nfirst lock structure, not from any combination of the individual\nrecord locks that might be described by multiple lock structures.\nLsof\ncan't search for files with restrictive access permissions by\nname\nunless it is installed with root set-UID permission.\nOtherwise it is limited to searching for files to which its user\nor its set-GID group (if any) has access permission.\nThe display of the destination address of a raw socket (e.g., for\nping\n) depends on the UNIX operating system.  Some dialects store\nthe destination address in the raw socket's protocol control\nblock, some do not.\nLsof\ncan't always represent Solaris device numbers in the same way\nthat\nls(1)\ndoes.  For example, the major and minor device numbers\nthat the\nlstat(2)\nand\nstat(2)\nfunctions report for the directory\non which CD-ROM files are mounted (typically\n/cdrom\n) are not the\nsame as the ones that it reports for the device on which CD-ROM\nfiles are mounted (typically\n/dev/sr0\n).  (\nLsof\nreports the\ndirectory numbers.)\nThe support for\n/proc\nfile systems is available only for BSD and\nTru64 UNIX dialects, Linux, and dialects derived from SYSV R4 -\ne.g., FreeBSD, NetBSD, OpenBSD, Solaris, UnixWare.\nSome\n/proc\nfile items - device number, inode number, and file size\n- are unavailable in some dialects.  Searching for files in a\n/proc\nfile system may require that the full path name be\nspecified.\nNo text (\ntxt\n) file descriptors are displayed for Linux processes.\nAll entries for files other than the current working directory,\nthe root directory, and numerical file descriptors are labeled\nmem\ndescriptors.\nLsof\ncan't search for Tru64 UNIX named pipes by name, because\ntheir kernel implementation of lstat(2) returns an improper device\nnumber for a named pipe.\nLsof\ncan't report fully or correctly on HP-UX 9.01, 10.20, and\n11.00 locks because of insufficient access to kernel data or\nerrors in the kernel data.  See the\nlsof\nFAQ (The\nFAQ\nsection\ngives its location.)  for details.\nThe AIX SMT file type is a fabrication.  It's made up for file\nstructures whose type (15) isn't defined in the AIX\n/usr/include/sys/file.h\nheader file.  One way to create such file\nstructures is to run X clients with the DISPLAY variable set to\n``:0.0''.\nThe\n+|-f\n[cfn]\noption is not supported under /proc-based Linux\nlsof\n, because it doesn't read kernel structures from kernel\nmemory.\nENVIRONMENT\ntop\nLsof\nmay access these environment variables.\nLANG   defines a language locale.  See\nsetlocale(3)\nfor the names\nof other variables that can be used in place of LANG -\ne.g., LC_ALL, LC_TYPE, etc.\nLSOFDEVCACHE\ndefines the path to a device cache file.  See the\nDEVICE\nCACHE PATH FROM AN ENVIRONMENT VARIABLE\nsection for more\ninformation.\nLSOFPERSDCPATH\ndefines the middle component of a modified personal device\ncache file path.  See the\nMODIFIED PERSONAL DEVICE CACHE\nPATH\nsection for more information.\nFAQ\ntop\nFrequently-asked questions and their answers (an FAQ) are\navailable in the\n00FAQ\nfile of the\nlsof\ndistribution.\nThat latest version of the file is found at:\nhttps://github.com/lsof-org/lsof/blob/master/00FAQ\nFILES\ntop\n/dev/kmem\nkernel virtual memory device\n/dev/mem\nphysical memory device\n/dev/swap\nsystem paging device\n.lsof_hostname\nlsof's\ndevice cache file (The suffix,\nhostname\n, is the\nfirst component of the host's name returned by\ngethostname(2)\n.)\nAUTHORS\ntop\nLsof\nwas written by Victor A.Abell <abe@purdue.edu> of Purdue\nUniversity.  Since version 4.93.0, the lsof-org team at GitHub\nmaintains lsof.  Many others have contributed to\nlsof\n.  They're\nlisted in the\n00CREDITS\nfile of the\nlsof\ndistribution.\nDISTRIBUTION\ntop\nThe latest distribution of\nlsof\nis available at\nhttps://github.com/lsof-org/lsof/releases\nSEE ALSO\ntop\nNot all the following manual pages may exist in every UNIX dialect\nto which\nlsof\nhas been ported.\naccess(2)\n,\nawk\n(1),\ncrash\n(1),\nfattach(3C), ff\n(1),\nfstat\n(8),\nfuser(1)\n,\ngethostname(2)\n,\nisprint(3)\n,\nkill(1)\n,\nlocaltime(3)\n,\nlstat(2)\n,\nmodload\n(8),\nmount(8)\n,\nnetstat\n(1),\nofiles(8L), open\n(2),\nperl\n(1),\nps(1)\n,\nreadlink(2)\n,\nsetlocale(3)\n,\nstat(2)\n,\nstrftime(3)\n,\ntime(2)\n,\nuname(1)\n.\nCOLOPHON\ntop\nThis page is part of the\nlsof\n(LiSt Open Files) project.\nInformation about the project can be found at\nâ¨\nhttp://people.freebsd.org/~abe/\nâ©.  If you have a bug report for\nthis manual page, send it to abe@purdue.edu.  This page was\nobtained from the tarball lsof-4.99.5.tar.gz fetched from\nâ¨\nhttps://github.com/lsof-org/lsof/releases/\nâ© on 2025-08-11.  If\nyou discover any rendering problems in this HTML version of the\npage, or you believe there is a better or more up-to-date source\nfor the page, or you have corrections or improvements to the\ninformation in this COLOPHON (which is\nnot\npart of the original\nmanual page), send a mail to man-pages@man7.org\nRevision-\nLSOF\n(8)\nPages that refer to this page:\nfuser(1)\n,\nlsfd(1)\n,\ncsysdig(8)\n,\nsysdig(8)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man8/lsof.8.html"}}
{"text": "pgrep(1) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\npgrep(1) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nOPTIONS\n|\nOPERANDS\n|\nEXAMPLES\n|\nEXIT STATUS\n|\nNOTES\n|\nBUGS\n|\nSEE ALSO\n|\nREPORTING BUGS\n|\nCOLOPHON\nPGREP\n(1)                 General Commands Manual\nPGREP\n(1)\nNAME\ntop\npgrep, pkill, pidwait - look up, signal, or wait for processes\nbased on name and other attributes\nSYNOPSIS\ntop\npgrep\n[\noption\n...]\npattern\npkill\n[\noption\n...]\npattern\npidwait\n[\noption\n...]\npattern\nDESCRIPTION\ntop\npgrep\nlooks through the currently running processes and lists the\nprocess IDs which match the selection criteria to stdout.  All the\ncriteria have to match.  For example,\n$ pgrep -u root sshd\nwill only list the processes whose name include\nsshd\nAND owned by\nroot\n.  On the other hand,\n$ pgrep -u root,daemon\nwill list the processes owned by\nroot\nOR\ndaemon\n.\npkill\nwill send the specified signal (by default\nSIGTERM\n) to each\nprocess instead of listing them on stdout.\npidwait\nwill wait for each process instead of listing them on\nstdout.\nOPTIONS\ntop\n-\nsignal\n--signal\nsignal\nDefines the signal to send to each matched process.  Either\nthe numeric or the symbolic signal name can be used. In\npgrep\nor\npidwait\nmode only the long option can be used and\nhas no effect unless used in conjunction with\n--require-handler\nto filter to processes with a userspace\nsignal handler present for a particular signal.\n-a\n,\n--list-full\nList the full command line as well as the process ID.\n(\npgrep\nonly.)\n-A\n,\n--ignore-ancestors\nIgnore all ancestors of\npgrep\n,\npkill\n, or\npidwait\n.  For\nexample, this can be useful when elevating with\nsudo\nor\nsimilar tools.\n-c\n,\n--count\nSuppress normal output; instead print a count of matching\nprocesses.  When count does not match anything, e.g.\nreturns zero, the command will return non-zero value. Note\nthat for pkill and pidwait, the count is the number of\nmatching processes, not the processes that were\nsuccessfully signaled or waited for.\n-d\n,\n--delimiter\ndelimiter\nSets the string used to delimit each process ID in the\noutput (by default a newline).  (\npgrep\nonly.)\n-e\n,\n--echo\nDisplay name and PID of the process being killed.  (\npkill\nonly.)\n-f\n,\n--full\nThe\npattern\nis normally only matched against the process\nname.  When\n-f\nis set, the full command line is used.\n-F\n,\n--pidfile\nfile\nRead\nPID\ns from\nfile\n.  This option is more useful for\npkill\nor\npidwait\nthan\npgrep\n.  The filename \"-\" can be used to\nread from\nSTDIN\n.  Conflicts with the\n--pid\noption.\n-g\n,\n--pgroup\npgrp\n,...\nOnly match processes in the process group IDs listed.\nProcess group 0 is translated into\npgrep\n's,\npkill\n's, or\npidwait\n's own process group.\n-G\n,\n--group\ngid\n,...\nOnly match processes whose real group ID is listed.  Either\nthe numerical or symbolical value may be used.\n-H\n,\n--require-handler\nOnly match processes with a userspace signal handler\npresent for the signal to be sent.\n-i\n,\n--ignore-case\nMatch processes case-insensitively.\n-l\n,\n--list-name\nList the process name as well as the process ID.  (\npgrep\nonly.)\n-L\n,\n--logpidfile\nFail if pidfile (see\n-F\n) not locked.\n-m\n,\n--mrelease\nAfter sending the signal, invoke the\nprocess_mrelease\n()\nsystem call to immediately free the target process's\nmemory.\n-n\n,\n--newest\nSelect only the newest (most recently started) of the\nmatching processes.\n-o\n,\n--oldest\nSelect only the oldest (least recently started) of the\nmatching processes.\n-O\n,\n--older\nsecs\nSelect processes older than secs.\n-p\n,\n--pid\npid\n,...\nOnly match processes whose process ID is listed. Conflicts\nwith the\n--pidfile\noption.\n-P\n,\n--parent\nppid\n,...\nOnly match processes whose parent process ID is listed.\n-q\n,\n--queue\nvalue\nSend the integer\nvalue\nalong with the signal. This option\nwill either use\npidfd_send_signal(2)\nwith a value applied\nor\nsigqueue(3)\nrather than\nkill(2)\n.  If the receiving\nprocess has installed a handler for this signal using the\nSA_SIGINFO flag to\nsigaction(2)\n, then it can obtain this\ndata via the si_value field of the siginfo_t structure.\n-Q\n,\n--shell-quote\nOutput the command line in shell-quoted form.  (\npgrep\nonly.)\n-r\n,\n--runstates\nD,R,S,Z,\n...\nMatch only processes which match the process state.\n-s\n,\n--session\nsid\n,...\nOnly match processes whose process session ID is listed.\nSession ID 0 is translated into\npgrep\n's,\npkill\n's, or\npidwait\n's own session ID.\n-t\n,\n--terminal\nterm\n,...\nOnly match processes whose controlling terminal is listed.\nThe terminal name should be specified without the \"/dev/\"\nprefix.\n-u\n,\n--euid\neuid\n,...\nOnly match processes whose effective user ID is listed.\nEither the numerical or symbolical value may be used.\n-U\n,\n--uid\nuid\n,...\nOnly match processes whose real user ID is listed.  Either\nthe numerical or symbolical value may be used.\n-v\n,\n--inverse\nNegates the matching.  This option is usually used in\npgrep\n's or\npidwait\n's context.  In\npkill\n's context the short\noption is disabled to avoid accidental usage of the option.\n-w\n,\n--lightweight\nShows all thread ids instead of pids in\npgrep\n's or\npidwait\n's context.  In\npkill\n's context this option is\ndisabled.\n-x\n,\n--exact\nOnly match processes whose names (or command lines if\n-f\nis\nspecified)\nexactly\nmatch the\npattern\n.\n--cgroup\nname\n,...\nMatch on provided control group (cgroup) v2 name. See\ncgroups(7)\n--env\nname\n[\n=value\n],...\nMatch on process that have these environment variables. If\nthe\n=value\nparameter is not defined then only the variable\nname is matched.\n--ns\npid\nMatch processes that belong to the same namespaces.\nRequired to run as root to match processes from other\nusers. See\n--nslist\nfor how to limit which namespaces to\nmatch.\n--nslist\nname\n,...\nMatch only the provided namespaces. Available namespaces:\nipc, mnt, net, pid, user, uts.\n-V\n,\n--version\nDisplay version information and exit.\n-h\n,\n--help\nDisplay help and exit.\nOPERANDS\ntop\npattern\nSpecifies an Extended Regular Expression for matching\nagainst the process names or command lines.\nEXAMPLES\ntop\nExample 1: Find the process ID of the\nnamed\ndaemon:\n$ pgrep -u root named\nExample 2: Make\nsyslog\nreread its configuration file:\n$ pkill -HUP syslogd\nExample 3: Give detailed information on all\nbash\nprocesses:\n$ ps -fp $(pgrep -d, -x bash)\nExample 4: Make all\nchrome\nprocesses run nicer:\n$ renice +4 $(pgrep chrome)\nExample 5: Wait for a process with a known PID to finish:\n$ echo ${PID} | pidwait -F -\nEXIT STATUS\ntop\n0\nOne or more processes matched the criteria. For\npkill\nand\npidwait\n, one or more processes must also have been\nsuccessfully signalled or waited for.\n1\nNo processes matched or none of them could be signalled.\n2\nSyntax error in the command line.\n3\nFatal error: out of memory etc.\nNOTES\ntop\nThe process name used for matching is limited to the 15 characters\npresent in the output of /proc/\npid\n/stat.  Use the\n-f\noption to\nmatch against the complete command line, /proc/\npid\n/cmdline.\nThreads may not have the same process name as the parent process\nbut will have the same command line.\nThe running\npgrep\n,\npkill\n, or\npidwait\nprocess will never report\nitself as a match.\nThe\n-O --older\noption will silently fail if\n/proc\nis mounted with\nthe\nsubset=pid\noption.\npkill\nwill attempt to use\npidfd_send_signal(2)\ninstead of\nkill(2)\nor\nsigqueue(3)\nto send a signal to the target process if it is\nable to get the process file descriptor.\nBUGS\ntop\nThe options\n-n\nand\n-o\nand\n-v\ncan not be combined.  Let me know if\nyou need to do this.\nIf processes start in the same clock tick (usually but not always\na 100th of a second), the options\n-n\nand\n-o\nwill not be able to\ndistinguish which process started in the same clock tick and may\ngive erroneous results.\nDefunct processes are reported.\npidwait\nrequires the\npidfd_open(2)\nsystem call which first\nappeared in Linux 5.3.\nSEE ALSO\ntop\nkillall(1)\n,\nkill(1)\n,\nps(1)\n,\nskill(1)\n,\nkill(2)\n,\nsigaction(2)\n,\npidfd_open(2)\n,\npidfd_send_signal(2)\n,\nsigqueue(3)\n,\ncgroups(7)\n,\nregex(7)\n,\nsignal(7)\nREPORTING BUGS\ntop\nPlease send bug reports to â¨procps@freelists.orgâ©.\nCOLOPHON\ntop\nThis page is part of the\nprocps-ng\n(/proc filesystem utilities)\nproject.  Information about the project can be found at\nâ¨\nhttps://gitlab.com/procps-ng/procps\nâ©.  If you have a bug report\nfor this manual page, see\nâ¨\nhttps://gitlab.com/procps-ng/procps/blob/master/Documentation/bugs.md\nâ©.\nThis page was obtained from the project's upstream Git repository\nâ¨\nhttps://gitlab.com/procps-ng/procps.git\nâ© on 2025-08-11.  (At that\ntime, the date of the most recent commit that was found in the\nrepository was 2025-07-30.)  If you discover any rendering\nproblems in this HTML version of the page, or you believe there is\na better or more up-to-date source for the page, or you have\ncorrections or improvements to the information in this COLOPHON\n(which is\nnot\npart of the original manual page), send a mail to\nman-pages@man7.org\nprocps-ng                       2025-06-11\nPGREP\n(1)\nPages that refer to this page:\nfuser(1)\n,\nkill(1@@procps-ng)\n,\nkillall(1)\n,\npidof(1)\n,\npmap(1)\n,\nps(1)\n,\npslog(1)\n,\npwdx(1)\n,\nskill(1)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man1/pgrep.1.html"}}
{"text": "pgrep(1) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\npgrep(1) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nOPTIONS\n|\nOPERANDS\n|\nEXAMPLES\n|\nEXIT STATUS\n|\nNOTES\n|\nBUGS\n|\nSEE ALSO\n|\nREPORTING BUGS\n|\nCOLOPHON\nPGREP\n(1)                 General Commands Manual\nPGREP\n(1)\nNAME\ntop\npgrep, pkill, pidwait - look up, signal, or wait for processes\nbased on name and other attributes\nSYNOPSIS\ntop\npgrep\n[\noption\n...]\npattern\npkill\n[\noption\n...]\npattern\npidwait\n[\noption\n...]\npattern\nDESCRIPTION\ntop\npgrep\nlooks through the currently running processes and lists the\nprocess IDs which match the selection criteria to stdout.  All the\ncriteria have to match.  For example,\n$ pgrep -u root sshd\nwill only list the processes whose name include\nsshd\nAND owned by\nroot\n.  On the other hand,\n$ pgrep -u root,daemon\nwill list the processes owned by\nroot\nOR\ndaemon\n.\npkill\nwill send the specified signal (by default\nSIGTERM\n) to each\nprocess instead of listing them on stdout.\npidwait\nwill wait for each process instead of listing them on\nstdout.\nOPTIONS\ntop\n-\nsignal\n--signal\nsignal\nDefines the signal to send to each matched process.  Either\nthe numeric or the symbolic signal name can be used. In\npgrep\nor\npidwait\nmode only the long option can be used and\nhas no effect unless used in conjunction with\n--require-handler\nto filter to processes with a userspace\nsignal handler present for a particular signal.\n-a\n,\n--list-full\nList the full command line as well as the process ID.\n(\npgrep\nonly.)\n-A\n,\n--ignore-ancestors\nIgnore all ancestors of\npgrep\n,\npkill\n, or\npidwait\n.  For\nexample, this can be useful when elevating with\nsudo\nor\nsimilar tools.\n-c\n,\n--count\nSuppress normal output; instead print a count of matching\nprocesses.  When count does not match anything, e.g.\nreturns zero, the command will return non-zero value. Note\nthat for pkill and pidwait, the count is the number of\nmatching processes, not the processes that were\nsuccessfully signaled or waited for.\n-d\n,\n--delimiter\ndelimiter\nSets the string used to delimit each process ID in the\noutput (by default a newline).  (\npgrep\nonly.)\n-e\n,\n--echo\nDisplay name and PID of the process being killed.  (\npkill\nonly.)\n-f\n,\n--full\nThe\npattern\nis normally only matched against the process\nname.  When\n-f\nis set, the full command line is used.\n-F\n,\n--pidfile\nfile\nRead\nPID\ns from\nfile\n.  This option is more useful for\npkill\nor\npidwait\nthan\npgrep\n.  The filename \"-\" can be used to\nread from\nSTDIN\n.  Conflicts with the\n--pid\noption.\n-g\n,\n--pgroup\npgrp\n,...\nOnly match processes in the process group IDs listed.\nProcess group 0 is translated into\npgrep\n's,\npkill\n's, or\npidwait\n's own process group.\n-G\n,\n--group\ngid\n,...\nOnly match processes whose real group ID is listed.  Either\nthe numerical or symbolical value may be used.\n-H\n,\n--require-handler\nOnly match processes with a userspace signal handler\npresent for the signal to be sent.\n-i\n,\n--ignore-case\nMatch processes case-insensitively.\n-l\n,\n--list-name\nList the process name as well as the process ID.  (\npgrep\nonly.)\n-L\n,\n--logpidfile\nFail if pidfile (see\n-F\n) not locked.\n-m\n,\n--mrelease\nAfter sending the signal, invoke the\nprocess_mrelease\n()\nsystem call to immediately free the target process's\nmemory.\n-n\n,\n--newest\nSelect only the newest (most recently started) of the\nmatching processes.\n-o\n,\n--oldest\nSelect only the oldest (least recently started) of the\nmatching processes.\n-O\n,\n--older\nsecs\nSelect processes older than secs.\n-p\n,\n--pid\npid\n,...\nOnly match processes whose process ID is listed. Conflicts\nwith the\n--pidfile\noption.\n-P\n,\n--parent\nppid\n,...\nOnly match processes whose parent process ID is listed.\n-q\n,\n--queue\nvalue\nSend the integer\nvalue\nalong with the signal. This option\nwill either use\npidfd_send_signal(2)\nwith a value applied\nor\nsigqueue(3)\nrather than\nkill(2)\n.  If the receiving\nprocess has installed a handler for this signal using the\nSA_SIGINFO flag to\nsigaction(2)\n, then it can obtain this\ndata via the si_value field of the siginfo_t structure.\n-Q\n,\n--shell-quote\nOutput the command line in shell-quoted form.  (\npgrep\nonly.)\n-r\n,\n--runstates\nD,R,S,Z,\n...\nMatch only processes which match the process state.\n-s\n,\n--session\nsid\n,...\nOnly match processes whose process session ID is listed.\nSession ID 0 is translated into\npgrep\n's,\npkill\n's, or\npidwait\n's own session ID.\n-t\n,\n--terminal\nterm\n,...\nOnly match processes whose controlling terminal is listed.\nThe terminal name should be specified without the \"/dev/\"\nprefix.\n-u\n,\n--euid\neuid\n,...\nOnly match processes whose effective user ID is listed.\nEither the numerical or symbolical value may be used.\n-U\n,\n--uid\nuid\n,...\nOnly match processes whose real user ID is listed.  Either\nthe numerical or symbolical value may be used.\n-v\n,\n--inverse\nNegates the matching.  This option is usually used in\npgrep\n's or\npidwait\n's context.  In\npkill\n's context the short\noption is disabled to avoid accidental usage of the option.\n-w\n,\n--lightweight\nShows all thread ids instead of pids in\npgrep\n's or\npidwait\n's context.  In\npkill\n's context this option is\ndisabled.\n-x\n,\n--exact\nOnly match processes whose names (or command lines if\n-f\nis\nspecified)\nexactly\nmatch the\npattern\n.\n--cgroup\nname\n,...\nMatch on provided control group (cgroup) v2 name. See\ncgroups(7)\n--env\nname\n[\n=value\n],...\nMatch on process that have these environment variables. If\nthe\n=value\nparameter is not defined then only the variable\nname is matched.\n--ns\npid\nMatch processes that belong to the same namespaces.\nRequired to run as root to match processes from other\nusers. See\n--nslist\nfor how to limit which namespaces to\nmatch.\n--nslist\nname\n,...\nMatch only the provided namespaces. Available namespaces:\nipc, mnt, net, pid, user, uts.\n-V\n,\n--version\nDisplay version information and exit.\n-h\n,\n--help\nDisplay help and exit.\nOPERANDS\ntop\npattern\nSpecifies an Extended Regular Expression for matching\nagainst the process names or command lines.\nEXAMPLES\ntop\nExample 1: Find the process ID of the\nnamed\ndaemon:\n$ pgrep -u root named\nExample 2: Make\nsyslog\nreread its configuration file:\n$ pkill -HUP syslogd\nExample 3: Give detailed information on all\nbash\nprocesses:\n$ ps -fp $(pgrep -d, -x bash)\nExample 4: Make all\nchrome\nprocesses run nicer:\n$ renice +4 $(pgrep chrome)\nExample 5: Wait for a process with a known PID to finish:\n$ echo ${PID} | pidwait -F -\nEXIT STATUS\ntop\n0\nOne or more processes matched the criteria. For\npkill\nand\npidwait\n, one or more processes must also have been\nsuccessfully signalled or waited for.\n1\nNo processes matched or none of them could be signalled.\n2\nSyntax error in the command line.\n3\nFatal error: out of memory etc.\nNOTES\ntop\nThe process name used for matching is limited to the 15 characters\npresent in the output of /proc/\npid\n/stat.  Use the\n-f\noption to\nmatch against the complete command line, /proc/\npid\n/cmdline.\nThreads may not have the same process name as the parent process\nbut will have the same command line.\nThe running\npgrep\n,\npkill\n, or\npidwait\nprocess will never report\nitself as a match.\nThe\n-O --older\noption will silently fail if\n/proc\nis mounted with\nthe\nsubset=pid\noption.\npkill\nwill attempt to use\npidfd_send_signal(2)\ninstead of\nkill(2)\nor\nsigqueue(3)\nto send a signal to the target process if it is\nable to get the process file descriptor.\nBUGS\ntop\nThe options\n-n\nand\n-o\nand\n-v\ncan not be combined.  Let me know if\nyou need to do this.\nIf processes start in the same clock tick (usually but not always\na 100th of a second), the options\n-n\nand\n-o\nwill not be able to\ndistinguish which process started in the same clock tick and may\ngive erroneous results.\nDefunct processes are reported.\npidwait\nrequires the\npidfd_open(2)\nsystem call which first\nappeared in Linux 5.3.\nSEE ALSO\ntop\nkillall(1)\n,\nkill(1)\n,\nps(1)\n,\nskill(1)\n,\nkill(2)\n,\nsigaction(2)\n,\npidfd_open(2)\n,\npidfd_send_signal(2)\n,\nsigqueue(3)\n,\ncgroups(7)\n,\nregex(7)\n,\nsignal(7)\nREPORTING BUGS\ntop\nPlease send bug reports to â¨procps@freelists.orgâ©.\nCOLOPHON\ntop\nThis page is part of the\nprocps-ng\n(/proc filesystem utilities)\nproject.  Information about the project can be found at\nâ¨\nhttps://gitlab.com/procps-ng/procps\nâ©.  If you have a bug report\nfor this manual page, see\nâ¨\nhttps://gitlab.com/procps-ng/procps/blob/master/Documentation/bugs.md\nâ©.\nThis page was obtained from the project's upstream Git repository\nâ¨\nhttps://gitlab.com/procps-ng/procps.git\nâ© on 2025-08-11.  (At that\ntime, the date of the most recent commit that was found in the\nrepository was 2025-07-30.)  If you discover any rendering\nproblems in this HTML version of the page, or you believe there is\na better or more up-to-date source for the page, or you have\ncorrections or improvements to the information in this COLOPHON\n(which is\nnot\npart of the original manual page), send a mail to\nman-pages@man7.org\nprocps-ng                       2025-06-11\nPGREP\n(1)\nPages that refer to this page:\nfuser(1)\n,\nkill(1@@procps-ng)\n,\nkillall(1)\n,\npidof(1)\n,\npmap(1)\n,\nps(1)\n,\npslog(1)\n,\npwdx(1)\n,\nskill(1)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man1/pkill.1.html"}}
{"text": "nice(1) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\nnice(1) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nAUTHOR\n|\nREPORTING BUGS\n|\nCOPYRIGHT\n|\nSEE ALSO\n|\nCOLOPHON\nNICE\n(1)                       User Commands\nNICE\n(1)\nNAME\ntop\nnice - run a program with modified scheduling priority\nSYNOPSIS\ntop\nnice\n[\nOPTION\n] [\nCOMMAND\n[\nARG\n]...]\nDESCRIPTION\ntop\nRun COMMAND with an adjusted niceness, which affects process\nscheduling.  With no COMMAND, print the current niceness.\nNiceness values range from\n-20\n(most favorable to the process) to\n19 (least favorable to the process).\nMandatory arguments to long options are mandatory for short\noptions too.\n-n\n,\n--adjustment\n=\nN\nadd integer N to the niceness (default 10)\n--help\ndisplay this help and exit\n--version\noutput version information and exit\nYour shell may have its own version of nice, which usually\nsupersedes the version described here.  Please refer to your\nshell's documentation for details about the options it supports.\nExit status:\n125    if the nice command itself fails\n126    if COMMAND is found but cannot be invoked\n127    if COMMAND cannot be found\n-      the exit status of COMMAND otherwise\nAUTHOR\ntop\nWritten by David MacKenzie.\nREPORTING BUGS\ntop\nGNU coreutils online help:\n<\nhttps://www.gnu.org/software/coreutils/\n>\nReport any translation bugs to\n<\nhttps://translationproject.org/team/\n>\nCOPYRIGHT\ntop\nCopyright Â© 2025 Free Software Foundation, Inc.  License GPLv3+:\nGNU GPL version 3 or later <\nhttps://gnu.org/licenses/gpl.html\n>.\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nSEE ALSO\ntop\nnice(2)\n,\nrenice(1)\nFull documentation <\nhttps://www.gnu.org/software/coreutils/nice\n>\nor available locally via: info '(coreutils) nice invocation'\nCOLOPHON\ntop\nThis page is part of the\ncoreutils\n(basic file, shell and text\nmanipulation utilities) project.  Information about the project\ncan be found at â¨\nhttp://www.gnu.org/software/coreutils/\nâ©.  If you\nhave a bug report for this manual page, see\nâ¨\nhttp://www.gnu.org/software/coreutils/\nâ©.  This page was obtained\nfrom the tarball coreutils-9.7.tar.xz fetched from\nâ¨\nhttp://ftp.gnu.org/gnu/coreutils/\nâ© on 2025-08-11.  If you\ndiscover any rendering problems in this HTML version of the page,\nor you believe there is a better or more up-to-date source for the\npage, or you have corrections or improvements to the information\nin this COLOPHON (which is\nnot\npart of the original manual page),\nsend a mail to man-pages@man7.org\nGNU coreutils 9.7               April 2025\nNICE\n(1)\nPages that refer to this page:\nchrt(1)\n,\ncoresched(1)\n,\nkill(1@@procps-ng)\n,\nps(1)\n,\nrenice(1)\n,\nskill(1)\n,\ntaskset(1)\n,\nuclampset(1)\n,\ngetpriority(2)\n,\nnice(2)\n,\nsched(7)\n,\novs-ctl(8)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man1/nice.1.html"}}
{"text": "renice(1) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\nrenice(1) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nOPTIONS\n|\nFILES\n|\nNOTES\n|\nHISTORY\n|\nEXAMPLE\n|\nSEE ALSO\n|\nREPORTING BUGS\n|\nAVAILABILITY\nRENICE\n(1)                     User Commands\nRENICE\n(1)\nNAME\ntop\nrenice - alter priority of running processes\nSYNOPSIS\ntop\nrenice\n[\n-n\n|\n--priority\n|\n--relative\n]\npriority\n[\n-g\n|\n-p\n|\n-u\n]\nidentifier\n...\nDESCRIPTION\ntop\nrenice\nalters the scheduling priority of one or more running\nprocesses. The first argument is the\npriority\nvalue to be used.\nThe other arguments are interpreted as process IDs (by default),\nprocess group IDs, user IDs, or user names.\nrenice\n'ing a process\ngroup causes all processes in the process group to have their\nscheduling priority altered.\nrenice\n'ing a user causes all\nprocesses owned by the user to have their scheduling priority\naltered.\nBy default,\npriority\nis understood as an absolute value. But when\noption\n--relative\nis given, or when option\n-n\nis given and the\nenvironment variable POSIXLY_CORRECT is set, then\npriority\nis\nunderstood as a relative value.\nOPTIONS\ntop\n-n\npriority\n|\ndelta\nSpecify the absolute scheduling priority (when POSIXLY_CORRECT\nis not set) or a relative priority (when POSIXLY_CORRECT\nis\nset). See\nNOTES\nbelow for more details. Using option\n-n\nis\noptional, but when used, it must be the first argument.\n--priority\npriority\nSpecify the absolute scheduling\npriority\nto be used. This is\nthe default, when no option is specified.\n--relative\ndelta\nSpecify a relative priority. The actual scheduling priority\ngets incremented/decremented by the given\ndelta\n. (This is the\nsame as the\n-n\noption when POSIXLY_CORRECT is set.)\n-g\n,\n--pgrp\nInterpret the succeeding arguments as process group IDs.\n-p\n,\n--pid\nInterpret the succeeding arguments as process IDs (the\ndefault).\n-u\n,\n--user\nInterpret the succeeding arguments as usernames or UIDs.\n-h\n,\n--help\nDisplay help text and exit.\n-V\n,\n--version\nDisplay version and exit.\nFILES\ntop\n/etc/passwd\nto map user names to user IDs\nNOTES\ntop\nUsers other than the superuser may alter the priority only of\nprocesses they own. Furthermore, an unprivileged user can only\nincrease\nthe \"nice value\" (that is: lower the urgency), and such\nchanges are irreversible unless (since Linux 2.6.12) the user has\na suitable \"nice\" resource limit (see\ngetrlimit(2)\n).\nThe superuser may alter the priority of any process and set the\npriority to any value in the range -20 to 19. Useful priorities\nare: 19 (the affected processes will run only when nothing else in\nthe system wants to), 0 (the \"base\" scheduling priority), anything\nnegative (to make things go very fast).\nFor historical reasons, the\n-n\noption in this implementation does\nnot follow the POSIX specification: instead of setting a\nrelative\npriority, it sets an\nabsolute\npriority by default. As this may not\nbe desirable, this behavior can be changed by setting the\nenvironment variable POSIXLY_CORRECT, to be fully POSIX compliant.\nSee\n--relative\nand\n--priority\nfor options that do not change\nbehavior depending on environment variables.\nHISTORY\ntop\nThe\nrenice\ncommand appeared in 4.0BSD.\nEXAMPLE\ntop\nThe following command changes the priority of the processes with\nPIDs 987 and 32, plus all processes owned by the users daemon and\nroot:\nrenice +1 987 -u daemon root -p 32\nSEE ALSO\ntop\nnice(1)\n,\nchrt(1)\n,\ngetpriority(2)\n,\nsetpriority(2)\n,\ncredentials(7)\n,\nsched(7)\nREPORTING BUGS\ntop\nFor bug reports, use the issue tracker\n<\nhttps://github.com/util-linux/util-linux/issues\n>.\nAVAILABILITY\ntop\nThe\nrenice\ncommand is part of the util-linux package which can be\ndownloaded from Linux Kernel Archive\n<\nhttps://www.kernel.org/pub/linux/utils/util-linux/\n>. This page is\npart of the\nutil-linux\n(a random collection of Linux utilities)\nproject. Information about the project can be found at\nâ¨\nhttps://www.kernel.org/pub/linux/utils/util-linux/\nâ©. If you have a\nbug report for this manual page, send it to\nutil-linux@vger.kernel.org. This page was obtained from the\nproject's upstream Git repository\nâ¨git://git.kernel.org/pub/scm/utils/util-linux/util-linux.gitâ© on\n2025-08-11. (At that time, the date of the most recent commit that\nwas found in the repository was 2025-08-05.) If you discover any\nrendering problems in this HTML version of the page, or you\nbelieve there is a better or more up-to-date source for the page,\nor you have corrections or improvements to the information in this\nCOLOPHON (which is\nnot\npart of the original manual page), send a\nmail to man-pages@man7.org\nutil-linux 2.42-start-521-ec46  2025-08-09\nRENICE\n(1)\nPages that refer to this page:\nchrt(1)\n,\ncoresched(1)\n,\nkill(1@@procps-ng)\n,\nnice(1)\n,\nskill(1)\n,\ntaskset(1)\n,\nuclampset(1)\n,\ngetpriority(2)\n,\nnice(2)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man1/renice.1.html"}}
{"text": "nohup(1) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\nnohup(1) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nAUTHOR\n|\nREPORTING BUGS\n|\nCOPYRIGHT\n|\nSEE ALSO\n|\nCOLOPHON\nNOHUP\n(1)                      User Commands\nNOHUP\n(1)\nNAME\ntop\nnohup - run a command immune to hangups, with output to a non-tty\nSYNOPSIS\ntop\nnohup\nCOMMAND\n[\nARG\n]...\nnohup\nOPTION\nDESCRIPTION\ntop\nRun COMMAND, ignoring hangup signals.\n--help\ndisplay this help and exit\n--version\noutput version information and exit\nIf standard input is a terminal, redirect it from an unreadable\nfile.  If standard output is a terminal, append output to\n'nohup.out' if possible, '$HOME/nohup.out' otherwise.  If standard\nerror is a terminal, redirect it to standard output.  To save\noutput to FILE, use 'nohup COMMAND > FILE'.\nYour shell may have its own version of nohup, which usually\nsupersedes the version described here.  Please refer to your\nshell's documentation for details about the options it supports.\nExit status:\n125    if the nohup command itself fails\n126    if COMMAND is found but cannot be invoked\n127    if COMMAND cannot be found\n-      the exit status of COMMAND otherwise\nAUTHOR\ntop\nWritten by Jim Meyering.\nREPORTING BUGS\ntop\nGNU coreutils online help:\n<\nhttps://www.gnu.org/software/coreutils/\n>\nReport any translation bugs to\n<\nhttps://translationproject.org/team/\n>\nCOPYRIGHT\ntop\nCopyright Â© 2025 Free Software Foundation, Inc.  License GPLv3+:\nGNU GPL version 3 or later <\nhttps://gnu.org/licenses/gpl.html\n>.\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nSEE ALSO\ntop\nFull documentation <\nhttps://www.gnu.org/software/coreutils/nohup\n>\nor available locally via: info '(coreutils) nohup invocation'\nCOLOPHON\ntop\nThis page is part of the\ncoreutils\n(basic file, shell and text\nmanipulation utilities) project.  Information about the project\ncan be found at â¨\nhttp://www.gnu.org/software/coreutils/\nâ©.  If you\nhave a bug report for this manual page, see\nâ¨\nhttp://www.gnu.org/software/coreutils/\nâ©.  This page was obtained\nfrom the tarball coreutils-9.7.tar.xz fetched from\nâ¨\nhttp://ftp.gnu.org/gnu/coreutils/\nâ© on 2025-08-11.  If you\ndiscover any rendering problems in this HTML version of the page,\nor you believe there is a better or more up-to-date source for the\npage, or you have corrections or improvements to the information\nin this COLOPHON (which is\nnot\npart of the original manual page),\nsend a mail to man-pages@man7.org\nGNU coreutils 9.7               April 2025\nNOHUP\n(1)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man1/nohup.1.html"}}
{"text": "timeout(1) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\ntimeout(1) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nBUGS\n|\nAUTHOR\n|\nREPORTING BUGS\n|\nCOPYRIGHT\n|\nSEE ALSO\n|\nCOLOPHON\nTIMEOUT\n(1)                    User Commands\nTIMEOUT\n(1)\nNAME\ntop\ntimeout - run a command with a time limit\nSYNOPSIS\ntop\ntimeout\n[\nOPTION\n]\nDURATION COMMAND\n[\nARG\n]...\ntimeout\n[\nOPTION\n]\nDESCRIPTION\ntop\nStart COMMAND, and kill it if still running after DURATION.\nMandatory arguments to long options are mandatory for short\noptions too.\n-f\n,\n--foreground\nwhen not running timeout directly from a shell prompt,\nallow COMMAND to read from the TTY and get TTY signals; in\nthis mode, children of COMMAND will not be timed out\n-k\n,\n--kill-after\n=\nDURATION\nalso send a KILL signal if COMMAND is still running this\nlong after the initial signal was sent\n-p\n,\n--preserve-status\nexit with the same status as COMMAND, even when the command\ntimes out\n-s\n,\n--signal\n=\nSIGNAL\nspecify the signal to be sent on timeout; SIGNAL may be a\nname like 'HUP' or a number; see 'kill\n-l\n' for a list of\nsignals\n-v\n,\n--verbose\ndiagnose to stderr any signal sent upon timeout\n--help\ndisplay this help and exit\n--version\noutput version information and exit\nDURATION is a floating point number with an optional suffix: 's'\nfor seconds (the default), 'm' for minutes, 'h' for hours or 'd'\nfor days.  A duration of 0 disables the associated timeout.\nUpon timeout, send the TERM signal to COMMAND, if no other SIGNAL\nspecified.  The TERM signal kills any process that does not block\nor catch that signal.  It may be necessary to use the KILL signal,\nsince this signal can't be caught.\nExit status:\n124    if COMMAND times out, and\n--preserve-status\nis not\nspecified\n125    if the timeout command itself fails\n126    if COMMAND is found but cannot be invoked\n127    if COMMAND cannot be found\n137    if COMMAND (or timeout itself) is sent the KILL (9) signal\n(128+9)\n-      the exit status of COMMAND otherwise\nBUGS\ntop\nSome platforms don't currently support timeouts beyond the year\n2038.\nAUTHOR\ntop\nWritten by Padraig Brady.\nREPORTING BUGS\ntop\nGNU coreutils online help:\n<\nhttps://www.gnu.org/software/coreutils/\n>\nReport any translation bugs to\n<\nhttps://translationproject.org/team/\n>\nCOPYRIGHT\ntop\nCopyright Â© 2025 Free Software Foundation, Inc.  License GPLv3+:\nGNU GPL version 3 or later <\nhttps://gnu.org/licenses/gpl.html\n>.\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nSEE ALSO\ntop\nkill(1)\nFull documentation\n<\nhttps://www.gnu.org/software/coreutils/timeout\n>\nor available locally via: info '(coreutils) timeout invocation'\nCOLOPHON\ntop\nThis page is part of the\ncoreutils\n(basic file, shell and text\nmanipulation utilities) project.  Information about the project\ncan be found at â¨\nhttp://www.gnu.org/software/coreutils/\nâ©.  If you\nhave a bug report for this manual page, see\nâ¨\nhttp://www.gnu.org/software/coreutils/\nâ©.  This page was obtained\nfrom the tarball coreutils-9.7.tar.xz fetched from\nâ¨\nhttp://ftp.gnu.org/gnu/coreutils/\nâ© on 2025-08-11.  If you\ndiscover any rendering problems in this HTML version of the page,\nor you believe there is a better or more up-to-date source for the\npage, or you have corrections or improvements to the information\nin this COLOPHON (which is\nnot\npart of the original manual page),\nsend a mail to man-pages@man7.org\nGNU coreutils 9.7               April 2025\nTIMEOUT\n(1)\nPages that refer to this page:\ntime(7)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man1/timeout.1.html"}}
{"text": "parted(8) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\nparted(8) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nOPTIONS\n|\nCOMMANDS\n|\nUNITS\n|\nREPORTING BUGS\n|\nSEE ALSO\n|\nAUTHOR\n|\nCOLOPHON\nPARTED\n(8)                   GNU Parted Manual\nPARTED\n(8)\nNAME\ntop\nparted - a partition manipulation program\nSYNOPSIS\ntop\nparted\n[options] [device [command [options...]...]]\nDESCRIPTION\ntop\nparted\nis a program to manipulate disk partitions.  It supports\nmultiple partition table formats, including MS-DOS and GPT.  It is\nuseful for creating space for new operating systems, reorganising\ndisk usage, and copying data to new hard disks.\nThis manual page documents\nparted\nbriefly.  Complete documentation\nis distributed with the package in GNU Info format.\nOPTIONS\ntop\n-h, --help\ndisplays a help message\n-l, --list\nlists partition layout on all block devices\n-m, --machine\ndisplays machine parseable output\n-j, --json\ndisplays JSON output\n-s, --script\nnever prompts for user intervention\n-f, --fix\nautomatically answer \"fix\" to exceptions in script mode\n-v, --version\ndisplays the version\n-a\nalignment-type\n, --align\nalignment-type\nSet alignment for newly created partitions, valid alignment\ntypes are:\nnone   Use the minimum alignment allowed by the disk type.\ncylinder\nAlign partitions to cylinders.\nminimal\nUse minimum alignment as given by the disk topology\ninformation. This and the opt value will use layout\ninformation provided by the disk to align the\nlogical partition table addresses to actual physical\nblocks on the disks.  The min value is the minimum\nalignment needed to align the partition properly to\nphysical blocks, which avoids performance\ndegradation.\noptimal\nUse optimum alignment as given by the disk topology\ninformation. This aligns to a multiple of the\nphysical block size in a way that guarantees optimal\nperformance.\nCOMMANDS\ntop\n[device]\nThe block device to be used.  When none is given,\nparted\nwill use the first block device it finds.\n[command [options]]\nSpecifies the command to be executed.  If no command is\ngiven,\nparted\nwill present a command prompt.  Possible\ncommands are:\nhelp\n[command]\nPrint general help, or help on\ncommand\nif specified.\nalign-check\ntype partition\nCheck if\npartition\nsatisfies the alignment\nconstraint of\ntype\n.\ntype\nmust be \"minimal\" or\n\"optimal\".\nmklabel\nlabel-type\nCreate a new disklabel (partition table) of\nlabel-\ntype\n.\nlabel-type\nshould be one of \"aix\", \"amiga\",\n\"bsd\", \"dvh\", \"gpt\", \"loop\", \"mac\", \"msdos\", \"pc98\",\nor \"sun\".\nmkpart [\npart-type name fs-type\n]\nstart end\nCreate a new partition.\npart-type\nmay be specified\nonly with msdos and dvh partition tables, it should\nbe one of \"primary\", \"logical\", or \"extended\".\nname\nis required for GPT partition tables and\nfs-type\nis\noptional.\nfs-type\ncan be one of \"btrfs\", \"ext2\",\n\"ext3\", \"ext4\", \"fat16\", \"fat32\", \"hfs\", \"hfs+\",\n\"linux-swap\", \"ntfs\", \"reiserfs\", \"udf\", or \"xfs\".\nname\npartition name\nSet the name of\npartition\nto\nname\n. This option works\nonly on Mac, PC98, and GPT disklabels. The name can\nbe placed in double quotes, if necessary.  And\ndepending on the shell may need to also be wrapped\nin single quotes so that the shell doesn't strip off\nthe double quotes.\nprint\nprint-type\nDisplay the partition table.\nprint-type\nis\noptional, and can be one of devices, free, list, or\nall.\nquit\nExit from\nparted\n.\nrescue\nstart end\nRescue a lost partition that was located somewhere\nbetween\nstart\nand\nend\n.  If a partition is found,\nparted\nwill ask if you want to create an entry for\nit in the partition table.\nresizepart\npartition end\nChange the\nend\nposition of\npartition\n.  Note that\nthis does not modify any filesystem present in the\npartition.\nrm\npartition\nDelete\npartition\n.\nselect\ndevice\nChoose\ndevice\nas the current device to edit.\ndevice\nshould usually be a Linux hard disk device, but it\ncan be a partition, software raid device, or an LVM\nlogical volume if necessary.\nset\npartition flag state\nChange the state of the\nflag\non\npartition\nto\nstate\n.\nSupported flags are: \"boot\", \"root\", \"swap\",\n\"hidden\", \"raid\", \"lvm\", \"lba\", \"legacy_boot\",\n\"irst\", \"msftres\", \"esp\", \"chromeos_kernel\",\n\"bls_boot\", \"linux-home\", \"no_automount\",\n\"bios_grub\", and \"palo\".\nstate\nshould be either\n\"on\" or \"off\".\nunit\nunit\nSet\nunit\nas the unit to use when displaying\nlocations and sizes, and for interpreting those\ngiven by the user when not suffixed with an explicit\nunit.\nunit\ncan be one of \"s\" (sectors), \"B\"\n(bytes), \"kB\", \"MB\", \"KiB\", \"MiB\", \"GB\", \"GiB\",\n\"TB\", \"TiB\", \"%\" (percentage of device size), \"cyl\"\n(cylinders), \"chs\" (cylinders, heads, sectors), or\n\"compact\" (megabytes for input, and a human-friendly\nform for output).\ntoggle\npartition flag\nToggle the state of\nflag\non\npartition\n.\ntype\npartition id\nor\nuuid\nOn MS-DOS set the type aka. partition id of\npartition\nto\nid\n. The\nid\nis a value between \"0x01\"\nand \"0xff\". On GPT the type-uuid of\npartition\nto\nuuid\n.\ndisk_set\nflag state\nChange a\nflag\non the disk to\nstate\n. A flag can be\neither \"on\" or \"off\".  Some or all of these flags\nwill be available, depending on what disk abel you\nare using.  Supported flags are: \"pmbr_boot\" on GPT\nto enable the boot flag on the GPT's protective MBR\npartition.\ndisk_toggle\nflag\nToggle the state of the disk\nflag\n.\nversion\nDisplay version information and a copyright message.\nUNITS\ntop\nparted\nwill compute sensible ranges for the locations you specify\nwhen using units like \"GB\", \"MB\", etc. Use the sector unit \"s\" or\nIEC binary units like \"GiB\", \"MiB\", to specify exact locations.\nWhen you specify start or end values using IEC binary units like\n\"MiB\", \"GiB\", \"TiB\", etc.,\nparted\ntreats those values as exact,\nand equivalent to the same number specified in bytes (i.e., with\nthe \"B\" suffix), in that it provides no helpful range of\nsloppiness.  Contrast that with a partition start request of\n\"4GB\", which may actually resolve to some sector up to 500MB\nbefore or after that point.  Thus, when creating a partition in an\nexact location you should use units of bytes (\"B\"), sectors (\"s\"),\nor IEC binary units like \"MiB\", \"GiB\", but not \"MB\", \"GB\", etc.\nREPORTING BUGS\ntop\nReport bugs to <bug-parted@gnu.org>\nSEE ALSO\ntop\nfdisk(8)\n,\nmkfs(8)\n, The\nparted\nprogram is fully documented in the\ninfo\n(1) format\nGNU partitioning software\nmanual.\nAUTHOR\ntop\nThis manual page was written by Timshel Knoll\n<timshel@debian.org>, for the Debian GNU/Linux system (but may be\nused by others).\nCOLOPHON\ntop\nThis page is part of the\nGNU parted\n(partition table manipulation)\nproject.  Information about the project can be found at\nâ¨\nhttp://www.gnu.org/software/parted/\nâ©.  If you have a bug report\nfor this manual page, send it to bug-parted@gnu.org.  This page\nwas obtained from the project's upstream Git repository\nâ¨git://git.savannah.gnu.org/parted.gitâ© on 2025-08-11.  (At that\ntime, the date of the most recent commit that was found in the\nrepository was 2025-05-30.)  If you discover any rendering\nproblems in this HTML version of the page, or you believe there is\na better or more up-to-date source for the page, or you have\ncorrections or improvements to the information in this COLOPHON\n(which is\nnot\npart of the original manual page), send a mail to\nman-pages@man7.org\nparted                      2021 September 28\nPARTED\n(8)\nPages that refer to this page:\naddpart(8)\n,\nbtrfs-filesystem(8)\n,\ncfdisk(8)\n,\ndelpart(8)\n,\npartprobe(8)\n,\npartx(8)\n,\nresizepart(8)\n,\nsfdisk(8)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man8/parted.8.html"}}
{"text": "mkfs(8) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\nmkfs(8) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nOPTIONS\n|\nBUGS\n|\nAUTHORS\n|\nSEE ALSO\n|\nREPORTING BUGS\n|\nAVAILABILITY\nMKFS\n(8)                   System Administration\nMKFS\n(8)\nNAME\ntop\nmkfs - build a Linux filesystem\nSYNOPSIS\ntop\nmkfs\n[options] [\n-t\ntype\n] [\nfs-options\n]\ndevice\n[\nsize\n]\nDESCRIPTION\ntop\nThis mkfs frontend is deprecated in favour of filesystem specific\nmkfs.<type> utils.\nmkfs\nis used to build a Linux filesystem on a device, usually a\nhard disk partition. The\ndevice\nargument is either the device name\n(e.g.,\n/dev/hda1\n,\n/dev/sdb2\n), or a regular file that shall contain\nthe filesystem. The\nsize\nargument is the number of blocks to be\nused for the filesystem.\nThe exit status returned by\nmkfs\nis 0 on success and 1 on failure.\nIn actuality,\nmkfs\nis simply a front-end for the various\nfilesystem builders (\nmkfs.\nfstype\n) available under Linux. The\nfilesystem-specific builder is searched for via your\nPATH\nenvironment setting only. Please see the filesystem-specific\nbuilder manual pages for further details.\nOPTIONS\ntop\n-t\n,\n--type\ntype\nSpecify the\ntype\nof filesystem to be built. If not specified,\nthe default filesystem type (currently ext2) is used.\nfs-options\nFilesystem-specific options to be passed to the real\nfilesystem builder.\n-V\n,\n--verbose\nProduce verbose output, including all filesystem-specific\ncommands that are executed. Specifying this option more than\nonce inhibits execution of any filesystem-specific commands.\nThis is really only useful for testing.\n-h\n,\n--help\nDisplay help text and exit.\n-V\n,\n--version\nDisplay version and exit. (Option\n-V\nwill display version\ninformation only when it is the only parameter, otherwise it\nwill work as\n--verbose\n.)\nBUGS\ntop\nAll generic options must precede and not be combined with\nfilesystem-specific options. Some filesystem-specific programs do\nnot automatically detect the device size and require the\nsize\nparameter to be specified.\nAUTHORS\ntop\nDavid Engel <david@ods.com>, Fred N. van Kempen\n<waltje@uwalt.nl.mugnet.org>, Ron Sommeling <sommel@sci.kun.nl>.\nThe manual page was shamelessly adapted from Remy Cardâs version\nfor the ext2 filesystem.\nSEE ALSO\ntop\nfs(5)\n,\nbadblocks(8)\n,\nfsck(8)\n,\nmkdosfs(8)\n,\nmke2fs(8)\n,\nmkfs.bfs(8)\n,\nmkfs.ext2\n(8),\nmkfs.ext3\n(8),\nmkfs.ext4\n(8),\nmkfs.minix(8)\n,\nmkfs.msdos(8)\n,\nmkfs.vfat(8)\n,\nmkfs.xfs\n(8)\nREPORTING BUGS\ntop\nFor bug reports, use the issue tracker\n<\nhttps://github.com/util-linux/util-linux/issues\n>.\nAVAILABILITY\ntop\nThe\nmkfs\ncommand is part of the util-linux package which can be\ndownloaded from Linux Kernel Archive\n<\nhttps://www.kernel.org/pub/linux/utils/util-linux/\n>. This page is\npart of the\nutil-linux\n(a random collection of Linux utilities)\nproject. Information about the project can be found at\nâ¨\nhttps://www.kernel.org/pub/linux/utils/util-linux/\nâ©. If you have a\nbug report for this manual page, send it to\nutil-linux@vger.kernel.org. This page was obtained from the\nproject's upstream Git repository\nâ¨git://git.kernel.org/pub/scm/utils/util-linux/util-linux.gitâ© on\n2025-08-11. (At that time, the date of the most recent commit that\nwas found in the repository was 2025-08-05.) If you discover any\nrendering problems in this HTML version of the page, or you\nbelieve there is a better or more up-to-date source for the page,\nor you have corrections or improvements to the information in this\nCOLOPHON (which is\nnot\npart of the original manual page), send a\nmail to man-pages@man7.org\nutil-linux 2.42-start-521-ec46  2025-01-16\nMKFS\n(8)\nPages that refer to this page:\ncrypttab(5)\n,\nfilesystems(5)\n,\nlvmvdo(7)\n,\nfdisk(8)\n,\nfsck(8@@e2fsprogs)\n,\nfsck(8)\n,\nfsck.minix(8)\n,\nmkfs.bfs(8)\n,\nmkfs.minix(8)\n,\nparted(8)\n,\nxfs_growfs(8)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man8/mkfs.8.html"}}
{"text": "fsck(8) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\nAnother version of this page is provided by the\ne2fsprogs\nproject\nfsck(8) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nOPTIONS\n|\nFILESYSTEM SPECIFIC OPTIONS\n|\nENVIRONMENT\n|\nFILES\n|\nNOTES\n|\nAUTHORS\n|\nSEE ALSO\n|\nREPORTING BUGS\n|\nAVAILABILITY\nFSCK\n(8)                   System Administration\nFSCK\n(8)\nNAME\ntop\nfsck - check and repair a Linux filesystem\nSYNOPSIS\ntop\nfsck\n[\n-lsAVRTMNP\n] [\n-r\n[\nfd\n]] [\n-C\n[\nfd\n]] [\n-t\nfstype\n] [\nfilesystem\n...]\n[\n--\n] [\nfs-specific-options\n]\nDESCRIPTION\ntop\nfsck\nis used to check and optionally repair one or more Linux\nfilesystems.\nfilesystem\ncan be a device name (e.g.,\n/dev/hdc1\n,\n/dev/sdb2\n), a mount point (e.g.,\n/\n,\n/usr\n,\n/home\n), or a filesystem\nlabel or UUID specifier (e.g.,\nUUID=8868abf6-88c5-4a83-98b8-bfc24057f7bd or LABEL=root).\nNormally, the\nfsck\nprogram will try to handle filesystems on\ndifferent physical disk drives in parallel to reduce the total\namount of time needed to check all of them.\nIf no filesystems are specified on the command line, and the\n-A\noption is not specified,\nfsck\nwill default to checking filesystems\nin\n/etc/fstab\nserially. This is equivalent to the\n-As\noptions.\nThe exit status returned by\nfsck\nis the sum of the following\nconditions:\n0\nNo errors\n1\nFilesystem errors corrected\n2\nSystem should be rebooted\n4\nFilesystem errors left uncorrected\n8\nOperational error\n16\nUsage or syntax error\n32\nChecking canceled by user request\n128\nShared-library error\nThe exit status returned when multiple filesystems are checked is\nthe bit-wise OR of the exit statuses for each filesystem that is\nchecked.\nIn actuality,\nfsck\nis simply a front-end for the various\nfilesystem checkers (\nfsck\n.\nfstype\n) available under Linux. The\nfilesystem-specific checker is searched for in the\nPATH\nenvironment variable. If the\nPATH\nis undefined then fallback to\n/sbin\n.\nPlease see the filesystem-specific checker manual pages for\nfurther details.\nOPTIONS\ntop\n-l\nCreate an exclusive\nflock(2)\nlock file\n(\n/run/fsck/<diskname>.lock\n) for whole-disk device. This option\ncan be used with one device only (this means that\n-A\nand\n-l\nare mutually exclusive). This option is recommended when more\nfsck\ninstances are executed in the same time. The option is\nignored when used for multiple devices or for non-rotating\ndisks.\nfsck\ndoes not lock underlying devices when executed to\ncheck stacked devices (e.g. MD or DM) - this feature is not\nimplemented yet.\n-r\n[\nfd\n]\nReport certain statistics for each fsck when it completes.\nThese statistics include the exit status, the maximum run set\nsize (in kilobytes), the elapsed all-clock time and the user\nand system CPU time used by the fsck run. For example:\n/dev/sda1: status 0, rss 92828, real 4.002804, user 2.677592,\nsys 0.86186\nGUI front-ends may specify a file descriptor\nfd\n, in which case\nthe progress bar information will be sent to that file\ndescriptor in a machine parsable format. For example:\n/dev/sda1 0 92828 4.002804 2.677592 0.86186\n-s\nSerialize\nfsck\noperations. This is a good idea if you are\nchecking multiple filesystems and the checkers are in an\ninteractive mode. (Note:\ne2fsck(8)\nruns in an interactive mode\nby default. To make\ne2fsck(8)\nrun in a non-interactive mode,\nyou must either specify the\n-p\nor\n-a\noption, if you wish for\nerrors to be corrected automatically, or the\n-n\noption if you\ndo not.)\n-t\nfslist\nSpecifies the type(s) of filesystem to be checked. When the\n-A\nflag is specified, only filesystems that match\nfslist\nare\nchecked. The\nfslist\nparameter is a comma-separated list of\nfilesystems and options specifiers. All of the filesystems in\nthis comma-separated list may be prefixed by a negation\noperator '\nno\n' or '\n!\n', which requests that only those\nfilesystems not listed in\nfslist\nwill be checked. If none of\nthe filesystems in\nfslist\nis prefixed by a negation operator,\nthen only those listed filesystems will be checked.\nOptions specifiers may be included in the comma-separated\nfslist\n. They must have the format\nopts=\nfs-option\n. If an\noptions specifier is present, then only filesystems which\ncontain\nfs-option\nin their mount options field of\n/etc/fstab\nwill be checked. If the options specifier is prefixed by a\nnegation operator, then only those filesystems that do not\nhave\nfs-option\nin their mount options field of\n/etc/fstab\nwill\nbe checked.\nFor example, if\nopts=ro\nappears in\nfslist\n, then only\nfilesystems listed in\n/etc/fstab\nwith the\nro\noption will be\nchecked.\nFor compatibility with Mandrake distributions whose boot\nscripts depend upon an unauthorized UI change to the\nfsck\nprogram, if a filesystem type of\nloop\nis found in\nfslist\n, it\nis treated as if\nopts=loop\nwere specified as an argument to\nthe\n-t\noption.\nNormally, the filesystem type is deduced by searching for\nfilesys\nin the\n/etc/fstab\nfile and using the corresponding\nentry. If the type cannot be deduced, and there is only a\nsingle filesystem given as an argument to the\n-t\noption,\nfsck\nwill use the specified filesystem type. If this type is not\navailable, then the default filesystem type (currently ext2)\nis used.\n-A\nWalk through the\n/etc/fstab\nfile and try to check all\nfilesystems in one run. This option is typically used from the\n/etc/rc\nsystem initialization file, instead of multiple\ncommands for checking a single filesystem.\nThe root filesystem will be checked first unless the\n-P\noption\nis specified (see below). After that, filesystems will be\nchecked in the order specified by the\nfs_passno\n(the sixth)\nfield in the\n/etc/fstab\nfile. Filesystems with a\nfs_passno\nvalue of 0 are skipped and are not checked at all. Filesystems\nwith a\nfs_passno\nvalue of greater than zero will be checked in\norder, with filesystems with the lowest\nfs_passno\nnumber being\nchecked first. If there are multiple filesystems with the same\npass number,\nfsck\nwill attempt to check them in parallel,\nalthough it will avoid running multiple filesystem checks on\nthe same physical disk.\nfsck\ndoes not check stacked devices (RAIDs, dm-crypt, ...) in\nparallel with any other device. See below for\nFSCK_FORCE_ALL_PARALLEL\nsetting. The\n/sys\nfilesystem is used\nto determine dependencies between devices.\nHence, a very common configuration in\n/etc/fstab\nfiles is to\nset the root filesystem to have a\nfs_passno\nvalue of 1 and to\nset all other filesystems to have a\nfs_passno\nvalue of 2. This\nwill allow\nfsck\nto automatically run filesystem checkers in\nparallel if it is advantageous to do so. System administrators\nmight choose not to use this configuration if they need to\navoid multiple filesystem checks running in parallel for some\nreason - for example, if the machine in question is short on\nmemory so that excessive paging is a concern.\nfsck\nnormally does not check whether the device actually\nexists before calling a filesystem specific checker. Therefore\nnon-existing devices may cause the system to enter filesystem\nrepair mode during boot if the filesystem specific checker\nreturns a fatal error. The\n/etc/fstab\nmount option\nnofail\nmay\nbe used to have\nfsck\nskip non-existing devices.\nfsck\nalso\nskips non-existing devices that have the special filesystem\ntype\nauto\n.\n-C\n[\nfd\n]\nDisplay completion/progress bars for those filesystem checkers\n(currently only for ext[234]) which support them.\nfsck\nwill\nmanage the filesystem checkers so that only one of them will\ndisplay a progress bar at a time. GUI front-ends may specify a\nfile descriptor\nfd\n, in which case the progress bar information\nwill be sent to that file descriptor.\n-M\nDo not check mounted filesystems and return an exit status of\n0 for mounted filesystems.\n-N\nDonât execute, just show what would be done.\n-P\nWhen the\n-A\nflag is set, check the root filesystem in parallel\nwith the other filesystems. This is not the safest thing in\nthe world to do, since if the root filesystem is in doubt\nthings like the\ne2fsck(8)\nexecutable might be corrupted! This\noption is mainly provided for those sysadmins who donât want\nto repartition the root filesystem to be small and compact\n(which is really the right solution).\n-R\nWhen checking all filesystems with the\n-A\nflag, skip the root\nfilesystem. (This is useful in case the root filesystem has\nalready been mounted read-write.)\n-T\nDonât show the title on startup.\n-V\nProduce verbose output, including all filesystem-specific\ncommands that are executed.\n-?\n,\n--help\nDisplay help text and exit.\n--version\nDisplay version and exit.\nFILESYSTEM SPECIFIC OPTIONS\ntop\nOptions which are not understood by fsck are passed to the\nfilesystem-specific checker!\nThese options\nmust\nnot take arguments, as there is no way for\nfsck\nto be able to properly guess which options take arguments and\nwhich donât.\nOptions and arguments which follow the\n--\nare treated as\nfilesystem-specific options to be passed to the\nfilesystem-specific checker.\nPlease note that\nfsck\nis not designed to pass arbitrarily\ncomplicated options to filesystem-specific checkers. If youâre\ndoing something complicated, please just execute the\nfilesystem-specific checker directly. If you pass\nfsck\nsome\nhorribly complicated options and arguments, and it doesnât do what\nyou expect,\ndonât bother reporting it as a bug.\nYouâre almost\ncertainly doing something that you shouldnât be doing with\nfsck\n.\nOptions to different filesystem-specific fsckâs are not\nstandardized.\nENVIRONMENT\ntop\nThe\nfsck\nprogramâs behavior is affected by the following\nenvironment variables:\nFSCK_FORCE_ALL_PARALLEL\nIf this environment variable is set,\nfsck\nwill attempt to\ncheck all of the specified filesystems in parallel, regardless\nof whether the filesystems appear to be on the same device.\n(This is useful for RAID systems or high-end storage systems\nsuch as those sold by companies such as IBM or EMC.) Note that\nthe\nfs_passno\nvalue is still used.\nFSCK_MAX_INST\nThis environment variable will limit the maximum number of\nfilesystem checkers that can be running at one time. This\nallows configurations which have a large number of disks to\navoid\nfsck\nstarting too many filesystem checkers at once,\nwhich might overload CPU and memory resources available on the\nsystem. If this value is zero, then an unlimited number of\nprocesses can be spawned. This is currently the default, but\nfuture versions of\nfsck\nmay attempt to automatically determine\nhow many filesystem checks can be run based on gathering\naccounting data from the operating system.\nPATH\nThe\nPATH\nenvironment variable is used to find filesystem\ncheckers.\nFSTAB_FILE\nThis environment variable allows the system administrator to\noverride the standard location of the\n/etc/fstab\nfile. It is\nalso useful for developers who are testing\nfsck\n.\nLIBBLKID_DEBUG=all\nenables libblkid debug output.\nLIBMOUNT_DEBUG=all\nenables libmount debug output.\nFILES\ntop\n/etc/fstab\nNOTES\ntop\nDuring boot,\nsystemd\ndoes not invoke\nfsck -A\n. Instead, it\nschedules the activation of mounts individually, taking into\naccount dependencies on backing devices, networking, and other\nfactors. Consequently,\nfsck\nis called individually for each\ndevice.\nAUTHORS\ntop\nTheodore Tsâo <tytso@mit.edu>, Karel Zak <kzak@redhat.com>\nSEE ALSO\ntop\nfstab(5)\n,\nmkfs(8)\n,\nfsck.ext2\n(8) or\nfsck.ext3\n(8) or\ne2fsck(8)\n,\nfsck.cramfs(8)\n,\nfsck.jfs\n(8),\nfsck.nfs\n(8),\nfsck.minix(8)\n,\nfsck.msdos(8)\n,\nfsck.vfat(8)\n,\nfsck.xfs(8)\n,\nreiserfsck\n(8)\nREPORTING BUGS\ntop\nFor bug reports, use the issue tracker\n<\nhttps://github.com/util-linux/util-linux/issues\n>.\nAVAILABILITY\ntop\nThe\nfsck\ncommand is part of the util-linux package which can be\ndownloaded from Linux Kernel Archive\n<\nhttps://www.kernel.org/pub/linux/utils/util-linux/\n>. This page is\npart of the\nutil-linux\n(a random collection of Linux utilities)\nproject. Information about the project can be found at\nâ¨\nhttps://www.kernel.org/pub/linux/utils/util-linux/\nâ©. If you have a\nbug report for this manual page, send it to\nutil-linux@vger.kernel.org. This page was obtained from the\nproject's upstream Git repository\nâ¨git://git.kernel.org/pub/scm/utils/util-linux/util-linux.gitâ© on\n2025-08-11. (At that time, the date of the most recent commit that\nwas found in the repository was 2025-08-05.) If you discover any\nrendering problems in this HTML version of the page, or you\nbelieve there is a better or more up-to-date source for the page,\nor you have corrections or improvements to the information in this\nCOLOPHON (which is\nnot\npart of the original manual page), send a\nmail to man-pages@man7.org\nutil-linux 2.42-start-521-ec46  2025-08-09\nFSCK\n(8)\nPages that refer to this page:\nsystemd-dissect(1)\n,\nfilesystems(5)\n,\nfstab(5)\n,\ne2mmpstatus(8)\n,\nfsadm(8)\n,\nfsck.btrfs(8)\n,\nfsck.minix(8)\n,\nfsck.xfs(8)\n,\nlogsave(8)\n,\nmkfs(8)\n,\nmkfs.minix(8)\n,\nquotacheck(8)\n,\nsystemd-fsck@.service(8)\n,\nsystemd-mountfsd.service(8)\n,\ntune2fs(8)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man8/fsck.8.html"}}
{"text": "tune2fs(8) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\ntune2fs(8) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nOPTIONS\n|\nBUGS\n|\nAUTHOR\n|\nAVAILABILITY\n|\nSEE ALSO\n|\nCOLOPHON\nTUNE2FS\n(8)               System Manager's Manual\nTUNE2FS\n(8)\nNAME\ntop\ntune2fs - adjust tunable file system parameters on ext2/ext3/ext4\nfile systems\nSYNOPSIS\ntop\ntune2fs\n[\n-l\n] [\n-c\nmax-mount-counts\n] [\n-e\nerrors-behavior\n] [\n-f\n] [\n-i\ninterval-between-checks\n] [\n-I\nnew_inode_size\n] [\n-j\n] [\n-J\njournal-options\n] [\n-m\nreserved-blocks-percentage\n] [\n-o\n[^]mount-\noptions\n[,...]\n] [\n-r\nreserved-blocks-count\n] [\n-u\nuser\n] [\n-g\ngroup\n] [\n-C\nmount-count\n] [\n-E\nextended-options\n] [\n-L\nvolume-\nlabel\n] [\n-M\nlast-mounted-directory\n] [\n-O\n[^]\nfeature\n[,...]  ] [\n-Q\nquota-options\n] [\n-T\ntime-last-checked\n] [\n-U\nUUID\n] [\n-z\nundo_file\n] device\nDESCRIPTION\ntop\ntune2fs\nallows the system administrator to adjust various tunable\nfile system parameters on Linux ext2, ext3, or ext4 file systems.\nThe current values of these options can be displayed by using the\n-l\noption to\ntune2fs(8)\nprogram, or by using the\ndumpe2fs(8)\nprogram.\nThe\ndevice\nspecifier can either be a filename (i.e., /dev/sda1),\nor a LABEL or UUID specifier: \"\nLABEL=\nvolume-label\n\" or \"\nUUID=\nuuid\n\".\n(i.e., LABEL=home or UUID=e40486c6-84d5-4f2f-b99c-032281799c9d).\nOPTIONS\ntop\n-c\nmax-mount-counts\nAdjust the number of mounts after which the file system\nwill be checked by\ne2fsck(8)\n.  If\nmax-mount-counts\nis the\nstring \"random\", tune2fs will use a random value between 20\nand 40.  If\nmax-mount-counts\nis 0 or -1, the number of\ntimes the file system is mounted will be disregarded by\ne2fsck(8)\nand the kernel.\nStaggering the mount-counts at which file systems are\nforcibly checked will avoid all file systems being checked\nat one time when using journaled file systems.\nMount-count-dependent checking is disabled by default to\navoid unanticipated long reboots while e2fsck does its\nwork.  If you are concerned about file system corruptions\ncaused by potential hardware problems of kernel bugs, a\nbetter solution than mount-count-dependent checking is to\nuse the\ne2scrub\n(8) program.  This does require placing the\nfile system on an LVM volume, however.\n-C\nmount-count\nSet the number of times the file system has been mounted.\nIf set to a greater value than the max-mount-counts\nparameter set by the\n-c\noption,\ne2fsck(8)\nwill check the\nfile system at the next reboot.\n-e\nerror-behavior\nChange the behavior of the kernel code when errors are\ndetected.  In all cases, a file system error will cause\ne2fsck(8)\nto check the file system on the next boot.\nerror-behavior\ncan be one of the following:\ncontinue\nContinue normal execution.\nremount-ro\nRemount file system read-only.\npanic\nCause a kernel panic.\n-E\nextended-options\nSet extended options for the file system.  Extended options\nare comma separated, and may take an argument using the\nequals ('=') sign.  The following extended options are\nsupported:\nclear_mmp\nReset the MMP block (if any) back to the clean\nstate.  Use only if absolutely certain the\ndevice is not currently mounted or being\nfscked, or major file system corruption can\nresult.  Needs '-f'.\nencoding=\nencoding-name\nEnable the\ncasefold\nfeature in the super block\nand set\nencoding-name\nas the encoding to be\nused.  If\nencoding-name\nis not specified, utf8\nis used. The encoding cannot be altered if\ncasefold was previously enabled.\nencoding_flags=\nencoding-flags\nDefine parameters for file name character\nencoding operations.  If a flag is not changed\nusing this parameter, its default value is\nused.\nencoding-flags\nshould be a comma-\nseparated lists of flags to be enabled.  The\nflags cannot be altered if casefold was\npreviously enabled.\nThe only flag that can be set right now is\nstrict\nwhich means that invalid strings should\nbe rejected by the file system.  In the default\nconfiguration, the\nstrict\nflag is disabled.\nforce_fsck\nSet a flag in the file system superblock\nindicating that errors have been found.  This\nwill force fsck to run at the next mount.\nhash_alg=\nhash-alg\nSet the default hash algorithm used for file\nsystems with hashed b-tree directories.  Valid\nalgorithms accepted are:\nlegacy\n,\nhalf_md4\n, and\ntea\n.\nmmp_update_interval=\ninterval\nAdjust the initial MMP update interval to\ninterval\nseconds.  Specifying an\ninterval\nof 0\nmeans to use the default interval.  The\nspecified interval must be less than 300\nseconds.  Requires that the\nmmp\nfeature be\nenabled.\nmount_opts=\nmount_option_string\nSet a set of default mount options which will\nbe used when the file system is mounted.\nUnlike the bitmask-based default mount options\nwhich can be specified with the\n-o\noption,\nmount_option_string\nis an arbitrary string with\na maximum length of 63 bytes, which is stored\nin the superblock.\nThe ext4 file system driver will first apply\nthe bitmask-based default options, and then\nparse the\nmount_option_string\n, before parsing\nthe mount options passed from the\nmount(8)\nprogram.\nThis superblock setting is only honored in\n2.6.35+ kernels; and not at all by the ext2 and\next3 file system drivers.\norphan_file_size=\nsize\nSet size of the file for tracking unlinked but\nstill open inodes and inodes with truncate in\nprogress. Larger file allows for better\nscalability, reserving a few blocks per cpu is\nideal.\nstride=\nstride-size\nConfigure the file system for a RAID array with\nstride-size\nfile system blocks. This is the\nnumber of blocks read or written to disk before\nmoving to next disk. This mostly affects\nplacement of file system metadata like bitmaps\nat\nmke2fs\n(2) time to avoid placing them on a\nsingle disk, which can hurt the performance.\nIt may also be used by block allocator.\nstripe_width=\nstripe-width\nConfigure the file system for a RAID array with\nstripe-width\nfile system blocks per stripe.\nThis is typically be stride-size * N, where N\nis the number of data disks in the RAID (e.g.\nRAID 5 N+1, RAID 6 N+2).  This allows the block\nallocator to prevent read-modify-write of the\nparity in a RAID stripe if possible when the\ndata is written.\ntest_fs\nSet a flag in the file system superblock\nindicating that it may be mounted using\nexperimental kernel code, such as the ext4dev\nfile system.\n^test_fs\nClear the test_fs flag, indicating the file\nsystem should only be mounted using production-\nlevel file system code.\n-f\nForce the tune2fs operation to complete even in the face of\nerrors.  This option is useful when removing the\nhas_journal\nfile system feature from a file system which\nhas an external journal (or is corrupted such that it\nappears to have an external journal), but that external\njournal is not available.   If the file system appears to\nrequire journal replay, the\n-f\nflag must be specified twice\nto proceed.\nWARNING:\nRemoving an external journal from a file system\nwhich was not cleanly unmounted without first replaying the\nexternal journal can result in severe data loss and file\nsystem corruption.\n-g\ngroup\nSet the group which can use the reserved file system\nblocks.  The\ngroup\nparameter can be a numerical gid or a\ngroup name.  If a group name is given, it is converted to a\nnumerical gid before it is stored in the superblock.\n-i\ninterval-between-checks\n[\nd\n|\nm\n|\nw\n]\nAdjust the maximal time between two file system checks.  No\nsuffix or\nd\nwill interpret the number\ninterval-between-\nchecks\nas days,\nm\nas months, and\nw\nas weeks.  A value of\nzero will disable the time-dependent checking.\nThere are pros and cons to disabling these periodic checks;\nsee the discussion under the\n-c\n(mount-count-dependent\ncheck) option for details.\n-I\nChange the inode size used by the file system.   This\nrequires rewriting the inode table, so it requires that the\nfile system is checked for consistency first using\ne2fsck(8)\n.  This operation can also take a while and the\nfile system can be corrupted and data lost if it is\ninterrupted while in the middle of converting the file\nsystem.  Backing up the file system before changing inode\nsize is recommended.\nFile systems with an inode size of 128 bytes do not support\ntimestamps beyond January 19, 2038.  Inodes which are 256\nbytes or larger will support extended timestamps, project\nid's, and the ability to store some extended attributes in\nthe inode table for improved performance.\n-j\nAdd an ext3 journal to the file system.  If the\n-J\noption\nis not specified, the default journal parameters will be\nused to create an appropriately sized journal (given the\nsize of the file system) stored within the file system.\nNote that you must be using a kernel which has ext3 support\nin order to actually make use of the journal.\nIf this option is used to create a journal on a mounted\nfile system, an immutable file,\n.journal\n, will be created\nin the top-level directory of the file system, as it is the\nonly safe way to create the journal inode while the file\nsystem is mounted.  While the ext3 journal is visible, it\nis not safe to delete it, or modify it while the file\nsystem is mounted; for this reason the file is marked\nimmutable.  While checking unmounted file systems,\ne2fsck(8)\nwill automatically move\n.journal\nfiles to the\ninvisible, reserved journal inode.  For all file systems\nexcept for the root file system,  this should happen\nautomatically and naturally during the next reboot cycle.\nSince the root file system is mounted read-only,\ne2fsck(8)\nmust be run from a rescue floppy in order to effect this\ntransition.\nOn some distributions, such as Debian, if an initial\nramdisk is used, the initrd scripts will automatically\nconvert an ext2 root file system to ext3 if the\n/etc/fstab\nfile specifies the ext3 file system for the root file\nsystem in order to avoid requiring the use of a rescue\nfloppy to add an ext3 journal to the root file system.\n-J\njournal-options\nOverride the default ext3 journal parameters. Journal\noptions are comma separated, and may take an argument using\nthe equals ('=')  sign.  The following journal options are\nsupported:\ndevice=\nexternal-journal\nAttach the file system to the journal block\ndevice located on\nexternal-journal\n.  The\nexternal journal must have been already created\nusing the command\nmke2fs -O journal_dev\nexternal-journal\nNote that\nexternal-journal\nmust be formatted\nwith the same block size as file systems which\nwill be using it.  In addition, while there is\nsupport for attaching multiple file systems to\na single external journal, the Linux kernel and\ne2fsck(8)\ndo not currently support shared\nexternal journals yet.\nInstead of specifying a device name directly,\nexternal-journal\ncan also be specified by\neither\nLABEL=\nlabel\nor\nUUID=\nUUID\nto locate the\nexternal journal by either the volume label or\nUUID stored in the ext2 superblock at the start\nof the journal.  Use\ndumpe2fs(8)\nto display a\njournal device's volume label and UUID.  See\nalso the\n-L\noption of\ntune2fs(8)\n.\nfast_commit_size=\nfast-commit-size\nCreate an additional fast commit journal area\nof size\nfast-commit-size\nkilobytes.  This\noption is only valid if\nfast_commit\nfeature is\nenabled on the file system. If this option is\nnot specified and if\nfast_commit\nfeature is\nturned on, fast commit area size defaults to\njournal-size\n/ 64 megabytes. The total size of\nthe journal with\nfast_commit\nfeature set is\njournal-size\n+ (\nfast-commit-size\n* 1024)\nmegabytes. The total journal size may be no\nmore than 10,240,000 file system blocks or half\nthe total file system size (whichever is\nsmaller).\nlocation\n=journal-location\nSpecify the location of the journal.  The\nargument\njournal-location\ncan either be\nspecified as a block number, or if the number\nhas a units suffix (e.g., 'M', 'G', etc.)\ninterpret it as the offset from the beginning\nof the file system.\nsize=\njournal-size\nCreate a journal stored in the file system of\nsize\njournal-size\nmegabytes.   The size of the\njournal must be at least 1024 file system\nblocks (i.e., 1 MiB if using 1k blocks, 4 MiB\nif using 4k blocks, etc.)  and may be no more\nthan 10,240,000 file system blocks.  There must\nbe enough free space in the file system to\ncreate a journal of that size.\nOnly one of the\nsize\nor\ndevice\noptions can be given for a\nfile system.\n-l\nList the contents of the file system superblock, including\nthe current values of the parameters that can be set via\nthis program.\n-L\nvolume-label\nSet the volume label of the file system.  Ext2 file system\nlabels can be at most 16 characters long; if\nvolume-label\nis longer than 16 characters,\ntune2fs\nwill truncate it and\nprint a warning.  For other file systems that support\nonline label manipulation and are mounted\ntune2fs\nwill work\nas well, but it will not attempt to truncate the\nvolume-\nlabel\nat all.  The volume label can be used by\nmount(8)\n,\nfsck(8)\n, and\n/etc/fstab\n(5) (and possibly others) by\nspecifying\nLABEL=\nvolume-label\ninstead of a block special\ndevice name like\n/dev/hda5\n.\n-m\nreserved-blocks-percentage\nSet the percentage of the file system which may only be\nallocated by privileged processes.   Reserving some number\nof file system blocks for use by privileged processes is\ndone to avoid file system fragmentation, and to allow\nsystem daemons, such as\nsyslogd\n(8), to continue to function\ncorrectly after non-privileged processes are prevented from\nwriting to the file system.  Normally, the default\npercentage of reserved blocks is 5%.\n-M\nlast-mounted-directory\nSet the last-mounted directory for the file system.\n-o\n[^]\nmount-option\n[,...]\nSet or clear the indicated default mount options in the\nfile system.  Default mount options can be overridden by\nmount options specified either in\n/etc/fstab\n(5) or on the\ncommand line arguments to\nmount(8)\n.  Older kernels may not\nsupport this feature; in particular, kernels which predate\n2.4.20 will almost certainly ignore the default mount\noptions field in the superblock.\nMore than one mount option can be cleared or set by\nseparating features with commas.  Mount options prefixed\nwith a caret character ('^') will be cleared in the file\nsystem's superblock; mount options without a prefix\ncharacter or prefixed with a plus character ('+') will be\nadded to the file system.\nThe following mount options can be set or cleared using\ntune2fs\n:\ndebug\nEnable debugging code for this file system.\nbsdgroups\nEmulate BSD behavior when creating new files:\nthey will take the group-id of the directory in\nwhich they were created.  The standard System V\nbehavior is the default, where newly created\nfiles take on the fsgid of the current process,\nunless the directory has the setgid bit set, in\nwhich case it takes the gid from the parent\ndirectory, and also gets the setgid bit set if\nit is a directory itself.\nuser_xattr\nEnable user-specified extended attributes.\nacl\nEnable Posix Access Control Lists.\nuid16\nDisables 32-bit UIDs and GIDs.  This is for\ninteroperability with older kernels which only\nstore and expect 16-bit values.\njournal_data\nWhen the file system is mounted with journaling\nenabled, all data (not just metadata) is\ncommitted into the journal prior to being\nwritten into the main file system.\njournal_data_ordered\nWhen the file system is mounted with journaling\nenabled, all data is forced directly out to the\nmain file system prior to its metadata being\ncommitted to the journal.\njournal_data_writeback\nWhen the file system is mounted with journaling\nenabled, data may be written into the main file\nsystem after its metadata has been committed to\nthe journal.  This may increase throughput,\nhowever, it may allow old data to appear in\nfiles after a crash and journal recovery.\nnobarrier\nThe file system will be mounted with barrier\noperations in the journal disabled.  (This\noption is currently only supported by the ext4\nfile system driver in 2.6.35+ kernels.)\nblock_validity\nThe file system will be mounted with the\nblock_validity option enabled, which causes\nextra checks to be performed after reading or\nwriting from the file system.  This prevents\ncorrupted metadata blocks from causing file\nsystem damage by overwriting parts of the inode\ntable or block group descriptors.  This comes\nat the cost of increased memory and CPU\noverhead, so it is enabled only for debugging\npurposes.  (This option is currently only\nsupported by the ext4 file system driver in\n2.6.35+ kernels.)\ndiscard\nThe file system will be mounted with the\ndiscard mount option.  This will cause the file\nsystem driver to attempt to use the\ntrim/discard feature of some storage devices\n(such as SSD's and thin-provisioned drives\navailable in some enterprise storage arrays) to\ninform the storage device that blocks belonging\nto deleted files can be reused for other\npurposes.  (This option is currently only\nsupported by the ext4 file system driver in\n2.6.35+ kernels.)\nnodelalloc\nThe file system will be mounted with the\nnodelalloc mount option.  This will disable the\ndelayed allocation feature.  (This option is\ncurrently only supported by the ext4 file\nsystem driver in 2.6.35+ kernels.)\n-O\n[^]\nfeature\n[,...]\nSet or clear the indicated file system features (options)\nin the file system.  More than one file system feature can\nbe cleared or set by separating features with commas.  File\nSystem features prefixed with a caret character ('^') will\nbe cleared in the file system's superblock; file system\nfeatures without a prefix character or prefixed with a plus\ncharacter ('+') will be added to the file system.  For a\ndetailed description of the file system features, please\nsee the man page\next4(5)\n.\nThe following file system features can be set or cleared\nusing\ntune2fs\n:\n64bit\nEnable the file system to be larger than 2^32\nblocks.\ncasefold\nEnable support for file system level\ncasefolding.  The option can be cleared only if\nfilesystem has no directories with\nF\nattribute.\ndir_index\nUse hashed b-trees to speed up lookups for\nlarge directories.\ndir_nlink\nAllow more than 65000 subdirectories per\ndirectory.\nea_inode\nAllow the value of each extended attribute to\nbe placed in the data blocks of a separate\ninode if necessary, increasing the limit on the\nsize and number of extended attributes per\nfile.\nTune2fs\ncurrently only supports setting\nthis file system feature.\nencrypt\nEnable support for file system level\nencryption.\nTune2fs\ncurrently only supports\nsetting this file system feature.\nextent\nEnable the use of extent trees to store the\nlocation of data blocks in inodes.\nTune2fs\ncurrently only supports setting this file\nsystem feature.\nextra_isize\nEnable the extended inode fields used by ext4.\nfiletype\nStore file type information in directory\nentries.\nflex_bg\nAllow bitmaps and inode tables for a block\ngroup to be placed anywhere on the storage\nmedia.\nTune2fs\nwill not reorganize the\nlocation of the inode tables and allocation\nbitmaps, as\nmke2fs(8)\nwill do when it creates a\nfreshly formatted file system with\nflex_bg\nenabled.\nhas_journal\nUse a journal to ensure file system consistency\neven across unclean shutdowns.  Setting the\nfile system feature is equivalent to using the\n-j\noption.\nfast_commit\nEnable fast commit journaling feature to\nimprove fsync latency.\nlarge_dir\nIncrease the limit on the number of files per\ndirectory.\nTune2fs\ncurrently only supports\nsetting this file system feature.\nhuge_file\nSupport files larger than 2 terabytes in size.\nlarge_file\nFile System can contain files that are greater\nthan 2 GiB.\nmetadata_csum\nStore a checksum to protect the contents in\neach metadata block.\nmetadata_csum_seed\nAllow the file system to store the metadata\nchecksum seed in the superblock, enabling the\nadministrator to change the UUID of a file\nsystem using the\nmetadata_csum\nfeature while it\nis mounted.\nmmp\nEnable or disable multiple mount protection\n(MMP) feature.\norphan_file\nStore the list of orphan inodes in multiple\nblocks instead of a single linked-list to avoid\npotential scalability bottlenecks for workloads\nthat perform a large number of file truncations\nor extensions in parallel.\nproject\nEnable project ID tracking.  This is used for\nproject quota tracking.\nquota\nEnable internal file system quota inodes.\nread-only\nForce the kernel to mount the file system read-\nonly.\nresize_inode\nReserve space so the block group descriptor\ntable may grow in the future.\nTune2fs\nonly\nsupports clearing this file system feature.\nsparse_super\nLimit the number of backup superblocks to save\nspace on large file systems.\nTune2fs\ncurrently\nonly supports setting this file system feature.\nstable_inodes\nPrevent the file system from being shrunk or\nhaving its UUID changed, in order to allow the\nuse of specialized encryption settings that\nmake use of the inode numbers and UUID.\nTune2fs\ncurrently only supports setting this\nfile system feature.\nuninit_bg\nAllow the kernel to initialize bitmaps and\ninode tables lazily, and to keep a high\nwatermark for the unused inodes in a file\nsystem, to reduce\ne2fsck(8)\ntime.  The first\ne2fsck run after enabling this feature will\ntake the full time, but subsequent e2fsck runs\nwill take only a fraction of the original time,\ndepending on how full the file system is.\nverity\nEnable support for verity protected files.\nTune2fs\ncurrently only supports setting this\nfile system feature.\nAfter setting or clearing\nsparse_super\n,\nuninit_bg\n,\nfiletype\n, or\nresize_inode\nfile system features, the file\nsystem may require being checked using\ne2fsck(8)\nto return\nthe file system to a consistent state.\nTune2fs\nwill print\na message requesting that the system administrator run\ne2fsck(8)\nif necessary.  After setting the\ndir_index\nfeature,\ne2fsck -D\ncan be run to convert existing\ndirectories to the hashed B-tree format.  Enabling certain\nfile system features may prevent the file system from being\nmounted by kernels which do not support those features.  In\nparticular, the\nuninit_bg\nand\nflex_bg\nfeatures are only\nsupported by the ext4 file system.\n-r\nreserved-blocks-count\nSet the number of reserved file system blocks.\n-Q\nquota-options\nSets 'quota' feature on the superblock and works on the\nquota files for the given quota type. Quota options could\nbe one or more of the following:\n[^]usrquota\nSets/clears user quota inode in the superblock.\n[^]grpquota\nSets/clears group quota inode in the\nsuperblock.\n[^]prjquota\nSets/clears project quota inode in the\nsuperblock.\n-T\ntime-last-checked\nSet the time the file system was last checked using\ne2fsck\n.\nThe time is interpreted using the current (local) timezone.\nThis can be useful in scripts which use a Logical Volume\nManager to make a consistent snapshot of a file system, and\nthen check the file system during off hours to make sure it\nhasn't been corrupted due to hardware problems, etc.  If\nthe file system was clean, then this option can be used to\nset the last checked time on the original file system.  The\nformat of\ntime-last-checked\nis the international date\nformat, with an optional time specifier, i.e.\nYYYYMMDD[HH[MM[SS]]].   The keyword\nnow\nis also accepted,\nin which case the last checked time will be set to the\ncurrent time.\n-u\nuser\nSet the user who can use the reserved file system blocks.\nuser\ncan be a numerical uid or a user name.  If a user name\nis given, it is converted to a numerical uid before it is\nstored in the superblock.\n-U\nUUID\nSet the universally unique identifier (UUID) of the file\nsystem to\nUUID\n.  The format of the UUID is a series of hex\ndigits separated by hyphens, like this:\n\"c1b9d5a2-f162-11cf-9ece-0020afc76f16\".  The\nUUID\nparameter\nmay also be one of the following:\nclear\nclear the file system UUID\nrandom\ngenerate a new randomly-generated UUID\ntime\ngenerate a new time-based UUID\nThe UUID may be used by\nmount(8)\n,\nfsck(8)\n, and\n/etc/fstab\n(5) (and possibly others) by specifying\nUUID=\nuuid\ninstead of a block special device name like\n/dev/hda1\n.\nSee\nuuidgen\n(8) for more information.  If the system does\nnot have a good random number generator such as\n/dev/random\nor\n/dev/urandom\n,\ntune2fs\nwill automatically use a time-\nbased UUID instead of a randomly-generated UUID.\n-z\nundo_file\nBefore overwriting a file system block, write the old\ncontents of the block to an undo file.  This undo file can\nbe used with e2undo(8) to restore the old contents of the\nfile system should something go wrong.  If the empty string\nis passed as the undo_file argument, the undo file will be\nwritten to a file named tune2fs-\ndevice\n.e2undo in the\ndirectory specified via the\nE2FSPROGS_UNDO_DIR\nenvironment\nvariable.\nWARNING: The undo file cannot be used to recover from a\npower or system crash.\nBUGS\ntop\nWe haven't found any bugs yet.  That doesn't mean there aren't\nany...\nAUTHOR\ntop\ntune2fs\nwas written by Remy Card <Remy.Card@linux.org>.  It is\ncurrently being maintained by Theodore Ts'o <tytso@alum.mit.edu>.\ntune2fs\nuses the ext2fs library written by Theodore Ts'o\n<tytso@mit.edu>.  This manual page was written by Christian Kuhtz\n<chk@data-hh.Hanse.DE>.  Time-dependent checking was added by Uwe\nOhse <uwe@tirka.gun.de>.\nAVAILABILITY\ntop\ntune2fs\nis part of the e2fsprogs package and is available from\nhttp://e2fsprogs.sourceforge.net\n.\nSEE ALSO\ntop\ndebugfs(8)\n,\ndumpe2fs(8)\n,\ne2fsck(8)\n,\nmke2fs(8)\n,\next4(5)\nCOLOPHON\ntop\nThis page is part of the\ne2fsprogs\n(utilities for ext2/3/4\nfilesystems) project.  Information about the project can be found\nat â¨\nhttp://e2fsprogs.sourceforge.net/\nâ©.  It is not known how to\nreport bugs for this man page; if you know, please send a mail to\nman-pages@man7.org.  This page was obtained from the project's\nupstream Git repository\nâ¨git://git.kernel.org/pub/scm/fs/ext2/e2fsprogs.gitâ© on\n2025-08-11.  (At that time, the date of the most recent commit\nthat was found in the repository was 2025-07-31.)  If you discover\nany rendering problems in this HTML version of the page, or you\nbelieve there is a better or more up-to-date source for the page,\nor you have corrections or improvements to the information in this\nCOLOPHON (which is\nnot\npart of the original manual page), send a\nmail to man-pages@man7.org\nE2fsprogs version 1.47.3        July 2025\nTUNE2FS\n(8)\nPages that refer to this page:\next4(5)\n,\nmke2fs.conf(5)\n,\ndebugfs(8)\n,\ndumpe2fs(8)\n,\ne2fsck(8)\n,\ne2label(8)\n,\ne2undo(8)\n,\nfsadm(8)\n,\nmke2fs(8)\n,\nmount(8)\n,\ntune2fs(8)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man8/tune2fs.8.html"}}
{"text": "resize2fs(8) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\nresize2fs(8) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nOPTIONS\n|\nKNOWN BUGS\n|\nAUTHOR\n|\nCOPYRIGHT\n|\nSEE ALSO\n|\nCOLOPHON\nRESIZE2FS\n(8)             System Manager's Manual\nRESIZE2FS\n(8)\nNAME\ntop\nresize2fs - ext2/ext3/ext4 file system resizer\nSYNOPSIS\ntop\nresize2fs\n[\n-fFpPMbs\n] [\n-d\ndebug-flags\n] [\n-S\nRAID-stride\n] [\n-z\nundo_file\n]\ndevice\n[\nsize\n]\nDESCRIPTION\ntop\nThe\nresize2fs\nprogram will resize ext2, ext3, or ext4 file\nsystems.  It can be used to enlarge or shrink an unmounted file\nsystem located on\ndevice\n.  If the file system is mounted, it can\nbe used to expand the size of the mounted file system, assuming\nthe kernel and the file system supports on-line resizing.  (Modern\nLinux 2.6 kernels will support on-line resize for file systems\nmounted using ext3 and ext4; ext3 file systems will require the\nuse of file systems with the resize_inode feature enabled.)\nThe\nsize\nparameter specifies the requested new size of the file\nsystem.  If no units are specified, the units of the\nsize\nparameter shall be the file system blocksize of the file system.\nOptionally, the\nsize\nparameter may be suffixed by one of the\nfollowing units designators: 'K', 'M', 'G', 'T' (either upper-case\nor lower-case) or 's' for power-of-two kilobytes, megabytes,\ngigabytes, terabytes or 512 byte sectors respectively. The\nsize\nof\nthe file system may never be larger than the size of the\npartition.  If\nsize\nparameter is not specified, it will default to\nthe size of the partition.\nThe\nresize2fs\nprogram does not manipulate the size of partitions.\nIf you wish to enlarge a file system, you must make sure you can\nexpand the size of the underlying partition first.  This can be\ndone using\nfdisk(8)\nby deleting the partition and recreating it\nwith a larger size or using\nlvextend(8)\n, if you're using the\nlogical volume manager\nlvm(8)\n.  When recreating the partition,\nmake sure you create it with the same starting disk cylinder as\nbefore!  Otherwise, the resize operation will certainly not work,\nand you may lose your entire file system.  After running\nfdisk(8)\n,\nrun resize2fs to resize the ext2 file system to use all of the\nspace in the newly enlarged partition.\nIf you wish to shrink an ext2 partition, first use\nresize2fs\nto\nshrink the size of file system.  Then you may use\nfdisk(8)\nto\nshrink the size of the partition.  When shrinking the size of the\npartition, make sure you do not make it smaller than the new size\nof the ext2 file system!\nThe\n-b\nand\n-s\noptions enable and disable the 64bit feature,\nrespectively.  The resize2fs program will, of course, take care of\nresizing the block group descriptors and moving other data blocks\nout of the way, as needed.  It is not possible to resize the file\nsystem concurrent with changing the 64bit status.\nOPTIONS\ntop\n-b\nTurns on the 64bit feature, resizes the group descriptors\nas necessary, and moves other metadata out of the way.\n-d\ndebug-flags\nTurns on various resize2fs debugging features, if they have\nbeen compiled into the binary.\ndebug-flags\nshould be\ncomputed by adding the numbers of the desired features from\nthe following list:\n2    - Debug block relocations\n4    - Debug inode relocations\n8    - Debug moving the inode table\n16   - Print timing information\n32   - Debug minimum file system size (-M) calculation\n-f\nForces resize2fs to proceed with the file system resize\noperation, overriding some safety checks which resize2fs\nnormally enforces.\n-F\nFlush the file system device's buffer caches before\nbeginning.  Only really useful for doing\nresize2fs\ntime\ntrials.\n-M\nShrink the file system to minimize its size as much as\npossible, given the files stored in the file system.\n-p\nPrint out percentage completion bars for each\nresize2fs\nphase during an offline (non-trivial) resize operation, so\nthat the user can keep track of what the program is doing.\n(For very fast resize operations, no progress bars may be\ndisplayed.)\n-P\nPrint an estimate of the number of file system blocks in\nthe file system if it is shrunk using\nresize2fs\n's\n-M\noption\nand then exit.\n-s\nTurns off the 64bit feature and frees blocks that are no\nlonger in use.\n-S\nRAID-stride\nThe\nresize2fs\nprogram will heuristically determine the RAID\nstride that was specified when the file system was created.\nThis option allows the user to explicitly specify a RAID\nstride setting to be used by resize2fs instead.\n-z\nundo_file\nBefore overwriting a file system block, write the old\ncontents of the block to an undo file.  This undo file can\nbe used with e2undo(8) to restore the old contents of the\nfile system should something go wrong.  If the empty string\nis passed as the undo_file argument, the undo file will be\nwritten to a file named resize2fs-\ndevice\n.e2undo in the\ndirectory specified via the\nE2FSPROGS_UNDO_DIR\nenvironment\nvariable.\nWARNING: The undo file cannot be used to recover from a\npower or system crash.\nKNOWN BUGS\ntop\nThe minimum size of the file system as estimated by resize2fs may\nbe incorrect, especially for file systems with 1k and 2k\nblocksizes.\nAUTHOR\ntop\nresize2fs\nwas written by Theodore Ts'o <tytso@mit.edu>.\nCOPYRIGHT\ntop\nResize2fs is Copyright 1998 by Theodore Ts'o and PowerQuest, Inc.\nAll rights reserved.  As of April, 2000\nResize2fs\nmay be\nredistributed under the terms of the GPL.\nSEE ALSO\ntop\nfdisk(8)\n,\ne2fsck(8)\n,\nmke2fs(8)\n,\nlvm(8)\n,\nlvextend(8)\nCOLOPHON\ntop\nThis page is part of the\ne2fsprogs\n(utilities for ext2/3/4\nfilesystems) project.  Information about the project can be found\nat â¨\nhttp://e2fsprogs.sourceforge.net/\nâ©.  It is not known how to\nreport bugs for this man page; if you know, please send a mail to\nman-pages@man7.org.  This page was obtained from the project's\nupstream Git repository\nâ¨git://git.kernel.org/pub/scm/fs/ext2/e2fsprogs.gitâ© on\n2025-08-11.  (At that time, the date of the most recent commit\nthat was found in the repository was 2025-07-31.)  If you discover\nany rendering problems in this HTML version of the page, or you\nbelieve there is a better or more up-to-date source for the page,\nor you have corrections or improvements to the information in this\nCOLOPHON (which is\nnot\npart of the original manual page), send a\nmail to man-pages@man7.org\nE2fsprogs version 1.47.3        July 2025\nRESIZE2FS\n(8)\nPages that refer to this page:\next4(5)\n,\nfsadm(8)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man8/resize2fs.8.html"}}
{"text": "dd(1) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\ndd(1) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nAUTHOR\n|\nREPORTING BUGS\n|\nCOPYRIGHT\n|\nSEE ALSO\n|\nCOLOPHON\nDD\n(1)                         User Commands\nDD\n(1)\nNAME\ntop\ndd - convert and copy a file\nSYNOPSIS\ntop\ndd\n[\nOPERAND\n]...\ndd\nOPTION\nDESCRIPTION\ntop\nCopy a file, converting and formatting according to the operands.\nbs=BYTES\nread and write up to BYTES bytes at a time (default: 512);\noverrides ibs and obs\ncbs=BYTES\nconvert BYTES bytes at a time\nconv=CONVS\nconvert the file as per the comma separated symbol list\ncount=N\ncopy only N input blocks\nibs=BYTES\nread up to BYTES bytes at a time (default: 512)\nif=FILE\nread from FILE instead of stdin\niflag=FLAGS\nread as per the comma separated symbol list\nobs=BYTES\nwrite BYTES bytes at a time (default: 512)\nof=FILE\nwrite to FILE instead of stdout\noflag=FLAGS\nwrite as per the comma separated symbol list\nseek=N (or oseek=N) skip N obs-sized output blocks\nskip=N (or iseek=N) skip N ibs-sized input blocks\nstatus=LEVEL\nThe LEVEL of information to print to stderr; 'none'\nsuppresses everything but error messages, 'noxfer'\nsuppresses the final transfer statistics, 'progress' shows\nperiodic transfer statistics\nN and BYTES may be followed by the following multiplicative\nsuffixes: c=1, w=2, b=512, kB=1000, K=1024, MB=1000*1000,\nM=1024*1024, xM=M, GB=1000*1000*1000, G=1024*1024*1024, and so on\nfor T, P, E, Z, Y, R, Q.  Binary prefixes can be used, too: KiB=K,\nMiB=M, and so on.  If N ends in 'B', it counts bytes not blocks.\nEach CONV symbol may be:\nascii  from EBCDIC to ASCII\nebcdic from ASCII to EBCDIC\nibm    from ASCII to alternate EBCDIC\nblock  pad newline-terminated records with spaces to cbs-size\nunblock\nreplace trailing spaces in cbs-size records with newline\nlcase  change upper case to lower case\nucase  change lower case to upper case\nsparse try to seek rather than write all-NUL output blocks\nswab   swap every pair of input bytes\nsync   pad every input block with NULs to ibs-size; when used with\nblock or unblock, pad with spaces rather than NULs\nexcl   fail if the output file already exists\nnocreat\ndo not create the output file\nnotrunc\ndo not truncate the output file\nnoerror\ncontinue after read errors\nfdatasync\nphysically write output file data before finishing\nfsync  likewise, but also write metadata\nEach FLAG symbol may be:\nappend append mode (makes sense only for output; conv=notrunc\nsuggested)\ndirect use direct I/O for data\ndirectory\nfail unless a directory\ndsync  use synchronized I/O for data\nsync   likewise, but also for metadata\nfullblock\naccumulate full blocks of input (iflag only)\nnonblock\nuse non-blocking I/O\nnoatime\ndo not update access time\nnocache\nRequest to drop cache.  See also oflag=sync\nnoctty do not assign controlling terminal from file\nnofollow\ndo not follow symlinks\nSending a USR1 signal to a running 'dd' process makes it print I/O\nstatistics to standard error and then resume copying.\nOptions are:\n--help\ndisplay this help and exit\n--version\noutput version information and exit\nAUTHOR\ntop\nWritten by Paul Rubin, David MacKenzie, and Stuart Kemp.\nREPORTING BUGS\ntop\nGNU coreutils online help:\n<\nhttps://www.gnu.org/software/coreutils/\n>\nReport any translation bugs to\n<\nhttps://translationproject.org/team/\n>\nCOPYRIGHT\ntop\nCopyright Â© 2025 Free Software Foundation, Inc.  License GPLv3+:\nGNU GPL version 3 or later <\nhttps://gnu.org/licenses/gpl.html\n>.\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.\nSEE ALSO\ntop\nFull documentation <\nhttps://www.gnu.org/software/coreutils/dd\n>\nor available locally via: info '(coreutils) dd invocation'\nCOLOPHON\ntop\nThis page is part of the\ncoreutils\n(basic file, shell and text\nmanipulation utilities) project.  Information about the project\ncan be found at â¨\nhttp://www.gnu.org/software/coreutils/\nâ©.  If you\nhave a bug report for this manual page, see\nâ¨\nhttp://www.gnu.org/software/coreutils/\nâ©.  This page was obtained\nfrom the tarball coreutils-9.7.tar.xz fetched from\nâ¨\nhttp://ftp.gnu.org/gnu/coreutils/\nâ© on 2025-08-11.  If you\ndiscover any rendering problems in this HTML version of the page,\nor you believe there is a better or more up-to-date source for the\npage, or you have corrections or improvements to the information\nin this COLOPHON (which is\nnot\npart of the original manual page),\nsend a mail to man-pages@man7.org\nGNU coreutils 9.7               April 2025\nDD\n(1)\nPages that refer to this page:\npipesz(1)\n,\ntruncate(1)\n,\nxfs(5)\n,\nfdisk(8)\n,\nsfdisk(8)\n,\nswapon(8)\n,\nxfs_copy(8)\n,\nxfs_repair(8)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man1/dd.1.html"}}
{"text": "blkid(8) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\nblkid(8) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nOPTIONS\n|\nEXIT STATUS\n|\nCONFIGURATION FILE\n|\nENVIRONMENT\n|\nAUTHORS\n|\nSEE ALSO\n|\nREPORTING BUGS\n|\nAVAILABILITY\nBLKID\n(8)                  System Administration\nBLKID\n(8)\nNAME\ntop\nblkid - locate/print block device attributes\nSYNOPSIS\ntop\nblkid --label\nlabel\n|\n--uuid\nuuid\nblkid\n[\n--no-encoding --garbage-collect --list-one --cache-file\nfile\n] [\n--output\nformat\n] [\n--match-tag\ntag\n] [\n--match-token\nNAME=value\n] [\ndevice\n...]\nblkid --probe\n[\n--offset\noffset\n] [\n--output\nformat\n] [\n--size\nsize\n]\n[\n--match-tag\ntag\n] [\n--match-types\nlist\n] [\n--usages\nlist\n]\n[\n--no-part-details\n]\ndevice\n...\nblkid --info\n[\n--output format\n] [\n--match-tag\ntag\n]\ndevice\n...\nDESCRIPTION\ntop\nThe\nblkid\nprogram is the command-line interface to working with\nthe\nlibblkid(3)\nlibrary. It can determine the type of content\n(e.g., filesystem or swap) that a block device holds, and also the\nattributes (tokens, NAME=value pairs) from the content metadata\n(e.g., LABEL or UUID fields).\nIt is recommended to use lsblk\n(8)\ncommand to get information about\nblock devices, or lsblk --fs to get an overview of filesystems, or\nfindmnt(8)\nto search in already mounted filesystems.\nlsblk(8)\nprovides more information, better control on\noutput formatting, easy to use in scripts and it does not\nrequire root permissions to get actual information.\nblkid\nreads information directly from devices and for non-root\nusers it returns cached unverified information.\nblkid\nis\nmostly designed for system services and to test\nlibblkid(3)\nfunctionality.\nWhen\ndevice\nis specified, tokens from only this device are\ndisplayed. It is possible to specify multiple\ndevice\narguments on\nthe command line. If none is given, all partitions or\nunpartitioned devices which appear in\n/proc/partitions\nare shown,\nif they are recognized.\nblkid\nhas two main forms of operation: either searching for a\ndevice with a specific NAME=value pair, or displaying NAME=value\npairs for one or more specified devices.\nFor security reasons\nblkid\nsilently ignores all devices where the\nprobing result is ambivalent (multiple colliding filesystems are\ndetected). The low-level probing mode (\n-p\n) provides more\ninformation and extra exit status in this case. Itâs recommended\nto use\nwipefs(8)\nto get a detailed overview and to erase obsolete\nstuff (magic strings) from the device.\nOPTIONS\ntop\nThe\nsize\nand\noffset\narguments may be followed by the\nmultiplicative suffixes like KiB (=1024), MiB (=1024*1024), and so\non for GiB, TiB, PiB, EiB, ZiB and YiB (the \"iB\" is optional,\ne.g., \"K\" has the same meaning as \"KiB\"), or the suffixes KB\n(=1000), MB (=1000*1000), and so on for GB, TB, PB, EB, ZB and YB.\n-c\n,\n--cache-file\ncachefile\nRead from\ncachefile\ninstead of reading from the default cache\nfile (see the\nCONFIGURATION FILE\nsection for more details). If\nyou want to start with a clean cache (i.e., donât report\ndevices previously scanned but not necessarily available at\nthis time), specify\n/dev/null\n.\n-d\n,\n--no-encoding\nDonât encode non-printing characters. The non-printing\ncharacters are encoded by ^ and M- notation by default. Note\nthat the\n--output udev\noutput format uses a different encoding\nwhich cannot be disabled.\n-D\n,\n--no-part-details\nDonât print information (PART_ENTRY_* tags) from partition\ntable in low-level probing mode.\n-g\n,\n--garbage-collect\nPerform a garbage collection pass on the blkid cache to remove\ndevices which no longer exist.\n-H\n,\n--hint\nsetting\nSet probing hint. The hints are an optional way to force\nprobing functions to check, for example, another location. The\ncurrently supported is \"session_offset=\nnumber\n\" to set session\noffset on multi-session UDF.\n-i\n,\n--info\nDisplay information about I/O Limits (aka I/O topology). The\n'export' output format is automatically enabled. This option\ncan be used together with the\n--probe\noption.\n-k\n,\n--list-filesystems\nList all known filesystems and RAIDs and exit.\n-l\n,\n--list-one\nLook up only one device that matches the search parameter\nspecified with the\n--match-token\noption. If there are multiple\ndevices that match the specified search parameter, then the\ndevice with the highest priority is returned, and/or the first\ndevice found at a given priority (but see below note about\nudev). Device types in order of decreasing priority are:\nDevice Mapper, EVMS, LVM, MD, and finally regular block\ndevices. If this option is not specified,\nblkid\nwill print all\nof the devices that match the search parameter.\nThis option forces\nblkid\nto use udev when used for LABEL or\nUUID tokens in\n--match-token\n. The goal is to provide output\nconsistent with other utils (like\nmount(8)\n, etc.) on systems\nwhere the same tag is used for multiple devices.\n-L\n,\n--label\nlabel\nLook up the device that uses this filesystem\nlabel\n; this is\nequal to\n--list-one --output device --match-token LABEL=\nlabel\n.\nThis lookup method is able to reliably use /dev/disk/by-label\nudev symlinks (dependent on a setting in\n/etc/blkid.conf\n).\nAvoid using the symlinks directly; it is not reliable to use\nthe symlinks without verification. The\n--label\noption works on\nsystems with and without udev.\nUnfortunately, the original\nblkid(8)\nfrom e2fsprogs uses the\n-L\noption as a synonym for\n-o list\n. For better portability,\nuse\n-l -o device -t LABEL=\nlabel\nand\n-o list\nin your scripts\nrather than the\n-L\noption.\n-n\n,\n--match-types\nlist\nRestrict the probing functions to the specified\n(comma-separated)\nlist\nof superblock types (names). The list\nitems may be prefixed with \"no\" to specify the types which\nshould be ignored. For example:\nblkid --probe --match-types vfat,ext3,ext4 /dev/sda1\nprobes for vfat, ext3 and ext4 filesystems, and\nblkid --probe --match-types nominix /dev/sda1\nprobes for all supported formats except minix filesystems.\nThis option is only useful together with\n--probe\n.\n-o\n,\n--output\nformat\nUse the specified output format. Note that the order of\nvariables and devices is not fixed. See also option\n-s\n. The\nformat\nparameter may be:\nfull\nprint all tags (the default)\nvalue\nprint the value of the tags\nlist\nprint the devices in a user-friendly format; this output\nformat is unsupported for low-level probing (\n--probe\nor\n--info\n).\nThis output format is\nDEPRECATED\nin favour of the\nlsblk(8)\ncommand.\ndevice\nprint the device name only; this output format is always\nenabled for the\n--label\nand\n--uuid\noptions\nudev\nprint key=\"value\" pairs for easy import into the udev\nenvironment; the keys are prefixed by ID_FS_ or ID_PART_\nprefixes. The value may be modified to be safe for udev\nenvironment; allowed is plain ASCII, hex-escaping and\nvalid UTF-8, everything else (including whitespaces) is\nreplaced with '_'. The keys with\n_ENC\npostfix use\nhex-escaping for unsafe chars.\nThe udev output returns the ID_FS_AMBIVALENT tag if more\nsuperblocks are detected, and ID_PART_ENTRY_* tags are\nalways returned for all partitions including empty\npartitions.\nThis output format is\nDEPRECATED\n.\nexport\nprint key=value pairs for easy import into the\nenvironment; this output format is automatically enabled\nwhen I/O Limits (\n--info\noption) are requested.\nThe non-printing characters are encoded by ^ and M-\nnotation and all potentially unsafe characters are\nescaped.\njson\nPrint the tags entries in JSON objects.\n-O\n,\n--offset\noffset\nProbe at the given\noffset\n(only useful with\n--probe\n). This\noption can be used together with the\n--info\noption.\n-p\n,\n--probe\nSwitch to low-level superblock probing mode (bypassing the\ncache).\nNote that low-level probing also returns information about\npartition table type (PTTYPE tag) and partitions (PART_ENTRY_*\ntags). The tag names produced by low-level probing are based\non names used internally by libblkid and it may be different\nthan when executed without\n--probe\n(for example\nPART_ENTRY_UUID= vs PARTUUID=). See also\n--no-part-details\n.\n-s\n,\n--match-tag\ntag\nFor each (specified) device, show only the tags that match\ntag\n. It is possible to specify multiple\n--match-tag\noptions.\nIf no tag is specified, then all tokens are shown for all\n(specified) devices. In order to just refresh the cache\nwithout showing any tokens, use\n--match-tag none\nwith no other\noptions.\n-S\n,\n--size\nsize\nOverride the size of device/file (only useful with\n--probe\n).\n-t\n,\n--match-token\nNAME=value\nSearch for block devices with tokens named\nNAME\nthat have the\nvalue\nvalue\n, and display any devices which are found. Common\nvalues for\nNAME\ninclude\nTYPE\n,\nLABEL\n, and\nUUID\n. If there are no\ndevices specified on the command line, all block devices will\nbe searched; otherwise only the specified devices are\nsearched.\n-u\n,\n--usages\nlist\nRestrict the probing functions to the specified\n(comma-separated)\nlist\nof \"usage\" types. Supported usage types\nare: filesystem, raid, crypto and other. The list items may be\nprefixed with \"no\" to specify the usage types which should be\nignored. For example:\nblkid --probe --usages filesystem,other /dev/sda1\nprobes for all filesystem and other (e.g., swap) formats, and\nblkid --probe --usages noraid /dev/sda1\nprobes for all supported formats except RAIDs. This option is\nonly useful together with\n--probe\n.\n-U\n,\n--uuid\nuuid\nLook up the device that uses this filesystem\nuuid\n. For more\ndetails see the\n--label\noption.\n-h\n,\n--help\nDisplay help text and exit.\n-V\n,\n--version\nDisplay version and exit.\nEXIT STATUS\ntop\nIf the specified device or device addressed by specified token\n(option\n--match-token\n) was found and itâs possible to gather any\ninformation about the device, an exit status 0 is returned. Note\nthe option\n--match-tag\nfilters output tags, but it does not affect\nexit status.\nIf the specified token was not found, or no (specified) devices\ncould be identified, or it is impossible to gather any information\nabout the device identifiers or device content an exit status of 2\nis returned.\nFor usage or other errors, an exit status of 4 is returned.\nIf an ambivalent probing result was detected by low-level probing\nmode (\n-p\n), an exit status of 8 is returned.\nCONFIGURATION FILE\ntop\nThe standard location of the\n/etc/blkid.conf\nconfig file can be\noverridden by the environment variable\nBLKID_CONF\n. The following\noptions control the libblkid library:\nSEND_UEVENT=<yes|not>\nSends uevent when\n/dev/disk/by-{label,uuid,partuuid,partlabel}/\nsymlink does not\nmatch with LABEL, UUID, PARTUUID or PARTLABEL on the device.\nDefault is \"yes\".\nCACHE_FILE=<path>\nOverrides the standard location of the cache file. This\nsetting can be overridden by the environment variable\nBLKID_FILE\n. Default is\n/run/blkid/blkid.tab\n, or\n/etc/blkid.tab\non systems without a\n/run\ndirectory.\nEVALUATE=<methods>\nDefines LABEL and UUID evaluation method(s). Currently, the\nlibblkid library supports the \"udev\" and \"scan\" methods. More\nthan one method may be specified in a comma-separated list.\nDefault is \"udev,scan\". The \"udev\" method uses udev\n/dev/disk/by-*\nsymlinks and the \"scan\" method scans all block\ndevices from the\n/proc/partitions\nfile.\nENVIRONMENT\ntop\nSetting\nLIBBLKID_DEBUG=all\nenables debug output.\nAUTHORS\ntop\nblkid\nwas written by Andreas Dilger for libblkid and improved by\nTheodore Tsâo and Karel Zak.\nSEE ALSO\ntop\nlibblkid(3)\n,\nfindfs(8)\n,\nlsblk(8)\n,\nwipefs(8)\nREPORTING BUGS\ntop\nFor bug reports, use the issue tracker\n<\nhttps://github.com/util-linux/util-linux/issues\n>.\nAVAILABILITY\ntop\nThe\nblkid\ncommand is part of the util-linux package which can be\ndownloaded from Linux Kernel Archive\n<\nhttps://www.kernel.org/pub/linux/utils/util-linux/\n>. This page is\npart of the\nutil-linux\n(a random collection of Linux utilities)\nproject. Information about the project can be found at\nâ¨\nhttps://www.kernel.org/pub/linux/utils/util-linux/\nâ©. If you have a\nbug report for this manual page, send it to\nutil-linux@vger.kernel.org. This page was obtained from the\nproject's upstream Git repository\nâ¨git://git.kernel.org/pub/scm/utils/util-linux/util-linux.gitâ© on\n2025-08-11. (At that time, the date of the most recent commit that\nwas found in the repository was 2025-08-05.) If you discover any\nrendering problems in this HTML version of the page, or you\nbelieve there is a better or more up-to-date source for the page,\nor you have corrections or improvements to the information in this\nCOLOPHON (which is\nnot\npart of the original manual page), send a\nmail to man-pages@man7.org\nutil-linux 2.42-start-521-ec46  2025-08-09\nBLKID\n(8)\nPages that refer to this page:\nFS_IOC_SETFSLABEL(2const)\n,\nopen_by_handle_at(2)\n,\nlibblkid(3)\n,\nfstab(5)\n,\nblkid(8)\n,\nbtrfs-device(8)\n,\nfindfs(8)\n,\nlsblk(8)\n,\nwipefs(8)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man8/blkid.8.html"}}
{"text": "lspci(8) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\nlspci(8) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nOPTIONS\n|\nMACHINE READABLE OUTPUT\n|\nFILES\n|\nBUGS\n|\nSEE ALSO\n|\nAUTHOR\n|\nCOLOPHON\nlspci\n(8)                    The PCI Utilities\nlspci\n(8)\nNAME\ntop\nlspci - list all PCI devices\nSYNOPSIS\ntop\nlspci\n[\noptions\n]\nDESCRIPTION\ntop\nlspci\nis a utility for displaying information about PCI buses in\nthe system and devices connected to them.\nBy default, it shows a brief list of devices. Use the options\ndescribed below to request either a more verbose output or output\nintended for parsing by other programs.\nIf you are going to report bugs in PCI device drivers or in\nlspci\nitself, please include output of \"lspci -vvx\" or even better\n\"lspci -vvxxx\" (however, see below for possible caveats).\nSome parts of the output, especially in the highly verbose modes,\nare probably intelligible only to experienced PCI hackers. For\nexact definitions of the fields, please consult either the PCI\nspecifications or the\nheader.h\nand\n/usr/include/linux/pci.h\ninclude files.\nAccess to some parts of the PCI configuration space is restricted\nto root on many operating systems, so the features of\nlspci\navailable to normal users are limited. However,\nlspci\ntries its\nbest to display as much as available and mark all other\ninformation with\n<access denied>\ntext.\nOPTIONS\ntop\nBasic display modes\n-m\nDump PCI device data in a backward-compatible machine\nreadable form.  See below for details.\n-mm\nDump PCI device data in a machine readable form for easy\nparsing by scripts.  See below for details.\n-t\nShow a tree-like diagram containing all buses, bridges,\ndevices and connections between them.\nDisplay options\n-v\nBe verbose and display detailed information about all\ndevices.\n-vv\nBe very verbose and display more details. This level\nincludes everything deemed useful.\n-vvv\nBe even more verbose and display everything we are able to\nparse, even if it doesn't look interesting at all (e.g.,\nundefined memory regions).\n-k\nShow kernel drivers handling each device and also kernel\nmodules capable of handling it.  Turned on by default when\n-v\nis given in the normal mode of output.  (Currently works\nonly on Linux with kernel 2.6 or newer.)\n-x\nShow hexadecimal dump of the standard part of the\nconfiguration space (the first 64 bytes or 128 bytes for\nCardBus bridges).\n-xxx\nShow hexadecimal dump of the whole PCI configuration space.\nIt is available only to root as several PCI devices\ncrash\nwhen you try to read some parts of the config space (this\nbehavior probably doesn't violate the PCI standard, but\nit's at least very stupid). However, such devices are rare,\nso you needn't worry much.\n-xxxx\nShow hexadecimal dump of the extended (4096-byte) PCI\nconfiguration space available on PCI-X 2.0 and PCI Express\nbuses.\n-b\nBus-centric view. Show all IRQ numbers and addresses as\nseen by the cards on the PCI bus instead of as seen by the\nkernel.\n-D\nAlways show PCI domain numbers. By default, lspci\nsuppresses them on machines which have only domain 0.\n-P\nIdentify PCI devices by path through each bridge, instead\nof by bus number.\n-PP\nIdentify PCI devices by path through each bridge, showing\nthe bus number as well as the device number.\nOptions to control resolving ID's to names\n-n\nShow PCI vendor and device codes as numbers instead of\nlooking them up in the PCI ID list.\n-nn\nShow PCI vendor and device codes as both numbers and names.\n-q\nUse DNS to query the central PCI ID database if a device is\nnot found in the local\npci.ids\nfile. If the DNS query\nsucceeds, the result is cached in\n$XDG_CACHE_HOME/pci-ids\nand it is recognized in subsequent runs even if\n-q\nis not\ngiven any more. Please use this switch inside automated\nscripts only with caution to avoid overloading the database\nservers.\n-qq\nSame as\n-q\n, but the local cache is reset.\n-Q\nQuery the central database even for entries which are\nrecognized locally.  Use this if you suspect that the\ndisplayed entry is wrong.\nOptions for selection of devices\n-s [[[[<domain>]:]<bus>]:][<device>][.[<func>]]\nShow only devices in the specified domain (in case your\nmachine has several host bridges, they can either share a\ncommon bus number space or each of them can address a PCI\ndomain of its own; domains are numbered from 0 to ffff),\nbus (0 to ff), device (0 to 1f) and function (0 to 7).\nEach component of the device address can be omitted or set\nto \"*\", both meaning \"any value\". All numbers are\nhexadecimal.  E.g., \"0:\" means all devices on bus 0, \"0\"\nmeans all functions of device 0 on any bus, \"0.3\" selects\nthird function of device 0 on all buses and \".4\" shows only\nthe fourth function of each device.\n-d [<vendor>]:[<device>][:<class>[:<prog-if>]]\nShow only devices with specified vendor, device, class ID,\nand programming interface.  The ID's are given in\nhexadecimal and may be omitted or given as \"*\", both\nmeaning \"any value\". The class ID can contain \"x\"\ncharacters which stand for \"any digit\".\nOther options\n-i <file>\nUse\n<file>\nas the PCI ID list instead of\n/usr/local/share/pci.ids.\n-p <file>\nUse\n<file>\nas the map of PCI ID's handled by kernel\nmodules. By default, lspci uses\n/lib/modules/\nkernel_version\n/modules.pcimap.  Applies only\nto Linux systems with recent enough module tools.\n-M\nInvoke bus mapping mode which performs a thorough scan of\nall PCI devices, including those behind misconfigured\nbridges, etc. This option gives meaningful results only\nwith a direct hardware access mode, which usually requires\nroot privileges.  By default, the bus mapper scans domain.\nYou can use the\n-s\noption to select a different domain.\n--version\nShows\nlspci\nversion. This option should be used stand-\nalone.\nPCI access options\nThe PCI utilities use the PCI library to talk to PCI devices (see\npcilib(7)\nfor details). You can use the following options to\ninfluence its behavior:\n-A <method>\nThe library supports a variety of methods to access the PCI\nhardware.  By default, it uses the first access method\navailable, but you can use this option to override this\ndecision. See\n-A help\nfor a list of available methods and\ntheir descriptions.\n-O <param>=<value>\nThe behavior of the library is controlled by several named\nparameters.  This option allows one to set the value of any\nof the parameters. Use\n-O help\nfor a list of known\nparameters and their default values.\n-H1\nUse direct hardware access via Intel configuration\nmechanism 1.  (This is a shorthand for\n-A intel-conf1\n.)\n-H2\nUse direct hardware access via Intel configuration\nmechanism 2.  (This is a shorthand for\n-A intel-conf2\n.)\n-F <file>\nInstead of accessing real hardware, read the list of\ndevices and values of their configuration registers from\nthe given file produced by an earlier run of lspci -x.\nThis is very useful for analysis of user-supplied bug\nreports, because you can display the hardware configuration\nin any way you want without disturbing the user with\nrequests for more dumps.\n-G\nIncrease debug level of the library.\nMACHINE READABLE OUTPUT\ntop\nIf you intend to process the output of lspci automatically, please\nuse one of the machine-readable output formats (\n-m\n,\n-vm\n,\n-vmm\n)\ndescribed in this section. All other formats are likely to change\nbetween versions of lspci.\nAll numbers are always printed in hexadecimal. If you want to\nprocess numeric ID's instead of names, please add the\n-n\nswitch.\nSimple format (-m)\nIn the simple format, each device is described on a single line,\nwhich is formatted as parameters suitable for passing to a shell\nscript, i.e., values separated by whitespaces, quoted and escaped\nif necessary.  Some of the arguments are positional: slot, class,\nvendor name, device name, subsystem vendor name and subsystem name\n(the last two are empty if the device has no subsystem); the\nremaining arguments are option-like:\n-r\nrev\nRevision number.\n-p\nprogif\nProgramming interface.\nThe relative order of positional arguments and options is\nundefined.  New options can be added in future versions, but they\nwill always have a single argument not separated from the option\nby any spaces, so they can be easily ignored if not recognized.\nVerbose format (-vmm)\nThe verbose output is a sequence of records separated by blank\nlines.  Each record describes a single device by a sequence of\nlines, each line containing a single `\ntag\n:\nvalue\n' pair. The\ntag\nand the\nvalue\nare separated by a single tab character.  Neither\nthe records nor the lines within a record are in any particular\norder.  Tags are case-sensitive.\nThe following tags are defined:\nSlot\nThe name of the slot where the device resides\n([\ndomain\n:]\nbus\n:\ndevice\n.\nfunction\n).  This tag is always the\nfirst in a record.\nClass\nName of the class.\nVendor\nName of the vendor.\nDevice\nName of the device.\nSVendor\nName of the subsystem vendor (optional).\nSDevice\nName of the subsystem (optional).\nPhySlot\nThe physical slot where the device resides (optional, Linux\nonly).\nRev\nRevision number (optional).\nProgIf\nProgramming interface (optional).\nDriver\nKernel driver currently handling the device (optional,\nLinux only).\nModule\nKernel module reporting that it is capable of handling the\ndevice (optional, Linux only). Multiple lines with this tag\ncan occur.\nNUMANode\nNUMA node this device is connected to (optional, Linux\nonly).\nIOMMUGroup\nIOMMU group that this device is part of (optional, Linux\nonly).\nNew tags can be added in future versions, so you should silently\nignore any tags you don't recognize.\nBackward-compatible verbose format (-vm)\nIn this mode, lspci tries to be perfectly compatible with its old\nversions.  It's almost the same as the regular verbose format, but\nthe\nDevice\ntag is used for both the slot and the device name, so\nit occurs twice in a single record. Please avoid using this format\nin any new code.\nFILES\ntop\n/usr/local/share/pci.ids\nA list of all known PCI ID's (vendors, devices, classes and\nsubclasses). Maintained at\nhttps://pci-ids.ucw.cz/\n, use the\nupdate-pciids\nutility to download the most recent version.\n/usr/local/share/pci.ids.gz\nIf lspci is compiled with support for compression, this\nfile is tried before pci.ids.\n$XDG_CACHE_HOME/pci-ids\nAll ID's found in the DNS query mode are cached in this\nfile.\nBUGS\ntop\nSometimes, lspci is not able to decode the configuration registers\ncompletely.  This usually happens when not enough documentation\nwas available to the authors.  In such cases, it at least prints\nthe\n<?>\nmark to signal that there is potentially something more to\nsay. If you know the details, patches will be of course welcome.\nAccess to the extended configuration space is currently supported\nonly by the\nlinux_sysfs\nback-end.\nSEE ALSO\ntop\nsetpci(8)\n,\npci.ids(5)\n,\nupdate-pciids(8)\n,\npcilib(7)\nAUTHOR\ntop\nThe PCI Utilities are maintained by Martin Mares <mj@ucw.cz>.\nCOLOPHON\ntop\nThis page is part of the\npciutils\n(PCI utilities) project.\nInformation about the project can be found at\nâ¨\nhttp://mj.ucw.cz/sw/pciutils/\nâ©.  If you have a bug report for this\nmanual page, send it to linux-pci@vger.kernel.org.  This page was\nobtained from the project's upstream Git repository\nâ¨git://git.kernel.org/pub/scm/utils/pciutils/pciutils.gitâ© on\n2025-08-11.  (At that time, the date of the most recent commit\nthat was found in the repository was 2025-07-07.)  If you discover\nany rendering problems in this HTML version of the page, or you\nbelieve there is a better or more up-to-date source for the page,\nor you have corrections or improvements to the information in this\nCOLOPHON (which is\nnot\npart of the original manual page), send a\nmail to man-pages@man7.org\npciutils-3.13.0                30 May 2024\nlspci\n(8)\nPages that refer to this page:\nlsusb.py(1)\n,\npci.ids(5)\n,\nproc(5)\n,\nproc_bus(5)\n,\npcilib(7)\n,\nlsusb(8)\n,\npcilmr(8)\n,\nsetpci(8)\n,\nupdate-pciids(8)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man8/lspci.8.html"}}
{"text": "lsusb(8) - Linux manual page\nman7.org\n> Linux >\nman-pages\nLinux/UNIX system programming training\nlsusb(8) — Linux manual page\nNAME\n|\nSYNOPSIS\n|\nDESCRIPTION\n|\nOPTIONS\n|\nRETURN VALUE\n|\nSEE ALSO\n|\nAUTHOR\n|\nCOLOPHON\nlsusb\n(8)                   Linux USB Utilities\nlsusb\n(8)\nNAME\ntop\nlsusb - list USB devices\nSYNOPSIS\ntop\nlsusb\n[\noptions\n]\nDESCRIPTION\ntop\nlsusb\nis a utility for displaying information about USB buses in\nthe system and the devices connected to them. It uses udev's\nhardware database to associate a full human-readable name to the\nvendor ID and the product ID.\nOPTIONS\ntop\n-v\n,\n--verbose\nTells\nlsusb\nto be verbose and display detailed information\nabout the devices shown.  This includes configuration\ndescriptors for the device's current speed.  Class\ndescriptors will be shown, when available, for USB device\nclasses including hub, audio, HID, communications, and\nchipcard. Can be used with the\n-t\noption.\n-s\n[[\nbus\n]\n:\n][\ndevnum\n]\nShow only devices in specified\nbus\nand/or\ndevnum\n.  Both IDs\nare given in decimal and may be omitted.\n-d\n[\nvendor\n]\n:\n[\nproduct\n]\nShow only devices with the specified vendor and product ID.\nBoth IDs are given in hexadecimal.\n-D\ndevice\nDo not scan the /dev/bus/usb directory, instead display\nonly information about the device whose device file is\ngiven.  The device file should be something like\n/dev/bus/usb/001/001.  This option displays detailed\ninformation like the\n-v\noption; you must be root to do\nthis.\n-t\n,\n--tree\nTells\nlsusb\nto dump the physical USB device hierarchy as a\ntree. Verbosity can be increased twice with the\n-v\noption.\n-V\n,\n--version\nPrint version information on standard output, then exit\nsuccessfully.\nRETURN VALUE\ntop\nIf the specified device is not found, a non-zero exit code is\nreturned.\nSEE ALSO\ntop\nlspci(8)\n,\nusbview\n(8).\nAUTHOR\ntop\nThomas Sailer, <sailer@ife.ee.ethz.ch>.\nCOLOPHON\ntop\nThis page is part of the\nusbutils\n(USB utilities for Linux)\nproject.  Information about the project can be found at\nâ¨\nhttp://www.linux-usb.org/\nâ©.  If you have a bug report for this\nmanual page, send it to linux-usb@vger.kernel.org.  This page was\nobtained from the project's upstream Git repository\nâ¨\nhttps://github.com/gregkh/usbutils.git\nâ© on 2025-08-11.  (At that\ntime, the date of the most recent commit that was found in the\nrepository was 2025-06-20.)  If you discover any rendering\nproblems in this HTML version of the page, or you believe there is\na better or more up-to-date source for the page, or you have\ncorrections or improvements to the information in this COLOPHON\n(which is\nnot\npart of the original manual page), send a mail to\nman-pages@man7.org\nusbutils                     11 February 2019\nlsusb\n(8)\nPages that refer to this page:\nlsusb.py(1)\n,\nusb-devices(1)\n,\nusbreset(1)\nHTML rendering created 2025-09-06\nby\nMichael Kerrisk\n,\nauthor of\nThe Linux Programming Interface\n.\nFor details of in-depth\nLinux/UNIX system programming training courses\nthat I teach, look\nhere\n.\nHosting by\njambit GmbH\n.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://man7.org/linux/man-pages/man8/lsusb.8.html"}}
