{"text": "nginx documentation\nConfused between\ningress-nginx\nand\nNGINX Ingress Controller\n?\nLearn about our long-term commitment to the NGINX Ingress Controller and Gateway API implementation.\nRead the Blog\n.\nnginx documentation\nIntroduction\nInstalling nginx\nBuilding nginx from Sources\nBeginner’s Guide\nAdmin’s Guide\nControlling nginx\nConnection processing methods\nSetting up hashes\nA debugging log\nLogging to syslog\nConfiguration file measurement units\nCommand-line parameters\nnginx for Windows\nSupport for QUIC and HTTP/3\nHow nginx processes a request\nServer names\nUsing nginx as HTTP load balancer\nConfiguring HTTPS servers\nHow nginx processes a TCP/UDP session\nScripting with njs\nChapter “nginx” in\n“The Architecture of Open Source Applications”\nHow-To\nBuilding nginx on the Win32 platform with Visual C\nInstalling NGINX Plus AMIs on Amazon EC2\nDebugging nginx with DTrace pid provider\nConverting rewrite rules\nWebSocket proxying\nDevelopment\nContributing Changes\nDevelopment guide\nModules reference\nAlphabetical index of directives\nAlphabetical index of variables\nCore functionality\nngx_http_core_module\nngx_http_access_module\nngx_http_addition_module\nngx_http_api_module\nngx_http_auth_basic_module\nngx_http_auth_jwt_module\nngx_http_auth_request_module\nngx_http_auth_require_module\nngx_http_autoindex_module\nngx_http_browser_module\nngx_http_charset_module\nngx_http_dav_module\nngx_http_empty_gif_module\nngx_http_f4f_module\nngx_http_fastcgi_module\nngx_http_flv_module\nngx_http_geo_module\nngx_http_geoip_module\nngx_http_grpc_module\nngx_http_gunzip_module\nngx_http_gzip_module\nngx_http_gzip_static_module\nngx_http_headers_module\nngx_http_hls_module\nngx_http_image_filter_module\nngx_http_index_module\nngx_http_internal_redirect_module\nngx_http_js_module\nngx_http_keyval_module\nngx_http_limit_conn_module\nngx_http_limit_req_module\nngx_http_log_module\nngx_http_map_module\nngx_http_memcached_module\nngx_http_mirror_module\nngx_http_mp4_module\nngx_http_oidc_module\nngx_http_perl_module\nngx_http_proxy_module\nngx_http_proxy_protocol_vendor_module\nngx_http_random_index_module\nngx_http_realip_module\nngx_http_referer_module\nngx_http_rewrite_module\nngx_http_scgi_module\nngx_http_secure_link_module\nngx_http_session_log_module\nngx_http_slice_module\nngx_http_split_clients_module\nngx_http_ssi_module\nngx_http_ssl_module\nngx_http_status_module\nngx_http_stub_status_module\nngx_http_sub_module\nngx_http_upstream_module\nngx_http_upstream_conf_module\nngx_http_upstream_hc_module\nngx_http_userid_module\nngx_http_uwsgi_module\nngx_http_v2_module\nngx_http_v3_module\nngx_http_xslt_module\nngx_mail_core_module\nngx_mail_auth_http_module\nngx_mail_proxy_module\nngx_mail_realip_module\nngx_mail_ssl_module\nngx_mail_imap_module\nngx_mail_pop3_module\nngx_mail_smtp_module\nngx_stream_core_module\nngx_stream_access_module\nngx_stream_geo_module\nngx_stream_geoip_module\nngx_stream_js_module\nngx_stream_keyval_module\nngx_stream_limit_conn_module\nngx_stream_log_module\nngx_stream_map_module\nngx_stream_mqtt_preread_module\nngx_stream_mqtt_filter_module\nngx_stream_pass_module\nngx_stream_proxy_module\nngx_stream_proxy_protocol_vendor_module\nngx_stream_realip_module\nngx_stream_return_module\nngx_stream_set_module\nngx_stream_split_clients_module\nngx_stream_ssl_module\nngx_stream_ssl_preread_module\nngx_stream_upstream_module\nngx_stream_upstream_hc_module\nngx_stream_zone_sync_module\nngx_google_perftools_module\nngx_mgmt_module\nngx_http_acme_module\nngx_otel_module", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://nginx.org/en/docs/"}}
{"text": "Beginner’s Guide\nConfused between\ningress-nginx\nand\nNGINX Ingress Controller\n?\nLearn about our long-term commitment to the NGINX Ingress Controller and Gateway API implementation.\nRead the Blog\n.\nBeginner’s Guide\nStarting, Stopping, and Reloading Configuration\nConfiguration File’s Structure\nServing Static Content\nSetting Up a Simple Proxy Server\nSetting Up FastCGI Proxying\nThis guide gives a basic introduction to nginx and describes some\nsimple tasks that can be done with it.\nIt is supposed that nginx is already installed on the reader’s machine.\nIf it is not, see the\nInstalling nginx\npage.\nThis guide describes how to start and stop nginx, and reload its\nconfiguration, explains the structure\nof the configuration file and describes how to set up nginx\nto serve out static content, how to configure nginx as a proxy\nserver, and how to connect it with a FastCGI application.\nnginx has one master process and several worker processes.\nThe main purpose of the master process is to read and evaluate configuration,\nand maintain worker processes.\nWorker processes do actual processing of requests.\nnginx employs event-based model and OS-dependent mechanisms to efficiently\ndistribute requests among worker processes.\nThe number of worker processes is defined in the configuration file and\nmay be fixed for a given configuration or automatically adjusted to the\nnumber of available CPU cores (see\nworker_processes\n).\nThe way nginx and its modules work is determined in the configuration file.\nBy default, the configuration file is named\nnginx.conf\nand placed in the directory\n/usr/local/nginx/conf\n,\n/etc/nginx\n, or\n/usr/local/etc/nginx\n.\nStarting, Stopping, and Reloading Configuration\nTo start nginx, run the executable file.\nOnce nginx is started, it can be controlled by invoking the executable\nwith the\n-s\nparameter.\nUse the following syntax:\nnginx -s\nsignal\nWhere\nsignal\nmay be one of the following:\nstop\n— fast shutdown\nquit\n— graceful shutdown\nreload\n— reloading the configuration file\nreopen\n— reopening the log files\nFor example, to stop nginx processes with waiting for the worker processes\nto finish serving current requests, the following command can be executed:\nnginx -s quit\nThis command should be executed under the same user that\nstarted nginx.\nChanges made in the configuration file\nwill not be applied until the command to reload configuration is\nsent to nginx or it is restarted.\nTo reload configuration, execute:\nnginx -s reload\nOnce the master process receives the signal to reload configuration,\nit checks the syntax validity\nof the new configuration file and tries to apply the configuration provided\nin it.\nIf this is a success, the master process starts new worker processes\nand sends messages to old worker processes, requesting them to\nshut down.\nOtherwise, the master process rolls back the changes and\ncontinues to work with the old configuration.\nOld worker processes, receiving a command to shut down,\nstop accepting new connections and continue to service current requests until\nall such requests are serviced.\nAfter that, the old worker processes exit.\nA signal may also be sent to nginx processes with the help of Unix tools\nsuch as the\nkill\nutility.\nIn this case a signal is sent directly to a process with a given process ID.\nThe process ID of the nginx master process is written, by default, to the\nnginx.pid\nin the directory\n/usr/local/nginx/logs\nor\n/var/run\n.\nFor example, if the master process ID is 1628, to send the QUIT signal\nresulting in nginx’s graceful shutdown, execute:\nkill -s QUIT 1628\nFor getting the list of all running nginx processes, the\nps\nutility may be used, for example, in the following way:\nps -ax | grep nginx\nFor more information on sending signals to nginx, see\nControlling nginx\n.\nConfiguration File’s Structure\nnginx consists of modules which are controlled by directives specified\nin the configuration file.\nDirectives are divided into simple directives and block directives.\nA simple directive consists of the name and parameters separated by spaces\nand ends with a semicolon (\n;\n).\nA block directive has the same structure as a simple directive, but\ninstead of the semicolon it ends with a set of additional instructions\nsurrounded by braces (\n{\nand\n}\n).\nIf a block directive can have other directives inside braces,\nit is called a context (examples:\nevents\n,\nhttp\n,\nserver\n,\nand\nlocation\n).\nDirectives placed in the configuration file outside\nof any contexts are considered to be in the\nmain\ncontext.\nThe\nevents\nand\nhttp\ndirectives\nreside in the\nmain\ncontext,\nserver\nin\nhttp\n, and\nlocation\nin\nserver\n.\nThe rest of a line after the\n#\nsign is considered a comment.\nServing Static Content\nAn important web server task is serving out\nfiles (such as images or static HTML pages).\nYou will implement an example where, depending on the request,\nfiles will be served from different local directories:\n/data/www\n(which may contain HTML files) and\n/data/images\n(containing images).\nThis will require editing of the configuration file and setting up of a\nserver\nblock inside the\nhttp\nblock with two\nlocation\nblocks.\nFirst, create the\n/data/www\ndirectory and put an\nindex.html\nfile with any text content into it and\ncreate the\n/data/images\ndirectory and place some\nimages in it.\nNext, open the configuration file.\nThe default configuration file already includes several examples of\nthe\nserver\nblock, mostly commented out.\nFor now comment out all such blocks and start a new\nserver\nblock:\nhttp {\nserver {\n}\n}\nGenerally, the configuration file may include several\nserver\nblocks\ndistinguished\nby ports on which\nthey\nlisten\nto\nand by\nserver names\n.\nOnce nginx decides which\nserver\nprocesses a request,\nit tests the URI specified in the request’s header against the parameters of the\nlocation\ndirectives defined inside the\nserver\nblock.\nAdd the following\nlocation\nblock to the\nserver\nblock:\nlocation / {\nroot /data/www;\n}\nThis\nlocation\nblock specifies the\n“\n/\n” prefix compared with the URI from the request.\nFor matching requests, the URI will be added to the path specified in the\nroot\ndirective, that is, to\n/data/www\n,\nto form the path to the requested file on the local file system.\nIf there are several matching\nlocation\nblocks nginx\nselects the one with the longest prefix.\nThe\nlocation\nblock above provides the shortest\nprefix, of length one,\nand so only if all other\nlocation\nblocks fail to provide a match, this block will be used.\nNext, add the second\nlocation\nblock:\nlocation /images/ {\nroot /data;\n}\nIt will be a match for requests starting with\n/images/\n(\nlocation /\nalso matches such requests,\nbut has shorter prefix).\nThe resulting configuration of the\nserver\nblock should\nlook like this:\nserver {\nlocation / {\nroot /data/www;\n}\nlocation /images/ {\nroot /data;\n}\n}\nThis is already a working configuration of a server that listens\non the standard port 80 and is accessible on the local machine at\nhttp://localhost/\n.\nIn response to requests with URIs starting with\n/images/\n,\nthe server will send files from the\n/data/images\ndirectory.\nFor example, in response to the\nhttp://localhost/images/example.png\nrequest nginx will\nsend the\n/data/images/example.png\nfile.\nIf such file does not exist, nginx will send a response\nindicating the 404 error.\nRequests with URIs not starting with\n/images/\nwill be\nmapped onto the\n/data/www\ndirectory.\nFor example, in response to the\nhttp://localhost/some/example.html\nrequest nginx will\nsend the\n/data/www/some/example.html\nfile.\nTo apply the new configuration, start nginx if it is not yet started or\nsend the\nreload\nsignal to the nginx’s master process,\nby executing:\nnginx -s reload\nIn case something does not work as expected, you may try to find out\nthe reason in\naccess.log\nand\nerror.log\nfiles in the directory\n/usr/local/nginx/logs\nor\n/var/log/nginx\n.\nSetting Up a Simple Proxy Server\nOne of the frequent uses of nginx is setting it up as a proxy server, which\nmeans a server that receives requests, passes them to the proxied servers,\nretrieves responses from them, and sends them to the clients.\nWe will configure a basic proxy server, which serves requests of\nimages with files from the local directory and sends all other requests to a\nproxied server.\nIn this example, both servers will be defined on a single nginx instance.\nFirst, define the proxied server by adding one more\nserver\nblock to the nginx’s configuration file with the following contents:\nserver {\nlisten 8080;\nroot /data/up1;\nlocation / {\n}\n}\nThis will be a simple server that listens on the port 8080\n(previously, the\nlisten\ndirective has not been specified\nsince the standard port 80 was used) and maps\nall requests to the\n/data/up1\ndirectory on the local\nfile system.\nCreate this directory and put the\nindex.html\nfile into it.\nNote that the\nroot\ndirective is placed in the\nserver\ncontext.\nSuch\nroot\ndirective is used when the\nlocation\nblock selected for serving a request does not\ninclude its own\nroot\ndirective.\nNext, use the server configuration from the previous section\nand modify it to make it a proxy server configuration.\nIn the first\nlocation\nblock, put the\nproxy_pass\ndirective with the protocol, name and port of the proxied server specified\nin the parameter (in our case, it is\nhttp://localhost:8080\n):\nserver {\nlocation / {\nproxy_pass http://localhost:8080;\n}\nlocation /images/ {\nroot /data;\n}\n}\nWe will modify the second\nlocation\nblock, which currently maps requests with the\n/images/\nprefix to the files under the\n/data/images\ndirectory,\nto make it match the requests of images with typical file extensions.\nThe modified\nlocation\nblock looks like this:\nlocation ~ \\.(gif|jpg|png)$ {\nroot /data/images;\n}\nThe parameter is a regular expression matching all URIs ending\nwith\n.gif\n,\n.jpg\n, or\n.png\n.\nA regular expression should be preceded with\n~\n.\nThe corresponding requests will be mapped to the\n/data/images\ndirectory.\nWhen nginx selects a\nlocation\nblock to serve a request\nit first checks\nlocation\ndirectives that specify prefixes, remembering\nlocation\nwith the longest prefix, and then checks regular expressions.\nIf there is a match with a regular expression, nginx picks this\nlocation\nor, otherwise, it picks the one remembered earlier.\nThe resulting configuration of a proxy server will look like this:\nserver {\nlocation / {\nproxy_pass http://localhost:8080/;\n}\nlocation ~ \\.(gif|jpg|png)$ {\nroot /data/images;\n}\n}\nThis server will filter requests ending with\n.gif\n,\n.jpg\n, or\n.png\nand map them to the\n/data/images\ndirectory (by adding URI to the\nroot\ndirective’s parameter) and pass all other requests\nto the proxied server configured above.\nTo apply new configuration, send the\nreload\nsignal to\nnginx as described in the previous sections.\nThere are many\nmore\ndirectives that may be used to further configure a proxy connection.\nSetting Up FastCGI Proxying\nnginx can be used to route requests to FastCGI servers which run\napplications built with various frameworks and programming languages\nsuch as PHP.\nThe most basic nginx configuration to work with a FastCGI server\nincludes using the\nfastcgi_pass\ndirective instead of the\nproxy_pass\ndirective,\nand\nfastcgi_param\ndirectives to set parameters passed to a FastCGI server.\nSuppose the FastCGI server is accessible on\nlocalhost:9000\n.\nTaking the proxy configuration from the previous section as a basis,\nreplace the\nproxy_pass\ndirective with the\nfastcgi_pass\ndirective and change the parameter to\nlocalhost:9000\n.\nIn PHP, the\nSCRIPT_FILENAME\nparameter is used for\ndetermining the script name, and the\nQUERY_STRING\nparameter is used to pass request parameters.\nThe resulting configuration would be:\nserver {\nlocation / {\nfastcgi_pass  localhost:9000;\nfastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\nfastcgi_param QUERY_STRING    $query_string;\n}\nlocation ~ \\.(gif|jpg|png)$ {\nroot /data/images;\n}\n}\nThis will set up a server that will route all requests except for\nrequests for static images to the proxied server operating on\nlocalhost:9000\nthrough the FastCGI protocol.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://nginx.org/en/docs/beginners_guide.html"}}
{"text": "Module ngx_http_core_module\nConfused between\ningress-nginx\nand\nNGINX Ingress Controller\n?\nLearn about our long-term commitment to the NGINX Ingress Controller and Gateway API implementation.\nRead the Blog\n.\nModule ngx_http_core_module\nDirectives\nabsolute_redirect\naio\naio_write\nalias\nauth_delay\nchunked_transfer_encoding\nclient_body_buffer_size\nclient_body_in_file_only\nclient_body_in_single_buffer\nclient_body_temp_path\nclient_body_timeout\nclient_header_buffer_size\nclient_header_timeout\nclient_max_body_size\nconnection_pool_size\ndefault_type\ndirectio\ndirectio_alignment\ndisable_symlinks\nearly_hints\nerror_page\netag\nhttp\nif_modified_since\nignore_invalid_headers\ninternal\nkeepalive_disable\nkeepalive_min_timeout\nkeepalive_requests\nkeepalive_time\nkeepalive_timeout\nlarge_client_header_buffers\nlimit_except\nlimit_rate\nlimit_rate_after\nlingering_close\nlingering_time\nlingering_timeout\nlisten\nlocation\nlog_not_found\nlog_subrequest\nmax_ranges\nmerge_slashes\nmsie_padding\nmsie_refresh\nopen_file_cache\nopen_file_cache_errors\nopen_file_cache_min_uses\nopen_file_cache_valid\noutput_buffers\nport_in_redirect\npostpone_output\nread_ahead\nrecursive_error_pages\nrequest_pool_size\nreset_timedout_connection\nresolver\nresolver_timeout\nroot\nsatisfy\nsend_lowat\nsend_timeout\nsendfile\nsendfile_max_chunk\nserver\nserver_name\nserver_name_in_redirect\nserver_names_hash_bucket_size\nserver_names_hash_max_size\nserver_tokens\nsubrequest_output_buffer_size\ntcp_nodelay\ntcp_nopush\ntry_files\ntypes\ntypes_hash_bucket_size\ntypes_hash_max_size\nunderscores_in_headers\nvariables_hash_bucket_size\nvariables_hash_max_size\nEmbedded Variables\nDirectives\nSyntax:\nabsolute_redirect\non\n|\noff\n;\nDefault:\nabsolute_redirect on;\nContext:\nhttp\n,\nserver\n,\nlocation\nThis directive appeared in version 1.11.8.\nIf disabled, redirects issued by nginx will be relative.\nSee also\nserver_name_in_redirect\nand\nport_in_redirect\ndirectives.\nSyntax:\naio\non\n|\noff\n|\nthreads\n[\n=\npool\n];\nDefault:\naio off;\nContext:\nhttp\n,\nserver\n,\nlocation\nThis directive appeared in version 0.8.11.\nEnables or disables the use of asynchronous file I/O (AIO)\non FreeBSD and Linux:\nlocation /video/ {\naio            on;\noutput_buffers 1 64k;\n}\nOn FreeBSD, AIO can be used starting from FreeBSD 4.3.\nPrior to FreeBSD 11.0,\nAIO can either be linked statically into a kernel:\noptions VFS_AIO\nor loaded dynamically as a kernel loadable module:\nkldload aio\nOn Linux, AIO can be used starting from kernel version 2.6.22.\nAlso, it is necessary to enable\ndirectio\n,\nor otherwise reading will be blocking:\nlocation /video/ {\naio            on;\ndirectio       512;\noutput_buffers 1 128k;\n}\nOn Linux,\ndirectio\ncan only be used for reading blocks that are aligned on 512-byte\nboundaries (or 4K for XFS).\nFile’s unaligned end is read in blocking mode.\nThe same holds true for byte range requests and for FLV requests\nnot from the beginning of a file: reading of unaligned data at the\nbeginning and end of a file will be blocking.\nWhen both AIO and\nsendfile\nare enabled on Linux,\nAIO is used for files that are larger than or equal to\nthe size specified in the\ndirectio\ndirective,\nwhile\nsendfile\nis used for files of smaller sizes\nor when\ndirectio\nis disabled.\nlocation /video/ {\nsendfile       on;\naio            on;\ndirectio       8m;\n}\nFinally, files can be read and\nsent\nusing multi-threading (1.7.11),\nwithout blocking a worker process:\nlocation /video/ {\nsendfile       on;\naio            threads;\n}\nRead and send file operations are offloaded to threads of the specified\npool\n.\nIf the pool name is omitted,\nthe pool with the name “\ndefault\n” is used.\nThe pool name can also be set with variables:\naio threads=pool$disk;\nBy default, multi-threading is disabled, it should be\nenabled with the\n--with-threads\nconfiguration parameter.\nCurrently, multi-threading is compatible only with the\nepoll\n,\nkqueue\n,\nand\neventport\nmethods.\nMulti-threaded sending of files is only supported on Linux.\nSee also the\nsendfile\ndirective.\nSyntax:\naio_write\non\n|\noff\n;\nDefault:\naio_write off;\nContext:\nhttp\n,\nserver\n,\nlocation\nThis directive appeared in version 1.9.13.\nIf\naio\nis enabled, specifies whether it is used for writing files.\nCurrently, this only works when using\naio threads\nand is limited to writing temporary files\nwith data received from proxied servers.\nSyntax:\nalias\npath\n;\nDefault:\n—\nContext:\nlocation\nDefines a replacement for the specified location.\nFor example, with the following configuration\nlocation /i/ {\nalias /data/w3/images/;\n}\non request of\n“\n/i/top.gif\n”, the file\n/data/w3/images/top.gif\nwill be sent.\nThe\npath\nvalue can contain variables,\nexcept\n$document_root\nand\n$realpath_root\n.\nIf\nalias\nis used inside a location defined\nwith a regular expression then such regular expression should\ncontain captures and\nalias\nshould refer to\nthese captures (0.7.40), for example:\nlocation ~ ^/users/(.+\\.(?:gif|jpe?g|png))$ {\nalias /data/w3/images/$1;\n}\nWhen location matches the last part of the directive’s value:\nlocation /images/ {\nalias /data/w3/images/;\n}\nit is better to use the\nroot\ndirective instead:\nlocation /images/ {\nroot /data/w3;\n}\nSyntax:\nauth_delay\ntime\n;\nDefault:\nauth_delay 0s;\nContext:\nhttp\n,\nserver\n,\nlocation\nThis directive appeared in version 1.17.10.\nDelays processing of unauthorized requests with 401 response code\nto prevent timing attacks when access is limited by\npassword\n, by the\nresult of subrequest\n,\nor by\nJWT\n.\nSyntax:\nchunked_transfer_encoding\non\n|\noff\n;\nDefault:\nchunked_transfer_encoding on;\nContext:\nhttp\n,\nserver\n,\nlocation\nAllows disabling chunked transfer encoding in HTTP/1.1.\nIt may come in handy when using a software failing to support\nchunked encoding despite the standard’s requirement.\nSyntax:\nclient_body_buffer_size\nsize\n;\nDefault:\nclient_body_buffer_size 8k|16k;\nContext:\nhttp\n,\nserver\n,\nlocation\nSets buffer size for reading client request body.\nIn case the request body is larger than the buffer,\nthe whole body or only its part is written to a\ntemporary file\n.\nBy default, buffer size is equal to two memory pages.\nThis is 8K on x86, other 32-bit platforms, and x86-64.\nIt is usually 16K on other 64-bit platforms.\nSyntax:\nclient_body_in_file_only\non\n|\nclean\n|\noff\n;\nDefault:\nclient_body_in_file_only off;\nContext:\nhttp\n,\nserver\n,\nlocation\nDetermines whether nginx should save the entire client request body\ninto a file.\nThis directive can be used during debugging, or when using the\n$request_body_file\nvariable, or the\n$r->request_body_file\nmethod of the module\nngx_http_perl_module\n.\nWhen set to the value\non\n, temporary files are not\nremoved after request processing.\nThe value\nclean\nwill cause the temporary files\nleft after request processing to be removed.\nSyntax:\nclient_body_in_single_buffer\non\n|\noff\n;\nDefault:\nclient_body_in_single_buffer off;\nContext:\nhttp\n,\nserver\n,\nlocation\nDetermines whether nginx should save the entire client request body\nin a single buffer.\nThe directive is recommended when using the\n$request_body\nvariable, to save the number of copy operations involved.\nSyntax:\nclient_body_temp_path\npath\n[\nlevel1\n[\nlevel2\n[\nlevel3\n]]];\nDefault:\nclient_body_temp_path client_body_temp;\nContext:\nhttp\n,\nserver\n,\nlocation\nDefines a directory for storing temporary files holding client request bodies.\nUp to three-level subdirectory hierarchy can be used under the specified\ndirectory.\nFor example, in the following configuration\nclient_body_temp_path /spool/nginx/client_temp 1 2;\na path to a temporary file might look like this:\n/spool/nginx/client_temp/7/45/00000123457\nSyntax:\nclient_body_timeout\ntime\n;\nDefault:\nclient_body_timeout 60s;\nContext:\nhttp\n,\nserver\n,\nlocation\nDefines a timeout for reading client request body.\nThe timeout is set only for a period between two successive read operations,\nnot for the transmission of the whole request body.\nIf a client does not transmit anything within this time, the\nrequest is terminated with the\n408 (Request Time-out)\nerror.\nSyntax:\nclient_header_buffer_size\nsize\n;\nDefault:\nclient_header_buffer_size 1k;\nContext:\nhttp\n,\nserver\nSets buffer size for reading client request header.\nFor most requests, a buffer of 1K bytes is enough.\nHowever, if a request includes long cookies, or comes from a WAP client,\nit may not fit into 1K.\nIf a request line or a request header field does not fit into\nthis buffer then larger buffers, configured by the\nlarge_client_header_buffers\ndirective,\nare allocated.\nIf the directive is specified on the\nserver\nlevel,\nthe value from the default server can be used.\nDetails are provided in the\n“\nVirtual\nserver selection\n” section.\nSyntax:\nclient_header_timeout\ntime\n;\nDefault:\nclient_header_timeout 60s;\nContext:\nhttp\n,\nserver\nDefines a timeout for reading client request header.\nIf a client does not transmit the entire header within this time, the\nrequest is terminated with the\n408 (Request Time-out)\nerror.\nSyntax:\nclient_max_body_size\nsize\n;\nDefault:\nclient_max_body_size 1m;\nContext:\nhttp\n,\nserver\n,\nlocation\nSets the maximum allowed size of the client request body.\nIf the size in a request exceeds the configured value, the\n413 (Request Entity Too Large)\nerror is returned to the client.\nPlease be aware that\nbrowsers cannot correctly display\nthis error.\nSetting\nsize\nto 0 disables checking of client\nrequest body size.\nSyntax:\nconnection_pool_size\nsize\n;\nDefault:\nconnection_pool_size 256|512;\nContext:\nhttp\n,\nserver\nAllows accurate tuning of per-connection memory allocations.\nThis directive has minimal impact on performance\nand should not generally be used.\nBy default, the size is equal to\n256 bytes on 32-bit platforms and 512 bytes on 64-bit platforms.\nPrior to version 1.9.8, the default value was 256 on all platforms.\nSyntax:\ndefault_type\nmime-type\n;\nDefault:\ndefault_type text/plain;\nContext:\nhttp\n,\nserver\n,\nlocation\nDefines the default MIME type of a response.\nMapping of file name extensions to MIME types can be set\nwith the\ntypes\ndirective.\nSyntax:\ndirectio\nsize\n|\noff\n;\nDefault:\ndirectio off;\nContext:\nhttp\n,\nserver\n,\nlocation\nThis directive appeared in version 0.7.7.\nEnables the use of\nthe\nO_DIRECT\nflag (FreeBSD, Linux),\nthe\nF_NOCACHE\nflag (macOS),\nor the\ndirectio()\nfunction (Solaris),\nwhen reading files that are larger than or equal to\nthe specified\nsize\n.\nThe directive automatically disables (0.7.15) the use of\nsendfile\nfor a given request.\nIt can be useful for serving large files:\ndirectio 4m;\nor when using\naio\non Linux.\nSyntax:\ndirectio_alignment\nsize\n;\nDefault:\ndirectio_alignment 512;\nContext:\nhttp\n,\nserver\n,\nlocation\nThis directive appeared in version 0.8.11.\nSets the alignment for\ndirectio\n.\nIn most cases, a 512-byte alignment is enough.\nHowever, when using XFS under Linux, it needs to be increased to 4K.\nSyntax:\ndisable_symlinks\noff\n;\ndisable_symlinks\non\n|\nif_not_owner\n[\nfrom\n=\npart\n];\nDefault:\ndisable_symlinks off;\nContext:\nhttp\n,\nserver\n,\nlocation\nThis directive appeared in version 1.1.15.\nDetermines how symbolic links should be treated when opening files:\noff\nSymbolic links in the pathname are allowed and not checked.\nThis is the default behavior.\non\nIf any component of the pathname is a symbolic link,\naccess to a file is denied.\nif_not_owner\nAccess to a file is denied if any component of the pathname\nis a symbolic link, and the link and object that the link\npoints to have different owners.\nfrom\n=\npart\nWhen checking symbolic links\n(parameters\non\nand\nif_not_owner\n),\nall components of the pathname are normally checked.\nChecking of symbolic links in the initial part of the pathname\nmay be avoided by specifying additionally the\nfrom\n=\npart\nparameter.\nIn this case, symbolic links are checked only from\nthe pathname component that follows the specified initial part.\nIf the value is not an initial part of the pathname checked, the whole\npathname is checked as if this parameter was not specified at all.\nIf the value matches the whole file name,\nsymbolic links are not checked.\nThe parameter value can contain variables.\nExample:\ndisable_symlinks on from=$document_root;\nThis directive is only available on systems that have the\nopenat()\nand\nfstatat()\ninterfaces.\nSuch systems include modern versions of FreeBSD, Linux, and Solaris.\nParameters\non\nand\nif_not_owner\nadd a processing overhead.\nOn systems that do not support opening of directories only for search,\nto use these parameters it is required that worker processes\nhave read permissions for all directories being checked.\nThe\nngx_http_autoindex_module\n,\nngx_http_random_index_module\n,\nand\nngx_http_dav_module\nmodules currently ignore this directive.\nSyntax:\nearly_hints\nstring\n...;\nDefault:\n—\nContext:\nhttp\n,\nserver\n,\nlocation\nThis directive appeared in version 1.29.0.\nDefines conditions under which\nthe 103 (Early Hints) response\nwill be passed to a client.\nIf at least one value of the string parameters is not empty and is not\nequal to “0” then the response will be passed:\nmap $http_sec_fetch_mode $early_hints {\nnavigate $http2$http3;\n}\nserver {\n...\nlocation / {\nearly_hints $early_hints;\nproxy_pass http://example.com;\n}\n}\nSyntax:\nerror_page\ncode\n...\n[\n=\n[\nresponse\n]]\nuri\n;\nDefault:\n—\nContext:\nhttp\n,\nserver\n,\nlocation\n,\nif in location\nDefines the URI that will be shown for the specified errors.\nA\nuri\nvalue can contain variables.\nExample:\nerror_page 404             /404.html;\nerror_page 500 502 503 504 /50x.html;\nThis causes an internal redirect to the specified\nuri\nwith the client request method changed to “\nGET\n”\n(for all methods other than\n“\nGET\n” and “\nHEAD\n”).\nFurthermore, it is possible to change the response code to another\nusing the “\n=\nresponse\n” syntax, for example:\nerror_page 404 =200 /empty.gif;\nIf an error response is processed by a proxied server\nor a FastCGI/uwsgi/SCGI/gRPC server,\nand the server may return different response codes (e.g., 200, 302, 401\nor 404), it is possible to respond with the code it returns:\nerror_page 404 = /404.php;\nIf there is no need to change URI and method during internal redirection\nit is possible to pass error processing into a named location:\nlocation / {\nerror_page 404 = @fallback;\n}\nlocation @fallback {\nproxy_pass http://backend;\n}\nIf\nuri\nprocessing leads to an error,\nthe status code of the last occurred error is returned to the client.\nIt is also possible to use URL redirects for error processing:\nerror_page 403      http://example.com/forbidden.html;\nerror_page 404 =301 http://example.com/notfound.html;\nIn this case, by default, the response code 302 is returned to the client.\nIt can only be changed to one of the redirect status\ncodes (301, 302, 303, 307, and 308).\nThe code 307 was not treated as a redirect until versions 1.1.16 and 1.0.13.\nThe code 308 was not treated as a redirect until version 1.13.0.\nThese directives are inherited from the previous configuration level\nif and only if there are no\nerror_page\ndirectives\ndefined on the current level.\nSyntax:\netag\non\n|\noff\n;\nDefault:\netag on;\nContext:\nhttp\n,\nserver\n,\nlocation\nThis directive appeared in version 1.3.3.\nEnables or disables automatic generation of the “ETag”\nresponse header field for static resources.\nSyntax:\nhttp\n{ ... }\nDefault:\n—\nContext:\nmain\nProvides the configuration file context in which the HTTP server directives\nare specified.\nSyntax:\nif_modified_since\noff\n|\nexact\n|\nbefore\n;\nDefault:\nif_modified_since exact;\nContext:\nhttp\n,\nserver\n,\nlocation\nThis directive appeared in version 0.7.24.\nSpecifies how to compare modification time of a response\nwith the time in the\n“If-Modified-Since”\nrequest header field:\noff\nthe response is always considered modified (0.7.34);\nexact\nexact match;\nbefore\nmodification time of the response is\nless than or equal to the time in the “If-Modified-Since”\nrequest header field.\nSyntax:\nignore_invalid_headers\non\n|\noff\n;\nDefault:\nignore_invalid_headers on;\nContext:\nhttp\n,\nserver\nControls whether header fields with invalid names should be ignored.\nValid names are composed of English letters, digits, hyphens, and possibly\nunderscores (as controlled by the\nunderscores_in_headers\ndirective).\nIf the directive is specified on the\nserver\nlevel,\nthe value from the default server can be used.\nDetails are provided in the\n“\nVirtual\nserver selection\n” section.\nSyntax:\ninternal\n;\nDefault:\n—\nContext:\nlocation\nSpecifies that a given location can only be used for internal requests.\nFor external requests, the client error\n404 (Not Found)\nis returned.\nInternal requests are the following:\nrequests redirected by the\nerror_page\n,\nindex\n,\ninternal_redirect\n,\nrandom_index\n, and\ntry_files\ndirectives;\nrequests redirected by the “X-Accel-Redirect”\nresponse header field from an upstream server;\nsubrequests formed by the\n“\ninclude virtual\n”\ncommand of the\nngx_http_ssi_module\nmodule, by the\nngx_http_addition_module\nmodule directives, and by\nauth_request\nand\nmirror\ndirectives;\nrequests changed by the\nrewrite\ndirective.\nExample:\nerror_page 404 /404.html;\nlocation = /404.html {\ninternal;\n}\nThere is a limit of 10 internal redirects per request to prevent\nrequest processing cycles that can occur in incorrect configurations.\nIf this limit is reached, the error\n500 (Internal Server Error) is returned.\nIn such cases, the “rewrite or internal redirection cycle” message\ncan be seen in the error log.\nSyntax:\nkeepalive_disable\nnone\n|\nbrowser\n...;\nDefault:\nkeepalive_disable msie6;\nContext:\nhttp\n,\nserver\n,\nlocation\nDisables keep-alive connections with misbehaving browsers.\nThe\nbrowser\nparameters specify which\nbrowsers will be affected.\nThe value\nmsie6\ndisables keep-alive connections\nwith old versions of MSIE, once a POST request is received.\nThe value\nsafari\ndisables keep-alive connections\nwith Safari and Safari-like browsers on macOS and macOS-like\noperating systems.\nThe value\nnone\nenables keep-alive connections\nwith all browsers.\nPrior to version 1.1.18, the value\nsafari\nmatched\nall Safari and Safari-like browsers on all operating systems, and\nkeep-alive connections with them were disabled by default.\nSyntax:\nkeepalive_min_timeout\ntimeout\n;\nDefault:\nkeepalive_min_timeout 0;\nContext:\nhttp\n,\nserver\n,\nlocation\nThis directive appeared in version 1.27.4.\nSets a timeout during which a keep-alive\nclient connection will not be closed on the server side\nfor connection reuse or on graceful shutdown of worker processes.\nSyntax:\nkeepalive_requests\nnumber\n;\nDefault:\nkeepalive_requests 1000;\nContext:\nhttp\n,\nserver\n,\nlocation\nThis directive appeared in version 0.8.0.\nSets the maximum number of requests that can be\nserved through one keep-alive connection.\nAfter the maximum number of requests are made, the connection is closed.\nClosing connections periodically is necessary to free\nper-connection memory allocations.\nTherefore, using too high maximum number of requests\ncould result in excessive memory usage and not recommended.\nPrior to version 1.19.10, the default value was 100.\nSyntax:\nkeepalive_time\ntime\n;\nDefault:\nkeepalive_time 1h;\nContext:\nhttp\n,\nserver\n,\nlocation\nThis directive appeared in version 1.19.10.\nLimits the maximum time during which\nrequests can be processed through one keep-alive connection.\nAfter this time is reached, the connection is closed\nfollowing the subsequent request processing.\nSyntax:\nkeepalive_timeout\ntimeout\n[\nheader_timeout\n];\nDefault:\nkeepalive_timeout 75s;\nContext:\nhttp\n,\nserver\n,\nlocation\nThe first parameter sets a timeout during which a keep-alive\nclient connection will stay open on the server side.\nThe zero value disables keep-alive client connections.\nThe optional second parameter sets a value in the\n“Keep-Alive: timeout=\ntime\n”\nresponse header field.\nTwo parameters may differ.\nThe\n“Keep-Alive: timeout=\ntime\n”\nheader field is recognized by Mozilla and Konqueror.\nMSIE closes keep-alive connections by itself in about 60 seconds.\nSyntax:\nlarge_client_header_buffers\nnumber\nsize\n;\nDefault:\nlarge_client_header_buffers 4 8k;\nContext:\nhttp\n,\nserver\nSets the maximum\nnumber\nand\nsize\nof\nbuffers used for reading large client request header.\nA request line cannot exceed the size of one buffer, or the\n414 (Request-URI Too Large)\nerror is returned to the client.\nA request header field cannot exceed the size of one buffer as well, or the\n400 (Bad Request)\nerror is returned to the client.\nBuffers are allocated only on demand.\nBy default, the buffer size is equal to 8K bytes.\nIf after the end of request processing a connection is transitioned\ninto the keep-alive state, these buffers are released.\nIf the directive is specified on the\nserver\nlevel,\nthe value from the default server can be used.\nDetails are provided in the\n“\nVirtual\nserver selection\n” section.\nSyntax:\nlimit_except\nmethod\n... { ... }\nDefault:\n—\nContext:\nlocation\nLimits allowed HTTP methods inside a location.\nThe\nmethod\nparameter can be one of the following:\nGET\n,\nHEAD\n,\nPOST\n,\nPUT\n,\nDELETE\n,\nMKCOL\n,\nCOPY\n,\nMOVE\n,\nOPTIONS\n,\nPROPFIND\n,\nPROPPATCH\n,\nLOCK\n,\nUNLOCK\n,\nor\nPATCH\n.\nAllowing the\nGET\nmethod makes the\nHEAD\nmethod also allowed.\nAccess to other methods can be limited using the\nngx_http_access_module\n,\nngx_http_auth_basic_module\n,\nand\nngx_http_auth_jwt_module\n(1.13.10)\nmodules directives:\nlimit_except GET {\nallow 192.168.1.0/32;\ndeny  all;\n}\nPlease note that this will limit access to all methods\nexcept\nGET and HEAD.\nSyntax:\nlimit_rate\nrate\n;\nDefault:\nlimit_rate 0;\nContext:\nhttp\n,\nserver\n,\nlocation\n,\nif in location\nLimits the rate of response transmission to a client.\nThe\nrate\nis specified in bytes per second.\nThe zero value disables rate limiting.\nThe limit is set per a request, and so if a client simultaneously opens\ntwo connections, the overall rate will be twice as much\nas the specified limit.\nParameter value can contain variables (1.17.0).\nIt may be useful in cases where rate should be limited\ndepending on a certain condition:\nmap $slow $rate {\n1     4k;\n2     8k;\n}\nlimit_rate $rate;\nRate limit can also be set in the\n$limit_rate\nvariable,\nhowever, since version 1.17.0, this method is not recommended:\nserver {\nif ($slow) {\nset $limit_rate 4k;\n}\n...\n}\nRate limit can also be set in the\n“X-Accel-Limit-Rate” header field of a proxied server response.\nThis capability can be disabled using the\nproxy_ignore_headers\n,\nfastcgi_ignore_headers\n,\nuwsgi_ignore_headers\n,\nand\nscgi_ignore_headers\ndirectives.\nSyntax:\nlimit_rate_after\nsize\n;\nDefault:\nlimit_rate_after 0;\nContext:\nhttp\n,\nserver\n,\nlocation\n,\nif in location\nThis directive appeared in version 0.8.0.\nSets the initial amount after which the further transmission\nof a response to a client will be rate limited.\nParameter value can contain variables (1.17.0).\nExample:\nlocation /flv/ {\nflv;\nlimit_rate_after 500k;\nlimit_rate       50k;\n}\nSyntax:\nlingering_close\noff\n|\non\n|\nalways\n;\nDefault:\nlingering_close on;\nContext:\nhttp\n,\nserver\n,\nlocation\nThis directive appeared in versions 1.1.0 and 1.0.6.\nControls how nginx closes client connections.\nThe default value “\non\n” instructs nginx to\nwait for\nand\nprocess\nadditional data from a client\nbefore fully closing a connection, but only\nif heuristics suggests that a client may be sending more data.\nThe value “\nalways\n” will cause nginx to unconditionally\nwait for and process additional client data.\nThe value “\noff\n” tells nginx to never wait for\nmore data and close the connection immediately.\nThis behavior breaks the protocol and should not be used under normal\ncircumstances.\nTo control closing\nHTTP/2\nconnections,\nthe directive must be specified on the\nserver\nlevel (1.19.1).\nSyntax:\nlingering_time\ntime\n;\nDefault:\nlingering_time 30s;\nContext:\nhttp\n,\nserver\n,\nlocation\nWhen\nlingering_close\nis in effect,\nthis directive specifies the maximum time during which nginx\nwill process (read and ignore) additional data coming from a client.\nAfter that, the connection will be closed, even if there will be\nmore data.\nSyntax:\nlingering_timeout\ntime\n;\nDefault:\nlingering_timeout 5s;\nContext:\nhttp\n,\nserver\n,\nlocation\nWhen\nlingering_close\nis in effect, this directive specifies\nthe maximum waiting time for more client data to arrive.\nIf data are not received during this time, the connection is closed.\nOtherwise, the data are read and ignored, and nginx starts waiting\nfor more data again.\nThe “wait-read-ignore” cycle is repeated, but no longer than specified by the\nlingering_time\ndirective.\nSyntax:\nlisten\naddress\n[:\nport\n]\n[\ndefault_server\n]\n[\nssl\n]\n[\nhttp2\n|\nquic\n]\n[\nproxy_protocol\n]\n[\nsetfib\n=\nnumber\n]\n[\nfastopen\n=\nnumber\n]\n[\nbacklog\n=\nnumber\n]\n[\nrcvbuf\n=\nsize\n]\n[\nsndbuf\n=\nsize\n]\n[\naccept_filter\n=\nfilter\n]\n[\ndeferred\n]\n[\nbind\n]\n[\nipv6only\n=\non\n|\noff\n]\n[\nreuseport\n]\n[\nso_keepalive\n=\non\n|\noff\n|[\nkeepidle\n]:[\nkeepintvl\n]:[\nkeepcnt\n]];\nlisten\nport\n[\ndefault_server\n]\n[\nssl\n]\n[\nhttp2\n|\nquic\n]\n[\nproxy_protocol\n]\n[\nsetfib\n=\nnumber\n]\n[\nfastopen\n=\nnumber\n]\n[\nbacklog\n=\nnumber\n]\n[\nrcvbuf\n=\nsize\n]\n[\nsndbuf\n=\nsize\n]\n[\naccept_filter\n=\nfilter\n]\n[\ndeferred\n]\n[\nbind\n]\n[\nipv6only\n=\non\n|\noff\n]\n[\nreuseport\n]\n[\nso_keepalive\n=\non\n|\noff\n|[\nkeepidle\n]:[\nkeepintvl\n]:[\nkeepcnt\n]];\nlisten\nunix:\npath\n[\ndefault_server\n]\n[\nssl\n]\n[\nhttp2\n|\nquic\n]\n[\nproxy_protocol\n]\n[\nbacklog\n=\nnumber\n]\n[\nrcvbuf\n=\nsize\n]\n[\nsndbuf\n=\nsize\n]\n[\naccept_filter\n=\nfilter\n]\n[\ndeferred\n]\n[\nbind\n]\n[\nso_keepalive\n=\non\n|\noff\n|[\nkeepidle\n]:[\nkeepintvl\n]:[\nkeepcnt\n]];\nDefault:\nlisten *:80 | *:8000;\nContext:\nserver\nSets the\naddress\nand\nport\nfor IP,\nor the\npath\nfor a UNIX-domain socket on which\nthe server will accept requests.\nBoth\naddress\nand\nport\n,\nor only\naddress\nor only\nport\ncan be specified.\nAn\naddress\nmay also be a hostname, for example:\nlisten 127.0.0.1:8000;\nlisten 127.0.0.1;\nlisten 8000;\nlisten *:8000;\nlisten localhost:8000;\nIPv6 addresses (0.7.36) are specified in square brackets:\nlisten [::]:8000;\nlisten [::1];\nUNIX-domain sockets (0.8.21) are specified with the “\nunix:\n”\nprefix:\nlisten unix:/var/run/nginx.sock;\nIf only\naddress\nis given, the port 80 is used.\nIf the directive is not present then either\n*:80\nis used\nif nginx runs with the superuser privileges, or\n*:8000\notherwise.\nThe\ndefault_server\nparameter, if present,\nwill cause the server to become the default server for the specified\naddress\n:\nport\npair.\nIf none of the directives have the\ndefault_server\nparameter then the first server with the\naddress\n:\nport\npair will be\nthe default server for this pair.\nIn versions prior to 0.8.21 this parameter is named simply\ndefault\n.\nThe\nssl\nparameter (0.7.14) allows specifying that all\nconnections accepted on this port should work in SSL mode.\nThis allows for a more compact\nconfiguration\nfor the server that\nhandles both HTTP and HTTPS requests.\nThe\nhttp2\nparameter (1.9.5) configures the port to accept\nHTTP/2\nconnections.\nNormally, for this to work the\nssl\nparameter should be\nspecified as well, but nginx can also be configured to accept HTTP/2\nconnections without SSL.\nThe parameter is deprecated,\nthe\nhttp2\ndirective\nshould be used instead.\nThe\nquic\nparameter (1.25.0) configures the port to accept\nQUIC\nconnections.\nThe\nproxy_protocol\nparameter (1.5.12)\nallows specifying that all connections accepted on this port should use the\nPROXY\nprotocol\n.\nThe PROXY protocol version 2 is supported since version 1.13.11.\nThe\nlisten\ndirective\ncan have several additional parameters specific to socket-related system calls.\nThese parameters can be specified in any\nlisten\ndirective, but only once for a given\naddress\n:\nport\npair.\nIn versions prior to 0.8.21, they could only be\nspecified in the\nlisten\ndirective together with the\ndefault\nparameter.\nsetfib\n=\nnumber\nthis parameter (0.8.44) sets the associated routing table, FIB\n(the\nSO_SETFIB\noption) for the listening socket.\nThis currently works only on FreeBSD.\nfastopen\n=\nnumber\nenables\n“\nTCP Fast Open\n”\nfor the listening socket (1.5.8) and\nlimits\nthe maximum length for the queue of connections that have not yet completed\nthe three-way handshake.\nDo not enable this feature unless the server can handle\nreceiving the\nsame SYN packet with data\nmore than once.\nbacklog\n=\nnumber\nsets the\nbacklog\nparameter in the\nlisten()\ncall that limits\nthe maximum length for the queue of pending connections.\nBy default,\nbacklog\nis set to -1 on FreeBSD, DragonFly BSD, and macOS,\nand to 511 on other platforms.\nrcvbuf\n=\nsize\nsets the receive buffer size\n(the\nSO_RCVBUF\noption) for the listening socket.\nsndbuf\n=\nsize\nsets the send buffer size\n(the\nSO_SNDBUF\noption) for the listening socket.\naccept_filter\n=\nfilter\nsets the name of accept filter\n(the\nSO_ACCEPTFILTER\noption) for the listening socket\nthat filters incoming connections before passing them to\naccept()\n.\nThis works only on FreeBSD and NetBSD 5.0+.\nPossible values are\ndataready\nand\nhttpready\n.\ndeferred\ninstructs to use a deferred\naccept()\n(the\nTCP_DEFER_ACCEPT\nsocket option) on Linux.\nbind\ninstructs to make a separate\nbind()\ncall for a given\naddress\n:\nport\npair.\nThis is useful because if there are several\nlisten\ndirectives with the same port but different addresses, and one of the\nlisten\ndirectives listens on all addresses\nfor the given port (\n*:\nport\n), nginx\nwill\nbind()\nonly to\n*:\nport\n.\nIt should be noted that the\ngetsockname()\nsystem call will be\nmade in this case to determine the address that accepted the connection.\nIf the\nsetfib\n,\nfastopen\n,\nbacklog\n,\nrcvbuf\n,\nsndbuf\n,\naccept_filter\n,\ndeferred\n,\nipv6only\n,\nreuseport\n,\nor\nso_keepalive\nparameters\nare used then for a given\naddress\n:\nport\npair\na separate\nbind()\ncall will always be made.\nipv6only\n=\non\n|\noff\nthis parameter (0.7.42) determines\n(via the\nIPV6_V6ONLY\nsocket option)\nwhether an IPv6 socket listening on a wildcard address\n[::]\nwill accept only IPv6 connections or both IPv6 and IPv4 connections.\nThis parameter is turned on by default.\nIt can only be set once on start.\nPrior to version 1.3.4,\nif this parameter was omitted then the operating system’s settings were\nin effect for the socket.\nreuseport\nthis parameter (1.9.1) instructs to create an individual listening socket\nfor each worker process\n(using the\nSO_REUSEPORT\nsocket option on Linux 3.9+ and DragonFly BSD,\nor\nSO_REUSEPORT_LB\non FreeBSD 12+), allowing a kernel\nto distribute incoming connections between worker processes.\nThis currently works only on Linux 3.9+, DragonFly BSD,\nand FreeBSD 12+ (1.15.1).\nInappropriate use of this option may have its security\nimplications\n.\nso_keepalive\n=\non\n|\noff\n|[\nkeepidle\n]:[\nkeepintvl\n]:[\nkeepcnt\n]\nthis parameter (1.1.11) configures the “TCP keepalive” behavior\nfor the listening socket.\nIf this parameter is omitted then the operating system’s settings will be\nin effect for the socket.\nIf it is set to the value “\non\n”, the\nSO_KEEPALIVE\noption is turned on for the socket.\nIf it is set to the value “\noff\n”, the\nSO_KEEPALIVE\noption is turned off for the socket.\nSome operating systems support setting of TCP keepalive parameters on\na per-socket basis using the\nTCP_KEEPIDLE\n,\nTCP_KEEPINTVL\n, and\nTCP_KEEPCNT\nsocket options.\nOn such systems\n(currently, Linux, NetBSD, Dragonfly, FreeBSD, and macOS),\nthey can be configured\nusing the\nkeepidle\n,\nkeepintvl\n, and\nkeepcnt\nparameters.\nOne or two parameters may be omitted, in which case the system default setting\nfor the corresponding socket option will be in effect.\nFor example,\nso_keepalive=30m::10\nwill set the idle timeout (\nTCP_KEEPIDLE\n) to 30 minutes,\nleave the probe interval (\nTCP_KEEPINTVL\n) at its system default,\nand set the probes count (\nTCP_KEEPCNT\n) to 10 probes.\nExample:\nlisten 127.0.0.1 default_server accept_filter=dataready backlog=1024;\nSyntax:\nlocation\n[\n=\n|\n~\n|\n~*\n|\n^~\n]\nuri\n{ ... }\nlocation\n@\nname\n{ ... }\nDefault:\n—\nContext:\nserver\n,\nlocation\nSets configuration depending on a request URI.\nThe matching is performed against a normalized URI,\nafter decoding the text encoded in the “\n%XX\n” form,\nresolving references to relative path components “\n.\n”\nand “\n..\n”, and possible\ncompression\nof two or more\nadjacent slashes into a single slash.\nA location can either be defined by a prefix string, or by a regular expression.\nRegular expressions are specified with the preceding\n“\n~*\n” modifier (for case-insensitive matching), or the\n“\n~\n” modifier (for case-sensitive matching).\nTo find location matching a given request, nginx first checks\nlocations defined using the prefix strings (prefix locations).\nAmong them, the location with the longest matching\nprefix is selected and remembered.\nThen regular expressions are checked, in the order of their appearance\nin the configuration file.\nThe search of regular expressions terminates on the first match,\nand the corresponding configuration is used.\nIf no match with a regular expression is found then the\nconfiguration of the prefix location remembered earlier is used.\nlocation\nblocks can be nested, with some exceptions\nmentioned below.\nFor case-insensitive operating systems such as macOS and Cygwin,\nmatching with prefix strings ignores a case (0.7.7).\nHowever, comparison is limited to one-byte locales.\nRegular expressions can contain captures (0.7.40) that can later\nbe used in other directives.\nIf the longest matching prefix location has the “\n^~\n” modifier\nthen regular expressions are not checked.\nAlso, using the “\n=\n” modifier it is possible to define\nan exact match of URI and location.\nIf an exact match is found, the search terminates.\nFor example, if a “\n/\n” request happens frequently,\ndefining “\nlocation = /\n” will speed up the processing\nof these requests, as search terminates right after the first\ncomparison.\nSuch a location cannot obviously contain nested locations.\nIn versions from 0.7.1 to 0.8.41, if a request matched the prefix\nlocation without the “\n=\n” and “\n^~\n”\nmodifiers, the search also terminated and regular expressions were\nnot checked.\nLet’s illustrate the above by an example:\nlocation = / {\n[ configuration A ]\n}\nlocation / {\n[ configuration B ]\n}\nlocation /documents/ {\n[ configuration C ]\n}\nlocation ^~ /images/ {\n[ configuration D ]\n}\nlocation ~* \\.(gif|jpg|jpeg)$ {\n[ configuration E ]\n}\nThe “\n/\n” request will match configuration A,\nthe “\n/index.html\n” request will match configuration B,\nthe “\n/documents/document.html\n” request will match\nconfiguration C,\nthe “\n/images/1.gif\n” request will match configuration D, and\nthe “\n/documents/1.jpg\n” request will match configuration E.\nThe “\n@\n” prefix defines a named location.\nSuch a location is not used for a regular request processing, but instead\nused for request redirection.\nThey cannot be nested, and cannot contain nested locations.\nIf a location is defined by a prefix string that ends with the slash character,\nand requests are processed by one of\nproxy_pass\n,\nfastcgi_pass\n,\nuwsgi_pass\n,\nscgi_pass\n,\nmemcached_pass\n, or\ngrpc_pass\n,\nthen the special processing is performed.\nIn response to a request with URI equal to this string,\nbut without the trailing slash,\na permanent redirect with the code 301 will be returned to the requested URI\nwith the slash appended.\nIf this is not desired, an exact match of the URI and location could be\ndefined like this:\nlocation /user/ {\nproxy_pass http://user.example.com;\n}\nlocation = /user {\nproxy_pass http://login.example.com;\n}\nSyntax:\nlog_not_found\non\n|\noff\n;\nDefault:\nlog_not_found on;\nContext:\nhttp\n,\nserver\n,\nlocation\nEnables or disables logging of errors about not found files into\nerror_log\n.\nSyntax:\nlog_subrequest\non\n|\noff\n;\nDefault:\nlog_subrequest off;\nContext:\nhttp\n,\nserver\n,\nlocation\nEnables or disables logging of subrequests into\naccess_log\n.\nSyntax:\nmax_ranges\nnumber\n;\nDefault:\n—\nContext:\nhttp\n,\nserver\n,\nlocation\nThis directive appeared in version 1.1.2.\nLimits the maximum allowed number of ranges in byte-range requests.\nRequests that exceed the limit are processed as if there were no\nbyte ranges specified.\nBy default, the number of ranges is not limited.\nThe zero value disables the byte-range support completely.\nSyntax:\nmerge_slashes\non\n|\noff\n;\nDefault:\nmerge_slashes on;\nContext:\nhttp\n,\nserver\nEnables or disables compression of two or more adjacent slashes\nin a URI into a single slash.\nNote that compression is essential for the correct matching of prefix string\nand regular expression locations.\nWithout it, the “\n//scripts/one.php\n” request would not match\nlocation /scripts/ {\n...\n}\nand might be processed as a static file.\nSo it gets converted to “\n/scripts/one.php\n”.\nTurning the compression\noff\ncan become necessary if a URI\ncontains base64-encoded names, since base64 uses the “\n/\n”\ncharacter internally.\nHowever, for security considerations, it is better to avoid turning\nthe compression off.\nIf the directive is specified on the\nserver\nlevel,\nthe value from the default server can be used.\nDetails are provided in the\n“\nVirtual\nserver selection\n” section.\nSyntax:\nmsie_padding\non\n|\noff\n;\nDefault:\nmsie_padding on;\nContext:\nhttp\n,\nserver\n,\nlocation\nEnables or disables adding comments to responses for MSIE clients with status\ngreater than 400 to increase the response size to 512 bytes.\nSyntax:\nmsie_refresh\non\n|\noff\n;\nDefault:\nmsie_refresh off;\nContext:\nhttp\n,\nserver\n,\nlocation\nEnables or disables issuing refreshes instead of redirects for MSIE clients.\nSyntax:\nopen_file_cache\noff\n;\nopen_file_cache\nmax\n=\nN\n[\ninactive\n=\ntime\n];\nDefault:\nopen_file_cache off;\nContext:\nhttp\n,\nserver\n,\nlocation\nConfigures a cache that can store:\nopen file descriptors, their sizes and modification times;\ninformation on existence of directories;\nfile lookup errors, such as “file not found”, “no read permission”,\nand so on.\nCaching of errors should be enabled separately by the\nopen_file_cache_errors\ndirective.\nThe directive has the following parameters:\nmax\nsets the maximum number of elements in the cache;\non cache overflow the least recently used (LRU) elements are removed;\ninactive\ndefines a time after which an element is removed from the cache\nif it has not been accessed during this time;\nby default, it is 60 seconds;\noff\ndisables the cache.\nExample:\nopen_file_cache          max=1000 inactive=20s;\nopen_file_cache_valid    30s;\nopen_file_cache_min_uses 2;\nopen_file_cache_errors   on;\nSyntax:\nopen_file_cache_errors\non\n|\noff\n;\nDefault:\nopen_file_cache_errors off;\nContext:\nhttp\n,\nserver\n,\nlocation\nEnables or disables caching of file lookup errors by\nopen_file_cache\n.\nSyntax:\nopen_file_cache_min_uses\nnumber\n;\nDefault:\nopen_file_cache_min_uses 1;\nContext:\nhttp\n,\nserver\n,\nlocation\nSets the minimum\nnumber\nof file accesses during\nthe period configured by the\ninactive\nparameter\nof the\nopen_file_cache\ndirective, required for a file\ndescriptor to remain open in the cache.\nSyntax:\nopen_file_cache_valid\ntime\n;\nDefault:\nopen_file_cache_valid 60s;\nContext:\nhttp\n,\nserver\n,\nlocation\nSets a time after which\nopen_file_cache\nelements should be validated.\nSyntax:\noutput_buffers\nnumber\nsize\n;\nDefault:\noutput_buffers 2 32k;\nContext:\nhttp\n,\nserver\n,\nlocation\nSets the\nnumber\nand\nsize\nof the\nbuffers used for reading a response from a disk.\nPrior to version 1.9.5, the default value was 1 32k.\nSyntax:\nport_in_redirect\non\n|\noff\n;\nDefault:\nport_in_redirect on;\nContext:\nhttp\n,\nserver\n,\nlocation\nEnables or disables specifying the port in\nabsolute\nredirects issued by nginx.\nThe use of the primary server name in redirects is controlled by\nthe\nserver_name_in_redirect\ndirective.\nSyntax:\npostpone_output\nsize\n;\nDefault:\npostpone_output 1460;\nContext:\nhttp\n,\nserver\n,\nlocation\nIf possible, the transmission of client data will be postponed until\nnginx has at least\nsize\nbytes of data to send.\nThe zero value disables postponing data transmission.\nSyntax:\nread_ahead\nsize\n;\nDefault:\nread_ahead 0;\nContext:\nhttp\n,\nserver\n,\nlocation\nSets the amount of pre-reading for the kernel when working with file.\nOn Linux, the\nposix_fadvise(0, 0, 0, POSIX_FADV_SEQUENTIAL)\nsystem call is used, and so the\nsize\nparameter is ignored.\nOn FreeBSD, the\nfcntl(O_READAHEAD,\nsize\n)\nsystem call, supported since FreeBSD 9.0-CURRENT, is used.\nFreeBSD 7 has to be\npatched\n.\nSyntax:\nrecursive_error_pages\non\n|\noff\n;\nDefault:\nrecursive_error_pages off;\nContext:\nhttp\n,\nserver\n,\nlocation\nEnables or disables doing several redirects using the\nerror_page\ndirective.\nThe number of such redirects is\nlimited\n.\nSyntax:\nrequest_pool_size\nsize\n;\nDefault:\nrequest_pool_size 4k;\nContext:\nhttp\n,\nserver\nAllows accurate tuning of per-request memory allocations.\nThis directive has minimal impact on performance\nand should not generally be used.\nSyntax:\nreset_timedout_connection\non\n|\noff\n;\nDefault:\nreset_timedout_connection off;\nContext:\nhttp\n,\nserver\n,\nlocation\nEnables or disables resetting timed out connections\nand connections\nclosed\nwith the non-standard code 444 (1.15.2).\nThe reset is performed as follows.\nBefore closing a socket, the\nSO_LINGER\noption is set on it with a timeout value of 0.\nWhen the socket is closed, TCP RST is sent to the client, and all memory\noccupied by this socket is released.\nThis helps avoid keeping an already closed socket with filled buffers\nin a FIN_WAIT1 state for a long time.\nIt should be noted that timed out keep-alive connections are\nclosed normally.\nSyntax:\nresolver\naddress\n...\n[\nvalid\n=\ntime\n]\n[\nipv4\n=\non\n|\noff\n]\n[\nipv6\n=\non\n|\noff\n]\n[\nstatus_zone\n=\nzone\n];\nDefault:\n—\nContext:\nhttp\n,\nserver\n,\nlocation\nConfigures name servers used to resolve names of upstream servers\ninto addresses, for example:\nresolver 127.0.0.1 [::1]:5353;\nThe address can be specified as a domain name or IP address,\nwith an optional port (1.3.1, 1.2.2).\nIf port is not specified, the port 53 is used.\nName servers are queried in a round-robin fashion.\nBefore version 1.1.7, only a single name server could be configured.\nSpecifying name servers using IPv6 addresses is supported\nstarting from versions 1.3.1 and 1.2.2.\nBy default, nginx will look up both IPv4 and IPv6 addresses while resolving.\nIf looking up of IPv4 or IPv6 addresses is not desired,\nthe\nipv4=off\n(1.23.1) or\nthe\nipv6=off\nparameter can be specified.\nResolving of names into IPv6 addresses is supported\nstarting from version 1.5.8.\nBy default, nginx caches answers using the TTL value of a response.\nAn optional\nvalid\nparameter allows overriding it:\nresolver 127.0.0.1 [::1]:5353 valid=30s;\nBefore version 1.1.9, tuning of caching time was not possible,\nand nginx always cached answers for the duration of 5 minutes.\nTo prevent DNS spoofing, it is recommended\nconfiguring DNS servers in a properly secured trusted local network.\nThe optional\nstatus_zone\nparameter (1.17.1)\nenables\ncollection\nof DNS server statistics of requests and responses\nin the specified\nzone\n.\nThe parameter is available as part of our\ncommercial subscription\n.\nSyntax:\nresolver_timeout\ntime\n;\nDefault:\nresolver_timeout 30s;\nContext:\nhttp\n,\nserver\n,\nlocation\nSets a timeout for name resolution, for example:\nresolver_timeout 5s;\nSyntax:\nroot\npath\n;\nDefault:\nroot html;\nContext:\nhttp\n,\nserver\n,\nlocation\n,\nif in location\nSets the root directory for requests.\nFor example, with the following configuration\nlocation /i/ {\nroot /data/w3;\n}\nThe\n/data/w3/i/top.gif\nfile will be sent in response to\nthe “\n/i/top.gif\n” request.\nThe\npath\nvalue can contain variables,\nexcept\n$document_root\nand\n$realpath_root\n.\nA path to the file is constructed by merely adding a URI to the value\nof the\nroot\ndirective.\nIf a URI has to be modified, the\nalias\ndirective should be used.\nSyntax:\nsatisfy\nall\n|\nany\n;\nDefault:\nsatisfy all;\nContext:\nhttp\n,\nserver\n,\nlocation\nAllows access if all (\nall\n) or at least one\n(\nany\n) of the\nngx_http_access_module\n,\nngx_http_auth_basic_module\n,\nngx_http_auth_request_module\n,\nngx_http_auth_jwt_module\n(1.13.10),\nor\nngx_http_auth_oidc_module\n(1.27.4)\nmodules allow access.\nExample:\nlocation / {\nsatisfy any;\nallow 192.168.1.0/32;\ndeny  all;\nauth_basic           \"closed site\";\nauth_basic_user_file conf/htpasswd;\n}\nSyntax:\nsend_lowat\nsize\n;\nDefault:\nsend_lowat 0;\nContext:\nhttp\n,\nserver\n,\nlocation\nIf the directive is set to a non-zero value, nginx will try to minimize\nthe number of send operations on client sockets by using either\nNOTE_LOWAT\nflag of the\nkqueue\nmethod\nor the\nSO_SNDLOWAT\nsocket option.\nIn both cases the specified\nsize\nis used.\nThis directive is ignored on Linux, Solaris, and Windows.\nSyntax:\nsend_timeout\ntime\n;\nDefault:\nsend_timeout 60s;\nContext:\nhttp\n,\nserver\n,\nlocation\nSets a timeout for transmitting a response to the client.\nThe timeout is set only between two successive write operations,\nnot for the transmission of the whole response.\nIf the client does not receive anything within this time,\nthe connection is closed.\nSyntax:\nsendfile\non\n|\noff\n;\nDefault:\nsendfile off;\nContext:\nhttp\n,\nserver\n,\nlocation\n,\nif in location\nEnables or disables the use of\nsendfile()\n.\nStarting from nginx 0.8.12 and FreeBSD 5.2.1,\naio\ncan be used to pre-load data\nfor\nsendfile()\n:\nlocation /video/ {\nsendfile       on;\ntcp_nopush     on;\naio            on;\n}\nIn this configuration,\nsendfile()\nis called with\nthe\nSF_NODISKIO\nflag which causes it not to block on disk I/O,\nbut, instead, report back that the data are not in memory.\nnginx then initiates an asynchronous data load by reading one byte.\nOn the first read, the FreeBSD kernel loads the first 128K bytes\nof a file into memory, although next reads will only load data in 16K chunks.\nThis can be changed using the\nread_ahead\ndirective.\nBefore version 1.7.11, pre-loading could be enabled with\naio sendfile;\n.\nSyntax:\nsendfile_max_chunk\nsize\n;\nDefault:\nsendfile_max_chunk 2m;\nContext:\nhttp\n,\nserver\n,\nlocation\nLimits the amount of data that can be\ntransferred in a single\nsendfile()\ncall.\nWithout the limit, one fast connection may seize the worker process entirely.\nPrior to version 1.21.4, by default there was no limit.\nSyntax:\nserver\n{ ... }\nDefault:\n—\nContext:\nhttp\nSets configuration for a virtual server.\nThere is no clear separation between IP-based (based on the IP address)\nand name-based (based on the “Host” request header field)\nvirtual servers.\nInstead, the\nlisten\ndirectives describe all\naddresses and ports that should accept connections for the server, and the\nserver_name\ndirective lists all server names.\nExample configurations are provided in the\n“\nHow nginx processes a request\n” document.\nSyntax:\nserver_name\nname\n...;\nDefault:\nserver_name \"\";\nContext:\nserver\nSets names of a virtual server, for example:\nserver {\nserver_name example.com www.example.com;\n}\nThe first name becomes the primary server name.\nServer names can include an asterisk (“\n*\n”)\nreplacing the first or last part of a name:\nserver {\nserver_name example.com *.example.com www.example.*;\n}\nSuch names are called wildcard names.\nThe first two of the names mentioned above can be combined in one:\nserver {\nserver_name .example.com;\n}\nIt is also possible to use regular expressions in server names,\npreceding the name with a tilde (“\n~\n”):\nserver {\nserver_name www.example.com ~^www\\d+\\.example\\.com$;\n}\nRegular expressions can contain captures (0.7.40) that can later\nbe used in other directives:\nserver {\nserver_name ~^(www\\.)?(.+)$;\nlocation / {\nroot /sites/$2;\n}\n}\nserver {\nserver_name _;\nlocation / {\nroot /sites/default;\n}\n}\nNamed captures in regular expressions create variables (0.8.25)\nthat can later be used in other directives:\nserver {\nserver_name ~^(www\\.)?(?<domain>.+)$;\nlocation / {\nroot /sites/$domain;\n}\n}\nserver {\nserver_name _;\nlocation / {\nroot /sites/default;\n}\n}\nIf the directive’s parameter is set to “\n$hostname\n” (0.9.4), the\nmachine’s hostname is inserted.\nIt is also possible to specify an empty server name (0.7.11):\nserver {\nserver_name www.example.com \"\";\n}\nIt allows this server to process requests without the “Host”\nheader field — instead of the default server — for the given address:port pair.\nThis is the default setting.\nBefore 0.8.48, the machine’s hostname was used by default.\nDuring searching for a virtual server by name,\nif the name matches more than one of the specified variants,\n(e.g. both a wildcard name and regular expression match), the first matching\nvariant will be chosen, in the following order of priority:\nthe exact name\nthe longest wildcard name starting with an asterisk,\ne.g. “\n*.example.com\n”\nthe longest wildcard name ending with an asterisk,\ne.g. “\nmail.*\n”\nthe first matching regular expression\n(in order of appearance in the configuration file)\nDetailed description of server names is provided in a separate\nServer names\ndocument.\nSyntax:\nserver_name_in_redirect\non\n|\noff\n;\nDefault:\nserver_name_in_redirect off;\nContext:\nhttp\n,\nserver\n,\nlocation\nEnables or disables the use of the primary server name, specified by the\nserver_name\ndirective,\nin\nabsolute\nredirects issued by nginx.\nWhen the use of the primary server name is disabled, the name from the\n“Host” request header field is used.\nIf this field is not present, the IP address of the server is used.\nThe use of a port in redirects is controlled by\nthe\nport_in_redirect\ndirective.\nSyntax:\nserver_names_hash_bucket_size\nsize\n;\nDefault:\nserver_names_hash_bucket_size 32|64|128;\nContext:\nhttp\nSets the bucket size for the server names hash tables.\nThe default value depends on the size of the processor’s cache line.\nThe details of setting up hash tables are provided in a separate\ndocument\n.\nSyntax:\nserver_names_hash_max_size\nsize\n;\nDefault:\nserver_names_hash_max_size 512;\nContext:\nhttp\nSets the maximum\nsize\nof the server names hash tables.\nThe details of setting up hash tables are provided in a separate\ndocument\n.\nSyntax:\nserver_tokens\non\n|\noff\n|\nbuild\n|\nstring\n;\nDefault:\nserver_tokens on;\nContext:\nhttp\n,\nserver\n,\nlocation\nEnables or disables emitting nginx version on error pages and in the\n“Server” response header field.\nThe\nbuild\nparameter (1.11.10) enables emitting\na\nbuild name\nalong with nginx version.\nAdditionally, as part of our\ncommercial subscription\n,\nstarting from version 1.9.13\nthe signature on error pages and\nthe “Server” response header field value\ncan be set explicitly using the\nstring\nwith variables.\nAn empty string disables the emission of the “Server” field.\nSyntax:\nsubrequest_output_buffer_size\nsize\n;\nDefault:\nsubrequest_output_buffer_size 4k|8k;\nContext:\nhttp\n,\nserver\n,\nlocation\nThis directive appeared in version 1.13.10.\nSets the\nsize\nof the buffer used for\nstoring the response body of a subrequest.\nBy default, the buffer size is equal to one memory page.\nThis is either 4K or 8K, depending on a platform.\nIt can be made smaller, however.\nThe directive is applicable only for subrequests\nwith response bodies saved into memory.\nFor example, such subrequests are created by\nSSI\n.\nSyntax:\ntcp_nodelay\non\n|\noff\n;\nDefault:\ntcp_nodelay on;\nContext:\nhttp\n,\nserver\n,\nlocation\nEnables or disables the use of the\nTCP_NODELAY\noption.\nThe option is enabled when a connection is transitioned into the\nkeep-alive state.\nAdditionally, it is enabled on SSL connections,\nfor unbuffered proxying,\nand for\nWebSocket\nproxying.\nSyntax:\ntcp_nopush\non\n|\noff\n;\nDefault:\ntcp_nopush off;\nContext:\nhttp\n,\nserver\n,\nlocation\nEnables or disables the use of\nthe\nTCP_NOPUSH\nsocket option on FreeBSD\nor the\nTCP_CORK\nsocket option on Linux.\nThe options are enabled only when\nsendfile\nis used.\nEnabling the option allows\nsending the response header and the beginning of a file in one packet,\non Linux and FreeBSD 4.*;\nsending a file in full packets.\nSyntax:\ntry_files\nfile\n...\nuri\n;\ntry_files\nfile\n... =\ncode\n;\nDefault:\n—\nContext:\nserver\n,\nlocation\nChecks the existence of files in the specified order and uses\nthe first found file for request processing; the processing\nis performed in the current context.\nThe path to a file is constructed from the\nfile\nparameter\naccording to the\nroot\nand\nalias\ndirectives.\nIt is possible to check directory’s existence by specifying\na slash at the end of a name, e.g. “\n$uri/\n”.\nIf none of the files were found, an internal redirect to the\nuri\nspecified in the last parameter is made.\nFor example:\nlocation /images/ {\ntry_files $uri /images/default.gif;\n}\nlocation = /images/default.gif {\nexpires 30s;\n}\nThe last parameter can also point to a named location,\nas shown in examples below.\nStarting from version 0.7.51, the last parameter can also be a\ncode\n:\nlocation / {\ntry_files $uri $uri/index.html $uri.html =404;\n}\nExample in proxying Mongrel:\nlocation / {\ntry_files /system/maintenance.html\n$uri $uri/index.html $uri.html\n@mongrel;\n}\nlocation @mongrel {\nproxy_pass http://mongrel;\n}\nExample for Drupal/FastCGI:\nlocation / {\ntry_files $uri $uri/ @drupal;\n}\nlocation ~ \\.php$ {\ntry_files $uri @drupal;\nfastcgi_pass ...;\nfastcgi_param SCRIPT_FILENAME /path/to$fastcgi_script_name;\nfastcgi_param SCRIPT_NAME     $fastcgi_script_name;\nfastcgi_param QUERY_STRING    $args;\n... other fastcgi_param's\n}\nlocation @drupal {\nfastcgi_pass ...;\nfastcgi_param SCRIPT_FILENAME /path/to/index.php;\nfastcgi_param SCRIPT_NAME     /index.php;\nfastcgi_param QUERY_STRING    q=$uri&$args;\n... other fastcgi_param's\n}\nIn the following example,\nlocation / {\ntry_files $uri $uri/ @drupal;\n}\nthe\ntry_files\ndirective is equivalent to\nlocation / {\nerror_page 404 = @drupal;\nlog_not_found off;\n}\nAnd here,\nlocation ~ \\.php$ {\ntry_files $uri @drupal;\nfastcgi_pass ...;\nfastcgi_param SCRIPT_FILENAME /path/to$fastcgi_script_name;\n...\n}\ntry_files\nchecks the existence of the PHP file\nbefore passing the request to the FastCGI server.\nExample for Wordpress and Joomla:\nlocation / {\ntry_files $uri $uri/ @wordpress;\n}\nlocation ~ \\.php$ {\ntry_files $uri @wordpress;\nfastcgi_pass ...;\nfastcgi_param SCRIPT_FILENAME /path/to$fastcgi_script_name;\n... other fastcgi_param's\n}\nlocation @wordpress {\nfastcgi_pass ...;\nfastcgi_param SCRIPT_FILENAME /path/to/index.php;\n... other fastcgi_param's\n}\nSyntax:\ntypes\n{ ... }\nDefault:\ntypes {\ntext/html  html;\nimage/gif  gif;\nimage/jpeg jpg;\n}\nContext:\nhttp\n,\nserver\n,\nlocation\nMaps file name extensions to MIME types of responses.\nExtensions are case-insensitive.\nSeveral extensions can be mapped to one type, for example:\ntypes {\napplication/octet-stream bin exe dll;\napplication/octet-stream deb;\napplication/octet-stream dmg;\n}\nA sufficiently full mapping table is distributed with nginx in the\nconf/mime.types\nfile.\nTo make a particular location emit the\n“\napplication/octet-stream\n”\nMIME type for all requests, the following configuration can be used:\nlocation /download/ {\ntypes        { }\ndefault_type application/octet-stream;\n}\nSyntax:\ntypes_hash_bucket_size\nsize\n;\nDefault:\ntypes_hash_bucket_size 64;\nContext:\nhttp\n,\nserver\n,\nlocation\nSets the bucket size for the types hash tables.\nThe details of setting up hash tables are provided in a separate\ndocument\n.\nPrior to version 1.5.13,\nthe default value depended on the size of the processor’s cache line.\nSyntax:\ntypes_hash_max_size\nsize\n;\nDefault:\ntypes_hash_max_size 1024;\nContext:\nhttp\n,\nserver\n,\nlocation\nSets the maximum\nsize\nof the types hash tables.\nThe details of setting up hash tables are provided in a separate\ndocument\n.\nSyntax:\nunderscores_in_headers\non\n|\noff\n;\nDefault:\nunderscores_in_headers off;\nContext:\nhttp\n,\nserver\nEnables or disables the use of underscores in client request header fields.\nWhen the use of underscores is disabled, request header fields whose names\ncontain underscores are\nmarked as invalid and become subject to the\nignore_invalid_headers\ndirective.\nIf the directive is specified on the\nserver\nlevel,\nthe value from the default server can be used.\nDetails are provided in the\n“\nVirtual\nserver selection\n” section.\nSyntax:\nvariables_hash_bucket_size\nsize\n;\nDefault:\nvariables_hash_bucket_size 64;\nContext:\nhttp\nSets the bucket size for the variables hash table.\nThe details of setting up hash tables are provided in a separate\ndocument\n.\nSyntax:\nvariables_hash_max_size\nsize\n;\nDefault:\nvariables_hash_max_size 1024;\nContext:\nhttp\nSets the maximum\nsize\nof the variables hash table.\nThe details of setting up hash tables are provided in a separate\ndocument\n.\nPrior to version 1.5.13, the default value was 512.\nEmbedded Variables\nThe\nngx_http_core_module\nmodule supports embedded variables\nwith names matching the Apache Server variables.\nFirst of all, these are variables representing client request header\nfields, such as\n$http_user_agent\n,\n$http_cookie\n,\nand so on.\nAlso there are other variables:\n$arg_\nname\nargument\nname\nin the request line\n$args\narguments in the request line\n$binary_remote_addr\nclient address in a binary form, value’s length is always 4 bytes\nfor IPv4 addresses or 16 bytes for IPv6 addresses\n$body_bytes_sent\nnumber of bytes sent to a client, not counting the response header;\nthis variable is compatible with the “\n%B\n” parameter of the\nmod_log_config\nApache module\n$bytes_sent\nnumber of bytes sent to a client (1.3.8, 1.2.5)\n$connection\nconnection serial number (1.3.8, 1.2.5)\n$connection_requests\ncurrent number of requests made through a connection (1.3.8, 1.2.5)\n$connection_time\nconnection time in seconds with a milliseconds resolution (1.19.10)\n$content_length\n“Content-Length” request header field\n$content_type\n“Content-Type” request header field\n$cookie_\nname\nthe\nname\ncookie\n$document_root\nroot\nor\nalias\ndirective’s value\nfor the current request\n$document_uri\nsame as\n$uri\n$host\nin this order of precedence:\nhost name from the request line, or\nhost name from the “Host” request header field, or\nthe server name matching a request\n$hostname\nhost name\n$http_\nname\narbitrary request header field;\nthe last part of a variable name is the field name converted\nto lower case with dashes replaced by underscores\n$https\n“\non\n”\nif connection operates in SSL mode,\nor an empty string otherwise\n$is_args\n“\n?\n” if a request line has arguments,\nor an empty string otherwise\n$is_request_port\n“\n:\n” if\n$request_port\nis non-empty,\nor an empty string otherwise (1.29.3)\n$limit_rate\nsetting this variable enables response rate limiting;\nsee\nlimit_rate\n$msec\ncurrent time in seconds with the milliseconds resolution (1.3.9, 1.2.6)\n$nginx_version\nnginx version\n$pid\nPID of the worker process\n$pipe\n“\np\n” if request was pipelined, “\n.\n”\notherwise (1.3.12, 1.2.7)\n$proxy_protocol_addr\nclient address from the PROXY protocol header (1.5.12)\nThe PROXY protocol must be previously enabled by setting the\nproxy_protocol\nparameter\nin the\nlisten\ndirective.\n$proxy_protocol_port\nclient port from the PROXY protocol header (1.11.0)\nThe PROXY protocol must be previously enabled by setting the\nproxy_protocol\nparameter\nin the\nlisten\ndirective.\n$proxy_protocol_server_addr\nserver address from the PROXY protocol header (1.17.6)\nThe PROXY protocol must be previously enabled by setting the\nproxy_protocol\nparameter\nin the\nlisten\ndirective.\n$proxy_protocol_server_port\nserver port from the PROXY protocol header (1.17.6)\nThe PROXY protocol must be previously enabled by setting the\nproxy_protocol\nparameter\nin the\nlisten\ndirective.\n$proxy_protocol_tlv_\nname\nTLV from the PROXY Protocol header (1.23.2).\nThe\nname\ncan be a TLV type name or its numeric value.\nIn the latter case, the value is hexadecimal\nand should be prefixed with\n0x\n:\n$proxy_protocol_tlv_alpn\n$proxy_protocol_tlv_0x01\nSSL TLVs can also be accessed by TLV type name\nor its numeric value,\nboth prefixed by\nssl_\n:\n$proxy_protocol_tlv_ssl_version\n$proxy_protocol_tlv_ssl_0x21\nThe following TLV type names are supported:\nalpn\n(\n0x01\n) -\nupper layer protocol used over the connection\nauthority\n(\n0x02\n) -\nhost name value passed by the client\nunique_id\n(\n0x05\n) -\nunique connection id\nnetns\n(\n0x30\n) -\nname of the namespace\nssl\n(\n0x20\n) -\nbinary SSL TLV structure\nThe following SSL TLV type names are supported:\nssl_version\n(\n0x21\n) -\nSSL version used in client connection\nssl_cn\n(\n0x22\n) -\nSSL certificate Common Name\nssl_cipher\n(\n0x23\n) -\nname of the used cipher\nssl_sig_alg\n(\n0x24\n) -\nalgorithm used to sign the certificate\nssl_key_alg\n(\n0x25\n) -\npublic-key algorithm\nAlso, the following special SSL TLV type name is supported:\nssl_verify\n-\nclient SSL certificate verification result,\n0\nif the client presented a certificate\nand it was successfully verified,\nnon-zero otherwise.\nThe PROXY protocol must be previously enabled by setting the\nproxy_protocol\nparameter\nin the\nlisten\ndirective.\n$query_string\nsame as\n$args\n$realpath_root\nan absolute pathname corresponding to the\nroot\nor\nalias\ndirective’s value\nfor the current request,\nwith all symbolic links resolved to real paths\n$remote_addr\nclient address\n$remote_port\nclient port\n$remote_user\nuser name supplied with the Basic authentication\n$request\nfull original request line\n$request_body\nrequest body\nThe variable’s value is made available in locations\nprocessed by the\nproxy_pass\n,\nfastcgi_pass\n,\nuwsgi_pass\n,\nand\nscgi_pass\ndirectives when the request body was read to\na\nmemory buffer\n.\n$request_body_file\nname of a temporary file with the request body\nAt the end of processing, the file needs to be removed.\nTo always write the request body to a file,\nclient_body_in_file_only\nneeds to be enabled.\nWhen the name of a temporary file is passed in a proxied request\nor in a request to a FastCGI/uwsgi/SCGI server,\npassing the request body should be disabled by the\nproxy_pass_request_body off\n,\nfastcgi_pass_request_body off\n,\nuwsgi_pass_request_body off\n, or\nscgi_pass_request_body off\ndirectives, respectively.\n$request_completion\n“\nOK\n” if a request has completed,\nor an empty string otherwise\n$request_filename\nfile path for the current request, based on the\nroot\nor\nalias\ndirectives, and the request URI\n$request_id\nunique request identifier\ngenerated from 16 random bytes, in hexadecimal (1.11.0)\n$request_length\nrequest length (including request line, header, and request body)\n(1.3.12, 1.2.7)\n$request_method\nrequest method, usually\n“\nGET\n” or “\nPOST\n”\n$request_port\nin this order of precedence:\nport number from the\nURI\nauthority component, or\nport number from the “Host” request header field (1.29.3)\n$request_time\nrequest processing time in seconds with a milliseconds resolution\n(1.3.9, 1.2.6);\ntime elapsed since the first bytes were read from the client\n$request_uri\nfull original request URI (with arguments)\n$scheme\nrequest scheme, “\nhttp\n” or “\nhttps\n”\n$sent_http_\nname\narbitrary response header field;\nthe last part of a variable name is the field name converted\nto lower case with dashes replaced by underscores\n$sent_trailer_\nname\narbitrary field sent at the end of the response (1.13.2);\nthe last part of a variable name is the field name converted\nto lower case with dashes replaced by underscores\n$server_addr\nan address of the server which accepted a request\nComputing a value of this variable usually requires one system call.\nTo avoid a system call, the\nlisten\ndirectives\nmust specify addresses and use the\nbind\nparameter.\n$server_name\nname of the server which accepted a request\n$server_port\nport of the server which accepted a request\n$server_protocol\nrequest protocol, usually\n“\nHTTP/1.0\n”,\n“\nHTTP/1.1\n”,\n“\nHTTP/2.0\n”,\nor\n“\nHTTP/3.0\n”\n$status\nresponse status (1.3.2, 1.2.2)\n$tcpinfo_rtt\n,\n$tcpinfo_rttvar\n,\n$tcpinfo_snd_cwnd\n,\n$tcpinfo_rcv_space\ninformation about the client TCP connection; available on systems\nthat support the\nTCP_INFO\nsocket option\n$time_iso8601\nlocal time in the ISO 8601 standard format (1.3.12, 1.2.7)\n$time_local\nlocal time in the Common Log Format (1.3.12, 1.2.7)\n$uri\ncurrent URI in request,\nnormalized\nThe value of\n$uri\nmay change during request processing,\ne.g. when doing internal redirects, or when using index files.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://nginx.org/en/docs/http/ngx_http_core_module.html"}}
{"text": "Configuring HTTPS servers\nConfused between\ningress-nginx\nand\nNGINX Ingress Controller\n?\nLearn about our long-term commitment to the NGINX Ingress Controller and Gateway API implementation.\nRead the Blog\n.\nConfiguring HTTPS servers\nHTTPS server optimization\nSSL certificate chains\nA single HTTP/HTTPS server\nName-based HTTPS servers\nAn SSL certificate with several names\nServer Name Indication\nCompatibility\nTo configure an HTTPS server, the\nssl\nparameter\nmust be enabled on\nlistening sockets\nin the\nserver\nblock,\nand the locations of the\nserver certificate\nand\nprivate key\nfiles should be specified:\nserver {\nlisten              443\nssl\n;\nserver_name         www.example.com;\nssl_certificate\nwww.example.com.crt\n;\nssl_certificate_key\nwww.example.com.key\n;\nssl_protocols       TLSv1.2 TLSv1.3;\nssl_ciphers         HIGH:!aNULL:!MD5;\n...\n}\nThe server certificate is a public entity.\nIt is sent to every client that connects to the server.\nThe private key is a secure entity and should be stored in a file with\nrestricted access, however, it must be readable by nginx’s master process.\nThe private key may alternately be stored in the same file as the certificate:\nssl_certificate     www.example.com.cert;\nssl_certificate_key www.example.com.cert;\nin which case the file access rights should also be restricted.\nAlthough the certificate and the key are stored in one file,\nonly the certificate is sent to a client.\nThe directives\nssl_protocols\nand\nssl_ciphers\ncan be used to limit connections\nto include only the strong versions and ciphers of SSL/TLS.\nBy default nginx uses\n“\nssl_protocols TLSv1.2 TLSv1.3\n”\nand “\nssl_ciphers HIGH:!aNULL:!MD5\n”,\nso configuring them explicitly is generally not needed.\nNote that default values of these directives were\nchanged\nseveral times.\nHTTPS server optimization\nSSL operations consume extra CPU resources.\nOn multi-processor systems several\nworker processes\nshould be run,\nno less than the number of available CPU cores.\nThe most CPU-intensive operation is the SSL handshake.\nThere are two ways to minimize the number of these operations per client:\nthe first is by enabling\nkeepalive\nconnections to send several\nrequests via one connection and the second is to reuse SSL session\nparameters to avoid SSL handshakes for parallel and subsequent connections.\nThe sessions are stored in an SSL session cache shared between workers\nand configured by the\nssl_session_cache\ndirective.\nOne megabyte of the cache contains about 4000 sessions.\nThe default cache timeout is 5 minutes.\nIt can be increased by using the\nssl_session_timeout\ndirective.\nHere is a sample configuration optimized for a multi-core system\nwith 10 megabyte shared session cache:\nworker_processes auto\n;\nhttp {\nssl_session_cache   shared:SSL:10m\n;\nssl_session_timeout 10m\n;\nserver {\nlisten              443 ssl;\nserver_name         www.example.com;\nkeepalive_timeout   70\n;\nssl_certificate     www.example.com.crt;\nssl_certificate_key www.example.com.key;\nssl_protocols       TLSv1.2 TLSv1.3;\nssl_ciphers         HIGH:!aNULL:!MD5;\n...\nSSL certificate chains\nSome browsers may complain about a certificate signed by a well-known\ncertificate authority, while other browsers may accept the certificate\nwithout issues.\nThis occurs because the issuing authority has signed the server certificate\nusing an intermediate certificate that is not present in the certificate\nbase of well-known trusted certificate authorities which is distributed\nwith a particular browser.\nIn this case the authority provides a bundle of chained certificates\nwhich should be concatenated to the signed server certificate.\nThe server certificate must appear before the chained certificates\nin the combined file:\n$ cat www.example.com.crt bundle.crt > www.example.com.chained.crt\nThe resulting file should be used in the\nssl_certificate\ndirective:\nserver {\nlisten              443 ssl;\nserver_name         www.example.com;\nssl_certificate     www.example.com.chained.crt;\nssl_certificate_key www.example.com.key;\n...\n}\nIf the server certificate and the bundle have been concatenated in the wrong\norder, nginx will fail to start and will display the error message:\nSSL_CTX_use_PrivateKey_file(\" ... /www.example.com.key\") failed\n(SSL: error:05800074:x509 certificate routines::key values mismatch)\nbecause nginx has tried to use the private key with the bundle’s\nfirst certificate instead of the server certificate.\nBrowsers usually store intermediate certificates which they receive\nand which are signed by trusted authorities, so actively used browsers\nmay already have the required intermediate certificates and\nmay not complain about a certificate sent without a chained bundle.\nTo ensure the server sends the complete certificate chain,\nthe\nopenssl\ncommand-line utility may be used, for example:\n$ openssl s_client -connect www.godaddy.com:443\n...\nCertificate chain\n0 s:/C=US/ST=Arizona/L=Scottsdale/1.3.6.1.4.1.311.60.2.1.3=US\n/1.3.6.1.4.1.311.60.2.1.2=AZ/O=GoDaddy.com, Inc\n/OU=MIS Department/\nCN=www.GoDaddy.com\n/serialNumber=0796928-7/2.5.4.15=V1.0, Clause 5.(b)\ni:/C=US/ST=Arizona/L=Scottsdale/O=GoDaddy.com, Inc.\n/OU=http://certificates.godaddy.com/repository\n/CN=Go Daddy Secure Certification Authority\n/serialNumber=07969287\n1 s:/C=US/ST=Arizona/L=Scottsdale/O=GoDaddy.com, Inc.\n/OU=http://certificates.godaddy.com/repository\n/CN=Go Daddy Secure Certification Authority\n/serialNumber=07969287\ni:/C=US/O=The Go Daddy Group, Inc.\n/OU=Go Daddy Class 2 Certification Authority\n2 s:/C=US/O=The Go Daddy Group, Inc.\n/OU=Go Daddy Class 2 Certification Authority\ni:/L=ValiCert Validation Network/O=\nValiCert, Inc.\n/OU=ValiCert Class 2 Policy Validation Authority\n/CN=http://www.valicert.com//emailAddress=info@valicert.com\n...\nIn this example the subject (“\ns\n”) of the\nwww.GoDaddy.com\nserver certificate #0 is signed by an issuer\n(“\ni\n”) which itself is the subject of the certificate #1,\nwhich is signed by an issuer which itself is the subject of the certificate #2,\nwhich signed by the well-known issuer\nValiCert, Inc.\nwhose certificate is stored in the browsers’ built-in\ncertificate base (that lay in the house that Jack built).\nIf a certificate bundle has not been added, only the server certificate #0\nwill be shown.\nA single HTTP/HTTPS server\nIt is possible to configure a single server that handles both HTTP\nand HTTPS requests:\nserver {\nlisten              80;\nlisten              443 ssl;\nserver_name         www.example.com;\nssl_certificate     www.example.com.crt;\nssl_certificate_key www.example.com.key;\n...\n}\nPrior to 0.7.14 SSL could not be enabled selectively for\nindividual listening sockets, as shown above.\nSSL could only be enabled for the entire server using the\nssl\ndirective,\nmaking it impossible to set up a single HTTP/HTTPS server.\nThe\nssl\nparameter of the\nlisten\ndirective\nwas added to solve this issue.\nThe use of the\nssl\ndirective\nin modern versions is thus discouraged;\nit was removed in 1.25.1.\nName-based HTTPS servers\nA common issue arises when configuring two or more HTTPS servers\nlistening on a single IP address:\nserver {\nlisten          443 ssl;\nserver_name     www.example.com;\nssl_certificate www.example.com.crt;\n...\n}\nserver {\nlisten          443 ssl;\nserver_name     www.example.org;\nssl_certificate www.example.org.crt;\n...\n}\nWith this configuration a browser receives the default server’s certificate,\ni.e.\nwww.example.com\nregardless of the requested server name.\nThis is caused by SSL protocol behaviour.\nThe SSL connection is established before the browser sends an HTTP request\nand nginx does not know the name of the requested server.\nTherefore, it may only offer the default server’s certificate.\nThe oldest and most robust method to resolve the issue\nis to assign a separate IP address for every HTTPS server:\nserver {\nlisten          192.168.1.1:443 ssl;\nserver_name     www.example.com;\nssl_certificate www.example.com.crt;\n...\n}\nserver {\nlisten          192.168.1.2:443 ssl;\nserver_name     www.example.org;\nssl_certificate www.example.org.crt;\n...\n}\nAn SSL certificate with several names\nThere are other ways that allow sharing a single IP address\nbetween several HTTPS servers.\nHowever, all of them have their drawbacks.\nOne way is to use a certificate with several names in\nthe SubjectAltName certificate field, for example,\nwww.example.com\nand\nwww.example.org\n.\nHowever, the SubjectAltName field length is limited.\nAnother way is to use a certificate with a wildcard name, for example,\n*.example.org\n.\nA wildcard certificate secures all subdomains of the specified domain,\nbut only on one level.\nThis certificate matches\nwww.example.org\n, but does not match\nexample.org\nand\nwww.sub.example.org\n.\nThese two methods can also be combined.\nA certificate may contain exact and wildcard names in the\nSubjectAltName field, for example,\nexample.org\nand\n*.example.org\n.\nIt is better to place a certificate file with several names and\nits private key file at the\nhttp\nlevel of configuration\nto inherit their single memory copy in all servers:\nssl_certificate     common.crt;\nssl_certificate_key common.key;\nserver {\nlisten          443 ssl;\nserver_name     www.example.com;\n...\n}\nserver {\nlisten          443 ssl;\nserver_name     www.example.org;\n...\n}\nServer Name Indication\nA more generic solution for running several HTTPS servers on a single\nIP address is\nTLS\nServer Name Indication extension\n(SNI, RFC 6066),\nwhich allows a browser to pass a requested server name during the SSL handshake\nand, therefore, the server will know which certificate it should use\nfor the connection.\nSNI is currently\nsupported\nby most modern browsers\nand is a mandatory-to-implement extension in TLSv1.3,\nthough may not be used by some old or special clients.\nOnly domain names can be passed in SNI,\nhowever some browsers may erroneously pass an IP address of the server\nas its name if a request includes literal IP address.\nOne should not rely on this.\nIn order to use SNI in nginx, it must be supported in both the\nOpenSSL library with which the nginx binary has been built as well as\nthe library to which it is being dynamically linked at run time.\nOpenSSL supports SNI since 0.9.8f version if it was built with config option\n“--enable-tlsext”.\nSince OpenSSL 0.9.8j this option is enabled by default.\nIf nginx was built with SNI support, then nginx will show this\nwhen run with the “-V” switch:\n$ nginx -V\n...\nTLS SNI support enabled\n...\nHowever, if the SNI-enabled nginx is linked dynamically to\nan OpenSSL library without SNI support, nginx displays the warning:\nnginx was built with SNI support, however, now it is linked\ndynamically to an OpenSSL library which has no tlsext support,\ntherefore SNI is not available\nCompatibility\nThe SNI support status has been shown by the “-V” switch\nsince 0.8.21 and 0.7.62.\nThe\nssl\nparameter of the\nlisten\ndirective has been supported since 0.7.14.\nPrior to 0.8.21 it could only be specified along with the\ndefault\nparameter.\nSNI has been supported since 0.5.23.\nThe shared SSL session cache has been supported since 0.5.6.\nVersion 1.27.3 and later: the default SSL protocols are\nTLSv1.2 and TLSv1.3 (if supported by the OpenSSL library).\nOtherwise, when OpenSSL 1.0.0 or older is used,\nthe default SSL protocols are TLSv1 and TLSv1.1.\nVersion 1.23.4 and later: the default SSL protocols are TLSv1,\nTLSv1.1, TLSv1.2, and TLSv1.3 (if supported by the OpenSSL library).\nVersion 1.9.1 and later: the default SSL protocols are TLSv1,\nTLSv1.1, and TLSv1.2 (if supported by the OpenSSL library).\nVersion 0.7.65, 0.8.19 and later: the default SSL protocols are SSLv3, TLSv1,\nTLSv1.1, and TLSv1.2 (if supported by the OpenSSL library).\nVersion 0.7.64, 0.8.18 and earlier: the default SSL protocols are SSLv2,\nSSLv3, and TLSv1.\nVersion 1.0.5 and later: the default SSL ciphers are\n“\nHIGH:!aNULL:!MD5\n”.\nVersion 0.7.65, 0.8.20 and later: the default SSL ciphers are\n“\nHIGH:!ADH:!MD5\n”.\nVersion 0.8.19: the default SSL ciphers are\n“\nALL:!ADH:RC4+RSA:+HIGH:+MEDIUM\n”.\nVersion 0.7.64, 0.8.18 and earlier: the default SSL ciphers are\n“\nALL:!ADH:RC4+RSA:+HIGH:+MEDIUM:+LOW:+SSLv2:+EXP\n”.\nwritten by Igor Sysoev\nedited by Brian Mercer", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://nginx.org/en/docs/http/configuring_https_servers.html"}}
{"text": "Getting Started - Apache HTTP Server Version 2.4\nModules\n|\nDirectives\n|\nFAQ\n|\nGlossary\n|\nSitemap\nApache HTTP Server Version 2.4\nApache\n>\nHTTP Server\n>\nDocumentation\n>\nVersion 2.4\nGetting Started\nAvailable Languages:\nen\n|\nfr\n|\nru\nIf you're completely new to the Apache HTTP Server, or even to running\na website at all, you might not know where to start, or what questions to\nask. This document walks you through the basics.\nClients, Servers, and URLs\nHostnames and DNS\nConfiguration Files and Directives\nWeb Site Content\nLog Files and Troubleshooting\nWhat's next?\nSee also\nComments\nClients, Servers, and URLs\nAddresses on the Web are expressed with URLs - Uniform Resource Locators\n- which specify a protocol (e.g.\nhttp\n), a servername (e.g.\nwww.apache.org\n), a URL-path (e.g.\n/docs/current/getting-started.html\n), and possibly a query\nstring (e.g.\n?arg=value\n) used to pass additional\narguments to the server.\nA client (e.g., a web browser) connects to a server (e.g., your Apache HTTP Server),\nwith the specified protocol, and makes a\nrequest\nfor a resource using the\nURL-path.\nThe URL-path may represent any number of things on the server. It may\nbe a file (like\ngetting-started.html\n) a handler (like\nserver-status\n) or some kind of program\nfile (like\nindex.php\n). We'll discuss this more below in\nthe\nWeb Site Content\nsection.\nThe server will send a\nresponse\nconsisting of a status\ncode and, optionally, a response body.\nThe status code indicates whether the request was successful, and, if not, what\nkind of error condition there was. This tells the client what it should\ndo with the response. You can read about the possible response codes in\nHTTP Server\nwiki\n.\nDetails of the transaction, and any error conditions, are written to\nlog files. This is discussed in greater detail below in the\nLogs Files and Troubleshooting\nsection.\nHostnames and DNS\nIn order to connect to a server, the client will first have to resolve\nthe servername to an IP address - the location on the Internet where the\nserver resides. Thus, in order for your web server to be reachable, it\nis necessary that the servername be in DNS.\nIf you don't know how to do this, you'll need to contact your network\nadministrator, or Internet service provider, to perform this step for\nyou.\nMore than one hostname may point to the same IP address, and more\nthan one IP address can be attached to the same physical server. Thus, you\ncan run more than one web site on the same physical server, using a\nfeature called\nvirtual hosts\n.\nIf you are testing a server that is not Internet-accessible, you\ncan put host names in your hosts file in order to do local resolution.\nFor example, you might want to put a record in your hosts file to map a\nrequest for\nwww.example.com\nto your local system, for\ntesting purposes. This entry would look like:\n127.0.0.1 www.example.com\nA hosts file will probably be located at\n/etc/hosts\nor\nC:\\Windows\\system32\\drivers\\etc\\hosts\n.\nYou can read more about the hosts file at\nWikipedia.org/wiki/Hosts_(file)\n, and\nmore about DNS at\nWikipedia.org/wiki/Domain_Name_System\n.\nConfiguration Files and Directives\nThe Apache HTTP Server is configured via simple text files.\nThese files may be located any of a variety of places, depending on how\nexactly you installed the server. Common locations for these files may\nbe found\nin\nthe httpd wiki\n. If you installed httpd from source, the default\nlocation of the configuration files is\n/usr/local/apache2/conf\n. The default configuration file is\nusually called\nhttpd.conf\n. This, too, can vary in\nthird-party distributions of the server.\nThe configuration is frequently broken into multiple smaller files,\nfor ease of management. These files are loaded via the\nInclude\ndirective. The names or locations of\nthese sub-files are not magical, and may vary greatly from one\ninstallation to another. Arrange and subdivide these files as\nmakes the most sense to\nyou\n. If the file arrangement\nyou have by default doesn't make sense to you, feel free to rearrange it.\nThe server is configured by placing\nconfiguration directives\nin these\nconfiguration files. A directive is a keyword followed by one or more\narguments that set its value.\nThe question of \"\nWhere should I put that\ndirective?\n\" is generally answered by considering where you want a\ndirective to be effective. If it is a global setting, it should appear\nin the configuration file, outside of any\n<Directory>\n,\n<Location>\n,\n<VirtualHost>\n, or other section. If it is to\napply only to a particular directory, then it should go inside a\n<Directory>\nsection referring to\nthat directory, and so on. See the\nConfiguration\nSections\ndocument for further discussion of these sections.\nIn addition to the main configuration files, certain directives may go in\n.htaccess\nfiles located in the content directories.\n.htaccess\nfiles are primarily for people who do not have\naccess to the main server configuration file(s). You can read more about\n.htaccess\nfiles in the\n.htaccess\nhowto\n.\nWeb Site Content\nWeb site content can take many different forms, but may be broadly\ndivided into static and dynamic content.\nStatic content is things like HTML files, image files, CSS files,\nand other files that reside in the filesystem. The\nDocumentRoot\ndirective specifies where in your\nfilesystem you should place these files. This directive is either set\nglobally, or per virtual host. Look in your configuration file(s) to\ndetermine how this is set for your server.\nTypically, a document called\nindex.html\nwill be served\nwhen a directory is requested without a file name being specified. For\nexample, if\nDocumentRoot\nis set to\n/var/www/html\nand a request is made for\nhttp://www.example.com/work/\n, the file\n/var/www/html/work/index.html\nwill be served to the\nclient.\nDynamic content is anything that is generated at request\ntime, and may change from one request to another. There are numerous\nways that dynamic content may be generated. Various\nhandlers\nare available to generate content.\nCGI programs\nmay be written to generate\ncontent for your site.\nThird-party modules like mod_php may be used to write code that does a\nvariety of things. Many third-party applications, written using a\nvariety of languages and tools, are available for download and\ninstallation on your Apache HTTP Server. Support of these third-party\nthings is beyond the scope of this documentation, and you should find\ntheir documentation or other support forums to answer your questions\nabout them.\nLog Files and Troubleshooting\nAs an Apache HTTP Server administrator, your most valuable assets are\nthe log files, and, in particular, the error log. Troubleshooting any\nproblem without the error log is like driving with your eyes closed.\nThe location of the error log is defined by the\nErrorLog\ndirective, which may be set globally,\nor per virtual host. Entries in the error log tell you what went wrong,\nand when. They often also tell you how to fix it. Each error log message\ncontains an error code, which you can search for online for even more\ndetailed descriptions of how to address the problem. You can also\nconfigure your error log to contain a log ID which you can then\ncorrelate to an access log entry, so that you can determine what request\ncaused the error condition.\nYou can read more about logging in the\nlogs\ndocumentation\n.\nWhat's next?\nOnce you have the prerequisites under your belt, it's time to move\non.\nThis document covers only the bare basics. We hope that this gets you\nstarted, but there are many other things that you might need to\nknow.\nDownload\nInstall\nConfigure\nStart\nFrequently Asked Questions\nAvailable Languages:\nen\n|\nfr\n|\nru\nComments\nNotice:\nThis is not a Q&A section. Comments placed here should be pointed towards suggestions on improving the documentation or server, and may be removed by our moderators if they are either implemented or considered invalid/off-topic. Questions on how to manage the Apache HTTP Server should be directed at either our IRC channel, #httpd, on Libera.chat, or sent to our\nmailing lists\n.\nCopyright 2025 The Apache Software Foundation.\nLicensed under the\nApache License, Version 2.0\n.\nModules\n|\nDirectives\n|\nFAQ\n|\nGlossary\n|\nSitemap", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://httpd.apache.org/docs/current/getting-started.html"}}
{"text": "Configuration Files - Apache HTTP Server Version 2.4\nModules\n|\nDirectives\n|\nFAQ\n|\nGlossary\n|\nSitemap\nApache HTTP Server Version 2.4\nApache\n>\nHTTP Server\n>\nDocumentation\n>\nVersion 2.4\nConfiguration Files\nAvailable Languages:\nde\n|\nen\n|\nfr\n|\nja\n|\nko\n|\ntr\nThis document describes the files used to configure Apache HTTP\nServer.\nMain Configuration Files\nSyntax of the Configuration Files\nModules\nScope of Directives\n.htaccess Files\nSee also\nComments\nMain Configuration Files\nRelated Modules\nRelated Directives\nmod_mime\n<IfDefine>\nInclude\nTypesConfig\nApache HTTP Server is configured by placing\ndirectives\nin plain text\nconfiguration files. The main configuration file is usually called\nhttpd.conf\n. The location of this file is set at\ncompile-time, but may be overridden with the\n-f\ncommand line flag. In addition, other configuration files may be\nadded using the\nInclude\ndirective, and wildcards can be used to include many configuration\nfiles. Any directive may be placed in any of these configuration\nfiles. Changes to the main configuration files are only\nrecognized by httpd when it is started or restarted.\nThe server also reads a file containing mime document types;\nthe filename is set by the\nTypesConfig\ndirective,\nand is\nmime.types\nby default.\nSyntax of the Configuration Files\nhttpd configuration files contain one directive per line.\nThe backslash \"\\\" may be used as the last character on a line\nto indicate that the directive continues onto the next line.\nTo be interpreted as such a continuation, there must be no\nother characters or white space between the backslash and the\nend of the line.\nLines that begin with the hash character \"#\" are considered\ncomments, and are ignored. Comments may\nnot\nbe\nincluded on the same line as a configuration directive, including\nat the start of a line that has been continued as described in the\npreceding paragraph. Commented lines may also be continued, meaning\nthe next physical line is also interpreted as a comment because the\nlogical line begins with a hash character.\nWhite space occurring before a directive is ignored, so\nyou may indent directives for clarity. Blank lines are also ignored.\nArguments to directives are separated by whitespace. If an\nargument contains spaces, you must enclose that argument in quotes.\nDirectives in the configuration files are case-insensitive,\nbut arguments to directives are often case sensitive.\nThe values of variables defined with the\nDefine\nof or shell environment variables can\nbe used in configuration file lines using the syntax\n${VAR}\n.\nIf \"VAR\" is the name of a valid variable, the value of that variable is\nsubstituted into that spot in the configuration file line, and processing\ncontinues as if that text were found directly in the configuration file.\nVariables defined with\nDefine\ntake\nprecedence over shell environment variables.\nIf the \"VAR\" variable is not found, the characters\n${VAR}\nare left unchanged, and a warning is logged.\nVariable names may not contain colon \":\" characters, to avoid clashes with\nRewriteMap\n's syntax.\nOnly shell environment variables defined before the server is started\ncan be used in expansions. Environment variables defined in the\nconfiguration file itself, for example with\nSetEnv\n, take effect too late to be used for\nexpansions in the configuration file.\nThe maximum length of a line in normal configuration files, after\nvariable substitution and joining any continued lines, is approximately\n16 MiB. In\n.htaccess files\n, the\nmaximum length is 8190 characters.\nYou can check your configuration files for syntax errors\nwithout starting the server by using\napachectl\nconfigtest\nor the\n-t\ncommand line\noption.\nYou can use\nmod_info\n's\n-DDUMP_CONFIG\nto\ndump the configuration with all included files and environment\nvariables resolved and all comments and non-matching\n<IfDefine>\nand\n<IfModule>\nsections\nremoved. However, the output does not reflect the merging or overriding\nthat may happen for repeated directives.\nModules\nRelated Modules\nRelated Directives\nmod_so\n<IfModule>\nLoadModule\nhttpd is a modular server. This implies that only the most\nbasic functionality is included in the core server. Extended\nfeatures are available through\nmodules\nwhich can be loaded\ninto httpd. By default, a\nbase\nset of modules is\nincluded in the server at compile-time. If the server is\ncompiled to use\ndynamically loaded\nmodules, then modules can be compiled separately and added at\nany time using the\nLoadModule\ndirective.\nOtherwise, httpd must be recompiled to add or remove modules.\nConfiguration directives may be included conditional on a\npresence of a particular module by enclosing them in an\n<IfModule>\nblock. However,\n<IfModule>\nblocks are not\nrequired, and in some cases may mask the fact that you're missing an\nimportant module.\nTo see which modules are currently compiled into the server,\nyou can use the\n-l\ncommand line option. You can also\nsee what modules are loaded dynamically using the\n-M\ncommand line option.\nScope of Directives\nRelated Modules\nRelated Directives\n<Directory>\n<DirectoryMatch>\n<Files>\n<FilesMatch>\n<Location>\n<LocationMatch>\n<VirtualHost>\nDirectives placed in the main configuration files apply to\nthe entire server. If you wish to change the configuration for\nonly a part of the server, you can scope your directives by\nplacing them in\n<Directory>\n,\n<DirectoryMatch>\n,\n<Files>\n,\n<FilesMatch>\n,\n<Location>\n, and\n<LocationMatch>\nsections. These sections limit the application of the\ndirectives which they enclose to particular filesystem\nlocations or URLs. They can also be nested, allowing for very\nfine grained configuration.\nhttpd has the capability to serve many different websites\nsimultaneously. This is called\nVirtual\nHosting\n. Directives can also be scoped by placing them\ninside\n<VirtualHost>\nsections, so that they will only apply to requests for a\nparticular website.\nAlthough most directives can be placed in any of these\nsections, some directives do not make sense in some contexts.\nFor example, directives controlling process creation can only\nbe placed in the main server context. To find which directives\ncan be placed in which sections, check the\nContext\nof the\ndirective. For further information, we provide details on\nHow Directory, Location and Files sections\nwork\n.\n.htaccess Files\nRelated Modules\nRelated Directives\nAccessFileName\nAllowOverride\nhttpd allows for decentralized management of configuration\nvia special files placed inside the web tree. The special files\nare usually called\n.htaccess\n, but any name can be\nspecified in the\nAccessFileName\ndirective. Directives placed in\n.htaccess\nfiles\napply to the directory where you place the file, and all\nsub-directories. The\n.htaccess\nfiles follow the\nsame syntax as the main configuration files. Since\n.htaccess\nfiles are read on every request, changes\nmade in these files take immediate effect.\nTo find which directives can be placed in\n.htaccess\nfiles, check the\nContext\nof the\ndirective. The server administrator further controls what\ndirectives may be placed in\n.htaccess\nfiles by\nconfiguring the\nAllowOverride\ndirective in the main configuration files.\nFor more information on\n.htaccess\nfiles, see\nthe\n.htaccess tutorial\n.\nAvailable Languages:\nde\n|\nen\n|\nfr\n|\nja\n|\nko\n|\ntr\nComments\nNotice:\nThis is not a Q&A section. Comments placed here should be pointed towards suggestions on improving the documentation or server, and may be removed by our moderators if they are either implemented or considered invalid/off-topic. Questions on how to manage the Apache HTTP Server should be directed at either our IRC channel, #httpd, on Libera.chat, or sent to our\nmailing lists\n.\nCopyright 2025 The Apache Software Foundation.\nLicensed under the\nApache License, Version 2.0\n.\nModules\n|\nDirectives\n|\nFAQ\n|\nGlossary\n|\nSitemap", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://httpd.apache.org/docs/current/configuring.html"}}
{"text": "SSL/TLS Strong Encryption: How-To - Apache HTTP Server Version 2.4\nModules\n|\nDirectives\n|\nFAQ\n|\nGlossary\n|\nSitemap\nApache HTTP Server Version 2.4\nApache\n>\nHTTP Server\n>\nDocumentation\n>\nVersion 2.4\n>\nSSL/TLS\nSSL/TLS Strong Encryption: How-To\nAvailable Languages:\nen\n|\nfr\nThis document is intended to get you started, and get a few things\nworking. You are strongly encouraged to read the rest of the SSL\ndocumentation, and arrive at a deeper understanding of the material,\nbefore progressing to the advanced techniques.\nBasic Configuration Example\nCipher Suites and Enforcing Strong Security\nOCSP Stapling\nClient Authentication and Access Control\nLogging\nSee also\nComments\nBasic Configuration Example\nYour SSL configuration will need to contain, at minimum, the\nfollowing directives.\nLoadModule ssl_module modules/mod_ssl.so\nListen 443\n<VirtualHost *:443>\nServerName www.example.com\nSSLEngine on\nSSLCertificateFile \"/path/to/www.example.com.cert\"\nSSLCertificateKeyFile \"/path/to/www.example.com.key\"\n</VirtualHost>\nCipher Suites and Enforcing Strong Security\nHow can I create an SSL server which accepts strong encryption only?\nHow can I create an SSL server which accepts all types of ciphers in general, but\nrequires a strong cipher for access to a particular URL?\nHow can I create an SSL server which accepts strong encryption\nonly?\nThe following enables only the strongest ciphers:\nSSLCipherSuite HIGH:!aNULL:!MD5\nWhile with the following configuration you specify a preference\nfor specific speed-optimized ciphers (which will be selected by\nmod_ssl, provided that they are supported by the client):\nSSLCipherSuite RC4-SHA:AES128-SHA:HIGH:!aNULL:!MD5\nSSLHonorCipherOrder on\nHow can I create an SSL server which accepts all types of ciphers\nin general, but requires a strong ciphers for access to a particular\nURL?\nObviously, a server-wide\nSSLCipherSuite\nwhich restricts\nciphers to the strong variants, isn't the answer here. However,\nmod_ssl\ncan be reconfigured within\nLocation\nblocks, to give a per-directory solution, and can automatically force\na renegotiation of the SSL parameters to meet the new configuration.\nThis can be done as follows:\n# be liberal in general\nSSLCipherSuite ALL:!aNULL:RC4+RSA:+HIGH:+MEDIUM:+LOW:+EXP:+eNULL\n<Location \"/strong/area\">\n# but https://hostname/strong/area/ and below\n# requires strong ciphers\nSSLCipherSuite HIGH:!aNULL:!MD5\n</Location>\nOCSP Stapling\nThe Online Certificate Status Protocol (OCSP) is a mechanism for\ndetermining whether or not a server certificate has been revoked, and OCSP\nStapling is a special form of this in which the server, such as httpd and\nmod_ssl, maintains current OCSP responses for its certificates and sends\nthem to clients which communicate with the server.  Most certificates\ncontain the address of an OCSP responder maintained by the issuing\nCertificate Authority, and mod_ssl can communicate with that responder to\nobtain a signed response that can be sent to clients communicating with\nthe server.\nBecause the client can obtain the certificate revocation status from\nthe server, without requiring an extra connection from the client to the\nCertificate Authority, OCSP Stapling is the preferred way for the\nrevocation status to be obtained.  Other benefits of eliminating the\ncommunication between clients and the Certificate Authority are that the\nclient browsing history is not exposed to the Certificate Authority and\nobtaining status is more reliable by not depending on potentially heavily\nloaded Certificate Authority servers.\nBecause the response obtained by the server can be reused for all clients\nusing the same certificate during the time that the response is valid, the\noverhead for the server is minimal.\nOnce general SSL support has been configured properly, enabling OCSP\nStapling generally requires only very minor modifications to the httpd\nconfiguration â the addition of these two directives:\nSSLUseStapling On\nSSLStaplingCache \"shmcb:logs/ssl_stapling(32768)\"\nThese directives are placed at global scope (i.e., not within a virtual\nhost definition) wherever other global SSL configuration directives are\nplaced, such as in\nconf/extra/httpd-ssl.conf\nfor normal\nopen source builds of httpd,\n/etc/apache2/mods-enabled/ssl.conf\nfor the Ubuntu or Debian-bundled httpd, etc.\nThe path on the\nSSLStaplingCache\ndirective\n(e.g.,\nlogs/\n) should match the one on the\nSSLSessionCache\ndirective.  This path is relative\nto\nServerRoot\n.\nThis particular\nSSLStaplingCache\ndirective requires\nmod_socache_shmcb\n(from the\nshmcb\nprefix on the\ndirective's argument).  This module is usually enabled already for\nSSLSessionCache\nor on behalf of some module other than\nmod_ssl\n.  If you enabled an SSL session cache using a\nmechanism other than\nmod_socache_shmcb\n, use that alternative\nmechanism for\nSSLStaplingCache\nas well.  For example:\nSSLSessionCache \"dbm:logs/ssl_scache\"\nSSLStaplingCache \"dbm:logs/ssl_stapling\"\nYou can use the openssl command-line program to verify that an OCSP response\nis sent by your server:\n$ openssl s_client -connect www.example.com:443 -status -servername www.example.com\n...\nOCSP response:\n======================================\nOCSP Response Data:\nOCSP Response Status: successful (0x0)\nResponse Type: Basic OCSP Response\n...\nCert Status: Good\n...\nThe following sections highlight the most common situations which require\nfurther modification to the configuration.  Refer also to the\nmod_ssl\nreference manual.\nIf more than a few SSL certificates are used for the server\nOCSP responses are stored in the SSL stapling cache.  While the responses\nare typically a few hundred to a few thousand bytes in size, mod_ssl\nsupports OCSP responses up to around 10K bytes in size.  With more than a\nfew certificates, the stapling cache size (32768 bytes in the example above)\nmay need to be increased.  Error message AH01929 will be logged in case of\nan error storing a response.\nIf the certificate does not point to an OCSP responder, or if a\ndifferent address must be used\nRefer to the\nSSLStaplingForceURL\ndirective.\nYou can confirm that a server certificate points to an OCSP responder\nusing the openssl command-line program, as follows:\n$ openssl x509 -in ./www.example.com.crt -text | grep 'OCSP.*http'\nOCSP - URI:http://ocsp.example.com\nIf the OCSP URI is provided and the web server can communicate to it\ndirectly without using a proxy, no configuration is required.  Note that\nfirewall rules that control outbound connections from the web server may\nneed to be adjusted.\nIf no OCSP URI is provided, contact your Certificate Authority to\ndetermine if one is available; if so, configure it with\nSSLStaplingForceURL\nin the virtual\nhost that uses the certificate.\nIf multiple SSL-enabled virtual hosts are configured and OCSP\nStapling should be disabled for some\nAdd\nSSLUseStapling Off\nto the virtual hosts for which OCSP\nStapling should be disabled.\nIf the OCSP responder is slow or unreliable\nSeveral directives are available to handle timeouts and errors.  Refer\nto the documentation for the\nSSLStaplingFakeTryLater\n,\nSSLStaplingResponderTimeout\n, and\nSSLStaplingReturnResponderErrors\ndirectives.\nIf mod_ssl logs error AH02217\nAH02217: ssl_stapling_init_cert: Can't retrieve issuer certificate!\nIn order to support OCSP Stapling when a particular server certificate is\nused, the certificate chain for that certificate must be configured.  If it\nwas not configured as part of enabling SSL, the AH02217 error will be issued\nwhen stapling is enabled, and an OCSP response will not be provided for clients\nusing the certificate.\nRefer to the\nSSLCertificateChainFile\nand\nSSLCertificateFile\nfor instructions\nfor configuring the certificate chain.\nClient Authentication and Access Control\nHow can I force clients to authenticate using certificates?\nHow can I force clients to authenticate using certificates for a\nparticular URL, but still allow arbitrary clients to access the rest of the server?\nHow can I allow only clients who have certificates to access a\nparticular URL, but allow all clients to access the rest of the server?\nHow can I require HTTPS with strong ciphers, and either\nbasic authentication or client certificates, for access to part of the\nIntranet website, for clients coming from the Internet?\nHow can I force clients to authenticate using certificates?\nWhen you know all of your users (eg, as is often the case on a corporate\nIntranet), you can require plain certificate authentication. All you\nneed to do is to create client certificates signed by your own CA\ncertificate (\nca.crt\n) and then verify the clients against this\ncertificate.\n# require a client certificate which has to be directly\n# signed by our CA certificate in ca.crt\nSSLVerifyClient require\nSSLVerifyDepth 1\nSSLCACertificateFile \"conf/ssl.crt/ca.crt\"\nHow can I force clients to authenticate using certificates for a\nparticular URL, but still allow arbitrary clients to access the rest of the server?\nTo force clients to authenticate using certificates for a particular URL,\nyou can use the per-directory reconfiguration features of\nmod_ssl\n:\nSSLVerifyClient none\nSSLCACertificateFile \"conf/ssl.crt/ca.crt\"\n<Location \"/secure/area\">\nSSLVerifyClient require\nSSLVerifyDepth 1\n</Location>\nHow can I allow only clients who have certificates to access a\nparticular URL, but allow all clients to access the rest of the server?\nThe key to doing this is checking that part of the client certificate\nmatches what you expect. Usually this means checking all or part of the\nDistinguished Name (DN), to see if it contains some known string.\nThere are two ways to do this, using either\nmod_auth_basic\nor\nSSLRequire\n.\nThe\nmod_auth_basic\nmethod is generally required when\nthe certificates are completely arbitrary, or when their DNs have\nno common fields (usually the organisation, etc.). In this case,\nyou should establish a password database containing\nall\nclients allowed, as follows:\nSSLVerifyClient      none\nSSLCACertificateFile \"conf/ssl.crt/ca.crt\"\nSSLCACertificatePath \"conf/ssl.crt\"\n<Directory \"/usr/local/apache2/htdocs/secure/area\">\nSSLVerifyClient      require\nSSLVerifyDepth       5\nSSLOptions           +FakeBasicAuth\nSSLRequireSSL\nAuthName             \"Snake Oil Authentication\"\nAuthType             Basic\nAuthBasicProvider    file\nAuthUserFile         \"/usr/local/apache2/conf/httpd.passwd\"\nRequire              valid-user\n</Directory>\nThe password used in this example is the DES encrypted string \"password\".\nSee the\nSSLOptions\ndocs for more\ninformation.\nhttpd.passwd\n/C=DE/L=Munich/O=Snake Oil, Ltd./OU=Staff/CN=Foo:xxj31ZMTZzkVA\n/C=US/L=S.F./O=Snake Oil, Ltd./OU=CA/CN=Bar:xxj31ZMTZzkVA\n/C=US/L=L.A./O=Snake Oil, Ltd./OU=Dev/CN=Quux:xxj31ZMTZzkVA\nWhen your clients are all part of a common hierarchy, which is encoded\ninto the DN, you can match them more easily using\nSSLRequire\n, as follows:\nSSLVerifyClient      none\nSSLCACertificateFile \"conf/ssl.crt/ca.crt\"\nSSLCACertificatePath \"conf/ssl.crt\"\n<Directory \"/usr/local/apache2/htdocs/secure/area\">\nSSLVerifyClient      require\nSSLVerifyDepth       5\nSSLOptions           +FakeBasicAuth\nSSLRequireSSL\nSSLRequire       %{SSL_CLIENT_S_DN_O}  eq \"Snake Oil, Ltd.\" \\\nand %{SSL_CLIENT_S_DN_OU} in {\"Staff\", \"CA\", \"Dev\"}\n</Directory>\nHow can I require HTTPS with strong ciphers, and either basic\nauthentication or client certificates, for access to part of the\nIntranet website, for clients coming from the Internet? I still want to allow\nplain HTTP access for clients on the Intranet.\nThese examples presume that clients on the Intranet have IPs in the range\n192.168.1.0/24, and that the part of the Intranet website you want to allow\ninternet access to is\n/usr/local/apache2/htdocs/subarea\n.\nThis configuration should remain outside of your HTTPS virtual host, so\nthat it applies to both HTTPS and HTTP.\nSSLCACertificateFile \"conf/ssl.crt/company-ca.crt\"\n<Directory \"/usr/local/apache2/htdocs\">\n#   Outside the subarea only Intranet access is granted\nRequire              ip 192.168.1.0/24\n</Directory>\n<Directory \"/usr/local/apache2/htdocs/subarea\">\n#   Inside the subarea any Intranet access is allowed\n#   but from the Internet only HTTPS + Strong-Cipher + Password\n#   or the alternative HTTPS + Strong-Cipher + Client-Certificate\n#   If HTTPS is used, make sure a strong cipher is used.\n#   Additionally allow client certs as alternative to basic auth.\nSSLVerifyClient      optional\nSSLVerifyDepth       1\nSSLOptions           +FakeBasicAuth +StrictRequire\nSSLRequire           %{SSL_CIPHER_USEKEYSIZE} >= 128\n#   Force clients from the Internet to use HTTPS\nRewriteEngine        on\nRewriteCond          \"%{REMOTE_ADDR}\" \"!^192\\.168\\.1\\.[0-9]+$\"\nRewriteCond          \"%{HTTPS}\" \"!=on\"\nRewriteRule          \".\" \"-\" [F]\n#   Allow Network Access and/or Basic Auth\nSatisfy              any\n#   Network Access Control\nRequire              ip 192.168.1.0/24\n#   HTTP Basic Authentication\nAuthType             basic\nAuthName             \"Protected Intranet Area\"\nAuthBasicProvider    file\nAuthUserFile         \"conf/protected.passwd\"\nRequire              valid-user\n</Directory>\nLogging\nmod_ssl\ncan log extremely verbose debugging information\nto the error log, when its\nLogLevel\nis\nset to the higher trace levels. On the other hand, on a very busy server,\nlevel\ninfo\nmay already be too much. Remember that you can\nconfigure the\nLogLevel\nper module to\nsuite your needs.\nAvailable Languages:\nen\n|\nfr\nComments\nNotice:\nThis is not a Q&A section. Comments placed here should be pointed towards suggestions on improving the documentation or server, and may be removed by our moderators if they are either implemented or considered invalid/off-topic. Questions on how to manage the Apache HTTP Server should be directed at either our IRC channel, #httpd, on Libera.chat, or sent to our\nmailing lists\n.\nCopyright 2025 The Apache Software Foundation.\nLicensed under the\nApache License, Version 2.0\n.\nModules\n|\nDirectives\n|\nFAQ\n|\nGlossary\n|\nSitemap", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://httpd.apache.org/docs/current/ssl/ssl_howto.html"}}
{"text": "Welcome — Caddy Documentation\nDocumentation\na\nproject\nWelcome to Caddy\nCaddy is a powerful, extensible platform to serve your sites, services, and apps, written in Go. If you're new to Caddy, the way you serve the Web is about to change.\nIntroduction\nMost people use Caddy as a web server or proxy, but at its core, Caddy is a server of servers. With the\nrequisite modules\n, it can take on the role of any long-running process!\nConfiguration is both dynamic and exportable with\nCaddy's API\n. Although no config files required, you can still use them; most people's favorite way of configuring Caddy is using the\nCaddyfile\n. The format of the config document takes many forms with\nconfig adapters\n, but Caddy's native config language is\nJSON\n.\nCaddy compiles for all major platforms and has no runtime dependencies.\nFirst time?\nNo problem!\nWe suggest that\neveryone\nregardless of experience go through our\nGetting Started guide\n.\nIt will give you a well-rounded perspective on your new web server that will be invaluable as you continue learning.\nIf you only have a few minutes and need to hit the ground running, try one of our\nquick starts\n.\nFor expanded content like specific examples, check out\nour community wiki\n- then contribute to it!\nWe recommend sticking to these official resources to\ninstall\n,\nconfigure\n, and\nrun\nCaddy, rather than running commands or copying config snippets from random blogs and Q&A boards. You will find that our material is generally more accurate and up-to-date. We also encourage you to craft your own configurations to ensure that you understand how your server works so you'll be more able to fix problems if they arise later on.\nBut whatever you do, enjoy using your new web server. Caddy is an experience unlike any other server software you've used!\nGetting help\nIf you need help using Caddy, please ask nicely in\nour community forum\n. We would be happy to help you. All we ask is that you fill out the help template as thoroughly as possible, and pay it forward by helping others. We always need more helpers.\nOnly use\nour issue tracker\nif you've positively identified a bug in Caddy or have a specific feature request.\nThis website is\nmaintained on GitHub\n. To submit improvements, open an issue or pull request.\nThank you for participating in our community! We hope Caddy will serve you well.", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://caddyserver.com/docs/"}}
{"text": "Quick-starts — Caddy Documentation\nDocumentation\na\nproject\nQuick-starts\nThese tutorials are designed to get you up and running quickly without much explanation to get in the way.\nIt is\nhighly recommended\nthat you follow-up by reading other tutorials and reference documentation to fully understand how your web server works.\nMenu\nUsing the API\nUsing a Caddyfile\nStatic file server\nReverse proxy\nHTTPS", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://caddyserver.com/docs/quick-starts"}}
{"text": "The Caddyfile — Caddy Documentation\nDocumentation\na\nproject\nThe Caddyfile\nThe\nCaddyfile\nis a convenient Caddy configuration format for humans. It is most people's favorite way to use Caddy because it is easy to write, easy to understand, and expressive enough for most use cases.\nIt looks like this:\nexample.com\n{\nroot\n*\n/var/www/wordpress\nencode\nphp_fastcgi\nunix//run/php/php-version-fpm.sock\nfile_server\n}\n(That's a real, production-ready Caddyfile that serves WordPress with fully-managed HTTPS.)\nThe basic idea is that you first type the address of your site, then the features or functionality you need your site to have.\nView more common patterns.\nMenu\nQuick start guide\nA good place to begin getting familiar with the Caddyfile.\nFull Caddyfile tutorial\nLearn to do a variety of common things with the Caddyfile.\nCaddyfile concepts\nRequired reading! Structure, site addresses, matchers, placeholders, and more.\nDirectives\nKeywords at the beginning of lines that enable features for your sites.\nRequest matchers\nFilter requests by using matchers with your directives.\nGlobal options\nSettings that apply to the whole server rather than individual sites.\nCommon patterns\nSimple ways to do common things.\nNote\nThe Caddyfile is just a\nconfig adapter\nfor Caddy. It is usually preferred when manually crafting configurations by hand, but is not as expressive, flexible, or programmable as Caddy's\nnative JSON structure\n. If you are automating your Caddy configurations/deployments, you may wish to use JSON with\nCaddy's API\n. (You can actually use the Caddyfile with the API too, just to a limited extent.)", "metadata": {"source_type": "vendor_docs", "trust": "vendor_docs", "os": "linux", "distro": "ubuntu-22.04", "license": "CC BY-SA (assumed; verify per site)", "attribution_url": "https://caddyserver.com/docs/caddyfile"}}
